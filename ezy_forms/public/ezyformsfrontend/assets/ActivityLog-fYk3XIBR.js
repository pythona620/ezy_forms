import{_ as A,e as D,d as e,w as d,I as S,o as w,c as E,b as o,a as v,G as U,P as V,E as F,k as g,l as y,n as h}from"./index-BHd6CXej.js";const I={class:"mt-2"},O={__name:"ActivityLog",setup(R){const L=D(()=>F.value),m=e(0),l=e([]);e(["yes","no"]),e([]),e(""),e(null),e(""),e([]),e({ezy_departments_items:[]});const b=e([]);e([{name:"View Categories",icon:"fa-solid fa-eye"}]);const s=e({limitPageLength:20,limit_start:0,filters:[]}),c=e({department_code:"",department_name:""}),k=e([]),p=e([{th:"User Name",td_key:"full_name"},{th:"User Id",td_key:"user"},{th:"Type of Activity",td_key:"subject"},{th:"Date",td_key:"communication_date"},{th:"Ip Address",td_key:"ip_address"},{th:"Status",td_key:"status"}]),x=e({full_name:{type:"input"},subject:{type:"input"},status:{type:"select",options:["Success","Failed"]}}),u=e({department_code:"",department_name:"",business_unit:"",ezy_departments_items:[]});d(()=>u.value.department_code,t=>{const i=t.trim().toLowerCase();k.value.filter(a=>a!==null).map(a=>a.trim().toLowerCase()).includes(i)?c.value.department_code="Department code already exists.":c.value.department_code=""}),d(()=>u.value.department_name,t=>{const i=t.trim().toLowerCase();b.value.filter(a=>a!==null).map(a=>a.trim().toLowerCase()).includes(i)?c.value.department_name="Department name already exists.":c.value.department_name=""}),S({applieddepartment_name:!1,applieddepartment_code:!1,department_name:"",department_code:""}),d(L,t=>{u.value.business_unit=t,t.length&&r()},{immediate:!0});const _=e(null);function C(t){clearTimeout(_.value),_.value=setTimeout(()=>{s.value.filters=[],p.value.forEach(i=>{const n=i.td_key;t[n]&&s.value.filters.push([n,"like",`%${t[n]}%`])}),s.value.filters.length?r(s.value.filters):r()},500)}const P=t=>{s.value.limitPageLength=t,s.value.limit_start=0,r()},N=([t,i])=>{s.value.limitPageLength=t,s.value.limit_start=i,r()};function r(t){t&&s.value.filters.push(...t);const i={fields:JSON.stringify(["*"]),filters:JSON.stringify(s.value.filters),limit_page_length:s.value.limitPageLength,limit_start:s.value.limit_start,order_by:"`tabActivity Log`.`creation` desc"},n={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(s.value.filters)};g.get(`${y.resource}${h.ActivityLog}`,{params:n}).then(a=>{m.value=a.data[0].total_count}).catch(a=>{console.error("Error fetching ezyForms data:",a)}),g.get(y.resource+h.ActivityLog,{params:i}).then(a=>{if(a.data){const f=a.data;s.value.limit_start===0?l.value=f:l.value=l.value.concat(f)}}).catch(a=>{console.error("Error fetching department data:",a)})}return(t,i)=>(w(),E("div",null,[i[0]||(i[0]=o("div",{class:"d-flex justify-content-between align-items-center py-2"},[o("div",null,[o("h1",{class:"mt-3 font-13"}," Activity Log ")]),o("div",{class:"d-flex gap-2 align-items-center"})],-1)),o("div",I,[v(U,{tHeaders:p.value,tData:l.value,isCheckbox:"true",isFiltersoption:"true","field-mapping":x.value,onUpdateFilters:C},null,8,["tHeaders","tData","field-mapping"]),v(V,{currentRecords:l.value.length,totalRecords:m.value,onUpdateValue:P,onLimitStart:N},null,8,["currentRecords","totalRecords"])])]))}},z=A(O,[["__scopeId","data-v-9bf728e0"]]);export{z as default};
