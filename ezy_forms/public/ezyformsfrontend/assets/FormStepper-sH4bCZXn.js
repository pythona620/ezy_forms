var Wl=Object.defineProperty,Hl=Object.defineProperties;var Jl=Object.getOwnPropertyDescriptors;var _t=Object.getOwnPropertySymbols;var ss=Object.prototype.hasOwnProperty,ls=Object.prototype.propertyIsEnumerable;var ts=(j,A,M)=>A in j?Wl(j,A,{enumerable:!0,configurable:!0,writable:!0,value:M}):j[A]=M,ne=(j,A)=>{for(var M in A||(A={}))ss.call(A,M)&&ts(j,M,A[M]);if(_t)for(var M of _t(A))ls.call(A,M)&&ts(j,M,A[M]);return j},ze=(j,A)=>Hl(j,Jl(A));var Ut=(j,A)=>{var M={};for(var S in j)ss.call(j,S)&&A.indexOf(S)<0&&(M[S]=j[S]);if(j!=null&&_t)for(var S of _t(j))A.indexOf(S)<0&&ls.call(j,S)&&(M[S]=j[S]);return M};var Qe=(j,A,M)=>new Promise((S,E)=>{var de=X=>{try{f(M.next(X))}catch(ce){E(ce)}},he=X=>{try{f(M.throw(X))}catch(ce){E(ce)}},f=X=>X.done?S(X.value):Promise.resolve(X.value).then(de,he);f((M=M.apply(j,A)).next())});import{_ as Rt,r as _,x as me,o as n,c as i,d as t,i as D,j as P,F as B,h as N,t as h,m as k,l as b,Z as Lt,Q as gt,n as W,k as qe,a6 as ms,b as se,L as U,a7 as os,N as ke,U as ie,H as fe,u as Gl,M as Yl,e as ve,E as Zl,w as Ae,f as Kl,a8 as as,K as be,y as K,z as Q,S as ns,O as at,B as is,R as Pe,X as _e,v as ht,a9 as rs,aa as ds,ab as Ql,ac as Tt,a2 as us,ad as cs,D as ps,ae as Xl}from"./index-Ccx5AK26.js";const xl="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",Il={class:"simple-field-library"},eo={class:"field-search"},to={class:"field-types-grid"},so=["onDragstart","onClick"],lo={__name:"SimpleFieldLibrary",props:{fields:{type:Array,required:!0}},emits:["field-add","field-dragstart","field-dragend"],setup(j,{emit:A}){const M=j,S=A,E=_(""),de=_(!1),he=me(()=>{if(!E.value)return M.fields;const z=E.value.toLowerCase();return M.fields.filter(re=>re.label.toLowerCase().includes(z))}),f=(z,re)=>{de.value=!0,z.dataTransfer.effectAllowed="copy",z.dataTransfer.setData("text/plain",re.type),S("field-dragstart",re.type)},X=()=>{de.value=!1,S("field-dragend")},ce=z=>{S("field-add",z.type)};return(z,re)=>(n(),i("div",Il,[t("div",eo,[re[1]||(re[1]=t("i",{class:"bi bi-search"},null,-1)),D(t("input",{"onUpdate:modelValue":re[0]||(re[0]=x=>E.value=x),type:"text",placeholder:"Search fields",class:"search-input"},null,512),[[P,E.value]])]),t("div",to,[(n(!0),i(B,null,N(he.value,x=>(n(),i("button",{key:x.type,class:"field-type-btn",draggable:!0,onDragstart:I=>f(I,x),onDragend:X,onClick:I=>ce(x)},h(x.label),41,so))),128))])]))}},oo=Rt(lo,[["__scopeId","data-v-cb64d6f9"]]),ao={class:"frappe-form-builder"},no={class:"builder-toolbar"},io={class:"d-flex gap-2"},ro=["disabled"],uo=["disabled"],co={class:"sections-container"},po={key:0,class:"empty-state"},mo={class:"section-header"},fo={class:"section-info flex-grow-1"},vo=["onUpdate:modelValue"],bo={class:"section-actions d-flex gap-2 align-items-center"},_o=["onUpdate:modelValue"],ho=["onClick"],go={class:"section-body"},yo=["onClick"],wo={class:"field-card"},ko={class:"field-header"},$o={class:"field-actions"},Co=["onClick"],Fo=["onClick"],Do={class:"field-body"},So=["onUpdate:modelValue","onInput"],Ao=["onUpdate:modelValue","onChange"],qo=["value"],Vo={class:"mb-2"},Eo={class:"small"},Uo={key:0,class:"mb-2"},To=["onUpdate:modelValue","placeholder"],Lo=["onUpdate:modelValue","placeholder"],Ro={class:"d-flex gap-2 mb-2 flex-wrap"},Mo={class:"form-check"},Oo=["onUpdate:modelValue","id"],Bo=["for"],No={class:"form-check"},zo=["onUpdate:modelValue","id"],Po=["for"],jo=["onUpdate:modelValue"],Wo={key:1,class:"empty-fields-state"},Ho={__name:"FrappeFormBuilder",props:{formName:{type:String,default:""},existingFields:{type:Array,default:()=>[]},currentBlockIndex:{type:Number,default:0}},emits:["save","update","addFields"],setup(j,{expose:A,emit:M}){const S=M,E=_([]),de=_([{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}]),he=_(!1),f=_(1),X=_(1),ce=()=>({id:`section_${X.value++}`,label:"",columns:2,fields:[]}),z=()=>{const V=ce();E.value.push(V),S("update",q())},re=V=>{const F=E.value[V].label||"this section";confirm(`Delete "${F}" and all its fields?`)&&(E.value.splice(V,1),S("update",q()))},x=()=>({id:`field_${f.value++}`,fieldname:"",fieldtype:"Data",label:"",description:"",options:"",reqd:0,read_only:0,hidden:0,default:"",depends_on:"",mandatory_depends_on:"",read_only_depends_on:"",permlevel:0,in_list_view:0,in_standard_filter:0,in_global_search:0,bold:0,allow_bulk_edit:0,allow_in_quick_entry:0,allow_on_submit:0,ignore_user_permissions:0,ignore_xss_filter:0,translatable:0,unique:0,fetch_from:"",fetch_if_empty:0,columns:0,length:0,precision:"",non_negative:0,report_hide:0,collapsible:0,collapsible_depends_on:"",print_hide:0,print_hide_if_no_value:0,sort_options:0,remember_last_selected_value:0,is_virtual:0,search_index:0,documentation_url:""}),I=V=>{const $=x();E.value[V].fields.push($),S("update",q())},J=(V,$)=>{const F=ne({},E.value[V].fields[$]);F.id=`field_${f.value++}`,F.fieldname=`${F.fieldname}_copy`,F.label=`${F.label} (Copy)`,E.value[V].fields.push(F),S("update",q())},H=(V,$)=>{const F=E.value[V].fields[$].label||"this field";confirm(`Delete "${F}"?`)&&(E.value[V].fields.splice($,1),S("update",q()))},Ve=()=>{confirm("Clear all sections and fields?")&&(E.value=[],S("update",[]))},$e=(V,$)=>{const F=E.value[V].fields[$];F.label&&(F.fieldname=F.label.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),S("update",q()))},We=(V,$)=>{const F=E.value[V].fields[$];Ce(F.fieldtype)||(F.options=""),S("update",q())},Ce=V=>["Select","Link","Table","Table MultiSelect","Small Text"].includes(V),nt=V=>V==="Select"||V==="Small Text"?`Option 1
Option 2
Option 3`:V==="Link"?"DocType Name (e.g., Customer)":V==="Table"?"Child DocType Name":"Enter options",yt=V=>/^[a-z_][a-z0-9_]*$/.test(V),q=()=>{const V=[];return E.value.forEach($=>{$.fields.forEach(F=>{V.push(F)})}),V},oe=()=>{for(const $ of E.value)for(const F of $.fields){if(!F.label||!F.fieldname||!F.fieldtype){ie("All fields must have a label, fieldname, and type");return}if(!yt(F.fieldname)){ie(`Invalid fieldname: ${F.fieldname}`);return}if(Ce(F.fieldtype)&&(!F.options||!F.options.trim())){ie(`Options required for ${F.fieldtype} field: ${F.label}`);return}}S("addFields",E.value);const V=q().length;fe(`${E.value.length} section(s) with ${V} field(s) added to form!`),E.value=[]};return A({sections:E,addFieldsToCurrentBlock:oe,addNewSection:z,getAllFields:()=>q()}),(V,$)=>(n(),i("div",ao,[t("div",no,[t("div",io,[t("button",{onClick:z,class:"btn btn-primary btn-sm"},$[3]||($[3]=[t("i",{class:"bi bi-plus-circle"},null,-1),k(" Add Section ")])),t("button",{onClick:oe,class:"btn btn-success btn-sm",disabled:E.value.length===0},$[4]||($[4]=[t("i",{class:"bi bi-check-circle"},null,-1),k(" Add to Form ")]),8,ro),t("button",{onClick:Ve,class:"btn btn-outline-secondary btn-sm",disabled:E.value.length===0},$[5]||($[5]=[t("i",{class:"bi bi-trash"},null,-1),k(" Clear All ")]),8,uo)])]),t("div",co,[E.value.length===0?(n(),i("div",po,$[6]||($[6]=[t("i",{class:"bi bi-inbox"},null,-1),t("p",null,'No sections yet. Click "Add Section" to start building your form.',-1)]))):b("",!0),E.value.length>0?(n(),Lt(U(os),{key:1,modelValue:E.value,"onUpdate:modelValue":$[0]||($[0]=F=>E.value=F),"item-key":F=>F.id,handle:".section-drag-handle",onStart:$[1]||($[1]=F=>he.value=!0),onEnd:$[2]||($[2]=F=>he.value=!1),animation:200,"ghost-class":"ghost-section"},{item:gt(({element:F,index:pe})=>[t("div",{class:W(["section-card",{dragging:he.value}])},[t("div",mo,[$[9]||($[9]=t("div",{class:"section-drag-handle"},[t("i",{class:"bi bi-grip-vertical"})],-1)),t("div",fo,[D(t("input",{"onUpdate:modelValue":T=>F.label=T,placeholder:"Section Label (e.g., Customer Details)",class:"form-control form-control-sm fw-bold"},null,8,vo),[[P,F.label]])]),t("div",bo,[D(t("select",{"onUpdate:modelValue":T=>F.columns=T,class:"form-select form-select-sm",style:{width:"auto"}},$[7]||($[7]=[t("option",{value:1},"1 Column",-1),t("option",{value:2},"2 Columns",-1),t("option",{value:3},"3 Columns",-1),t("option",{value:4},"4 Columns",-1)]),8,_o),[[qe,F.columns,void 0,{number:!0}]]),t("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:T=>re(pe),title:"Remove Section"},$[8]||($[8]=[t("i",{class:"bi bi-trash"},null,-1)]),8,ho)])]),t("div",go,[t("button",{onClick:T=>I(pe),class:"btn btn-outline-primary btn-sm mb-3"},$[10]||($[10]=[t("i",{class:"bi bi-plus"},null,-1),k(" Add Field to Section ")]),8,yo),F.fields.length>0?(n(),i("div",{key:0,class:"fields-grid",style:ms({gridTemplateColumns:`repeat(${F.columns}, 1fr)`})},[se(U(os),{modelValue:F.fields,"onUpdate:modelValue":T=>F.fields=T,"item-key":T=>T.id,handle:".field-drag-handle",animation:200,"ghost-class":"ghost-field",class:"fields-draggable-container",style:{display:"contents"}},{item:gt(({element:T,index:L})=>[t("div",wo,[t("div",ko,[$[13]||($[13]=t("div",{class:"field-drag-handle"},[t("i",{class:"bi bi-grip-vertical"})],-1)),t("div",$o,[t("button",{class:"btn btn-sm btn-link text-primary p-0",onClick:O=>J(pe,L),title:"Duplicate"},$[11]||($[11]=[t("i",{class:"bi bi-files"},null,-1)]),8,Co),t("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:O=>H(pe,L),title:"Delete"},$[12]||($[12]=[t("i",{class:"bi bi-trash"},null,-1)]),8,Fo)])]),t("div",Do,[D(t("input",{"onUpdate:modelValue":O=>T.label=O,placeholder:"Field Label",class:"form-control form-control-sm mb-2",onInput:O=>$e(pe,L)},null,40,So),[[P,T.label]]),D(t("select",{"onUpdate:modelValue":O=>T.fieldtype=O,class:"form-select form-select-sm mb-2",onChange:O=>We(pe,L)},[$[14]||($[14]=t("option",{value:""},"Select Type",-1)),(n(!0),i(B,null,N(de.value,O=>(n(),i("option",{key:O.type,value:O.type},h(O.label),9,qo))),128))],40,Ao),[[qe,T.fieldtype]]),t("div",Vo,[$[15]||($[15]=t("small",{class:"text-muted d-block"},"Fieldname:",-1)),t("code",Eo,h(T.fieldname),1)]),Ce(T.fieldtype)?(n(),i("div",Uo,[T.fieldtype==="Select"||T.fieldtype==="Small Text"?D((n(),i("textarea",{key:0,"onUpdate:modelValue":O=>T.options=O,class:"form-control form-control-sm",rows:"3",placeholder:nt(T.fieldtype)},null,8,To)),[[P,T.options]]):D((n(),i("input",{key:1,"onUpdate:modelValue":O=>T.options=O,type:"text",class:"form-control form-control-sm",placeholder:nt(T.fieldtype)},null,8,Lo)),[[P,T.options]])])):b("",!0),t("div",Ro,[t("div",Mo,[D(t("input",{"onUpdate:modelValue":O=>T.reqd=O,type:"checkbox",class:"form-check-input",id:`reqd-${pe}-${L}`,"true-value":1,"false-value":0},null,8,Oo),[[ke,T.reqd]]),t("label",{class:"form-check-label small",for:`reqd-${pe}-${L}`},"Required",8,Bo)]),t("div",No,[D(t("input",{"onUpdate:modelValue":O=>T.unique=O,type:"checkbox",class:"form-check-input",id:`unique-${pe}-${L}`,"true-value":1,"false-value":0},null,8,zo),[[ke,T.unique]]),t("label",{class:"form-check-label small",for:`unique-${pe}-${L}`},"Unique",8,Po)])]),D(t("input",{"onUpdate:modelValue":O=>T.description=O,type:"text",class:"form-control form-control-sm",placeholder:"Description (optional)"},null,8,jo),[[P,T.description]])])])]),_:2},1032,["modelValue","onUpdate:modelValue","item-key"])],4)):(n(),i("div",Wo,$[16]||($[16]=[t("small",{class:"text-muted"},'No fields in this section. Click "Add Field to Section" above.',-1)])))])],2)]),_:1},8,["modelValue","item-key"])):b("",!0)])]))}},Jo=Rt(Ho,[["__scopeId","data-v-257e8b1a"]]),Go={class:""},Yo={class:""},Zo={class:"d-flex justify-content-between align-items-center CancelNdSave"},Ko={class:"d-flex align-items-center"},Qo={key:0,class:"font-16"},Xo=["disabled"],xo={class:"form-container p-0 container-fluid mt-3"},Io={class:"row g-4"},ea={class:"col-lg-2 col-md-3 col-sm-12"},ta={class:"steps-sticky-div"},sa={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},la=["onClick"],oa={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},aa={class:"step-text"},na={class:"font-11"},ia={class:"font-14"},ra={class:"col-lg-10 col-md-9 col-sm-12 formbackground-color"},da={class:"px-2"},ua={class:"form-content stepsDiv"},ca={key:0},pa={class:""},ma={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},fa={class:"container-fluid aboutFields p-0"},va={class:"row"},ba={class:"col-sm-12 col-md-12 mt-lg-3 p-lg-4"},_a={class:"container-fluid"},ha={class:"row g-3"},ga={class:"col-md-6"},ya={class:"position-relative"},wa={key:0,class:"font-12 position-absolute PredefinedLabel"},ka={key:1,class:"text-danger ErrorMsg ms-2"},$a={class:"col-md-6"},Ca={key:0,class:"text-danger ErrorMsg ms-2"},Fa={class:"col-md-6"},Da={class:"col-md-6"},Sa={key:0,class:"text-danger"},Aa={class:"col-md-6"},qa={key:0,class:"text-danger"},Va={class:"col-md-6"},Ea={key:0,class:"text-danger"},Ua={class:"custom-option"},Ta=["checked","onChange"],La={class:"col-md-6"},Ra={class:"col-md-6"},Ma={key:0,class:"col-md-6"},Oa={key:1,class:"col-md-6"},Ba={key:2,class:"col-md-6"},Na={key:3,class:"col-md-6"},za={class:"form-check d-flex align-items-center p-0 pe-3"},Pa=["disabled"],ja={key:4,class:"col-md-6"},Wa=["disabled"],Ha={key:0,class:"list-group position-absolute w-100 z-3 formslist"},Ja=["onMousedown"],Ga={key:1,class:"zoho-form-builder"},Ya={class:"zoho-toolbar"},Za={class:"toolbar-left"},Ka={class:"zoho-tabs"},Qa=["onClick"],Xa=["onClick"],xa={class:"toolbar-right"},Ia={class:"zoho-builder-container"},en={key:0,class:"advanced-builder-wrapper"},tn={class:"d-flex align-items-center justify-content-between w-100"},sn={class:"mb-0 font-14 fw-bold"},ln={class:"btn btn-sm btn-link p-0 text-dark"},on={key:0,class:"library-content"},an={class:"zoho-form-canvas"},nn={class:"requestandAppHeader"},rn={class:"d-flex justify-content-between align-items-center"},dn={class:""},un={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},cn={class:"text-center ms-2 mt-1"},pn={key:0,class:"font-12 d-flex align-items-center"},mn={class:"font-12 approver_type_div"},fn={class:"font-12 fw-bold"},vn={class:"font-12 text-danger ms-1"},bn={class:"d-flex align-items-center"},_n={key:0,class:"role-container"},hn={key:0,class:"role-text d-flex align-items-center"},gn={class:"role-label fw-bold"},yn={class:"role-names text-primary"},wn=["onClick"],kn=["onClick"],$n=["onClick"],Cn=["onClick"],Fn={class:"pt-0 section_block"},Dn={class:"d-flex justify-content-between align-items-center"},Sn={class:"d-flex flex-column"},An=["onUpdate:modelValue","onChange","onInput"],qn={key:0,class:"text-danger ps-3 font-10"},Vn={class:"d-flex align-items-center"},En=["onClick"],Un={class:"container-fluid"},Tn={class:"d-flex justify-content-between align-items-center"},Ln={class:"rownames m-0"},Rn=["onClick"],Mn={class:"col"},On={class:"row"},Bn=["onMouseenter"],Nn={class:"column_name d-flex align-items-center justify-content-between"},zn={class:"d-flex flex-column ps-2"},Pn=["onUpdate:modelValue","onChange","onInput"],jn={key:0,class:"text-danger ps-2 font-10"},Wn={class:"position-absolute top-0 end-0"},Hn=["onClick"],Jn=["onDrop"],Gn=["onMouseenter","onDragstart","onDrop"],Yn=["onDrop"],Zn=["onDragstart","onDrop"],Kn={class:"d-flex justify-content-between"},Qn={class:"flex-column d-flex"},Xn=["onUpdate:modelValue","onChange","onInput"],xn={key:0,class:"text-danger font-10"},In={class:"FieldcopyRemove"},ei=["onClick"],ti=["onClick"],si=["onUpdate:modelValue","onChange"],li=["value"],oi={key:0},ai=["onUpdate:modelValue"],ni={key:0,class:"text-danger font-10"},ii={key:1},ri=["for"],di=["id","onUpdate:modelValue","onInput","onFocus"],ui={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},ci=["onClick"],pi={class:"d-flex align-items-center justify-content-between"},mi={class:"d-flex align-items-center gap-2"},fi={class:"d-flex align-items-center"},vi=["onUpdate:modelValue","id"],bi=["for"],_i=["onClick"],hi=["onUpdate:modelValue"],gi={key:3,class:"text-danger font-10"},yi=["onDrop"],wi={class:"childtableShow"},ki={class:"mt-2"},$i={key:0,class:"childTableContainer"},Ci={key:0,class:"font-13"},Fi={key:1,class:"d-flex align-items-center gap-2"},Di={class:"d-flex align-items-center"},Si=["onUpdate:modelValue"],Ai=["onClick"],qi={key:2,class:"table table-bordered rounded-table"},Vi=["onDrop"],Ei=["draggable","onDragstart"],Ui={key:0},Ti=["onUpdate:modelValue","onInput"],Li={key:0,class:"text-danger font-11"},Ri={key:1},Mi={key:2},Oi={class:"d-flex gap-1"},Bi=["onUpdate:modelValue","onChange"],Ni=["value"],zi={class:"d-flex"},Pi={class:"d-flex align-items-center gap-2"},ji={class:"d-flex align-items-center"},Wi=["onUpdate:modelValue"],Hi=["onClick"],Ji={key:0},Gi=["onUpdate:modelValue","onInput"],Yi={key:0,class:"text-danger font-10"},Zi={key:1,class:"font-11 text-danger"},Ki={key:3},Qi={key:3,class:"mb-2 mt-3"},Xi=["onClick"],xi=["onClick"],Ii=["onDrop"],er=["onDrop"],tr={class:"d-flex justify-content-center align-items-center my-2"},sr=["onClick"],lr={class:"font-13"},or={key:0,class:"d-flex align-items-center gap-2"},ar={class:"d-flex align-items-center"},nr=["onUpdate:modelValue"],ir=["onClick"],rr={class:"table table-bordered rounded-table"},dr={key:0},ur=["onUpdate:modelValue","onBlur"],cr={key:0,class:"text-danger font-11 mt-1"},pr={key:1},mr={key:2},fr={class:"d-flex gap-1 align-items-center"},vr=["onUpdate:modelValue","onChange"],br=["value"],_r=["onClick"],hr={key:0,class:"mt-1"},gr=["onUpdate:modelValue","onInput"],yr={key:1,class:"text-danger font-11 mt-1"},wr={key:3},kr={class:"mb-2"},$r=["onClick"],Cr=["onClick"],Fr=["onClick"],Dr={key:0},Sr={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},Ar=["onUpdate:modelValue","onBlur"],qr={key:0,class:"text-danger font-12"},Vr={key:1,class:"text-danger font-12"},Er={class:"d-flex align-items-center gap-2"},Ur={class:"d-flex align-items-center"},Tr=["onUpdate:modelValue"],Lr=["onClick"],Rr=["onClick"],Mr={class:"px-1 field-border"},Or={class:"d-flex justify-content-between"},Br=["onUpdate:modelValue","onBlur"],Nr={key:0,class:"text-danger font-12"},zr={class:"d-flex align-items-center"},Pr={class:"d-flex my-1"},jr=["onUpdate:modelValue"],Wr=["onClick"],Hr=["onClick"],Jr=["onUpdate:modelValue"],Gr=["value"],Yr={key:0},Zr=["onUpdate:modelValue"],Kr={key:0,class:"text-danger font-10"},Qr={key:1,class:"text-danger font-12"},Xr=["onClick"],xr=["onClick"],Ir={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},ed=["onClick"],td={key:0,class:"m-2"},sd={key:0,class:"zoho-properties-panel"},ld={class:"properties-header"},od={key:2},ad={class:"stepperbackground d-flex align-items-center justify-content-between p-3"},nd={class:"container-fluid mt-4 p-4"},id={class:"card mb-4"},rd={class:"card-body"},dd={class:"row g-3"},ud={class:"col-md-6"},cd={class:"btn-group w-100",role:"group"},pd={key:0,class:"col-md-6"},md={key:0,class:"card mb-4"},fd={class:"card-body"},vd={key:0,class:"table-responsive"},bd={class:"table table-bordered"},_d=["onUpdate:modelValue"],hd={class:"form-check form-switch"},gd=["onUpdate:modelValue"],yd={class:"form-check-label font-12"},wd=["onClick"],kd=["onClick"],$d={key:1,class:"card mb-4"},Cd={class:"card-body"},Fd={class:"alert alert-success"},Dd={class:"table-responsive"},Sd={class:"table table-bordered"},Ad={key:0,class:"badge bg-success"},qd={key:1,class:"badge bg-secondary"},Vd={class:"text-muted"},Ed={key:2,class:"card mb-4"},Ud={class:"card-body"},Td={class:"alert alert-success"},Ld={class:"table-responsive"},Rd={class:"table table-bordered table-hover"},Md={class:"badge bg-dark"},Od={key:0,class:"badge bg-danger"},Bd={key:1,class:"badge bg-secondary"},Nd={key:0,class:"badge bg-info"},zd={key:1,class:"badge bg-warning text-dark"},Pd={key:2,class:"badge bg-success"},jd={key:3,class:"badge bg-secondary"},Wd={class:"text-muted"},Hd={key:3},Jd={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},Gd={class:"modal-dialog modal-dialog-centered"},Yd={class:"modal-content"},Zd={class:"modal-body"},Kd=["placeholder"],Qd={class:"d-flex align-items-center gap-2"},Xd={class:"d-flex align-items-center py-2"},xd={class:"modal fade",id:"formViewModal",tabindex:"-1","aria-labelledby":"formViewModalLabel","aria-hidden":"true"},Id={class:"modal-dialog modal-xl modal-dialog-scrollable"},eu={class:"modal-content"},tu={class:"modal-body"},su={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},lu={class:"offcanvas-header add_designationHeader"},ou={id:"offcanvasRightLabel",class:"font-14 fw-bold"},au={class:"offcanvas-body add_desig_offCanvas_body p-0"},nu={class:""},iu={key:0,class:"p-3 approval-border-bottom"},ru={class:"px-3 listofdesignations"},du={class:"my-1 d-flex justify-content-between"},uu={class:"font-12 fw-bold"},cu={class:"italic-style text-secondary font-12"},pu={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},mu={class:"d-flex align-items-center justify-content-between gap-1"},fu={class:"form-check ps-1 d-flex align-items-center m-0"},vu=["checked"],bu={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},_u={key:0,class:"form-check d-flex align-items-center m-0"},hu={key:1},gu={key:1,class:"p-3"},yu=["value"],wu={key:2},ku={class:""},$u={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},Cu={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},Fu={class:"offcanvas-footer"},Du={class:"text-end p-3"},je="Select All",Su={__name:"FormStepper",setup(j){const A=Gl(),M=Yl(),S=_(1),E=_([]);_([]);const de=_([]),he=_([]);ve([]);let f=ve([]),X=ve([]);const ce=_([]),z=_([]),re=_([]),x=_(""),I=_(""),J=_("");let H=ve([]);const Ve=_("");_(!1),_(!1),_(!1);const $e=_(""),We=_(""),Ce=_(""),nt=_([]),yt=_([]),q=ve({}),oe=_([]),V=_(!1),$=_([]),F=_(!1);let pe=null;const T=_("");let L=_("");const O=_(null),Mt=_(null),fs=_(null),Ee=_(0),Ue=_(!1),He=_(!0),Xe=_([]),Fe=_(null),we=_("new"),it=_([]),Je=_([]);_([]);const Te=_([]),Le=me(()=>Zl);_(!1);const rt=ve([]),ue=_({routepath:A.query.routepath,business_unit:A.query.business_unit,formId:A.query.id}),dt=_(""),Ge=_(!1),Ye=_(!1),Ot=[{label:"Public",value:1},{label:"Private",value:0}],Bt=me({get(){return Ot.find(s=>s.value===v.value.as_web_view)},set(s){v.value.as_web_view=s?s.value:null}}),wt=me({get(){return v.value.form_name||A.query.form_name||""},set(s){v.value.form_name=s}}),v=_({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${Le.value.value||ue.value.business_unit||A.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:A.query.id?1:0,as_web_view:0,mail_id:""});Ae(()=>A.query.form_name,s=>{s&&(v.value.form_name=s,v.value.form_short_name=s)},{immediate:!0});const ut=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(s=>s.toLowerCase().trim()),Nt=["Approver","Approved on","Approved By"].map(s=>s.toLowerCase().trim());function vs(s){return s.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}me(()=>v.value),_(""),_(!1),Ae(Le,s=>{s&&s.value&&(v.value.business_unit=s.value)},{immediate:!0});function bs(s){if(L==null||L==="new")return!1;const e=Y(s).roles;if(s===0)return e.length===0;const l=Y(s-1).roles;return l.length>0&&l[0]!==null&&l[0]!==""&&e.length===0}Ae(()=>v.value.form_name,s=>{v.value.form_name=s.trim()}),Ae(()=>v.value.form_short_name,s=>{v.value.form_short_name=s.trim()}),Ae(()=>v.value.series,s=>{v.value.series=s.trim()}),Ae(()=>we.value,s=>{s==="existing"&&(f.splice(0,f.length),Te.value=[],H.length=0)});const xe=_(null),zt=(s,e,l,o,a,r)=>{xe.value={blockIndex:e,sectionIndex:l,rowIndex:o,columnIndex:a,fieldIndex:r}},Re=(s,e,l,o,a,r)=>{if(s.preventDefault(),s.stopPropagation(),console.log("Field dropped at index:",{targetBlock:e,targetSection:l,targetRow:o,targetColumn:a,insertIndex:r,draggedField:xe.value,draggedFieldType:O.value}),O.value){console.log("Dropping from field library:",O.value);const w=es(O.value);if(!w){console.error("Failed to create field from type:",O.value);return}const C=f[e];if(!C){ie("Target block not found");return}C.sections||(C.sections=[]),C.sections[l]||(C.sections[l]={label:"",rows:[]}),C.sections[l].rows||(C.sections[l].rows=[]),C.sections[l].rows[o]||(C.sections[l].rows[o]={label:"",columns:[]}),C.sections[l].rows[o].columns||(C.sections[l].rows[o].columns=[]),C.sections[l].rows[o].columns[a]||(C.sections[l].rows[o].columns[a]={label:"",fields:[]}),C.sections[l].rows[o].columns[a].fields.splice(r,0,w),console.log("Field added successfully:",w),fe(`${w.label} field added`),O.value=null;return}if(!xe.value){console.log("No dragged field found");return}const{blockIndex:u,sectionIndex:c,rowIndex:m,columnIndex:d,fieldIndex:p}=xe.value,y=f[u].sections[c].rows[m].columns[d].fields,R=f[e].sections[l].rows[o].columns[a].fields;if(u===e&&c===l&&m===o&&d===a&&p===r)return;const g=y.splice(p,1)[0];y===R&&p<r&&r--,R.splice(r,0,g),xe.value=null},Ze=_(""),_s=s=>Qe(this,null,function*(){const e=[["module","in",["User Forms"]],["istable","=",1]];s!=null&&s.trim()&&e.push(["name","=",`${s}`]);const l={fields:JSON.stringify(["name"]),filters:JSON.stringify(e),limit_page_length:"None",doctype:be.doctypesList};try{return(yield K.get(Q.GetDoctypeData,{params:l})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),ct=_(null),Pt=s=>Qe(this,null,function*(){if(Ze.value="",ct.value=null,s.tableName){let e=s.tableName.trim();if(e.length>64){Ze.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(e)){Ze.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield _s(e);ct.value=o.find(a=>a.name.toLowerCase()===e.toLowerCase()),ct.value&&(Ze.value="Table already exists"),s.tableName=e}s.label&&(s.fieldname=vs(s.label))});function hs(){const s=v.value.is_linked_form;if(!s){$.value=[];return}clearTimeout(pe),pe=setTimeout(()=>{const e=[["business_unit","=",`${Le.value.value}`],["name","like",`%${s}%`]],l={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(e),doctype:be.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};K.get(`${Q.GetDoctypeData}`,{params:l}).then(o=>{$.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function gs(s){v.value.is_linked_form=s,F.value=!1}function ys(){setTimeout(()=>{F.value=!1},200)}ve({query:"",key:""});function De(s,e,l,o,a){return`${s}-${e}-${l}-${o}-${a}`}ve({});const Ie=ve({}),kt=ve({});function ws(s){kt[s]=!0}function ks(s,e,l,o,a,r){const u=De(e,l,o,a,r),c=[["istable","=",0]];s!=null&&s.trim()&&c.push(["name","like",`%${s}%`]);const m={fields:JSON.stringify(["name"]),filters:JSON.stringify(c),limit_page_length:"none",doctype:be.doctypesList};K.get(Q.GetDoctypeData,{params:m}).then(d=>{Ie[u]=d.message.data||[]}).catch(d=>{console.error("Error fetching doctype list:",d),Ie[u]=[]})}function $s(s,e,l,o,a,r){f[s].sections[e].rows[l].columns[o].fields[a].options=r;const u=De(s,e,l,o,a);Ie[u]=[],kt[u]=!1}const Cs=me(()=>f!=null&&f.length?J.value===1?[0]:Array.from({length:J.value},(s,e)=>e).filter(s=>s<J.value):[]),Se=_(null),Me=_(null),Fs=(s,e,l,o,a)=>{Se.value={blockIndex:s,sectionIndex:e,rowIndex:l,columnIndex:o,fieldIndex:a}},Ds=()=>{Se.value=null},Ss=(s,e,l,o,a)=>Se.value&&Se.value.blockIndex===s&&Se.value.sectionIndex===e&&Se.value.rowIndex===l&&Se.value.columnIndex===o&&Se.value.fieldIndex===a,As=(s,e,l,o)=>{Me.value={blockIndex:s,sectionIndex:e,rowIndex:l,columnIndex:o}},qs=()=>{Me.value=null},Vs=(s,e,l,o)=>Me.value&&Me.value.blockIndex===s&&Me.value.sectionIndex===e&&Me.value.rowIndex===l&&Me.value.columnIndex===o,jt=_([{form_json:""}]),Oe=_("");Kl(()=>{Gt(),Oe.value=A.query.Clone,L.value=A.query.id||"new",Oe.value==="1"&&(v.value.series=""),L.value!=null&&L.value!=null&&L.value!="new"&&(Jt(),qt()),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?V.value=!0:V.value=!1;let s=localStorage.getItem("Bu");if(v.value.business_unit=s,A.query.preId==="PreDefine"){const e=localStorage.getItem("form_json");if(e){jt.value[0].form_json=e;const l=jt.value[0],o=JSON.parse(l.form_json),a=as(o.fields);oe.value=o.child_table_fields,a.forEach(r=>{f.push(r)})}}});const Be=_(null),le=ve({}),Wt=_(null),Es=s=>{Be.value=s},Us=()=>{Be.value=null},Ts=s=>{s.preventDefault()},Ls=(s,e)=>{const l=s.target.closest("tr");if(!l)return;const o=Array.from(l.parentNode.children).indexOf(l);if(o!==Be.value){const a=e[Be.value];e.splice(Be.value,1),e.splice(o,0,a),Be.value=o}},Rs=_([]),$t=s=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(s.fieldtype)&&s.options){const e=s.options.split(`
`).map(a=>a.trim()).filter(a=>a),l=[],o=new Set;return e.forEach(a=>{const r=a.toLowerCase();o.has(r)||(o.add(r),l.push(a))}),`
`+l.join(`
`)}else if(["Link","Table"].includes(s.fieldtype)&&s.options)return s.options.trim();return s.options},Ms=(s,e)=>{const l=f[s].sections[e];l.childTables||(l.childTables=[]);const o=l.childTables.length;l.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[ne({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},rt.fieldtype==="Select"&&rt.options?{options:rt.options?`
${rt.options}`:`
`}:{})],newTable:!0})},Os=(s,e,l)=>{const o=f[s].sections[e].childTables[l];o.columns||(o.columns=[]),o.columns.push(ne({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},Bs=(s,e,l)=>{f[s].sections[e].childTables.splice(l,1)},Ns=(s,e,l,o)=>{f[s].sections[e].childTables[l].columns.splice(o,1)};function zs(s,e,l,o,a,r){var d;const u=`${e}-${l}-${o}`;q[u]||(q[u]={columns:[]});const c={},m=((d=s.label)==null?void 0:d.trim())||"";if(!m)c.label="Field Label is required";else{const p=m.toLowerCase();if(ut.includes(p)&&!Nt.includes(p))c.label=`"${m}" is a restricted field label`;else if(m.length>64)c.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(m))c.label="Field Label can only contain letters, numbers, and single spaces between words";else{const y=r.map((R,g)=>{var w;return{label:(w=R.label)==null?void 0:w.trim().toLowerCase(),index:g}}).filter(R=>R.label===p);if(y.length>1){const R=y[0].index;a!==R&&(c.label=`"${m}" is already used in this table`)}}}q[u].columns[a]=c}function pt(s,e,l){var r;q[e]||(q[e]={});const o=[],a=((r=s.label)==null?void 0:r.trim())||"";a||o.push("Label is required"),a.length>64&&o.push("Label cannot exceed 64 characters"),a&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(a)&&o.push("No special characters allowed"),a&&ut.includes(a.toLowerCase().trim())&&o.push("This label is restricted"),a&&oe.value[e].map(m=>{var d;return(d=m.label)==null?void 0:d.trim().toLowerCase()}).filter(Boolean).filter(m=>m===a.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),s.fieldtype||o.push("Field type is required"),s.fieldtype==="Select"&&(!s.options||s.options.trim()==="")&&o.push("Options are required"),q[e][l]=o}const Ps=(s,e,l)=>{var u;const o=f[s].sections[e].childTables[l],a={tableName:!1,columns:[]};let r=!1;return(u=o.tableName)!=null&&u.trim()||(a.tableName="Table name is required.",r=!0),o.columns.forEach((c,m)=>{var p,y;const d={};(p=c.label)!=null&&p.trim()||(d.label="Field Label is required",r=!0),(y=c.fieldtype)!=null&&y.trim()||(d.fieldtype="Please select field type",r=!0),a.columns[m]=d}),q[`${s}-${e}-${l}`]=a,r},js=(s,e,l)=>{var a,r;const o=(r=(a=f[s])==null?void 0:a.sections)==null?void 0:r[e];o&&!Array.isArray(o[l])&&(o[l]=[])},Ws=s=>s?s.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",Hs=(s,e,l)=>{if(Ps(s,e,l)){ie("Please fix validation errors before creating the table",{transition:"zoom"});return}if(ct.value){ie("Table already exists",{transition:"zoom"});return}const a=f[s].sections[e].childTables[l],r=f[s].sections[e];a.columns=a.columns.map((c,m)=>ze(ne({},c),{idx:m,options:$t(c)})),a.newTable=!1;const u={form_short_name:a.tableName,fields:a.columns,idx:a.idx,as_a_block:a.as_a_block?a.as_a_block:"false"};K.post(Q.childtable,u).then(c=>{var m,d,p;if(c){js(s,e,"afterCreated"),r.afterCreated[l]=ne({},a),fe("Table created successfully!");const y=(p=(d=(m=c.message)==null?void 0:m[0])==null?void 0:d[0])==null?void 0:p.child_doc;y&&(f[s].sections[e].childTables[l]=ze(ne(ne({},f[s].sections[e].childTables[l]),y),{newTable:!1}))}}).catch(c=>{console.error("Error creating table:",c)})},et=(s,e,l,o=[])=>{var u;le[e]||(le[e]=[]),le[e]=le[e].filter(c=>c!==l),q[e]||(q[e]=[]),q[e][l]=[];const a=[],r=((u=s.label)==null?void 0:u.trim())||"";if(r?ut.includes(r.toLowerCase())?a.push("This label is restricted"):r.length>64?a.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(r)||a.push("Only letters, numbers, and single spaces allowed"):a.push("Label is required"),o.length){const c=r.toLowerCase(),m=o.map((d,p)=>{var y;return{label:(y=d.label)==null?void 0:y.trim().toLowerCase(),idx:p}}).filter(d=>d.label===c);if(m.length>1){const d=m[0].idx;l!==d?(a.push("Duplicate label not allowed"),s._duplicate=!0):s._duplicate=!1}else s._duplicate=!1}return s.fieldtype||a.push("Field type is required"),s.fieldtype==="Select"&&(!s.options||!s.options.trim())&&a.push("Options are required"),q[e][l]=a,a.length>0&&le[e].push(l),a.length===0},Js=(s,e,l)=>{const a=f[s].sections[e].afterCreated.find(c=>c.tableName===l);if(!a)return;const r=a.columns.length,u={fieldname:"",fieldtype:"",idx:r+1,label:"",value:"",isNew:!0,description:""};a.columns.push(u),et(u,l,r,a.columns)},Ht=_([]),Gs=(s,e,l,o)=>{const r=f[s].sections[e].afterCreated.find(c=>c.tableName===l);if(!r)return;r.columns.splice(o,1),r.columns.forEach((c,m)=>{c.idx=m+1});const u=le.value[l];u&&(le.value[l]=u.filter(c=>c!==o).map(c=>c>o?c-1:c))},Ys=(s,e,l)=>{const a=f[s].sections[e].afterCreated.find(r=>r.tableName===l);if(a){if(ee[l]){le[l]=[];let r=!0;if(a.columns.forEach((m,d)=>{et(m,l,d,a.columns)||(r=!1)}),!r){ie("Please fix the errors in the highlighted fields before saving!");return}const u=a.columns.map((y,p)=>{var R=y,{isNew:m}=R,d=Ut(R,["isNew"]);return ze(ne({},d),{idx:p+1,options:$t(d)})}),c={form_short_name:Ws(l),fields:u,as_a_block:a.description};K.post(Q.childtable,c).then(m=>{Ht.value=m.data,fe("Fields updated successfully!")}).catch(m=>{console.error("❌ Saving fields failed:",m)})}ee[l]=!ee[l]}},ee=ve({}),Zs=s=>{oe.value[s]||(oe.value[s]=[]);const e=oe.value[s].length+1;oe.value[s].push({fieldname:"",fieldtype:"",idx:e,label:"",value:"",isNew:!0,description:"",options:oe.value[s].options?`
${oe.value[s].options}`:""})},Ks=(s,e)=>{oe.value[s]&&oe.value[s].splice(e,1)},Qs=(s,e)=>{if(!s)return;le.value||(le.value={}),le.value[s]||(le.value[s]=[]);const l=oe.value[s];if(l){if(ee[s]){le.value[s]=[];let o=!0;if(l.forEach((u,c)=>{var d;pt(u,s,c);const m=(d=q[s])==null?void 0:d[c];m&&m.length>0&&(le.value[s].push(c),o=!1),u.label&&(u.label=u.label.trim())}),!o){ie("Please fix the errors before saving");return}const a=l.map((d,m)=>{var p=d,{isNew:u}=p,c=Ut(p,["isNew"]);return ze(ne({},c),{idx:m+1,options:$t(c)})}),r={form_short_name:s,fields:a,as_a_block:e};K.post(Q.childtable,r).then(u=>{Ht.value=u.data,fe("Fields updated successfully!")}).catch(u=>{console.error("❌ Saving fields failed:",u)})}ee[s]=!ee[s],Wt.value=ee[s]?s:null}},Xs=_([{id:1,label:"Form Info",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Form Fields",stepno:"Step 2",icon:"bi bi-grid-3x3-gap"},{id:3,label:"Workflow Setup",stepno:"Step 3",icon:"bi bi-diagram-3"},{id:4,label:"Print Format",stepno:"Step 4",icon:"ri-checkbox-circle-line"}]),Ct=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],mt=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],xs=me(()=>[je,...de.value]),Is=me(()=>{const s=v.value.accessible_departments;return s.includes(je)?"All Selected":s.length>1?`${s[0]}.. +${s.length-1} more selected`:s.join(", ")}),el=s=>s===je?v.value.accessible_departments.length===de.value.length:v.value.accessible_departments.includes(s),tl=(s,e)=>{s===je?e.target.checked?v.value.accessible_departments=[...de.value]:v.value.accessible_departments=[]:(e.target.checked?v.value.accessible_departments.push(s):v.value.accessible_departments=v.value.accessible_departments.filter(l=>l!==s),v.value.accessible_departments.length===de.value.length?v.value.accessible_departments=[...de.value]:v.value.accessible_departments=v.value.accessible_departments.filter(l=>l!==je))},sl=s=>{s===je&&(v.value.accessible_departments=[...de.value])},ll=s=>{s===je&&(v.value.accessible_departments=[])},Ft=_(!1),tt=me(()=>{var e;let s=[...ce.value];if(Ye.value&&(s=s.filter(l=>l.is_hod===1)),(e=Ve.value)!=null&&e.trim()){const l=Ve.value.toLowerCase();s=s.filter(o=>o.role.toLowerCase().includes(l))}return s.sort((l,o)=>l.role.localeCompare(o.role)),s.sort((l,o)=>{const a=z.value.includes(l.role),r=z.value.includes(o.role);return a===r?0:a?1:-1}),s.map(l=>l.role)}),ol=me(()=>{const s=tt.value;return s.length>0&&s.every(e=>z.value.includes(e))});Ae([z,tt],()=>{const s=tt.value;Ft.value=s.length>0&&s.every(e=>z.value.includes(e))},{immediate:!0,deep:!0});function al(s){const e=s.target.checked,l=ce.value.filter(o=>{var a;return!(Ye.value&&o.is_hod!==1||(a=Ve.value)!=null&&a.trim()&&!o.role.toLowerCase().includes(Ve.value.toLowerCase()))}).map(o=>o.role);e?z.value=Array.from(new Set([...z.value,...l])):z.value=z.value.filter(o=>!l.includes(o)),Ft.value=e}function nl(){z.value=[],Ft.value=!1,Ye.value=!1}const ge=_("");function il(){const s=f[J.value];if(!s||!s.sections){console.error("Error: Invalid block or sections not found.");return}let e={type:J.value==0?"requestor":"approver",roles:z.value,approval_required:We.value,approver_can_edit:Ce.value,fields:s.sections.flatMap(Tt),idx:J.value};J.value!==0&&(e.view_only_reportee=ge.value==="ViewOnlyReportee"?1:0,e.all_approvals_required=ge.value==="all_approvals_required"?1:0,e.requester_as_a_approver=ge.value==="requester_as_a_approver"?1:0,e.on_rejection=$e.value?$e.value:0);const l=H.findIndex(o=>o.idx===e.idx);l!==-1?H[l]=e:H.push(e),ul()}function Y(s){const e=H.filter(a=>a.idx===s);if(e.length===0)return{roles:[]};if(e.length===1)return e[0];const l=ne({},e[0]),o=[];return e.forEach(a=>{a.roles&&Array.isArray(a.roles)&&o.push(...a.roles)}),l.roles=o,console.log(`getWorkflowSetup(${s}): Found ${e.length} entries, merged roles:`,o),l}function rl(s){const e=Y(s),l=e.roles||[];z.value=[...l],$e.value=e.on_rejection,We.value=e.approval_required,Ce.value=e.approver_can_edit,e.view_only_reportee===1?ge.value="ViewOnlyReportee":e.all_approvals_required===1?ge.value="all_approvals_required":e.requester_as_a_approver===1?ge.value="requester_as_a_approver":ge.value=""}const Dt=s=>{Ye.value=!1,Ve.value="",ge.value="",$e.value="",v.value.accessible_departments.length&&dl(s,v.value.accessible_departments),J.value=s,rl(s)};function dl(s,e){let l={index:s,departments:e,property:v.value.business_unit};K.post(Q.addDesignationroles,l).then(o=>{o.message&&(ce.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function ul(){K.post(Q.add_roles_WF,{workflow_setup:H,doctype:v.value.form_short_name,business_unit:v.value.business_unit}).then(s=>{console.log(s),J.value==0?fe("Requestor Added"):fe(`Approver-${J.value} Added`)})}function cl(){M.push({path:ue.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function pl(){v.value.form_name="",v.value.form_short_name="",v.value.owner_of_the_form="",v.value.business_unit="",v.value.form_category="",v.value.accessible_departments=[]}const ml=s=>{if(vt.value){ie("Please check all required fields before proceeding.");return}s<S.value?At():s>S.value&&St()},St=()=>{if(vt.value){ie("Please check all required fields before proceeding.");return}S.value<4&&(S.value+=1,S.value===4&&(bt.value=f))},At=()=>{S.value>1&&(S.value-=1)},fl=_([]);function Jt(){const s={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:be.EzyFormDefinitions,doc_id:L.value};K.get(Q.GetDoctypeData,{params:s}).then(e=>{var o;let l=e==null?void 0:e.message.data;if(l){l.accessible_departments&&(l.accessible_departments=l.accessible_departments.split(",")),v.value=ze(ne(ne({},v.value),l),{owner_of_the_form:l.owner_of_the_form||v.value.owner_of_the_form||""});const a=JSON.parse((o=e.message.data)==null?void 0:o.form_json);nt.value=a.workflow,T.value=a.fields.filter(u=>u.fieldtype==="Table"),fl.value=a.fields.filter(u=>u.fieldtype==="Table"),Ge.value=e.message.data.is_landscape;let r=as(JSON.parse(l==null?void 0:l.form_json).fields);oe.value=JSON.parse(e.message.data.form_json).child_table_fields,Rs.value=[],yt.value=[],r.forEach((u,c)=>{f.push(u)}),JSON.parse(l==null?void 0:l.form_json).workflow.forEach((u,c)=>{H.push(u)})}}).catch(e=>{console.error("Error fetching  data:",e)})}function vl(){const s={};dt.value&&(s.print_format=dt.value),Ge.value!==void 0&&Ge.value!==null&&(s.is_landscape=Ge.value),K.put(Q.resource+be.EzyFormDefinitions+`/${A.query.id}`,s).then(e=>{console.log(e),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),fe("Print Format Added Successfully")}).catch(e=>{console.error("Error fetching  data:",e)})}function Gt(){const s={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${ue.value.business_unit||A.query.business_unit}`,doctype:be.departments};K.get(Q.GetDoctypeData,{params:s}).then(e=>{var l;(l=e==null?void 0:e.message.data)!=null&&l.length&&(he.value=e.message.data.map(o=>o.name),de.value=e.message.data.map(o=>o.name))}).catch(e=>{console.error("Error fetching department data:",e)})}_(""),Ae(()=>v.value.owner_of_the_form,s=>{s&&qt(s)});function qt(s){s&&typeof s=="string"&&s.trim()!==""&&bl(s)}function bl(s){const e={fields:JSON.stringify(["ezy_departments_items"]),doctype:be.departments,doc_id:s};K.get(Q.GetDoctypeData,{params:e}).then(l=>{var o;(o=l==null?void 0:l.message.data)!=null&&o.ezy_departments_items&&(E.value=l.message.data.ezy_departments_items.map(a=>a.category))}).catch(l=>{console.error("Error fetching categories data:",l)})}function Vt(s){let e=Xl(f);const l=ze(ne({},v.value),{fields:e,doctype:be.EzyFormDefinitions,workflow_setup:H,form_status:s==="save"?"Created":"Draft"});l.accessible_departments=l.accessible_departments.toString(),K.post(Q.savedata,l).then(o=>{if(o&&o.message&&o.message.message){let a=localStorage.getItem("preName");if(a){let r={installed:"Yes"};K.put(`${Q.resource}${be.preDefinedForm}/${a}`,r).then(u=>{localStorage.removeItem("preName")}).catch(u=>{console.error("Error fetching ezyForms data:",u)})}if(M.push({params:{paramid:o.message.message},query:{id:o.message.message}}),L.value=o.message.message,L&&L!=="new"&&(f.splice(0,f.length),Jt()),H.length<f.length)ps("Add Workflow");else if(Zt.value===!0){fe("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let r=localStorage.getItem("routepath");s==="save"?M.push({path:r}):s==="Draft"&&M.push({path:r})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const ft=_(""),Yt=()=>{var l,o;const s=f.length,e={label:s===0?"requestor":`approver-${s}`,parent:`${(l=Le.value)==null?void 0:l.value}-${(o=v.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${Le.value.value}-${v.value.form_short_name}`,childTables:[],afterCreated:{},rows:s===0?[{label:`row_0_0_${s}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${s}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${s}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};f.push(e),us(()=>{ft.value&&ft.value.scrollTo({top:ft.value.scrollHeight,behavior:"smooth"})})},Zt=_(!1),Kt=s=>{let e=f[s];e.parent&&X.push(e);let l=[];H.length>s&&H[s].roles&&(l=[...H[s].roles]),f.splice(s,1),H.length>s&&H.splice(s,1),f.forEach((o,a)=>{o.sections.forEach((r,u)=>{r.rows.forEach((c,m)=>{c.columns.forEach((d,p)=>{ye(a,u,m,p)})})})}),l.length&&_l(l,s)};function _l(s,e){const l={role:s,level:e,document_type:v.value.form_name,short_name:v.value.form_short_name,property:v.value.business_unit};K.post(Q.deleteAssigneRoles,l).then(o=>{o&&Vt()})}const hl=(s,e)=>{const l={label:"",parent:`${Le.value.value}-${v.value.form_short_name}`,rows:[{label:`row_0_${e}_${s}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};f[s].sections.splice(e+1,0,l)},gl=(s,e)=>{let l=f[s].sections[e];l.parent&&X.push(l),f[s].sections.splice(e,1),f[s].sections.forEach((o,a)=>{o.rows.forEach((r,u)=>{r.columns.forEach((c,m)=>{ye(s,a,u,m)})})})},yl=(s,e,l)=>{f[s].sections[e].rows[l].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},wl=(s,e,l,o)=>{const r=f[s].sections[e].rows[l].columns,u=r[o];u.parent&&X.push(u),r.length===1?f[s].sections[e].rows.splice(l,1):r.splice(o,1),f[s].sections.forEach((c,m)=>{c.rows.forEach((d,p)=>{d.columns.forEach((y,R)=>{ye(s,m,p,R)})})})},kl=(s,e,l,o)=>{f[s].sections[e].rows[l].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},$l=(s,e,l,o,a)=>{let r=f[s].sections[e].rows[l].columns[o].fields[a];r.parent&&X.push(r),f[s].sections[e].rows[l].columns[o].fields.splice(a,1)},Cl=(s,e,l,o,a)=>{const r=f[s].sections[e].rows[l].columns[o].fields[a],u=ne({},r);u.name=`${r.name} Name the field`,f[s].sections[e].rows[l].columns[o].fields.splice(a+1,0,u)},Fl=(s,e,l,o,a)=>{const r=cs(f);f.splice(0,f.length,...r);let u=f[s].sections[e].rows[l].columns[o].fields[a].fieldtype;(u!=="Select"||u!=="radio"||u!=="multiselect")&&(f[s].sections[e].rows[l].columns[o].fields[a].options="")};function Dl(s){return ut.includes(s==null?void 0:s.trim().toLowerCase())}function Sl(s){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(s)||s.includes('"')||s.includes("'")}function Al(s){return s.flatMap(e=>{var l;return[(l=e.label)==null?void 0:l.trim().toLowerCase(),...e.sections.flatMap(o=>{var a;return[(a=o.label)==null?void 0:a.trim().toLowerCase(),...o.rows.flatMap(r=>r.columns.flatMap(u=>{var c;return[(c=u.label)==null?void 0:c.trim().toLowerCase(),...u.fields.map(m=>{var d;return(d=m.label)==null?void 0:d.trim().toLowerCase()})]}))]})]}).filter(e=>e!==""&&!Nt.includes(e))}function ye(s,e,l,o,a){const u=Al(f).filter((d,p,y)=>y.indexOf(d)!==p),c=cs(f);f.splice(0,f.length,...c);function m(d,p){if(!d){p.errorMsg="";return}Dl(d)?p.errorMsg="Entered label is restricted":Sl(d)?p.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:d.length>64?p.errorMsg="Label should not exceed 64 characters":p.errorMsg=u.includes(d.trim().toLowerCase())?"Duplicate Label Name":""}a!==void 0&&m(f[s].sections[e].rows[l].columns[o].fields[a].label,f[s].sections[e].rows[l].columns[o].fields[a]),a===void 0&&o!==void 0&&m(f[s].sections[e].rows[l].columns[o].label,f[s].sections[e].rows[l].columns[o]),o===void 0&&a===void 0&&m(f[s].sections[e].label,f[s].sections[e]),f.forEach(d=>{d.sections.forEach(p=>{m(p.label,p),p.rows.forEach(y=>{y.columns.forEach(R=>{m(R.label,R),R.fields.forEach(g=>{m(g.label,g)})})})})})}const Et=me(()=>{function s(e){return!e||typeof e!="object"?!1:"fieldtype"in e&&e.fieldtype===""||"error"in e&&e.error||"errorMsg"in e&&e.errorMsg||["Select","Table MultiSelect"].includes(e.fieldtype)&&(!e.options||e.options.trim()==="")?!0:Array.isArray(e)?e.some(s):Object.values(e).some(s)}return s(f)}),vt=me(()=>x.value.length>0||I.value.length>0||!v.value.form_category||!v.value.owner_of_the_form||v.value.accessible_departments.length===0),ql=me(()=>f.some(s=>s.sections.some(e=>e.rows.some(l=>l.columns.some(o=>o.fields.some(a=>a.label&&a.fieldtype))))));function Qt(s,e){let l=s.target.value.trim();if(!l){e==="form_name"?x.value="Input cannot be empty or only spaces":e==="form_short_name"&&(I.value="Input cannot be empty or only spaces");return}if(l.length>63){e==="form_name"?x.value="Name cannot exceed 63 characters":e==="form_short_name"&&(I.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(l)){e==="form_short_name"&&(I.value="First character must be a letter");return}else I.value="";if(e==="form_short_name"&&l.length<2){I.value="Short name must have at least 2 letters";return}if(e==="form_short_name"&&/[^a-zA-Z ]/.test(l)){I.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(l)){e==="form_name"?x.value="Special characters are not allowed":e==="form_short_name"&&(I.value="Special characters are not allowed");return}else e==="form_name"?x.value="":e==="form_short_name"&&(I.value="");const o=[[e,"=",`${l}`],["business_unit","=",`${v.value.business_unit}`]],a={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:be.EzyFormDefinitions};K.get(`${Q.GetDoctypeData}`,{params:a}).then(r=>{re.value=r.message.data,e==="form_name"?x.value=l&&re.value.some(u=>u.form_name&&u.form_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":e==="form_short_name"&&(I.value=l&&re.value.some(u=>u.form_short_name&&u.form_short_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(r=>{console.error("Error fetching ezyForms data:",r),e==="form_name"?x.value="":e==="form_short_name"&&(I.value="")})}const Vl=s=>s===0?"1st row":s===1?"2nd row":s===2?"3rd row":`${s+1}th row`,bt=_([]),El=()=>{f.length&&(bt.value=f,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function Ul(){K.post(Q.delete_form_items,{deleted_fields:X.flatMap(Tt),doctype:L}).then(s=>{var e;(e=s==null?void 0:s.message)!=null&&e.success&&Vt()})}function Xt(s){return Qe(this,null,function*(){if(Et.value){ie("Please fix the errors before proceeding.");return}Zt.value=!0;let e=X.flatMap(Tt);L!=null&&L!=null&&L!="new"&&e.length?Ul():Vt(s)})}const Tl=()=>{it.value.push({role:"",autoApproval:!1,permissions:{}})},Ll=s=>{it.value.splice(s,1)},Rl=s=>{ps("Permission configuration modal will be implemented here")},xt=()=>Qe(this,null,function*(){var s;if(!(Xe.value.length>0))try{const e={doctype:"WF Roadmap",fields:JSON.stringify(["name","roadmap_title","document_type","workflow_levels","property","cluster_name"]),filters:JSON.stringify([])},l=yield K.get(Q.GetDoctypeData,{params:e});(s=l==null?void 0:l.message)!=null&&s.data&&(Xe.value=l.message.data.map(o=>({roadmap_title:o.name,display_name:`${o.roadmap_title} (${o.document_type})`,document_type:o.document_type,workflow_levels:o.workflow_levels,property:o.property,cluster_name:o.cluster_name})),console.log("Fetched WF Road Maps:",Xe.value))}catch(e){console.error("Error fetching WF Road Maps:",e),ie("Failed to fetch workflow road maps")}}),It=s=>Qe(this,null,function*(){var e;try{console.log("Selected WF Road Map:",s);const l=yield K.get(`${Q.resource}${be.wfRoadmap}/${s.roadmap_title}`),o=((e=l==null?void 0:l.data)==null?void 0:e.data)||(l==null?void 0:l.data)||{};console.log("WF Road Map Data:",o);const a=(o.wf_requestors&&o.wf_requestors.length>0,1),r={};o.wf_level_setup&&o.wf_level_setup.length>0&&o.wf_level_setup.forEach(d=>{r[d.level]||(r[d.level]=[]),r[d.level].push(d)});const u=Object.keys(r).length,c=a+u;for(console.log(`Required blocks: ${c} (1 requestor + ${u} approver levels)`),H=[],Je.value=[],Te.value=[];f.length>c;)f.pop();for(;f.length<c;)Yt();console.log(`Block adjustment complete: ${f.length} blocks`);let m=0;o.wf_requestors&&o.wf_requestors.length>0?(Je.value=o.wf_requestors,console.log(`Loaded ${o.wf_requestors.length} requestor role(s)`),o.wf_requestors.forEach(d=>{H.push({type:"requestor",roles:[d.requestor],auto_approval:d.auto_approval||0,columns_allowed:d.columns_allowed||"",fields:[],idx:0})})):console.warn("No Requestors found in roadmap, creating default requestor setup"),m=1,o.wf_level_setup&&o.wf_level_setup.length>0?(Te.value=o.wf_level_setup.sort((p,y)=>p.level-y.level),console.log(`Loaded ${o.wf_level_setup.length} approver level(s)`),Object.keys(r).sort((p,y)=>parseInt(p)-parseInt(y)).forEach(p=>{const y=r[p],R=m;console.log(`Level ${p} → Block Index ${R}, Roles: ${y.length}`),y.forEach(g=>{H.push({type:"approver",level:parseInt(p),roles:[g.role],approval_required:g.mandatory?1:0,approver_can_edit:0,view_only_reportee:g.view_only_reportee||0,all_approvals_required:g.all_approvals_required||0,requester_as_a_approver:g.requester_as_a_approver||0,on_rejection:g.on_rejection||0,columns_allowed:g.columns_allowed||"",fields:[],idx:R})}),m++})):console.warn("No approver levels found in roadmap"),console.log("Final blockArr length:",f.length),console.log("Final workflowSetup:",H),fe(`Workflow configured! ${Je.value.length} requestor role(s), ${Te.value.length} approver level(s) across ${f.length} blocks.`),us(()=>{Ee.value=0})}catch(l){console.error("Error in handleWFRoadMapSelect:",l),ie("Failed to load workflow. Please try again.")}}),Ml=s=>{console.log("Field added from library:",s);const e=Ee.value,l=f[e];if(!l){ie("Please create a block first before adding fields");return}const o=es(s);if(!o)return;l.sections||(l.sections=[]),l.sections.length===0&&l.sections.push({label:"",rows:[[{label:"",fields:[]}]]});const u=l.sections[0].rows[0][0];u.fields||(u.fields=[]),u.fields.push(o),console.log("Field added successfully:",o),fe(`${o.label} field added successfully`)},Ol=s=>{console.log("Drag started:",s),O.value=s},Bl=()=>{console.log("Drag ended")},Nl=s=>{console.log("Advanced builder fields saved:",s),fe(`${s.length} field(s) saved successfully!`)},zl=s=>{console.log("Advanced builder fields updated:",s)},Pl=s=>{const e=Ee.value,l=f[e];if(!l){ie("Please create a block first");return}l.sections||(l.sections=[]);let o=0;s.forEach(a=>{var y,R;const r=l.sections.length,u={label:a.label||"",parent:`${(y=Le.value)==null?void 0:y.value}-${(R=v.value)==null?void 0:R.form_short_name}`,rows:[]},m={label:`row_0_${r}_${e}`,columns:[]},d=a.columns||1,p=Math.ceil(a.fields.length/d);for(let g=0;g<d;g++){const w={label:"",fields:[]},C=g*p,Z=Math.min(C+p,a.fields.length);a.fields.slice(C,Z).forEach(G=>{const Ne=ne({label:G.label,fieldname:G.fieldname,fieldtype:G.fieldtype,options:G.options||"",reqd:G.reqd||0,unique:G.unique||0,description:G.description||"",default:G.default||"",read_only:G.read_only||0,hidden:G.hidden||0,depends_on:G.depends_on||"",mandatory_depends_on:G.mandatory_depends_on||"",read_only_depends_on:G.read_only_depends_on||""},G);w.fields.push(Ne),o++}),m.columns.push(w)}u.rows.push(m),l.sections.push(u)}),fe(`Added ${s.length} section(s) with ${o} field(s) to ${e===0?"Requestor":`Approver ${e}`} Block`),Ue.value=!1},es=s=>{console.log("Creating field from Frappe type:",s);const e=mt.find(r=>r.type===s);if(!e)return console.error("Field type not found:",s),console.error("Available types:",mt.map(r=>r.type)),ie(`Field type "${s}" not found. Please try again.`),null;const l=Date.now(),o=Math.random().toString(36).substring(2,6),a=`field_${l}_${o}`;return{id:`field_${l}_${o}`,fieldname:a,label:e.label,fieldtype:e.type,options:"",reqd:0,read_only:0,hidden:0,description:"",default:"",placeholder:""}};return(s,e)=>(n(),i("div",null,[t("div",Go,[t("div",Yo,[t("div",Zo,[t("div",Ko,[t("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:e[0]||(e[0]=l=>cl())},e[43]||(e[43]=[t("button",{class:"btn font-13 ms-3"},[t("i",{class:"bi bi-arrow-left"}),t("span",{class:"ms-2"},"Back")],-1)])),s.$route.query.id||s.$route.query.preId?(n(),i("span",Qo,"("+h(ue.value.formId||U(A).query.form_name)+")",1)):b("",!0)]),t("div",null,[S.value===2&&U(f).length&&!s.$route.query.id?(n(),i("button",{key:0,disabled:Et.value||vt.value,style:ms({cursor:Et.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:e[1]||(e[1]=l=>Xt("Draft"))},e[44]||(e[44]=[t("i",{class:"bi bi-bookmark-check-fill"},null,-1),k(" Save As Draft ")]),12,Xo)):b("",!0)])]),t("div",xo,[t("div",Io,[t("div",ea,[t("div",ta,[t("ul",sa,[(n(!0),i(B,null,N(Xs.value,l=>(n(),i("li",{key:l.id,class:W({active:S.value===l.id,completed:S.value>l.id})},[t("div",{class:W(["d-flex gap-3 align-items-center",{"not-allowed":vt.value&&S.value+1===l.id}]),onClick:o=>ml(l.id)},[S.value>l.id?(n(),i("i",oa)):(n(),i("i",{key:1,class:W(l.icon)},null,2)),t("div",aa,[t("span",na,h(l.stepno),1),e[45]||(e[45]=t("br",null,null,-1)),t("span",ia,h(l.label),1)])],10,la)],2))),128))])])]),t("div",ra,[t("div",da,[t("div",ua,[S.value===1?(n(),i("div",ca,[t("div",pa,[t("div",ma,[e[46]||(e[46]=t("div",null,null,-1)),e[47]||(e[47]=t("h1",{class:"font-14 fw-bold m-0"},"Form Info",-1)),t("div",null,[!s.$route.query.id&&!s.$route.query.preId?(n(),i("button",{key:0,class:"btn btn-light font-12 mx-2",type:"button",onClick:pl},"Clear Form")):b("",!0),S.value<5?(n(),Lt(ns,{key:1,class:"btn btn-dark bg-dark text-white fw-bold font-13",name:"Next",onClick:St})):b("",!0)])])]),t("div",fa,[t("div",va,[e[63]||(e[63]=t("div",{class:"col-sm-none col-md-4"},null,-1)),t("div",ba,[t("div",_a,[t("div",ha,[t("div",ga,[t("div",ya,[U(A).query.preId?(n(),i("span",wa,e[48]||(e[48]=[k("Predefined "),t("i",{class:"bi bi-check2-circle"},null,-1)]))):b("",!0),se(at,{disabled:(ue.value.formId&&ue.value.formId.length>0||U(A).query.form_name)&&Oe.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Untitled Form",onChange:e[2]||(e[2]=l=>Qt(l,"form_name")),modelValue:wt.value,"onUpdate:modelValue":e[3]||(e[3]=l=>wt.value=l)},null,8,["disabled","modelValue"]),x.value?(n(),i("span",ka,h(x.value),1)):b("",!0)])]),t("div",$a,[se(at,{disabled:(ue.value.formId&&ue.value.formId.length>0||U(A).query.form_name)&&Oe.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Untitled Form",onChange:e[4]||(e[4]=l=>Qt(l,"form_short_name")),modelValue:v.value.form_short_name,"onUpdate:modelValue":e[5]||(e[5]=l=>v.value.form_short_name=l)},null,8,["disabled","modelValue"]),I.value?(n(),i("span",Ca,h(I.value),1)):b("",!0)]),t("div",Fa,[se(at,{disabled:ue.value.formId&&ue.value.formId.length>0&&Oe.value!=="1",labeltext:"Form Naming series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Naming series",modelValue:v.value.series,"onUpdate:modelValue":e[6]||(e[6]=l=>v.value.series=l)},null,8,["disabled","modelValue"]),e[49]||(e[49]=is('<small class="text-muted" style="font-size:12px;" data-v-ba866e10> Note : Enter <code data-v-ba866e10>YY-YY</code>, <code data-v-ba866e10>YYYY</code>, or <code data-v-ba866e10>ABC</code>. The system will default to the format <code data-v-ba866e10> 24-25-0001</code>, <code data-v-ba866e10> 2025-0001</code>, or <code data-v-ba866e10> ABC-0001</code> respectively. </small>',1))]),t("div",Da,[t("label",null,[e[50]||(e[50]=k("Owner Of The Form ")),v.value.owner_of_the_form?b("",!0):(n(),i("span",Sa,"*"))]),se(U(Pe),{disabled:ue.value.formId&&ue.value.formId.length>0&&Oe.value!=="1",onOpen:Gt,options:he.value,onChange:qt,modelValue:v.value.owner_of_the_form,"onUpdate:modelValue":e[7]||(e[7]=l=>v.value.owner_of_the_form=l),placeholder:"Select Department",multiple:!1,class:"font-11 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"])]),t("div",Aa,[t("label",null,[e[51]||(e[51]=k("Form Category ")),v.value.form_category?b("",!0):(n(),i("span",qa,"*"))]),se(U(Pe),{disabled:ue.value.formId&&ue.value.formId.length>0&&Oe.value!=="1",options:E.value,modelValue:v.value.form_category,"onUpdate:modelValue":e[8]||(e[8]=l=>v.value.form_category=l),placeholder:"Select Category",multiple:!1,searchable:!0,class:"font-11 multiselect"},null,8,["disabled","options","modelValue"])]),t("div",Va,[t("label",null,[e[52]||(e[52]=k("Accessible to Department ")),v.value.accessible_departments.length?b("",!0):(n(),i("span",Ea,"*"))]),se(U(Pe),{modelValue:v.value.accessible_departments,"onUpdate:modelValue":e[10]||(e[10]=l=>v.value.accessible_departments=l),options:xs.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Department",class:"font-11",onSelect:sl,onRemove:ll,openDirection:"bottom"},{option:gt(({option:l})=>[t("div",Ua,[t("input",{type:"checkbox",checked:el(l),class:"custom-checkbox",onChange:o=>tl(l,o),onClick:e[9]||(e[9]=_e(()=>{},["stop"]))},null,40,Ta),t("span",null,h(l),1)])]),selection:gt(({values:l,isOpen:o})=>[l.length?D((n(),i("span",{key:0,class:"multiselect__single font-10"},h(Is.value),513)),[[ht,!o]]):b("",!0)]),_:1},8,["modelValue","options"])]),t("div",La,[e[53]||(e[53]=t("label",null,"Form Type",-1)),se(U(Pe),{options:Ot,modelValue:Bt.value,"onUpdate:modelValue":e[11]||(e[11]=l=>Bt.value=l),placeholder:"Select Form Type",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:l=>l.value,class:"font-11 multiselect",openDirection:"top"},null,8,["modelValue","reduce"]),e[54]||(e[54]=t("small",{class:"text-muted font-12 ms-2"},"Note: Public form is accessible by anyone through QR code.",-1))]),t("div",Ra,[e[55]||(e[55]=t("label",null,[k("Has Workflow "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),se(U(Pe),{options:["Yes","No"],modelValue:v.value.has_workflow,"onUpdate:modelValue":e[12]||(e[12]=l=>v.value.has_workflow=l),placeholder:"Select",multiple:!1,class:"font-11 multiselect",searchable:!0},null,8,["modelValue"])]),v.value.has_workflow==="Yes"?(n(),i("div",Ma,[e[56]||(e[56]=t("label",null,[k("Use Existing Workflow "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),se(U(Pe),{onOpen:xt,options:Xe.value,modelValue:Fe.value,"onUpdate:modelValue":e[13]||(e[13]=l=>Fe.value=l),placeholder:"Select WF Road Map",multiple:!1,class:"font-11 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:It,openDirection:"bottom"},null,8,["options","modelValue"]),e[57]||(e[57]=t("small",{class:"text-muted font-12 ms-2"},[t("i",{class:"bi bi-info-circle me-1"}),k(" Select to auto-populate requestor and approver configurations ")],-1))])):b("",!0),v.value.as_web_view===1?(n(),i("div",Oa,[e[58]||(e[58]=t("label",null,[k("Form Submit Response "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),se(at,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit Response",modelValue:v.value.public_form_response,"onUpdate:modelValue":e[14]||(e[14]=l=>v.value.public_form_response=l)},null,8,["modelValue"])])):b("",!0),v.value.as_web_view===1?(n(),i("div",Ba,[e[59]||(e[59]=t("label",null,[k("Submit Notification Email "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),se(at,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit mail",modelValue:v.value.mail_id,"onUpdate:modelValue":e[15]||(e[15]=l=>v.value.mail_id=l)},null,8,["modelValue"]),e[60]||(e[60]=t("small",{class:"text-muted font-12 ms-2"},"Note : If multiple Emails, separate with commas (,).",-1))])):b("",!0),U(A).query.preId?(n(),i("div",Na,[t("div",za,[D(t("input",{class:"form-check-input linketoCheck p-1",disabled:v.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":e[16]||(e[16]=l=>v.value.is_linked=l),"true-value":1,"false-value":0},null,8,Pa),[[ke,v.value.is_linked]]),e[61]||(e[61]=t("label",{class:"form-check-label font-12 mx-2 mb-0 ps-1",for:"is_linked"}," Link ",-1))])])):b("",!0),v.value.is_linked?(n(),i("div",ja,[e[62]||(e[62]=t("label",{for:"standardFormInput"},"Form",-1)),D(t("input",{type:"text",class:"form-control standardFormInput",id:"standardFormInput",disabled:v.value.is_predefined_doctype==1,"onUpdate:modelValue":e[17]||(e[17]=l=>v.value.is_linked_form=l),placeholder:"Type to search Form Name...",onInput:hs,onFocus:e[18]||(e[18]=l=>F.value=!0),onBlur:ys},null,40,Wa),[[P,v.value.is_linked_form]]),F.value&&$.value.length?(n(),i("ul",Ha,[(n(!0),i(B,null,N($.value,(l,o)=>(n(),i("li",{class:"list-group-item formlistitem",key:o,onMousedown:_e(a=>gs(l.name),["prevent"])},h(l.name),41,Ja))),128))])):b("",!0)])):b("",!0)])])]),e[64]||(e[64]=t("div",{class:"col-sm-none col-md-4"},null,-1))])])])):b("",!0),S.value===2?(n(),i("div",Ga,[t("div",Ya,[t("div",Za,[t("button",{onClick:e[19]||(e[19]=l=>At()),class:"btn btn-sm btn-light"},e[65]||(e[65]=[t("i",{class:"bi bi-chevron-left"},null,-1),k(" Back ")]))]),t("div",Ka,[(n(!0),i(B,null,N(U(f),(l,o)=>(n(),i("button",{key:o,class:W(["zoho-tab",{active:Ee.value===o}]),onClick:a=>Ee.value=o},[e[66]||(e[66]=t("i",{class:"bi bi-file-earmark-text me-1"},null,-1)),k(" "+h(o===0?"Requestor Block":`Approver Block ${o}`)+" ",1),U(f).length>1?(n(),i("i",{key:0,class:"bi bi-x-lg ms-2",onClick:_e(a=>Kt(o),["stop"])},null,8,Xa)):b("",!0)],10,Qa))),128))]),t("div",xa,[t("button",{class:W(["btn btn-sm me-2",Ue.value?"btn-dark":"btn-outline-dark"]),onClick:e[20]||(e[20]=l=>Ue.value=!Ue.value),title:"Toggle Advanced Field Builder"},[t("i",{class:W(Ue.value?"bi bi-tools":"bi bi-grid-3x3-gap")},null,2),k(" "+h(Ue.value?"Advanced":"Simple"),1)],2),t("button",{class:"btn btn-sm btn-primary me-2",onClick:Yt},e[67]||(e[67]=[t("i",{class:"bi bi-plus-lg me-1"},null,-1),k("Add Block ")])),ql.value?(n(),i("button",{key:0,class:"btn btn-sm btn-light me-2",onClick:El},e[68]||(e[68]=[t("i",{class:"bi bi-eye me-1"},null,-1),k("Preview ")]))):b("",!0),U(f).length?(n(),i("button",{key:1,class:"btn btn-sm btn-dark",onClick:e[21]||(e[21]=l=>Xt("save"))},h(U(L)!=="new"?"Update Form":"Create Form"),1)):b("",!0)])]),t("div",Ia,[Ue.value?(n(),i("div",en,[e[69]||(e[69]=t("div",{class:"alert alert-info mb-3"},[t("i",{class:"bi bi-info-circle me-2"}),t("strong",null,"Advanced Mode:"),k(" Use this mode to access all Frappe field types and advanced field properties. Fields created here will be added to the current block. ")],-1)),se(Jo,{ref_key:"frappeBuilderRef",ref:fs,formName:wt.value,currentBlockIndex:Ee.value,onSave:Nl,onUpdate:zl,onAddFields:Pl},null,8,["formName","currentBlockIndex"])])):(n(),i(B,{key:1},[t("aside",{class:W(["zoho-field-library",{collapsed:!He.value}])},[t("div",{class:"library-header",onClick:e[22]||(e[22]=l=>He.value=!He.value)},[t("div",tn,[t("h6",sn,[e[70]||(e[70]=t("i",{class:"bi bi-grid-3x3-gap me-2"},null,-1)),k(" "+h(He.value?"Field Types":"Fields"),1)]),t("button",ln,[t("i",{class:W(He.value?"bi bi-chevron-left":"bi bi-chevron-right")},null,2)])])]),He.value?(n(),i("div",on,[se(oo,{fields:mt,onFieldAdd:Ml,onFieldDragstart:Ol,onFieldDragend:Bl})])):b("",!0)],2),t("div",an,[t("div",{class:"canvas-inner",ref_key:"mainBlockRef",ref:ft},[(n(!0),i(B,null,N(U(f),(l,o)=>D((n(),i("div",{class:"block-level",key:o},[t("div",nn,[t("div",rn,[t("div",dn,[t("h6",un,h(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),t("div",cn,[o!==0&&Y(o).view_only_reportee||Y(o).all_approvals_required||Y(o).requester_as_a_approver?(n(),i("div",pn,[t("span",mn,h(Y(o).view_only_reportee===1?"Reporting Manager only":"")+" "+h(Y(o).all_approvals_required===1?"All of the selected approvers":"")+" "+h(Y(o).requester_as_a_approver===1?"Approval by Requestor":""),1),t("span",null,[e[71]||(e[71]=t("span",{class:"ms-1"}," on rejection escalating to ",-1)),t("span",fn,h(Y(o).on_rejection?`Level ${Y(o).on_rejection}`:"Requestor"),1)]),t("span",vn,h(Y(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):b("",!0)])]),t("div",bn,[U(L)&&U(H).length?(n(),i("div",_n,[Y(o)?(n(),i("label",hn,[t("span",gn,h(Y(o).roles.length>0?o===0?"Requestor Roles: ":"Approver Roles: ":""),1),t("span",yn,h(Y(o).roles.slice(0,2).join(", ")),1),Y(o).roles.length>2?(n(),i("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:a=>Dt(o),class:"more-count badge bg-primary ms-2",style:{cursor:"pointer"}}," +"+h(Y(o).roles.length-2)+" more ",9,wn)):b("",!0)])):b("",!0)])):b("",!0),bs(o)&&U(L)!=null&&U(L)!=null&&U(L)!="new"&&Y(o).roles.length===0?(n(),i("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:a=>Dt(o)},[e[72]||(e[72]=t("img",{src:xl,alt:"Add",class:"me-1"},null,-1)),k(" "+h(o===0?"Add Requestors":"Add Approvers"),1)],8,kn)):b("",!0),U(L)!=null&&U(L)!=null&&U(L)!="new"&&Y(o).roles.length>0?(n(),i("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:a=>Dt(o)},e[73]||(e[73]=[t("i",{class:"bi bi-pencil font-14"},null,-1)]),8,$n)):b("",!0),t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:a=>Kt(o)},e[74]||(e[74]=[t("i",{class:"bi bi-trash me-1"},null,-1),k(" Delete Block ")]),8,Cn)])])]),t("div",Fn,[(n(!0),i(B,null,N(l.sections,(a,r)=>(n(),i("div",{key:"section-"+r,class:"dynamicSection mt-0 section"},[t("section",Dn,[t("div",Sn,[D(t("input",{"onUpdate:modelValue":u=>a.label=u,type:"text",class:W(["border-less-input","font-14",{"italic-style":!a.label},{"fw-medium":a.label}]),onChange:u=>ye(o,r),onInput:u=>ye(o,r),placeholder:"Untitled section"},null,42,An),[[P,a.label]]),a.errorMsg?(n(),i("small",qn,h(a.errorMsg),1)):b("",!0)]),t("div",Vn,[t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:u=>gl(o,r)},e[75]||(e[75]=[t("i",{class:"bi bi-trash me-1"},null,-1),k(" Delete Section ")]),8,En)])]),t("div",Un,[(n(!0),i(B,null,N(a.rows,(u,c)=>(n(),i("section",{class:"row dynamicRow row-container",key:"row-"+c},[t("div",Tn,[t("label",Ln,h(Vl(c)),1),t("div",null,[u.columns.length<3?(n(),i("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:m=>yl(o,r,c)},e[76]||(e[76]=[t("i",{class:"bi bi-plus font-14"},null,-1),k(" Add Column ")]),8,Rn)):b("",!0)])]),t("div",Mn,[t("div",On,[(n(!0),i(B,null,N(u.columns,(m,d)=>(n(),i("div",{key:"column-"+d,onMouseenter:p=>As(o,r,c,d),onMouseleave:qs,class:"col p-0 dynamicColumn position-relative column-container"},[t("div",Nn,[t("div",zn,[D(t("input",{"onUpdate:modelValue":p=>m.label=p,type:"text",class:W(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!m.label},{"fw-medium":m.label}]),onChange:p=>ye(o,r,c,d),onInput:p=>ye(o,r,c,d),placeholder:"Column Name"},null,42,Pn),[[P,m.label]]),m.errorMsg?(n(),i("small",jn,h(m.errorMsg),1)):b("",!0)]),D(t("div",Wn,[t("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:p=>wl(o,r,c,d)},e[77]||(e[77]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Hn)],512),[[ht,Vs(o,r,c,d)]])]),m.fields.length===0?(n(),i("div",{key:0,class:"empty-drop-zone",onDragover:e[23]||(e[23]=_e(()=>{},["prevent"])),onDrop:p=>Re(p,o,r,c,d,s.fieldIndex)},null,40,Jn)):b("",!0),(n(!0),i(B,null,N(m.fields,(p,y)=>{var R;return n(),i("div",{key:"field-"+y,onMouseenter:g=>Fs(o,r,c,d,y),onMouseleave:Ds,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:g=>zt(g,o,r,c,d,y),onDragover:e[27]||(e[27]=_e(()=>{},["prevent"])),onDrop:g=>Re(g,o,r,c,d,y)},[t("div",{class:"drop-zone",onDragover:e[24]||(e[24]=_e(()=>{},["prevent"])),onDrop:g=>Re(g,o,r,c,d,y)},null,40,Yn),p.fieldtype!=="Table"?(n(),i("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:g=>zt(g,o,r,c,d,y),onDragover:e[25]||(e[25]=_e(()=>{},["prevent"])),onDrop:g=>Re(g,o,r,c,d,y)},[t("div",Kn,[t("div",Qn,[D(t("input",{"onUpdate:modelValue":g=>p.label=g,placeholder:"Name the field",class:W(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!p.label},{"fw-medium":p.label}]),onChange:g=>ye(o,r,c,d,y),onInput:g=>ye(o,r,c,d,y)},null,42,Xn),[[P,p.label]]),p.errorMsg?(n(),i("small",xn,h(p.errorMsg),1)):b("",!0)]),D(t("div",In,[t("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:g=>Cl(o,r,c,d,y)},e[78]||(e[78]=[t("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,ei),t("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:g=>{$l(o,r,c,d,y),ye(o,r,c,d)}},e[79]||(e[79]=[t("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,ti)],512),[[ht,Ss(o,r,c,d,y)]])]),D(t("select",{"onUpdate:modelValue":g=>p.fieldtype=g,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:g=>Fl(o,r,c,d,y)},[e[80]||(e[80]=t("option",{value:""},"Select Type",-1)),(n(),i(B,null,N(mt,g=>t("option",{key:g,value:g.type},h(g.label),9,li)),64))],40,si),[[qe,p.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(p.fieldtype)?(n(),i("div",oi,[e[81]||(e[81]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":g=>p.options=g,class:"form-control shadow-none mb-1 font-12"},null,8,ai),[[P,p.options]]),!p.options||p.options.trim()===""?(n(),i("small",ni," Options are required for this field type. ")):b("",!0)])):b("",!0),p.fieldtype==="Link"?(n(),i("div",ii,[t("label",{class:"font-11 fw-light",for:"link-search-"+De(o,r,c,d,y)}," Search Doctype: ",8,ri),D(t("input",{id:"link-search-"+De(o,r,c,d,y),type:"text","onUpdate:modelValue":g=>U(f)[o].sections[r].rows[c].columns[d].fields[y].options=g,onInput:g=>ks(U(f)[o].sections[r].rows[c].columns[d].fields[y].options,o,r,c,d,y),onFocus:g=>ws(De(o,r,c,d,y)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,di),[[P,U(f)[o].sections[r].rows[c].columns[d].fields[y].options]]),(R=Ie[De(o,r,c,d,y)])!=null&&R.length&&kt[De(o,r,c,d,y)]?(n(),i("ul",ui,[(n(!0),i(B,null,N(Ie[De(o,r,c,d,y)],(g,w)=>(n(),i("li",{key:w,onClick:C=>$s(o,r,c,d,y,g.name),class:"list-group-item list-group-item-action"},h(g.name),9,ci))),128))])):b("",!0)])):b("",!0),t("div",pi,[t("div",mi,[t("div",fi,[D(t("input",{class:"font-12","onUpdate:modelValue":g=>p.reqd=g,"true-value":1,id:"mandatory-"+o+"-"+r+"-"+c+"-"+d+"-"+y,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,vi),[[ke,p.reqd]])]),t("div",null,[t("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+r+"-"+c+"-"+d+"-"+y},"Mandatory",8,bi)])]),t("div",null,[t("button",{class:"btn btn-sm font-12",onClick:g=>p.showDescription=!p.showDescription},h(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,_i)])]),p.showDescription?D((n(),i("textarea",{key:2,"onUpdate:modelValue":g=>p.description=g,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,hi)),[[P,p.description]]):b("",!0),p.error?(n(),i("small",gi,h(p.error),1)):b("",!0)],40,Zn)):b("",!0),t("div",{class:"drop-zone",onDragover:e[26]||(e[26]=_e(()=>{},["prevent"])),onDrop:g=>Re(g,o,r,c,d,y)},null,40,yi),t("div",wi,[t("div",null,[t("div",null,[t("div",ki,[p.fieldtype==="Table"?(n(),i("div",$i,[(n(!0),i(B,null,N(oe.value,(g,w)=>(n(),i("div",{key:w,class:"childTable"},[w===p.fieldname||w===p.options?(n(),i("h5",Ci,h(w.replace(/_/g," ")),1)):b("",!0),ee[w]&&w===Wt.value?(n(),i("div",Fi,[t("div",Di,[p.showDescription?D((n(),i("input",{key:0,"onUpdate:modelValue":C=>p.description=C,class:"form-control font-12",placeholder:"Enter field description"},null,8,Si)),[[P,p.description]]):b("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:C=>p.showDescription=!p.showDescription},h(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,Ai)])])):b("",!0),w===p.options||w===p.fieldname?(n(),i("table",qi,[e[85]||(e[85]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Label"),t("th",null,"Field Type")])],-1)),t("tbody",{onDragover:_e(Ts,["prevent"]),onDrop:C=>Ls(C,g)},[(n(!0),i(B,null,N(g,(C,Z)=>{var Ke,G,Ne,st,lt,ot,ae;return n(),i("tr",{key:Z,draggable:ee[w],onDragstart:te=>Es(Z),onDragend:Us,class:W({dragging:Be.value===Z})},[t("td",null,h(Z+1),1),ee[w]?(n(),i("td",Ui,[D(t("input",{"onUpdate:modelValue":te=>C.label=te,onInput:te=>pt(C,w,Z),placeholder:"Field Label",class:W(["form-control",{"border-1 border-danger":(G=(Ke=q[w])==null?void 0:Ke[Z])==null?void 0:G.length}])},null,42,Ti),[[P,C.label]]),(st=(Ne=q[w])==null?void 0:Ne[Z])!=null&&st.length?(n(),i("div",Li,[(n(!0),i(B,null,N(q[w][Z],(te,jl)=>(n(),i("div",{key:jl},h(te),1))),128))])):b("",!0)])):(n(),i("td",Ri,h(C.label),1)),ee[w]?(n(),i("td",Mi,[t("div",Oi,[D(t("select",{"onUpdate:modelValue":te=>C.fieldtype=te,onChange:te=>pt(C,w,Z),class:W(["form-select form-select-sm",{"border-1 border-danger":(ot=(lt=q[w])==null?void 0:lt[Z])==null?void 0:ot.length}])},[e[82]||(e[82]=t("option",{value:""},"Select Type",-1)),(n(),i(B,null,N(Ct,te=>t("option",{key:te.type,value:te.type},h(te.label),9,Ni)),64))],42,Bi),[[qe,C.fieldtype]]),t("div",zi,[t("div",Pi,[t("div",ji,[D(t("input",{class:"font-12 form-control-sm","onUpdate:modelValue":te=>C.description=te,placeholder:"description",type:"text"},null,8,Wi),[[P,C.description]])])]),t("button",{class:"btn btn-light btn-sm",onClick:te=>Ks(w,Z)},e[83]||(e[83]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Hi)])]),["Select"].includes(C.fieldtype)?(n(),i("div",Ji,[e[84]||(e[84]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":te=>C.options=te,onInput:te=>pt(C,w,Z),class:"form-control shadow-none mb-1 font-12"},null,40,Gi),[[P,C.options]]),!C.options||C.options.trim()===""?(n(),i("small",Yi," Options are required for this field type. ")):b("",!0)])):b("",!0),(ae=le[w])!=null&&ae.includes(Z)?(n(),i("span",Zi,"Type required**")):b("",!0)])):(n(),i("td",Ki,h(C.fieldtype),1))],42,Ei)}),128))],40,Vi)])):b("",!0),p.fieldtype==="Table"&&(p.label===w||p.fieldname===w)?(n(),i("div",Qi,[t("button",{class:"btn btn-light btn-sm mx-2",onClick:C=>Qs(w,p.description)},h(ee[w]?"Save":"Edit"),9,Xi),ee[w]?(n(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:C=>Zs(w)}," Add More Field ",8,xi)):b("",!0)])):b("",!0)]))),128))])):b("",!0)])])])])],40,Gn)}),128)),t("div",{class:"drop-zone-bottom",onDragover:e[28]||(e[28]=_e(()=>{},["prevent"])),onDrop:p=>Re(p,o,r,c,d,m.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,Ii),t("div",{class:"drop-zone",onDragover:e[29]||(e[29]=_e(()=>{},["prevent"])),onDrop:p=>Re(p,o,r,c,d,s.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,er),t("div",tr,[t("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:p=>kl(o,r,c,d)},e[86]||(e[86]=[t("i",{class:"bi bi-plus fs-5"},null,-1),t("span",null,"Add Field",-1)]),8,sr)])],40,Bn))),128))])])]))),128)),t("div",null,[(n(!0),i(B,null,N(a.afterCreated,(u,c)=>(n(),i("div",{key:c,class:"childTable dynamicColumn m-0 p-2"},[t("h5",lr,h(u.tableName),1),ee[u.tableName]?(n(),i("div",or,[t("div",ar,[u.showDescription?D((n(),i("input",{key:0,"onUpdate:modelValue":m=>u.description=m,class:"form-control font-12",placeholder:"Enter field description"},null,8,nr)),[[P,u.description]]):b("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:m=>u.showDescription=!u.showDescription},h(u.showDescription?"Hide Description":u.description?"Edit Description":"Add Description"),9,ir)])])):b("",!0),t("table",rr,[e[92]||(e[92]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Label"),t("th",null,"Field Type")])],-1)),t("tbody",null,[(n(!0),i(B,null,N(u.columns,(m,d)=>{var p,y,R,g;return n(),i("tr",{key:d},[t("td",null,h(d+1),1),ee[u.tableName]?(n(),i("td",dr,[D(t("input",{"onUpdate:modelValue":w=>m.label=w,placeholder:"Field Label",class:W(["form-control",{"border-1 border-danger":(p=le[u.tableName])==null?void 0:p.includes(d)}]),onBlur:w=>{var C;m.label=(C=m.label)==null?void 0:C.trim(),et(m,u.tableName,d,u.columns)}},null,42,ur),[[P,m.label]]),(y=q[u.tableName])!=null&&y[d]?(n(),i("div",cr,[(n(!0),i(B,null,N(q[u.tableName][d],(w,C)=>(n(),i("span",{key:C},[k(h(w)+" ",1),e[87]||(e[87]=t("br",null,null,-1))]))),128))])):b("",!0)])):(n(),i("td",pr,h(m.label),1)),ee[u.tableName]?(n(),i("td",mr,[t("div",fr,[D(t("select",{"onUpdate:modelValue":w=>m.fieldtype=w,class:W(["form-select form-select-sm",{"border-1 border-danger":(R=le[u.tableName])==null?void 0:R.includes(d)}]),onChange:w=>et(m,u.tableName,d,u.columns)},[e[88]||(e[88]=t("option",{value:""},"Select Type",-1)),(n(),i(B,null,N(Ct,w=>t("option",{key:w.type,value:w.type},h(w.label),9,br)),64))],42,vr),[[qe,m.fieldtype]]),t("button",{class:"btn btn-light btn-sm",onClick:w=>Gs(o,r,u.tableName,d)},e[89]||(e[89]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,_r)]),m.fieldtype==="Select"?(n(),i("div",hr,[e[90]||(e[90]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":w=>m.options=w,class:"form-control shadow-none mb-1 font-12",onInput:w=>et(m,u.tableName,d,u.columns)},null,40,gr),[[P,m.options]])])):b("",!0),(g=q[u.tableName])!=null&&g[d]?(n(),i("div",yr,[(n(!0),i(B,null,N(q[u.tableName][d],(w,C)=>(n(),i("span",{key:C},[k(h(w),1),e[91]||(e[91]=t("br",null,null,-1))]))),128))])):b("",!0)])):(n(),i("td",wr,h(m.fieldtype),1))])}),128))])]),t("div",kr,[t("button",{class:"btn btn-light btn-sm mx-2",onClick:m=>Ys(o,r,u.tableName)},h(ee[u.tableName]?"Save":"Edit"),9,$r),ee[u.tableName]?(n(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:m=>Js(o,r,u.tableName)}," Add More Field ",8,Cr)):b("",!0)])]))),128))])]),t("div",null,[t("div",null,[o==0?(n(),i("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:u=>Ms(o,r)}," Add New Table ",8,Fr)):b("",!0),(n(!0),i(B,null,N(a.childTables,(u,c)=>{var m;return n(),i("div",{key:`table-${o}-${r}-${c}`,class:"child-table"},[u.newTable?(n(),i("div",Dr,[t("div",Sr,[t("div",null,[t("span",{class:W(u.tableName?"d-none":"text-danger")},"*",2),D(t("input",{"onUpdate:modelValue":d=>u.tableName=d,placeholder:"Table Name",onBlur:d=>Pt(u),class:W(["border-less-input font-14 p-0 inputHeight",{"italic-style":!u.tableName,"fw-medium":u.tableName}])},null,42,Ar),[[P,u.tableName]]),(m=q[`${o}-${r}-${c}`])!=null&&m.tableName?(n(),i("div",qr,h(q[`${o}-${r}-${c}`].tableName),1)):b("",!0),Ze.value?(n(),i("div",Vr,h(Ze.value),1)):b("",!0),t("div",Er,[t("div",Ur,[u.showDescription?D((n(),i("input",{key:0,"onUpdate:modelValue":d=>u.as_a_block=d,class:"form-control font-12",placeholder:"Enter field description"},null,8,Tr)),[[P,u.as_a_block]]):b("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:d=>u.showDescription=!u.showDescription},h(u.showDescription?"Hide Description":u.description?"Edit Description":"Add Description"),9,Lr)])])]),t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:d=>Bs(o,r,c)},e[93]||(e[93]=[t("i",{class:"bi bi-trash"},null,-1),k(" Remove Table ")]),8,Rr)]),(n(!0),i(B,null,N(u.columns,(d,p)=>{var y,R,g,w,C,Z,Ke,G,Ne,st,lt,ot;return n(),i("div",{key:p,class:"dynamicField"},[t("div",Mr,[t("div",Or,[t("div",null,[t("span",{class:W(d.label?"d-none":"text-danger")},"*",2),D(t("input",{"onUpdate:modelValue":ae=>d.label=ae,placeholder:"Name the field",onBlur:()=>{Pt(d),zs(d,o,r,c,p,u.columns)},class:W(["border-less-input font-14 p-0 inputHeight",{"italic-style":!d.label,"fw-medium":d.label,"is-invalid":(g=(R=(y=q[`${o}-${r}-${c}`])==null?void 0:y.columns)==null?void 0:R[p])==null?void 0:g.label}])},null,42,Br),[[P,d.label]]),(Z=(C=(w=q[`${o}-${r}-${c}`])==null?void 0:w.columns)==null?void 0:C[p])!=null&&Z.label?(n(),i("div",Nr,h(q[`${o}-${r}-${c}`].columns[p].label),1)):b("",!0)]),t("div",zr,[t("div",Pr,[d.showDescription?D((n(),i("input",{key:0,"onUpdate:modelValue":ae=>d.description=ae,class:"form-control font-12",placeholder:"Enter field description"},null,8,jr)),[[P,d.description]]):b("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:ae=>d.showDescription=!d.showDescription},h(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,Wr)]),t("button",{class:"btn btn-sm trash-btn py-0",onClick:ae=>Ns(o,r,c,p)},e[94]||(e[94]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Hr)])]),D(t("select",{"onUpdate:modelValue":ae=>d.fieldtype=ae,class:W(["form-select font-13 mb-1",{"is-invalid":(Ne=(G=(Ke=q[`${o}-${r}-${c}`])==null?void 0:Ke.columns)==null?void 0:G[p])==null?void 0:Ne.fieldtype}])},[e[95]||(e[95]=t("option",{value:""},"Select Type",-1)),(n(),i(B,null,N(Ct,ae=>t("option",{key:ae.type,value:ae.type},h(ae.label),9,Gr)),64))],10,Jr),[[qe,d.fieldtype]]),["Select"].includes(d.fieldtype)?(n(),i("div",Yr,[e[96]||(e[96]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":ae=>d.options=ae,class:"form-control shadow-none mb-1 font-12"},null,8,Zr),[[P,d.options]]),!d.options||d.options.trim()===""?(n(),i("small",Kr," Options are required for this field type. ")):b("",!0)])):b("",!0),(ot=(lt=(st=q[`${o}-${r}-${c}`])==null?void 0:st.columns)==null?void 0:lt[p])!=null&&ot.fieldtype?(n(),i("div",Qr,h(q[`${o}-${r}-${c}`].columns[p].fieldtype),1)):b("",!0)])])}),128)),t("button",{class:"btn btn-light btn-sm addField mx-1",onClick:d=>Os(o,r,c)},e[97]||(e[97]=[t("i",{class:"bi bi-plus"},null,-1),k(" Add Field ")]),8,Xr),t("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:d=>Hs(o,r,c)}," Create Table ",8,xr),e[98]||(e[98]=t("hr",null,null,-1))])):b("",!0)])}),128))])]),t("div",Ir,[t("button",{class:"btn btn-light border font-12",onClick:u=>hl(o,r)},e[99]||(e[99]=[t("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),k(" Add Section ")]),8,ed)])]))),128)),o===0?(n(),i("div",td)):b("",!0)])])),[[ht,o===Ee.value]])),128))],512)]),Mt.value?(n(),i("aside",sd,[t("div",ld,[e[101]||(e[101]=t("h6",{class:"mb-0"},"Field Properties",-1)),t("button",{class:"btn btn-sm btn-link p-0",onClick:e[30]||(e[30]=l=>Mt.value=null)},e[100]||(e[100]=[t("i",{class:"bi bi-x-lg"},null,-1)]))]),e[102]||(e[102]=t("div",{class:"properties-content"},[t("p",{class:"text-muted small"},"Select a field to edit its properties")],-1))])):b("",!0)],64))])])):b("",!0),S.value===3?(n(),i("div",od,[t("div",ad,[t("button",{onClick:e[31]||(e[31]=l=>At()),class:"btn btn-sm btn-light"},e[103]||(e[103]=[t("i",{class:"bi bi-chevron-left"},null,-1),k(" Back ")])),e[105]||(e[105]=t("h1",{class:"font-14 fw-bold m-0"},"Workflow Setup",-1)),t("button",{class:"btn btn-sm btn-dark",onClick:St},e[104]||(e[104]=[k(" Next "),t("i",{class:"bi bi-chevron-right"},null,-1)]))]),t("div",nd,[t("div",id,[e[111]||(e[111]=t("div",{class:"card-header bg-light"},[t("h6",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-diagram-3 me-2"}),k("Workflow Configuration")])],-1)),t("div",rd,[t("div",dd,[t("div",ud,[e[108]||(e[108]=t("label",{class:"form-label fw-bold"},"Workflow Type",-1)),t("div",cd,[D(t("input",{type:"radio",class:"btn-check",name:"workflowType",id:"existingWorkflow",value:"existing","onUpdate:modelValue":e[32]||(e[32]=l=>we.value=l)},null,512),[[rs,we.value]]),e[106]||(e[106]=t("label",{class:"btn btn-outline-primary",for:"existingWorkflow"},[t("i",{class:"bi bi-folder me-1"}),k("Use Existing ")],-1)),D(t("input",{type:"radio",class:"btn-check",name:"workflowType",id:"newWorkflow",value:"new","onUpdate:modelValue":e[33]||(e[33]=l=>we.value=l),checked:""},null,512),[[rs,we.value]]),e[107]||(e[107]=t("label",{class:"btn btn-outline-primary",for:"newWorkflow"},[t("i",{class:"bi bi-plus-circle me-1"}),k("Create New ")],-1))])]),we.value==="existing"?(n(),i("div",pd,[e[109]||(e[109]=t("label",{class:"form-label fw-bold"},"Select Workflow",-1)),se(U(Pe),{onOpen:xt,options:Xe.value,modelValue:Fe.value,"onUpdate:modelValue":e[34]||(e[34]=l=>Fe.value=l),placeholder:"Select WF Road Map",multiple:!1,class:"font-11 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:It,openDirection:"bottom"},null,8,["options","modelValue"]),e[110]||(e[110]=t("small",{class:"text-muted font-12 mt-1 d-block"},[t("i",{class:"bi bi-info-circle me-1"}),k("Auto-populates requestors and approvers ")],-1))])):b("",!0)])])]),we.value==="new"?(n(),i("div",md,[e[117]||(e[117]=t("div",{class:"card-header bg-light"},[t("h6",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-person-plus me-2"}),k("Requestor Configuration")])],-1)),t("div",fd,[e[116]||(e[116]=t("p",{class:"text-muted font-12 mb-3"},[t("i",{class:"bi bi-info-circle me-1"}),k(" Define who can submit requests for this form based on WF Requestors ")],-1)),t("button",{class:"btn btn-primary btn-sm mb-3",onClick:Tl},e[112]||(e[112]=[t("i",{class:"bi bi-plus-lg me-1"},null,-1),k("Add Requestor Role ")])),it.value.length>0?(n(),i("div",vd,[t("table",bd,[e[115]||(e[115]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{width:"40%"},"Role"),t("th",{width:"30%"},"Auto Approval"),t("th",{width:"20%"},"Permissions"),t("th",{width:"10%"},"Action")])],-1)),t("tbody",null,[(n(!0),i(B,null,N(it.value,(l,o)=>(n(),i("tr",{key:o},[t("td",null,[D(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":a=>l.role=a,placeholder:"Enter role name"},null,8,_d),[[P,l.role]])]),t("td",null,[t("div",hd,[D(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":a=>l.autoApproval=a},null,8,gd),[[ke,l.autoApproval]]),t("label",yd,h(l.autoApproval?"Yes":"No"),1)])]),t("td",null,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:a=>Rl()},e[113]||(e[113]=[t("i",{class:"bi bi-gear"},null,-1),k(" Configure ")]),8,wd)]),t("td",null,[t("button",{class:"btn btn-sm btn-danger",onClick:a=>Ll(o)},e[114]||(e[114]=[t("i",{class:"bi bi-trash"},null,-1)]),8,kd)])]))),128))])])])):b("",!0)])])):b("",!0),we.value==="existing"&&Fe.value&&Je.value.length>0?(n(),i("div",$d,[e[123]||(e[123]=t("div",{class:"card-header bg-success text-white"},[t("h6",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-check-circle me-2"}),k("Loaded Requestors")])],-1)),t("div",Cd,[t("div",Fd,[e[118]||(e[118]=t("i",{class:"bi bi-check-circle me-1"},null,-1)),t("strong",null,h(Je.value.length),1),e[119]||(e[119]=k(" requestor role(s) loaded from ")),t("strong",null,h(Fe.value.display_name),1)]),t("div",Dd,[t("table",Sd,[e[121]||(e[121]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Role"),t("th",null,"Auto Approval"),t("th",null,"Columns Allowed")])],-1)),t("tbody",null,[(n(!0),i(B,null,N(Je.value,(l,o)=>(n(),i("tr",{key:o},[t("td",null,[t("strong",null,h(l.requestor),1)]),t("td",null,[l.auto_approval?(n(),i("span",Ad,e[120]||(e[120]=[t("i",{class:"bi bi-check-circle me-1"},null,-1),k("Yes ")]))):(n(),i("span",qd,"No"))]),t("td",null,[t("small",Vd,h(l.columns_allowed||"All fields"),1)])]))),128))])])]),e[122]||(e[122]=t("div",{class:"alert alert-info mt-3"},[t("i",{class:"bi bi-info-circle me-1"}),k(" Go to "),t("strong",null,"Step 2"),k(" and click "),t("strong",null,'"Add Requestors"'),k(" to select specific designations for these roles ")],-1))])])):b("",!0),we.value==="existing"&&Fe.value&&Te.value.length>0?(n(),i("div",Ed,[e[132]||(e[132]=t("div",{class:"card-header bg-primary text-white"},[t("h6",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-diagram-3 me-2"}),k("Loaded Approval Workflow")])],-1)),t("div",Ud,[t("div",Td,[e[124]||(e[124]=t("i",{class:"bi bi-check-circle me-1"},null,-1)),t("strong",null,h(Te.value.length),1),e[125]||(e[125]=k(" approval level(s) loaded from ")),t("strong",null,h(Fe.value.display_name),1)]),t("div",Ld,[t("table",Rd,[e[130]||(e[130]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{width:"10%"},"Level"),t("th",{width:"25%"},"Role"),t("th",{width:"15%"},"Mandatory"),t("th",{width:"20%"},"Approval Type"),t("th",{width:"30%"},"Columns Allowed")])],-1)),t("tbody",null,[(n(!0),i(B,null,N(Te.value,(l,o)=>(n(),i("tr",{key:o},[t("td",null,[t("span",Md,"Level "+h(l.level),1)]),t("td",null,[t("strong",null,h(l.role),1)]),t("td",null,[l.mandatory?(n(),i("span",Od,e[126]||(e[126]=[t("i",{class:"bi bi-exclamation-circle me-1"},null,-1),k("Required ")]))):(n(),i("span",Bd,"Optional"))]),t("td",null,[l.view_only_reportee?(n(),i("span",Nd,e[127]||(e[127]=[t("i",{class:"bi bi-person me-1"},null,-1),k("Reporting Manager ")]))):l.all_approvals_required?(n(),i("span",zd,e[128]||(e[128]=[t("i",{class:"bi bi-people me-1"},null,-1),k("All Users ")]))):l.requester_as_a_approver?(n(),i("span",Pd,e[129]||(e[129]=[t("i",{class:"bi bi-person-check me-1"},null,-1),k("Requestor ")]))):(n(),i("span",jd," Any One "))]),t("td",null,[t("small",Wd,h(l.columns_allowed||"All fields"),1)])]))),128))])])]),e[131]||(e[131]=t("div",{class:"alert alert-info mt-3"},[t("i",{class:"bi bi-info-circle me-1"}),k(" Go to "),t("strong",null,"Step 2"),k(" and click "),t("strong",null,'"Add Approvers"'),k(" for each level to select specific designations ")],-1))])])):b("",!0),e[133]||(e[133]=is('<div class="card mt-4" data-v-ba866e10><div class="card-header bg-light" data-v-ba866e10><h6 class="mb-0 fw-bold" data-v-ba866e10><i class="bi bi-shield-check me-2" data-v-ba866e10></i>System Generated Fields</h6></div><div class="card-body" data-v-ba866e10><div class="alert alert-secondary mb-3" data-v-ba866e10><i class="bi bi-info-circle me-2" data-v-ba866e10></i> These fields are automatically included for all requestors. </div><div class="row g-3" data-v-ba866e10><div class="col-md-6" data-v-ba866e10><div class="field-preview-card" data-v-ba866e10><label class="form-label fw-bold" data-v-ba866e10>Requestor Name</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-ba866e10></div></div><div class="col-md-6" data-v-ba866e10><div class="field-preview-card" data-v-ba866e10><label class="form-label fw-bold" data-v-ba866e10>Requestor Email</label><input type="email" class="form-control" value="Auto-populated from user profile" disabled data-v-ba866e10></div></div><div class="col-md-6" data-v-ba866e10><div class="field-preview-card" data-v-ba866e10><label class="form-label fw-bold" data-v-ba866e10>Request Date</label><input type="text" class="form-control" value="Auto-populated on submission" disabled data-v-ba866e10></div></div><div class="col-md-6" data-v-ba866e10><div class="field-preview-card" data-v-ba866e10><label class="form-label fw-bold" data-v-ba866e10>Department</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-ba866e10></div></div></div></div></div>',1))])])):b("",!0),S.value===4?(n(),i("div",Hd,[e[134]||(e[134]=t("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[t("div",null,[t("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),t("div")],-1)),se(ds,{blockArr:bt.value},null,8,["blockArr"])])):b("",!0)])])])])])])]),t("div",Jd,[t("div",Gd,[t("div",Yd,[e[138]||(e[138]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Zd,[e[136]||(e[136]=t("label",{for:""},"Form Name",-1)),D(t("input",{"onUpdate:modelValue":e[35]||(e[35]=l=>dt.value=l),multiple:!1,placeholder:U(A).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,Kd),[[P,dt.value]]),t("div",Qd,[t("div",Xd,[D(t("input",{class:"font-12","onUpdate:modelValue":e[36]||(e[36]=l=>Ge.value=l),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[ke,Ge.value]])]),e[135]||(e[135]=t("div",null,[t("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),t("div",{class:"modal-footer"},[e[137]||(e[137]=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),t("button",{type:"button",class:"btn btn-dark",onClick:vl},"Add Print Format")])])])]),t("div",xd,[t("div",Id,[t("div",eu,[e[139]||(e[139]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"formViewModalLabel"},"Form Preview"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",tu,[se(ds,{blockArr:bt.value},null,8,["blockArr"])]),e[140]||(e[140]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])]),t("div",su,[t("div",lu,[t("span",ou,h(J.value==0?"Add Requestors":`Approval Settings - Level ${J.value}`),1),e[141]||(e[141]=t("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),t("div",au,[t("div",nu,[J.value!==0?(n(),i("div",iu,[e[143]||(e[143]=t("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),D(t("select",{"onUpdate:modelValue":e[37]||(e[37]=l=>ge.value=l),class:"form-select shadow-none font-12"},e[142]||(e[142]=[t("option",{value:""},"Any one of the selected approvers",-1),t("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),t("option",{value:"all_approvals_required"},"All of the selected approvers",-1),t("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[qe,ge.value]])])):b("",!0),t("div",ru,[t("div",du,[t("span",uu," Select "+h(J.value===0?"Requestors":"Approvers"),1),t("span",cu,h(z.value.length)+" Selected ",1)]),ce.value.length?(n(),i("div",pu,[t("div",mu,[t("div",fu,[t("input",{type:"checkbox",id:"selectAll",checked:ol.value,onChange:al,class:"form-check-input me-2 designationCheckBox"},null,40,vu),t("label",bu," Select all designation ("+h(tt.value.length)+") ",1)]),J.value!==0?(n(),i("div",_u,[D(t("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":e[38]||(e[38]=l=>Ye.value=l),class:"form-check-input me-2 designationCheckBox"},null,512),[[ke,Ye.value]]),e[144]||(e[144]=t("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):b("",!0),t("div",null,[z.value.length?(n(),i("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:nl},e[145]||(e[145]=[t("i",{class:"bi bi-x"},null,-1),k(" Clear all ")]))):b("",!0)])]),ce.value.length?(n(),Lt(U(Ql),{key:0,multiple:!0,modelValue:z.value,"onUpdate:modelValue":e[39]||(e[39]=l=>z.value=l),options:tt.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):b("",!0)],512)):(n(),i("div",hu,e[146]||(e[146]=[t("div",{class:"d-flex justify-content-center"},[t("span",null,"No Designations Found")],-1)])))]),J.value!==0?(n(),i("div",gu,[e[147]||(e[147]=t("div",null,[t("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),D(t("select",{"onUpdate:modelValue":e[40]||(e[40]=l=>$e.value=l),class:"form-select shadow-none font-12 mt-1 me-2"},[(n(!0),i(B,null,N(Cs.value,l=>(n(),i("option",{key:l,value:l},h(l===0?"Requestor":"Approver Level "+l),9,yu))),128))],512),[[qe,$e.value,void 0,{number:!0}]])])):b("",!0),J.value!==0?(n(),i("div",wu,[t("div",ku,[t("div",$u,[D(t("input",{"onUpdate:modelValue":e[41]||(e[41]=l=>We.value=l),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[ke,We.value]]),e[148]||(e[148]=t("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),V.value===!0?(n(),i("div",Cu,[D(t("input",{"onUpdate:modelValue":e[42]||(e[42]=l=>Ce.value=l),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[ke,Ce.value]]),e[149]||(e[149]=t("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):b("",!0)])])):b("",!0)]),t("div",Fu,[t("div",Du,[se(ns,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:il,name:J.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},Vu=Rt(Su,[["__scopeId","data-v-ba866e10"]]);export{Vu as default};
