var Sl=Object.defineProperty,Fl=Object.defineProperties;var Cl=Object.getOwnPropertyDescriptors;var ft=Object.getOwnPropertySymbols;var Dl=Object.prototype.hasOwnProperty,ql=Object.prototype.propertyIsEnumerable;var vt=(N,b,k)=>b in N?Sl(N,b,{enumerable:!0,configurable:!0,writable:!0,value:k}):N[b]=k,J=(N,b)=>{for(var k in b||(b={}))Dl.call(b,k)&&vt(N,k,b[k]);if(ft)for(var k of ft(b))ql.call(b,k)&&vt(N,k,b[k]);return N},Re=(N,b)=>Fl(N,Cl(b));var $e=(N,b,k)=>new Promise((x,de)=>{var j=T=>{try{c(k.next(T))}catch(ee){de(ee)}},ke=T=>{try{c(k.throw(T))}catch(ee){de(ee)}},c=T=>T.done?x(T.value):Promise.resolve(T.value).then(j,ke);c((k=k.apply(N,b)).next())});import{_ as Al,u as Ll,M as Vl,r,e as O,x as E,E as Rl,w as te,f as $l,a6 as bt,K as Q,y as B,z as I,U as le,o as i,c as n,d as t,t as v,L as S,l as m,a7 as Ml,m as d,F as U,h as P,n as ie,b as L,O as we,R as ne,Q as gt,X as fe,i as _,v as El,N as K,j as X,k as Je,a8 as _t,B as Bl,a9 as yt,Z as Il,aa as Nl,S as Ol,H as se,ab as je,a2 as ht,ac as Tl,D as wt,ad as Ul}from"./index-Xw3tDZzJ.js";const Pl={class:""},zl={class:""},Wl={class:"d-flex justify-content-between align-items-center CancelNdSave"},Hl={class:"d-flex align-items-center"},Yl={key:0,class:"font-16"},Jl=["disabled"],jl={class:"form-container p-0 container-fluid mt-3"},Gl={class:"row g-4"},Zl={class:"col-lg-2 col-md-3 col-sm-12"},Ql={class:"steps-sticky-div"},Kl={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},Xl=["onClick"],es={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},ts={class:"step-text"},ls={class:"font-11"},ss={class:"font-14"},os={class:"col-lg-10 col-md-9 col-sm-12 formbackground-color"},as={class:"px-2"},is={class:"form-content stepsDiv"},ns={key:0},rs={class:""},ds={class:"stepperbackground ps-3 pe-3 py-2 m-0 d-flex justify-content-between align-items-center"},us={class:"d-flex gap-2 align-items-center"},cs=["disabled"],ps={class:"container-fluid aboutFields p-0"},ms={class:"row"},fs={class:"col-12"},vs={class:"p-4"},bs={class:"card border-0 shadow-sm mb-4"},gs={class:"card-body p-4"},_s={class:"row g-4"},ys={class:"col-md-6"},hs={class:"position-relative"},ws={key:0,class:"badge bg-success position-absolute",style:{top:"-8px",right:"10px","z-index":"10"}},ks={key:1,class:"text-danger font-12 ms-1"},xs={class:"col-md-6"},Ss={key:0,class:"text-danger font-12 ms-1"},Fs={class:"col-md-6"},Cs={class:"card border-0 shadow-sm mb-4"},Ds={class:"card-body p-4"},qs={class:"row g-4"},As={class:"col-md-6"},Ls={class:"form-label font-13 fw-medium"},Vs={key:0,class:"text-danger"},Rs={class:"col-md-6"},$s={class:"form-label font-13 fw-medium"},Ms={key:0,class:"text-danger"},Es={class:"col-md-12"},Bs={class:"form-label font-13 fw-medium"},Is={key:0,class:"text-danger"},Ns={class:"custom-option"},Os=["checked","onChange"],Ts={class:"card border-0 shadow-sm mb-4"},Us={class:"card-body p-4"},Ps={class:"row g-4"},zs={class:"col-md-6"},Ws={class:"text-muted font-11 ms-1"},Hs={key:0,class:"text-success"},Ys={key:1},Js={class:"col-md-6"},js={key:0,class:"col-md-6"},Gs={key:0,class:"card border-0 shadow-sm mb-4"},Zs={class:"card-body p-4"},Qs={class:"row g-4"},Ks={class:"col-md-6"},Xs={class:"col-md-6"},eo={key:1,class:"card border-0 shadow-sm mb-4"},to={class:"card-body p-4"},lo={class:"row g-4"},so={class:"col-md-12"},oo={class:"form-check"},ao=["disabled"],io={key:0,class:"col-md-12"},no={class:"position-relative"},ro=["disabled"],uo={key:0,class:"list-group position-absolute w-100 z-3",style:{"max-height":"200px","overflow-y":"auto"}},co=["onMousedown"],po={key:1,class:"frappe-form-builder"},mo={class:"frappe-nav-bar"},fo={class:"nav-left"},vo={class:"nav-center"},bo={class:"btn-group btn-group-sm",role:"group"},go=["onClick"],_o=["onClick"],yo={class:"nav-right"},ho={class:"frappe-builder-container"},wo={class:"frappe-field-library"},ko={class:"field-library-body"},xo={class:"category-title"},So=["onClick","onDragstart"],Fo={class:"field-item-info"},Co={class:"field-item-label"},Do={class:"field-item-desc"},qo={class:"frappe-form-canvas"},Ao={class:"canvas-header"},Lo={class:"mb-0 font-13"},Vo={class:"field-count"},Ro={class:"fields-list"},$o=["onClick","onDragstart","onDrop"],Mo={class:"field-header"},Eo={class:"field-label"},Bo={key:0,class:"field-required"},Io={class:"field-actions"},No=["onClick"],Oo=["onClick"],To={class:"field-type-badge"},Uo={key:0,class:"field-meta"},Po={class:"text-muted"},zo={key:0,class:"empty-state"},Wo={class:"frappe-properties-panel"},Ho={key:0,class:"properties-content"},Yo={class:"properties-header"},Jo={class:"property-group"},jo={class:"property-field"},Go={class:"property-field"},Zo=["value"],Qo={class:"property-field"},Ko={key:0,class:"property-group"},Xo={class:"property-field"},ea={key:1,class:"property-group"},ta={class:"property-field"},la={class:"property-group"},sa={class:"property-checkbox"},oa=["id"],aa=["for"],ia={class:"property-checkbox"},na=["id"],ra=["for"],da={class:"property-checkbox"},ua=["id"],ca=["for"],pa={class:"property-group"},ma={class:"property-field"},fa={class:"property-group"},va={class:"property-field"},ba={key:1,class:"no-field-selected"},ga={key:2},_a={class:"stepperbackground d-flex align-items-center justify-content-between p-3"},ya={class:"container-fluid mt-4 p-4"},ha={class:"card mb-4"},wa={class:"card-body"},ka={class:"row g-3"},xa={class:"col-md-6"},Sa={class:"btn-group w-100",role:"group"},Fa={key:0,class:"col-md-6"},Ca={key:0,class:"card mb-4"},Da={class:"card-body"},qa={key:0,class:"table-responsive"},Aa={class:"table table-bordered"},La=["onUpdate:modelValue"],Va={class:"form-check form-switch"},Ra=["onUpdate:modelValue"],$a={class:"form-check-label font-12"},Ma=["onClick"],Ea=["onClick"],Ba={key:1,class:"card mb-4"},Ia={class:"card-body"},Na={class:"alert alert-success"},Oa={class:"table-responsive"},Ta={class:"table table-bordered"},Ua={key:0,class:"badge bg-success"},Pa={key:1,class:"badge bg-secondary"},za={class:"text-muted"},Wa={key:2,class:"card mb-4"},Ha={class:"card-body"},Ya={class:"alert alert-success"},Ja={class:"table-responsive"},ja={class:"table table-bordered table-hover"},Ga={class:"badge bg-dark"},Za={key:0,class:"badge bg-danger"},Qa={key:1,class:"badge bg-secondary"},Ka={key:0,class:"badge bg-info"},Xa={key:1,class:"badge bg-warning text-dark"},ei={key:2,class:"badge bg-success"},ti={key:3,class:"badge bg-secondary"},li={class:"text-muted"},si={key:3},oi={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},ai={class:"modal-dialog modal-dialog-centered"},ii={class:"modal-content"},ni={class:"modal-body"},ri=["placeholder"],di={class:"d-flex align-items-center gap-2"},ui={class:"d-flex align-items-center py-2"},ci={class:"modal fade",id:"formViewModal",tabindex:"-1","aria-labelledby":"formViewModalLabel","aria-hidden":"true"},pi={class:"modal-dialog modal-xl modal-dialog-scrollable"},mi={class:"modal-content"},fi={class:"modal-body"},vi={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},bi={class:"offcanvas-header add_designationHeader"},gi={id:"offcanvasRightLabel",class:"font-14 fw-bold"},_i={class:"offcanvas-body add_desig_offCanvas_body p-0"},yi={class:""},hi={key:0,class:"p-3 approval-border-bottom"},wi={class:"px-3 listofdesignations"},ki={class:"my-1 d-flex justify-content-between"},xi={class:"font-12 fw-bold"},Si={class:"italic-style text-secondary font-12"},Fi={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},Ci={class:"d-flex align-items-center justify-content-between gap-1"},Di={class:"form-check ps-1 d-flex align-items-center m-0"},qi=["checked"],Ai={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},Li={key:0,class:"form-check d-flex align-items-center m-0"},Vi={key:1},Ri={key:1,class:"p-3"},$i=["value"],Mi={key:2},Ei={class:""},Bi={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},Ii={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},Ni={class:"offcanvas-footer"},Oi={class:"text-end p-3"},re="Select All",Ti={__name:"FormStepper",setup(N){const b=Ll(),k=Vl(),x=r(1),de=r([]);r([]);const j=r([]),ke=r([]);O([]);let c=O([]),T=O([]);const ee=r([]),A=r([]),Me=r([]),z=r(""),V=r(""),C=r("");let D=O([]);const xe=r("");r(!1),r(!1),r(!1);const Se=r(""),Ee=r(""),Be=r(""),kt=r([]),xt=r([]);O({});const Ge=r([]),Ie=r(!1),Fe=r([]),Ce=r(!1);let Ze=null;const St=r("");let $=r("");const Ft=r(null);r(null),r(null),r(0);const q=r(0),Ct=r(!0),y=r(null),De=r(null),Qe=r(!1),Ke=r(!1),Xe=r(!1);r(!1);const ve=r([]),G=r(null),Z=r("new"),qe=r([]),ue=r([]);r([]);const oe=r([]),be=E(()=>Rl);r(!1),O([]);const R=r({routepath:b.query.routepath,business_unit:b.query.business_unit,formId:b.query.id}),Ae=r(""),ce=r(!1),ge=r(!1),et=[{label:"Public",value:1},{label:"Private",value:0}],Ne=E({get(){return et.find(s=>s.value===a.value.as_web_view)},set(s){a.value.as_web_view=s?s.value:null}}),tt=E({get(){return a.value.form_name||b.query.form_name||""},set(s){a.value.form_name=s}}),a=r({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${be.value.value||R.value.business_unit||b.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:b.query.id?1:0,as_web_view:0,mail_id:""});te(()=>b.query.form_name,s=>{s&&(a.value.form_name=s,a.value.form_short_name=s)},{immediate:!0});const Dt=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(s=>s.toLowerCase().trim()),qt=["Approver","Approved on","Approved By"].map(s=>s.toLowerCase().trim());E(()=>a.value),r(""),r(!1),te(be,s=>{s&&s.value&&(a.value.business_unit=s.value)},{immediate:!0}),te(()=>a.value.form_name,s=>{a.value.form_name=s.trim()}),te(()=>a.value.form_short_name,s=>{a.value.form_short_name=s.trim()}),te(()=>a.value.series,s=>{a.value.series=s.trim()}),te(()=>Z.value,s=>{s==="existing"&&(c.splice(0,c.length),oe.value=[],D.length=0)}),r(null),r(""),r(null);function At(){const s=a.value.is_linked_form;if(!s){Fe.value=[];return}clearTimeout(Ze),Ze=setTimeout(()=>{const e=[["business_unit","=",`${be.value.value}`],["name","like",`%${s}%`]],l={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(e),doctype:Q.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};B.get(`${I.GetDoctypeData}`,{params:l}).then(o=>{Fe.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function Lt(s){a.value.is_linked_form=s,Ce.value=!1}function Vt(){setTimeout(()=>{Ce.value=!1},200)}O({query:"",key:""}),O({}),O({}),O({});const Rt=E(()=>c!=null&&c.length?C.value===1?[0]:Array.from({length:C.value},(s,e)=>e).filter(s=>s<C.value):[]);r(null),r(null);const lt=r([{form_json:""}]),ae=r("");$l(()=>{nt(),ae.value=b.query.Clone,$.value=b.query.id||"new",ae.value==="1"&&(a.value.series=""),$.value!=null&&$.value!=null&&$.value!="new"&&it(),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?Ie.value=!0:Ie.value=!1;let s=localStorage.getItem("Bu");if(a.value.business_unit=s,b.query.preId==="PreDefine"){const e=localStorage.getItem("form_json");if(e){lt.value[0].form_json=e;const l=lt.value[0],o=JSON.parse(l.form_json),u=bt(o.fields);Ge.value=o.child_table_fields,u.forEach(p=>{c.push(p)})}}}),r(null),O({}),r(null);const $t=r([]);r([]),O({});const Mt=r([{id:1,label:"Form Info",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Form Fields",stepno:"Step 2",icon:"bi bi-grid-3x3-gap"},{id:3,label:"Workflow Setup",stepno:"Step 3",icon:"bi bi-diagram-3"},{id:4,label:"Print Format",stepno:"Step 4",icon:"ri-checkbox-circle-line"}]),Le=[{label:"Data",type:"Data",icon:"bi-input-cursor-text",category:"Basic",description:"Single line text input"},{label:"Small Text",type:"Small Text",icon:"bi-textarea-t",category:"Basic",description:"Multi-line text, comma-separated values"},{label:"Text Editor",type:"Text",icon:"bi-file-earmark-richtext",category:"Basic",description:"Rich text editor"},{label:"Code",type:"Code",icon:"bi-code-slash",category:"Basic",description:"Code editor with syntax highlighting"},{label:"Int",type:"Int",icon:"bi-123",category:"Number",description:"Integer number"},{label:"Float",type:"Float",icon:"bi-hash",category:"Number",description:"Decimal number"},{label:"Currency",type:"Currency",icon:"bi-currency-dollar",category:"Number",description:"Money amount with currency"},{label:"Percent",type:"Percent",icon:"bi-percent",category:"Number",description:"Percentage value"},{label:"Check",type:"Check",icon:"bi-check-square",category:"Selection",description:"Checkbox (Yes/No)"},{label:"Select",type:"Select",icon:"bi-menu-button-wide",category:"Selection",description:"Dropdown selection"},{label:"Table MultiSelect",type:"Table MultiSelect",icon:"bi-ui-checks-grid",category:"Selection",description:"Select multiple items"},{label:"Link",type:"Link",icon:"bi-link-45deg",category:"Selection",description:"Link to another DocType"},{label:"Dynamic Link",type:"Dynamic Link",icon:"bi-diagram-3",category:"Selection",description:"Dynamic link based on another field"},{label:"Rating",type:"Rating",icon:"bi-star",category:"Selection",description:"Star rating field"},{label:"Date",type:"Date",icon:"bi-calendar",category:"DateTime",description:"Date picker"},{label:"Datetime",type:"Datetime",icon:"bi-calendar-event",category:"DateTime",description:"Date and time picker"},{label:"Time",type:"Time",icon:"bi-clock",category:"DateTime",description:"Time picker"},{label:"Duration",type:"Duration",icon:"bi-hourglass-split",category:"DateTime",description:"Time duration (HH:MM:SS)"},{label:"Attach",type:"Attach",icon:"bi-paperclip",category:"Media",description:"File attachment"},{label:"Attach Image",type:"Attach Image",icon:"bi-image",category:"Media",description:"Image upload with preview"},{label:"Image",type:"Image",icon:"bi-file-image",category:"Media",description:"Display image from URL"},{label:"Signature",type:"Signature",icon:"bi-pen",category:"Media",description:"Digital signature pad"},{label:"Password",type:"Password",icon:"bi-key",category:"Special",description:"Masked password input"},{label:"Color",type:"Color",icon:"bi-palette",category:"Special",description:"Color picker"},{label:"Barcode",type:"Barcode",icon:"bi-upc-scan",category:"Special",description:"Barcode/QR code display"},{label:"Geolocation",type:"Geolocation",icon:"bi-geo-alt",category:"Special",description:"Map location picker"},{label:"HTML",type:"HTML",icon:"bi-filetype-html",category:"Special",description:"Custom HTML content"},{label:"JSON",type:"JSON",icon:"bi-braces",category:"Special",description:"JSON data editor"},{label:"Read Only",type:"Read Only",icon:"bi-eye",category:"Special",description:"Display-only text"},{label:"Table",type:"Table",icon:"bi-table",category:"Table",description:"Child table with rows"},{label:"Column Break",type:"Column Break",icon:"bi-layout-three-columns",category:"Layout",description:"Start new column"},{label:"Section Break",type:"Section Break",icon:"bi-layout-sidebar",category:"Layout",description:"Start new section"},{label:"Heading",type:"Heading",icon:"bi-type-h1",category:"Layout",description:"Section heading text"},{label:"Button",type:"Button",icon:"bi-square",category:"Layout",description:"Custom action button"}],pe=s=>{if(!s||!s.sections)return[];const e=[];return s.sections.forEach(l=>{l.rows&&l.rows.forEach(o=>{o.columns&&o.columns.forEach(u=>{u.fields&&u.fields.forEach(p=>{e.push({label:p.label||"",fieldtype:p.fieldtype||"",fieldname:p.fieldname||"",options:p.options||"",reqd:p.reqd||0,read_only:p.read_only||0,hidden:p.hidden||0,description:p.description||"",default:p.default||"",value:p.value||""})})})})}),e},st=(s,e)=>{(!s.sections||s.sections.length===0)&&(s.sections=[{label:"",rows:[]}]),(!s.sections[0].rows||s.sections[0].rows.length===0)&&(s.sections[0].rows=[{label:"",columns:[]}]),(!s.sections[0].rows[0].columns||s.sections[0].rows[0].columns.length===0)&&(s.sections[0].rows[0].columns=[{label:"",fields:[]}]),s.sections[0].rows[0].columns[0].fields.push(e)},Et=(s,e,l)=>{let o=0;for(let u of s.sections||[])for(let p of u.rows||[])for(let f of p.columns||[])for(let F=0;F<(f.fields||[]).length;F++){if(o===e)return Object.assign(f.fields[F],l),!0;o++}return!1},Bt=(s,e)=>{let l=0;for(let o of s.sections||[])for(let u of o.rows||[])for(let p of u.columns||[]){if(l+(p.fields||[]).length>e){const f=e-l;return p.fields.splice(f,1),!0}l+=(p.fields||[]).length}return!1},It=(s,e,l)=>{const o=pe(s),[u]=o.splice(e,1);o.splice(l,0,u);for(let p of s.sections||[])for(let f of p.rows||[])for(let F of f.columns||[])F.fields=[];o.forEach(p=>{s.sections&&s.sections[0]&&s.sections[0].rows&&s.sections[0].rows[0]&&s.sections[0].rows[0].columns&&s.sections[0].rows[0].columns[0]&&s.sections[0].rows[0].columns[0].fields.push(p)})},Nt=E(()=>[...new Set(Le.map(e=>e.category))]),Ot=s=>Le.filter(e=>e.category===s),Tt=s=>{const e=Le.find(l=>l.type===s);return(e==null?void 0:e.icon)||"bi-file-text"},Oe=()=>{const s=c[q.value];return s?pe(s):[]},ot=()=>Oe().length,g=()=>y.value===null?{}:Oe()[y.value]||{},Ut=s=>{y.value=s},W=()=>{if(y.value===null)return;const s=c[q.value];if(!s)return;const e=g();Et(s,y.value,e),c.splice(q.value,1,J({},s))},Pt=()=>{const s=g();["Select","Small Text","Table MultiSelect","Link"].includes(s.fieldtype)||(s.options=""),W()},zt=s=>{const e=c[q.value];if(!e)return;const l={label:s.label,fieldtype:s.type,fieldname:at(s.label),reqd:0,read_only:0,hidden:0,options:"",description:"",default:"",value:""};st(e,l),c.splice(q.value,1,J({},e));const o=pe(e);y.value=o.length-1,se(`${s.label} field added successfully`)},at=s=>s.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),Wt=s=>{const e=c[q.value];if(!e)return;const l=pe(e);if(s<0||s>=l.length)return;const o=l[s],u=Re(J({},o),{label:`${o.label} (Copy)`,fieldname:`${o.fieldname||at(o.label)}_copy_${Date.now()}`});st(e,u),c.splice(q.value,1,J({},e));const p=pe(e);y.value=p.length-1,se("Field duplicated successfully")},Ht=s=>{const e=c[q.value];if(!e)return;const l=pe(e);s<0||s>=l.length||(y.value===s?y.value=null:y.value!==null&&y.value>s&&y.value--,Bt(e,s),c.splice(q.value,1,J({},e)),se("Field deleted successfully"))},Yt=s=>{Ft.value=s},Jt=s=>{De.value=s},jt=s=>{if(De.value===null)return;const e=c[q.value];if(!e)return;const l=De.value;It(e,l,s),c.splice(q.value,1,J({},e)),y.value===l&&(y.value=s),De.value=null},Gt=E(()=>[re,...j.value]),Zt=E(()=>{const s=a.value.accessible_departments;return s.includes(re)?"All Selected":s.length>1?`${s[0]}.. +${s.length-1} more selected`:s.join(", ")}),Qt=s=>s===re?a.value.accessible_departments.length===j.value.length:a.value.accessible_departments.includes(s),Kt=(s,e)=>{s===re?e.target.checked?a.value.accessible_departments=[...j.value]:a.value.accessible_departments=[]:(e.target.checked?a.value.accessible_departments.push(s):a.value.accessible_departments=a.value.accessible_departments.filter(l=>l!==s),a.value.accessible_departments.length===j.value.length?a.value.accessible_departments=[...j.value]:a.value.accessible_departments=a.value.accessible_departments.filter(l=>l!==re))},Xt=s=>{s===re&&(a.value.accessible_departments=[...j.value])},el=s=>{s===re&&(a.value.accessible_departments=[])},Te=r(!1),_e=E(()=>{var e;let s=[...ee.value];if(ge.value&&(s=s.filter(l=>l.is_hod===1)),(e=xe.value)!=null&&e.trim()){const l=xe.value.toLowerCase();s=s.filter(o=>o.role.toLowerCase().includes(l))}return s.sort((l,o)=>l.role.localeCompare(o.role)),s.sort((l,o)=>{const u=A.value.includes(l.role),p=A.value.includes(o.role);return u===p?0:u?1:-1}),s.map(l=>l.role)}),tl=E(()=>{const s=_e.value;return s.length>0&&s.every(e=>A.value.includes(e))});te([A,_e],()=>{const s=_e.value;Te.value=s.length>0&&s.every(e=>A.value.includes(e))},{immediate:!0,deep:!0});function ll(s){const e=s.target.checked,l=ee.value.filter(o=>{var u;return!(ge.value&&o.is_hod!==1||(u=xe.value)!=null&&u.trim()&&!o.role.toLowerCase().includes(xe.value.toLowerCase()))}).map(o=>o.role);e?A.value=Array.from(new Set([...A.value,...l])):A.value=A.value.filter(o=>!l.includes(o)),Te.value=e}function sl(){A.value=[],Te.value=!1,ge.value=!1}const ye=r("");function ol(){const s=c[C.value];if(!s||!s.sections){console.error("Error: Invalid block or sections not found.");return}let e={type:C.value==0?"requestor":"approver",roles:A.value,approval_required:Ee.value,approver_can_edit:Be.value,fields:s.sections.flatMap(je),idx:C.value};C.value!==0&&(e.view_only_reportee=ye.value==="ViewOnlyReportee"?1:0,e.all_approvals_required=ye.value==="all_approvals_required"?1:0,e.requester_as_a_approver=ye.value==="requester_as_a_approver"?1:0,e.on_rejection=Se.value?Se.value:0);const l=D.findIndex(o=>o.idx===e.idx);l!==-1?D[l]=e:D.push(e),al()}function al(){B.post(I.add_roles_WF,{workflow_setup:D,doctype:a.value.form_short_name,business_unit:a.value.business_unit}).then(s=>{console.log(s),C.value==0?se("Requestor Added"):se(`Approver-${C.value} Added`)})}function il(){k.push({path:R.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function nl(){a.value.form_name="",a.value.form_short_name="",a.value.owner_of_the_form="",a.value.form_category="",a.value.accessible_departments=[],a.value.series="",a.value.has_workflow="",a.value.is_linked=0,a.value.is_linked_form="",a.value.mail_id="",a.value.public_form_response="",z.value="",V.value="",de.value=[],G.value=null}const rl=s=>{if(he.value){le("Please check all required fields before proceeding.");return}s<x.value?Pe():s>x.value&&Ue()},Ue=()=>{if(he.value){le("Please check all required fields before proceeding.");return}x.value<4&&(x.value+=1,x.value===4&&(Ve.value=c))},Pe=()=>{x.value>1&&(x.value-=1)},dl=r([]);function it(){Xe.value=!0;const s={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:Q.EzyFormDefinitions,doc_id:$.value};B.get(I.GetDoctypeData,{params:s}).then(e=>{var o;let l=e==null?void 0:e.message.data;if(l){l.accessible_departments&&typeof l.accessible_departments=="string"?l.accessible_departments=l.accessible_departments.split(",").filter(f=>f.trim()!==""):l.accessible_departments=[],a.value=Re(J(J({},a.value),l),{owner_of_the_form:l.owner_of_the_form||a.value.owner_of_the_form||""}),a.value.owner_of_the_form&&ze(a.value.owner_of_the_form);const u=JSON.parse((o=e.message.data)==null?void 0:o.form_json);kt.value=u.workflow,St.value=u.fields.filter(f=>f.fieldtype==="Table"),dl.value=u.fields.filter(f=>f.fieldtype==="Table"),ce.value=e.message.data.is_landscape;let p=bt(JSON.parse(l==null?void 0:l.form_json).fields);Ge.value=JSON.parse(e.message.data.form_json).child_table_fields,$t.value=[],xt.value=[],p.forEach((f,F)=>{c.push(f)}),JSON.parse(l==null?void 0:l.form_json).workflow.forEach((f,F)=>{D.push(f)})}}).catch(e=>{console.error("Error fetching data:",e),le("Failed to load form data. Please try again.")}).finally(()=>{Xe.value=!1})}function ul(){const s={};Ae.value&&(s.print_format=Ae.value),ce.value!==void 0&&ce.value!==null&&(s.is_landscape=ce.value),B.put(I.resource+Q.EzyFormDefinitions+`/${b.query.id}`,s).then(e=>{console.log(e),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),se("Print Format Added Successfully")}).catch(e=>{console.error("Error fetching  data:",e)})}function nt(){const s={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${R.value.business_unit||b.query.business_unit}`,doctype:Q.departments};Qe.value=!0,B.get(I.GetDoctypeData,{params:s}).then(e=>{var l;(l=e==null?void 0:e.message.data)!=null&&l.length&&(ke.value=e.message.data.map(o=>o.name),j.value=e.message.data.map(o=>o.name))}).catch(e=>{console.error("Error fetching department data:",e),le("Failed to load departments. Please refresh the page.")}).finally(()=>{Qe.value=!1})}r(""),te(()=>a.value.owner_of_the_form,s=>{s&&ze(s)});function ze(s){s&&typeof s=="string"&&s.trim()!==""&&cl(s)}function cl(s){Ke.value=!0;const e={fields:JSON.stringify(["ezy_departments_items"]),doctype:Q.departments,doc_id:s};B.get(I.GetDoctypeData,{params:e}).then(l=>{var o;(o=l==null?void 0:l.message.data)!=null&&o.ezy_departments_items&&(de.value=l.message.data.ezy_departments_items.map(u=>u.category))}).catch(l=>{console.error("Error fetching categories data:",l),le("Failed to load form categories. Please try again.")}).finally(()=>{Ke.value=!1})}function We(s){let e=Ul(c);const l=Re(J({},a.value),{fields:e,doctype:Q.EzyFormDefinitions,workflow_setup:D,form_status:s==="save"?"Created":"Draft"});l.accessible_departments=l.accessible_departments.toString(),B.post(I.savedata,l).then(o=>{if(o&&o.message&&o.message.message){let u=localStorage.getItem("preName");if(u){let p={installed:"Yes"};B.put(`${I.resource}${Q.preDefinedForm}/${u}`,p).then(f=>{localStorage.removeItem("preName")}).catch(f=>{console.error("Error fetching ezyForms data:",f)})}if(k.push({params:{paramid:o.message.message},query:{id:o.message.message}}),$.value=o.message.message,$&&$!=="new"&&(c.splice(0,c.length),it()),D.length<c.length)wt("Add Workflow");else if(dt.value===!0){se("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let p=localStorage.getItem("routepath");s==="save"?k.push({path:p}):s==="Draft"&&k.push({path:p})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const He=r(""),rt=()=>{var l,o;const s=c.length,e={label:s===0?"requestor":`approver-${s}`,parent:`${(l=be.value)==null?void 0:l.value}-${(o=a.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${be.value.value}-${a.value.form_short_name}`,childTables:[],afterCreated:{},rows:s===0?[{label:`row_0_0_${s}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${s}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${s}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};c.push(e),ht(()=>{He.value&&He.value.scrollTo({top:He.value.scrollHeight,behavior:"smooth"})})},dt=r(!1),pl=s=>{let e=c[s];e.parent&&T.push(e);let l=[];D.length>s&&D[s].roles&&(l=[...D[s].roles]),c.splice(s,1),D.length>s&&D.splice(s,1),c.forEach((o,u)=>{o.sections.forEach((p,f)=>{p.rows.forEach((F,M)=>{F.columns.forEach((h,w)=>{gl(u,f,M,w)})})})}),l.length&&ml(l,s)};function ml(s,e){const l={role:s,level:e,document_type:a.value.form_name,short_name:a.value.form_short_name,property:a.value.business_unit};B.post(I.deleteAssigneRoles,l).then(o=>{o&&We()})}function fl(s){return Dt.includes(s==null?void 0:s.trim().toLowerCase())}function vl(s){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(s)||s.includes('"')||s.includes("'")}function bl(s){return s.flatMap(e=>{var l;return[(l=e.label)==null?void 0:l.trim().toLowerCase(),...e.sections.flatMap(o=>{var u;return[(u=o.label)==null?void 0:u.trim().toLowerCase(),...o.rows.flatMap(p=>p.columns.flatMap(f=>{var F;return[(F=f.label)==null?void 0:F.trim().toLowerCase(),...f.fields.map(M=>{var h;return(h=M.label)==null?void 0:h.trim().toLowerCase()})]}))]})]}).filter(e=>e!==""&&!qt.includes(e))}function gl(s,e,l,o,u){const f=bl(c).filter((h,w,H)=>H.indexOf(h)!==w),F=Tl(c);c.splice(0,c.length,...F);function M(h,w){if(!h){w.errorMsg="";return}fl(h)?w.errorMsg="Entered label is restricted":vl(h)?w.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:h.length>64?w.errorMsg="Label should not exceed 64 characters":w.errorMsg=f.includes(h.trim().toLowerCase())?"Duplicate Label Name":""}o!==void 0&&M(c[s].sections[e].rows[l].columns[o].label,c[s].sections[e].rows[l].columns[o]),o===void 0&&u===void 0&&M(c[s].sections[e].label,c[s].sections[e]),c.forEach(h=>{h.sections.forEach(w=>{M(w.label,w),w.rows.forEach(H=>{H.columns.forEach(me=>{M(me.label,me),me.fields.forEach(Y=>{M(Y.label,Y)})})})})})}const Ye=E(()=>{function s(e){return!e||typeof e!="object"?!1:"fieldtype"in e&&e.fieldtype===""||"error"in e&&e.error||"errorMsg"in e&&e.errorMsg||["Select","Table MultiSelect"].includes(e.fieldtype)&&(!e.options||e.options.trim()==="")?!0:Array.isArray(e)?e.some(s):Object.values(e).some(s)}return s(c)}),he=E(()=>z.value.length>0||V.value.length>0||!a.value.form_category||!a.value.owner_of_the_form||a.value.accessible_departments.length===0),_l=E(()=>c.some(s=>s.sections.some(e=>e.rows.some(l=>l.columns.some(o=>o.fields.some(u=>u.label&&u.fieldtype))))));function ut(s,e){let l=s.target.value.trim();if(!l){e==="form_name"?z.value="Input cannot be empty or only spaces":e==="form_short_name"&&(V.value="Input cannot be empty or only spaces");return}if(l.length>63){e==="form_name"?z.value="Name cannot exceed 63 characters":e==="form_short_name"&&(V.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(l)){e==="form_short_name"&&(V.value="First character must be a letter");return}else V.value="";if(e==="form_short_name"&&l.length<2){V.value="Short name must have at least 2 letters";return}if(e==="form_short_name"&&/[^a-zA-Z ]/.test(l)){V.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(l)){e==="form_name"?z.value="Special characters are not allowed":e==="form_short_name"&&(V.value="Special characters are not allowed");return}else e==="form_name"?z.value="":e==="form_short_name"&&(V.value="");const o=[[e,"=",`${l}`],["business_unit","=",`${a.value.business_unit}`]],u={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:Q.EzyFormDefinitions};B.get(`${I.GetDoctypeData}`,{params:u}).then(p=>{Me.value=p.message.data,e==="form_name"?z.value=l&&Me.value.some(f=>f.form_name&&f.form_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":e==="form_short_name"&&(V.value=l&&Me.value.some(f=>f.form_short_name&&f.form_short_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(p=>{console.error("Error fetching ezyForms data:",p),e==="form_name"?z.value="":e==="form_short_name"&&(V.value="")})}const Ve=r([]),yl=()=>{c.length&&(Ve.value=c,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function hl(){B.post(I.delete_form_items,{deleted_fields:T.flatMap(je),doctype:$}).then(s=>{var e;(e=s==null?void 0:s.message)!=null&&e.success&&We()})}function ct(s){return $e(this,null,function*(){if(Ye.value){le("Please fix the errors before proceeding.");return}dt.value=!0;let e=T.flatMap(je);$!=null&&$!=null&&$!="new"&&e.length?hl():We(s)})}const wl=()=>{qe.value.push({role:"",autoApproval:!1,permissions:{}})},kl=s=>{qe.value.splice(s,1)},xl=s=>{wt("Permission configuration modal will be implemented here")},pt=()=>$e(this,null,function*(){var s;if(!(ve.value.length>0))try{const e={doctype:"WF Roadmap",fields:JSON.stringify(["name","roadmap_title","document_type","workflow_levels","property","cluster_name"]),filters:JSON.stringify([])},l=yield B.get(I.GetDoctypeData,{params:e});(s=l==null?void 0:l.message)!=null&&s.data&&(ve.value=l.message.data.map(o=>({roadmap_title:o.name,display_name:`${o.roadmap_title} (${o.document_type})`,document_type:o.document_type,workflow_levels:o.workflow_levels,property:o.property,cluster_name:o.cluster_name})),console.log("Fetched WF Road Maps:",ve.value))}catch(e){console.error("Error fetching WF Road Maps:",e),le("Failed to fetch workflow road maps")}}),mt=s=>$e(this,null,function*(){var e;try{console.log("Selected WF Road Map:",s);const l=yield B.get(`${I.resource}${Q.wfRoadmap}/${s.roadmap_title}`),o=((e=l==null?void 0:l.data)==null?void 0:e.data)||(l==null?void 0:l.data)||{};console.log("WF Road Map Data:",o);const u=(o.wf_requestors&&o.wf_requestors.length>0,1),p={};o.wf_level_setup&&o.wf_level_setup.length>0&&o.wf_level_setup.forEach(h=>{p[h.level]||(p[h.level]=[]),p[h.level].push(h)});const f=Object.keys(p).length,F=u+f;for(console.log(`Required blocks: ${F} (1 requestor + ${f} approver levels)`),D=[],ue.value=[],oe.value=[];c.length>F;)c.pop();for(;c.length<F;)rt();console.log(`Block adjustment complete: ${c.length} blocks`);let M=0;o.wf_requestors&&o.wf_requestors.length>0?(ue.value=o.wf_requestors,console.log(`Loaded ${o.wf_requestors.length} requestor role(s)`),o.wf_requestors.forEach(h=>{D.push({type:"requestor",roles:[h.requestor],auto_approval:h.auto_approval||0,columns_allowed:h.columns_allowed||"",fields:[],idx:0})})):console.warn("No Requestors found in roadmap, creating default requestor setup"),M=1,o.wf_level_setup&&o.wf_level_setup.length>0?(oe.value=o.wf_level_setup.sort((w,H)=>w.level-H.level),console.log(`Loaded ${o.wf_level_setup.length} approver level(s)`),Object.keys(p).sort((w,H)=>parseInt(w)-parseInt(H)).forEach(w=>{const H=p[w],me=M;console.log(`Level ${w} → Block Index ${me}, Roles: ${H.length}`),H.forEach(Y=>{D.push({type:"approver",level:parseInt(w),roles:[Y.role],approval_required:Y.mandatory?1:0,approver_can_edit:0,view_only_reportee:Y.view_only_reportee||0,all_approvals_required:Y.all_approvals_required||0,requester_as_a_approver:Y.requester_as_a_approver||0,on_rejection:Y.on_rejection||0,columns_allowed:Y.columns_allowed||"",fields:[],idx:me})}),M++})):console.warn("No approver levels found in roadmap"),console.log("Final blockArr length:",c.length),console.log("Final workflowSetup:",D),se(`Workflow configured! ${ue.value.length} requestor role(s), ${oe.value.length} approver level(s) across ${c.length} blocks.`),ht(()=>{q.value=0})}catch(l){console.error("Error in handleWFRoadMapSelect:",l),le("Failed to load workflow. Please try again.")}});return(s,e)=>(i(),n("div",null,[t("div",Pl,[t("div",zl,[t("div",Wl,[t("div",Hl,[t("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:e[0]||(e[0]=l=>il())},e[46]||(e[46]=[t("button",{class:"btn font-13 ms-3"},[t("i",{class:"bi bi-arrow-left"}),t("span",{class:"ms-2"},"Back")],-1)])),s.$route.query.id||s.$route.query.preId?(i(),n("span",Yl,"("+v(R.value.formId||S(b).query.form_name)+")",1)):m("",!0)]),t("div",null,[x.value===2&&S(c).length&&!s.$route.query.id?(i(),n("button",{key:0,disabled:Ye.value||he.value,style:Ml({cursor:Ye.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:e[1]||(e[1]=l=>ct("Draft"))},e[47]||(e[47]=[t("i",{class:"bi bi-bookmark-check-fill"},null,-1),d(" Save As Draft ")]),12,Jl)):m("",!0)])]),t("div",jl,[t("div",Gl,[t("div",Zl,[t("div",Ql,[t("ul",Kl,[(i(!0),n(U,null,P(Mt.value,l=>(i(),n("li",{key:l.id,class:ie({active:x.value===l.id,completed:x.value>l.id})},[t("div",{class:ie(["d-flex gap-3 align-items-center",{"not-allowed":he.value&&x.value+1===l.id}]),onClick:o=>rl(l.id)},[x.value>l.id?(i(),n("i",es)):(i(),n("i",{key:1,class:ie(l.icon)},null,2)),t("div",ts,[t("span",ls,v(l.stepno),1),e[48]||(e[48]=t("br",null,null,-1)),t("span",ss,v(l.label),1)])],10,Xl)],2))),128))])])]),t("div",os,[t("div",as,[t("div",is,[x.value===1?(i(),n("div",ns,[t("div",rs,[t("div",ds,[e[51]||(e[51]=t("div",null,[t("h1",{class:"font-16 fw-bold m-0"},"Form Information"),t("p",{class:"font-12 text-muted m-0"},"Configure basic form settings and permissions")],-1)),t("div",us,[!s.$route.query.id&&!s.$route.query.preId?(i(),n("button",{key:0,class:"btn btn-outline-secondary font-13",type:"button",onClick:nl},e[49]||(e[49]=[t("i",{class:"bi bi-x-circle me-1"},null,-1),d("Clear Form ")]))):m("",!0),x.value<5?(i(),n("button",{key:1,class:"btn btn-dark font-13 px-4",disabled:he.value,onClick:Ue},e[50]||(e[50]=[d(" Next "),t("i",{class:"bi bi-arrow-right ms-1"},null,-1)]),8,cs)):m("",!0)])])]),t("div",ps,[t("div",ms,[t("div",fs,[t("div",vs,[t("div",bs,[e[56]||(e[56]=t("div",{class:"card-header bg-light border-bottom"},[t("h6",{class:"m-0 fw-bold font-14"},[t("i",{class:"bi bi-file-earmark-text me-2"}),d("Form Details")])],-1)),t("div",gs,[t("div",_s,[t("div",ys,[t("div",hs,[S(b).query.preId?(i(),n("span",ws,e[52]||(e[52]=[t("i",{class:"bi bi-check2-circle me-1"},null,-1),d("Predefined ")]))):m("",!0),L(we,{disabled:(R.value.formId&&R.value.formId.length>0||S(b).query.form_name)&&ae.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Enter form name (e.g., Leave Request)",onChange:e[2]||(e[2]=l=>ut(l,"form_name")),modelValue:tt.value,"onUpdate:modelValue":e[3]||(e[3]=l=>tt.value=l)},null,8,["disabled","modelValue"]),z.value?(i(),n("span",ks,[e[53]||(e[53]=t("i",{class:"bi bi-exclamation-circle me-1"},null,-1)),d(v(z.value),1)])):m("",!0)])]),t("div",xs,[L(we,{disabled:(R.value.formId&&R.value.formId.length>0||S(b).query.form_name)&&ae.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Enter short code (e.g., LR, PR)",onChange:e[4]||(e[4]=l=>ut(l,"form_short_name")),modelValue:a.value.form_short_name,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.form_short_name=l)},null,8,["disabled","modelValue"]),V.value?(i(),n("span",Ss,[e[54]||(e[54]=t("i",{class:"bi bi-exclamation-circle me-1"},null,-1)),d(v(V.value),1)])):m("",!0)]),t("div",Fs,[L(we,{disabled:R.value.formId&&R.value.formId.length>0&&ae.value!=="1",labeltext:"Form Naming Series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"e.g., YY-YY, YYYY, or ABC",modelValue:a.value.series,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.series=l)},null,8,["disabled","modelValue"]),e[55]||(e[55]=t("small",{class:"text-muted font-11 ms-1"},[t("i",{class:"bi bi-info-circle me-1"}),d(" Format examples: "),t("code",null,"YY-YY"),d(" → 24-25-0001, "),t("code",null,"YYYY"),d(" → 2025-0001, "),t("code",null,"ABC"),d(" → ABC-0001 ")],-1))])])])]),t("div",Cs,[e[63]||(e[63]=t("div",{class:"card-header bg-light border-bottom"},[t("h6",{class:"m-0 fw-bold font-14"},[t("i",{class:"bi bi-building me-2"}),d("Department & Permissions")])],-1)),t("div",Ds,[t("div",qs,[t("div",As,[t("label",Ls,[e[57]||(e[57]=d(" Owner Department ")),a.value.owner_of_the_form?m("",!0):(i(),n("span",Vs,"*"))]),L(S(ne),{disabled:R.value.formId&&R.value.formId.length>0&&ae.value!=="1",onOpen:nt,options:ke.value,onChange:ze,modelValue:a.value.owner_of_the_form,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.owner_of_the_form=l),placeholder:"Select owning department",multiple:!1,class:"font-12 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"]),e[58]||(e[58]=t("small",{class:"text-muted font-11 ms-1"},[t("i",{class:"bi bi-info-circle me-1"}),d("Department that owns and manages this form ")],-1))]),t("div",Rs,[t("label",$s,[e[59]||(e[59]=d(" Form Category ")),a.value.form_category?m("",!0):(i(),n("span",Ms,"*"))]),L(S(ne),{disabled:R.value.formId&&R.value.formId.length>0&&ae.value!=="1",options:de.value,modelValue:a.value.form_category,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.form_category=l),placeholder:"Select a category",multiple:!1,searchable:!0,class:"font-12 multiselect"},null,8,["disabled","options","modelValue"]),e[60]||(e[60]=t("small",{class:"text-muted font-11 ms-1"},[t("i",{class:"bi bi-info-circle me-1"}),d("Categorize this form for better organization ")],-1))]),t("div",Es,[t("label",Bs,[e[61]||(e[61]=d(" Accessible to Departments ")),a.value.accessible_departments.length?m("",!0):(i(),n("span",Is,"*"))]),L(S(ne),{modelValue:a.value.accessible_departments,"onUpdate:modelValue":e[10]||(e[10]=l=>a.value.accessible_departments=l),options:Gt.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select departments that can access this form",class:"font-12",onSelect:Xt,onRemove:el,openDirection:"bottom"},{option:gt(({option:l})=>[t("div",Ns,[t("input",{type:"checkbox",checked:Qt(l),class:"custom-checkbox",onChange:o=>Kt(l,o),onClick:e[9]||(e[9]=fe(()=>{},["stop"]))},null,40,Os),t("span",null,v(l),1)])]),selection:gt(({values:l,isOpen:o})=>[l.length?_((i(),n("span",{key:0,class:"multiselect__single font-11"},v(Zt.value),513)),[[El,!o]]):m("",!0)]),_:1},8,["modelValue","options"]),e[62]||(e[62]=t("small",{class:"text-muted font-11 ms-1"},[t("i",{class:"bi bi-info-circle me-1"}),d("Users from these departments can raise requests using this form ")],-1))])])])]),t("div",Ts,[e[70]||(e[70]=t("div",{class:"card-header bg-light border-bottom"},[t("h6",{class:"m-0 fw-bold font-14"},[t("i",{class:"bi bi-gear me-2"}),d("Form Settings")])],-1)),t("div",Us,[t("div",Ps,[t("div",zs,[e[65]||(e[65]=t("label",{class:"form-label font-13 fw-medium"},"Form Type",-1)),L(S(ne),{options:et,modelValue:Ne.value,"onUpdate:modelValue":e[11]||(e[11]=l=>Ne.value=l),placeholder:"Select form visibility",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:l=>l.value,class:"font-12 multiselect",openDirection:"bottom"},null,8,["modelValue","reduce"]),t("small",Ws,[e[64]||(e[64]=t("i",{class:"bi bi-info-circle me-1"},null,-1)),Ne.value===1?(i(),n("span",Hs,"Public forms are accessible via QR code without login")):(i(),n("span",Ys,"Private forms require authentication to access"))])]),t("div",Js,[e[66]||(e[66]=t("label",{class:"form-label font-13 fw-medium"},[d(" Enable Workflow "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),L(S(ne),{options:["Yes","No"],modelValue:a.value.has_workflow,"onUpdate:modelValue":e[12]||(e[12]=l=>a.value.has_workflow=l),placeholder:"Enable approval workflow?",multiple:!1,class:"font-12 multiselect",searchable:!0},null,8,["modelValue"]),e[67]||(e[67]=t("small",{class:"text-muted font-11 ms-1"},[t("i",{class:"bi bi-info-circle me-1"}),d("Enable if this form requires multi-level approvals ")],-1))]),a.value.has_workflow==="Yes"?(i(),n("div",js,[e[68]||(e[68]=t("label",{class:"form-label font-13 fw-medium"},[d(" Use Existing Workflow "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),L(S(ne),{onOpen:pt,options:ve.value,modelValue:G.value,"onUpdate:modelValue":e[13]||(e[13]=l=>G.value=l),placeholder:"Select a workflow roadmap",multiple:!1,class:"font-12 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:mt,openDirection:"bottom"},null,8,["options","modelValue"]),e[69]||(e[69]=t("small",{class:"text-muted font-11 ms-1"},[t("i",{class:"bi bi-info-circle me-1"}),d(" Auto-populates requestor and approver configurations from existing workflow ")],-1))])):m("",!0)])])]),a.value.as_web_view===1?(i(),n("div",Gs,[e[75]||(e[75]=t("div",{class:"card-header bg-light border-bottom"},[t("h6",{class:"m-0 fw-bold font-14"},[t("i",{class:"bi bi-qr-code me-2"}),d("Public Form Settings")])],-1)),t("div",Zs,[t("div",Qs,[t("div",Ks,[e[71]||(e[71]=t("label",{class:"form-label font-13 fw-medium"},[d(" Submit Response Message "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),L(we,{class:"formHeight",type:"text",tag:"input",name:"Value",id:"formSubmitResponse",placeholder:"e.g., Thank you! Your request has been submitted.",modelValue:a.value.public_form_response,"onUpdate:modelValue":e[14]||(e[14]=l=>a.value.public_form_response=l)},null,8,["modelValue"]),e[72]||(e[72]=t("small",{class:"text-muted font-11 ms-1"},[t("i",{class:"bi bi-info-circle me-1"}),d("Message shown to users after successful form submission ")],-1))]),t("div",Xs,[e[73]||(e[73]=t("label",{class:"form-label font-13 fw-medium"},[d(" Notification Email(s) "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),L(we,{class:"formHeight",type:"text",tag:"input",name:"Value",id:"formSubmitEmail",placeholder:"email1@example.com, email2@example.com",modelValue:a.value.mail_id,"onUpdate:modelValue":e[15]||(e[15]=l=>a.value.mail_id=l)},null,8,["modelValue"]),e[74]||(e[74]=t("small",{class:"text-muted font-11 ms-1"},[t("i",{class:"bi bi-info-circle me-1"}),d("Email addresses to notify on form submission (comma-separated) ")],-1))])])])])):m("",!0),S(b).query.preId?(i(),n("div",eo,[e[79]||(e[79]=t("div",{class:"card-header bg-light border-bottom"},[t("h6",{class:"m-0 fw-bold font-14"},[t("i",{class:"bi bi-link-45deg me-2"}),d("Advanced Options")])],-1)),t("div",to,[t("div",lo,[t("div",so,[t("div",oo,[_(t("input",{class:"form-check-input",disabled:a.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":e[16]||(e[16]=l=>a.value.is_linked=l),"true-value":1,"false-value":0},null,8,ao),[[K,a.value.is_linked]]),e[76]||(e[76]=t("label",{class:"form-check-label font-13",for:"is_linked"}," Link this form to another form ",-1))]),e[77]||(e[77]=t("small",{class:"text-muted font-11 ms-4"},[t("i",{class:"bi bi-info-circle me-1"}),d("Create a relationship between this form and an existing form ")],-1))]),a.value.is_linked?(i(),n("div",io,[e[78]||(e[78]=t("label",{class:"form-label font-13 fw-medium"},"Linked Form",-1)),t("div",no,[_(t("input",{type:"text",class:"form-control font-13",id:"standardFormInput",disabled:a.value.is_predefined_doctype==1,"onUpdate:modelValue":e[17]||(e[17]=l=>a.value.is_linked_form=l),placeholder:"Type to search and select a form...",onInput:At,onFocus:e[18]||(e[18]=l=>Ce.value=!0),onBlur:Vt},null,40,ro),[[X,a.value.is_linked_form]]),Ce.value&&Fe.value.length?(i(),n("ul",uo,[(i(!0),n(U,null,P(Fe.value,(l,o)=>(i(),n("li",{class:"list-group-item list-group-item-action font-12",key:o,onMousedown:fe(u=>Lt(l.name),["prevent"]),style:{cursor:"pointer"}},v(l.name),41,co))),128))])):m("",!0)])])):m("",!0)])])])):m("",!0)])])])])])):m("",!0),x.value===2?(i(),n("div",po,[t("div",mo,[t("div",fo,[t("button",{onClick:e[19]||(e[19]=l=>Pe()),class:"btn btn-sm btn-link text-dark"},e[80]||(e[80]=[t("i",{class:"bi bi-chevron-left me-1"},null,-1),d("Back ")]))]),t("div",vo,[t("div",bo,[(i(!0),n(U,null,P(S(c),(l,o)=>(i(),n("button",{key:o,type:"button",class:ie(["btn",q.value===o?"btn-primary":"btn-outline-secondary"]),onClick:u=>q.value=o},[d(v(o===0?"Requestor":`Approver ${o}`)+" ",1),S(c).length>1?(i(),n("i",{key:0,class:"bi bi-x ms-2",onClick:fe(u=>pl(o),["stop"])},null,8,_o)):m("",!0)],10,go))),128))])]),t("div",yo,[t("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:rt},e[81]||(e[81]=[t("i",{class:"bi bi-plus-lg me-1"},null,-1),d("Add Block ")])),_l.value?(i(),n("button",{key:0,class:"btn btn-sm btn-outline-secondary me-2",onClick:yl},e[82]||(e[82]=[t("i",{class:"bi bi-eye me-1"},null,-1),d("Preview ")]))):m("",!0),S(c).length?(i(),n("button",{key:1,class:"btn btn-sm btn-primary",onClick:e[20]||(e[20]=l=>ct("save"))},[e[83]||(e[83]=t("i",{class:"bi bi-save me-1"},null,-1)),d(v(S($)!=="new"?"Update":"Save"),1)])):m("",!0)])]),t("div",ho,[t("aside",wo,[e[84]||(e[84]=t("div",{class:"field-library-header"},[t("h6",{class:"mb-0 font-13 fw-bold"},"Add Field")],-1)),t("div",ko,[(i(!0),n(U,null,P(Nt.value,l=>(i(),n("div",{key:l,class:"field-category"},[t("div",xo,v(l),1),(i(!0),n(U,null,P(Ot(l),o=>(i(),n("div",{key:o.type,class:"field-item",onClick:u=>zt(o),draggable:"true",onDragstart:u=>Yt(o)},[t("i",{class:ie(o.icon||"bi-file-text")},null,2),t("div",Fo,[t("div",Co,v(o.label),1),t("div",Do,v(o.description),1)])],40,So))),128))]))),128))])]),t("div",qo,[t("div",Ao,[t("h6",Lo,v(q.value===0?"Requestor Fields":`Approver ${q.value} Fields`),1),t("span",Vo,v(ot())+" fields",1)]),t("div",Ro,[(i(!0),n(U,null,P(Oe(),(l,o)=>(i(),n("div",{key:"field-"+o,class:ie(["form-field-item",{selected:y.value===o}]),onClick:u=>Ut(o),draggable:"true",onDragstart:u=>Jt(o),onDragover:e[21]||(e[21]=fe(()=>{},["prevent"])),onDrop:u=>jt(o)},[t("div",Mo,[t("div",Eo,[d(v(l.label||"Unnamed Field")+" ",1),l.reqd?(i(),n("span",Bo,"*")):m("",!0)]),t("div",Io,[t("button",{class:"btn btn-sm btn-link p-0 text-secondary",onClick:fe(u=>Wt(o),["stop"]),title:"Duplicate"},e[85]||(e[85]=[t("i",{class:"bi bi-files"},null,-1)]),8,No),t("button",{class:"btn btn-sm btn-link p-0 text-danger",onClick:fe(u=>Ht(o),["stop"]),title:"Delete"},e[86]||(e[86]=[t("i",{class:"bi bi-trash"},null,-1)]),8,Oo)])]),t("div",To,[t("i",{class:ie(Tt(l.fieldtype))},null,2),d(" "+v(l.fieldtype||"Data"),1)]),l.options&&["Select","Link"].includes(l.fieldtype)?(i(),n("div",Uo,[t("small",Po,v(l.options),1)])):m("",!0)],42,$o))),128)),t("div",{class:"add-field-btn",onClick:e[22]||(e[22]=l=>Ct.value=!0)},e[87]||(e[87]=[t("i",{class:"bi bi-plus-circle me-2"},null,-1),d(" Add Field ")])),ot()===0?(i(),n("div",zo,e[88]||(e[88]=[t("i",{class:"bi bi-inbox"},null,-1),t("p",null,"No fields yet",-1),t("small",null,'Click "Add Field" or drag a field type from the left',-1)]))):m("",!0)])]),t("aside",Wo,[y.value!==null?(i(),n("div",Ho,[t("div",Yo,[e[90]||(e[90]=t("div",{class:"properties-title"},[t("i",{class:"bi bi-sliders me-2"}),d(" Field Properties ")],-1)),t("button",{class:"btn btn-sm btn-link p-0 text-secondary",onClick:e[23]||(e[23]=l=>y.value=null)},e[89]||(e[89]=[t("i",{class:"bi bi-x-lg"},null,-1)]))]),t("div",Jo,[e[96]||(e[96]=t("div",{class:"property-group-title"},"Basic",-1)),t("div",jo,[e[91]||(e[91]=t("label",{class:"property-label"},"Label",-1)),_(t("input",{type:"text",class:"property-input","onUpdate:modelValue":e[24]||(e[24]=l=>g().label=l),placeholder:"Field Label",onInput:W},null,544),[[X,g().label]])]),t("div",Go,[e[93]||(e[93]=t("label",{class:"property-label"},"Field Type",-1)),_(t("select",{class:"property-input","onUpdate:modelValue":e[25]||(e[25]=l=>g().fieldtype=l),onChange:Pt},[e[92]||(e[92]=t("option",{value:""},"Select Type",-1)),(i(),n(U,null,P(Le,l=>t("option",{key:l.type,value:l.type},v(l.label),9,Zo)),64))],544),[[Je,g().fieldtype]])]),t("div",Qo,[e[94]||(e[94]=t("label",{class:"property-label"},"Field Name",-1)),_(t("input",{type:"text",class:"property-input","onUpdate:modelValue":e[26]||(e[26]=l=>g().fieldname=l),placeholder:"field_name",onInput:W},null,544),[[X,g().fieldname]]),e[95]||(e[95]=t("small",{class:"property-help-text"},"Internal field name (lowercase, underscores)",-1))])]),["Select","Small Text","Table MultiSelect"].includes(g().fieldtype)?(i(),n("div",Ko,[e[98]||(e[98]=t("div",{class:"property-group-title"},"Options",-1)),t("div",Xo,[e[97]||(e[97]=t("label",{class:"property-label"},"Options (one per line)",-1)),_(t("textarea",{class:"property-input",rows:"4","onUpdate:modelValue":e[27]||(e[27]=l=>g().options=l),placeholder:`Option 1
Option 2
Option 3`,onInput:W},null,544),[[X,g().options]])])])):m("",!0),g().fieldtype==="Link"?(i(),n("div",ea,[e[100]||(e[100]=t("div",{class:"property-group-title"},"Link Settings",-1)),t("div",ta,[e[99]||(e[99]=t("label",{class:"property-label"},"Link To (DocType)",-1)),_(t("input",{type:"text",class:"property-input","onUpdate:modelValue":e[28]||(e[28]=l=>g().options=l),placeholder:"Enter DocType name",onInput:W},null,544),[[X,g().options]])])])):m("",!0),t("div",la,[e[101]||(e[101]=t("div",{class:"property-group-title"},"Validation",-1)),t("div",sa,[_(t("input",{type:"checkbox",id:"mandatory-"+y.value,"onUpdate:modelValue":e[29]||(e[29]=l=>g().reqd=l),"true-value":1,"false-value":0,onChange:W},null,40,oa),[[K,g().reqd]]),t("label",{for:"mandatory-"+y.value},"Mandatory",8,aa)]),t("div",ia,[_(t("input",{type:"checkbox",id:"readonly-"+y.value,"onUpdate:modelValue":e[30]||(e[30]=l=>g().read_only=l),"true-value":1,"false-value":0,onChange:W},null,40,na),[[K,g().read_only]]),t("label",{for:"readonly-"+y.value},"Read Only",8,ra)]),t("div",da,[_(t("input",{type:"checkbox",id:"hidden-"+y.value,"onUpdate:modelValue":e[31]||(e[31]=l=>g().hidden=l),"true-value":1,"false-value":0,onChange:W},null,40,ua),[[K,g().hidden]]),t("label",{for:"hidden-"+y.value},"Hidden",8,ca)])]),t("div",pa,[e[103]||(e[103]=t("div",{class:"property-group-title"},"Help",-1)),t("div",ma,[e[102]||(e[102]=t("label",{class:"property-label"},"Description",-1)),_(t("textarea",{class:"property-input",rows:"3","onUpdate:modelValue":e[32]||(e[32]=l=>g().description=l),placeholder:"Help text for this field",onInput:W},null,544),[[X,g().description]])])]),t("div",fa,[t("div",va,[e[104]||(e[104]=t("label",{class:"property-label"},"Default Value",-1)),_(t("input",{type:"text",class:"property-input","onUpdate:modelValue":e[33]||(e[33]=l=>g().default=l),placeholder:"Default value",onInput:W},null,544),[[X,g().default]])])])])):(i(),n("div",ba,e[105]||(e[105]=[t("i",{class:"bi bi-hand-index"},null,-1),t("p",null,"Select a field",-1),t("small",null,"Click on a field to edit its properties",-1)])))])])])):m("",!0),x.value===3?(i(),n("div",ga,[t("div",_a,[t("button",{onClick:e[34]||(e[34]=l=>Pe()),class:"btn btn-sm btn-light"},e[106]||(e[106]=[t("i",{class:"bi bi-chevron-left"},null,-1),d(" Back ")])),e[108]||(e[108]=t("h1",{class:"font-14 fw-bold m-0"},"Workflow Setup",-1)),t("button",{class:"btn btn-sm btn-dark",onClick:Ue},e[107]||(e[107]=[d(" Next "),t("i",{class:"bi bi-chevron-right"},null,-1)]))]),t("div",ya,[t("div",ha,[e[114]||(e[114]=t("div",{class:"card-header bg-light"},[t("h6",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-diagram-3 me-2"}),d("Workflow Configuration")])],-1)),t("div",wa,[t("div",ka,[t("div",xa,[e[111]||(e[111]=t("label",{class:"form-label fw-bold"},"Workflow Type",-1)),t("div",Sa,[_(t("input",{type:"radio",class:"btn-check",name:"workflowType",id:"existingWorkflow",value:"existing","onUpdate:modelValue":e[35]||(e[35]=l=>Z.value=l)},null,512),[[_t,Z.value]]),e[109]||(e[109]=t("label",{class:"btn btn-outline-primary",for:"existingWorkflow"},[t("i",{class:"bi bi-folder me-1"}),d("Use Existing ")],-1)),_(t("input",{type:"radio",class:"btn-check",name:"workflowType",id:"newWorkflow",value:"new","onUpdate:modelValue":e[36]||(e[36]=l=>Z.value=l),checked:""},null,512),[[_t,Z.value]]),e[110]||(e[110]=t("label",{class:"btn btn-outline-primary",for:"newWorkflow"},[t("i",{class:"bi bi-plus-circle me-1"}),d("Create New ")],-1))])]),Z.value==="existing"?(i(),n("div",Fa,[e[112]||(e[112]=t("label",{class:"form-label fw-bold"},"Select Workflow",-1)),L(S(ne),{onOpen:pt,options:ve.value,modelValue:G.value,"onUpdate:modelValue":e[37]||(e[37]=l=>G.value=l),placeholder:"Select WF Road Map",multiple:!1,class:"font-11 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:mt,openDirection:"bottom"},null,8,["options","modelValue"]),e[113]||(e[113]=t("small",{class:"text-muted font-12 mt-1 d-block"},[t("i",{class:"bi bi-info-circle me-1"}),d("Auto-populates requestors and approvers ")],-1))])):m("",!0)])])]),Z.value==="new"?(i(),n("div",Ca,[e[120]||(e[120]=t("div",{class:"card-header bg-light"},[t("h6",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-person-plus me-2"}),d("Requestor Configuration")])],-1)),t("div",Da,[e[119]||(e[119]=t("p",{class:"text-muted font-12 mb-3"},[t("i",{class:"bi bi-info-circle me-1"}),d(" Define who can submit requests for this form based on WF Requestors ")],-1)),t("button",{class:"btn btn-primary btn-sm mb-3",onClick:wl},e[115]||(e[115]=[t("i",{class:"bi bi-plus-lg me-1"},null,-1),d("Add Requestor Role ")])),qe.value.length>0?(i(),n("div",qa,[t("table",Aa,[e[118]||(e[118]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{width:"40%"},"Role"),t("th",{width:"30%"},"Auto Approval"),t("th",{width:"20%"},"Permissions"),t("th",{width:"10%"},"Action")])],-1)),t("tbody",null,[(i(!0),n(U,null,P(qe.value,(l,o)=>(i(),n("tr",{key:o},[t("td",null,[_(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":u=>l.role=u,placeholder:"Enter role name"},null,8,La),[[X,l.role]])]),t("td",null,[t("div",Va,[_(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":u=>l.autoApproval=u},null,8,Ra),[[K,l.autoApproval]]),t("label",$a,v(l.autoApproval?"Yes":"No"),1)])]),t("td",null,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:u=>xl()},e[116]||(e[116]=[t("i",{class:"bi bi-gear"},null,-1),d(" Configure ")]),8,Ma)]),t("td",null,[t("button",{class:"btn btn-sm btn-danger",onClick:u=>kl(o)},e[117]||(e[117]=[t("i",{class:"bi bi-trash"},null,-1)]),8,Ea)])]))),128))])])])):m("",!0)])])):m("",!0),Z.value==="existing"&&G.value&&ue.value.length>0?(i(),n("div",Ba,[e[126]||(e[126]=t("div",{class:"card-header bg-success text-white"},[t("h6",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-check-circle me-2"}),d("Loaded Requestors")])],-1)),t("div",Ia,[t("div",Na,[e[121]||(e[121]=t("i",{class:"bi bi-check-circle me-1"},null,-1)),t("strong",null,v(ue.value.length),1),e[122]||(e[122]=d(" requestor role(s) loaded from ")),t("strong",null,v(G.value.display_name),1)]),t("div",Oa,[t("table",Ta,[e[124]||(e[124]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Role"),t("th",null,"Auto Approval"),t("th",null,"Columns Allowed")])],-1)),t("tbody",null,[(i(!0),n(U,null,P(ue.value,(l,o)=>(i(),n("tr",{key:o},[t("td",null,[t("strong",null,v(l.requestor),1)]),t("td",null,[l.auto_approval?(i(),n("span",Ua,e[123]||(e[123]=[t("i",{class:"bi bi-check-circle me-1"},null,-1),d("Yes ")]))):(i(),n("span",Pa,"No"))]),t("td",null,[t("small",za,v(l.columns_allowed||"All fields"),1)])]))),128))])])]),e[125]||(e[125]=t("div",{class:"alert alert-info mt-3"},[t("i",{class:"bi bi-info-circle me-1"}),d(" Go to "),t("strong",null,"Step 2"),d(" and click "),t("strong",null,'"Add Requestors"'),d(" to select specific designations for these roles ")],-1))])])):m("",!0),Z.value==="existing"&&G.value&&oe.value.length>0?(i(),n("div",Wa,[e[135]||(e[135]=t("div",{class:"card-header bg-primary text-white"},[t("h6",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-diagram-3 me-2"}),d("Loaded Approval Workflow")])],-1)),t("div",Ha,[t("div",Ya,[e[127]||(e[127]=t("i",{class:"bi bi-check-circle me-1"},null,-1)),t("strong",null,v(oe.value.length),1),e[128]||(e[128]=d(" approval level(s) loaded from ")),t("strong",null,v(G.value.display_name),1)]),t("div",Ja,[t("table",ja,[e[133]||(e[133]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{width:"10%"},"Level"),t("th",{width:"25%"},"Role"),t("th",{width:"15%"},"Mandatory"),t("th",{width:"20%"},"Approval Type"),t("th",{width:"30%"},"Columns Allowed")])],-1)),t("tbody",null,[(i(!0),n(U,null,P(oe.value,(l,o)=>(i(),n("tr",{key:o},[t("td",null,[t("span",Ga,"Level "+v(l.level),1)]),t("td",null,[t("strong",null,v(l.role),1)]),t("td",null,[l.mandatory?(i(),n("span",Za,e[129]||(e[129]=[t("i",{class:"bi bi-exclamation-circle me-1"},null,-1),d("Required ")]))):(i(),n("span",Qa,"Optional"))]),t("td",null,[l.view_only_reportee?(i(),n("span",Ka,e[130]||(e[130]=[t("i",{class:"bi bi-person me-1"},null,-1),d("Reporting Manager ")]))):l.all_approvals_required?(i(),n("span",Xa,e[131]||(e[131]=[t("i",{class:"bi bi-people me-1"},null,-1),d("All Users ")]))):l.requester_as_a_approver?(i(),n("span",ei,e[132]||(e[132]=[t("i",{class:"bi bi-person-check me-1"},null,-1),d("Requestor ")]))):(i(),n("span",ti," Any One "))]),t("td",null,[t("small",li,v(l.columns_allowed||"All fields"),1)])]))),128))])])]),e[134]||(e[134]=t("div",{class:"alert alert-info mt-3"},[t("i",{class:"bi bi-info-circle me-1"}),d(" Go to "),t("strong",null,"Step 2"),d(" and click "),t("strong",null,'"Add Approvers"'),d(" for each level to select specific designations ")],-1))])])):m("",!0),e[136]||(e[136]=Bl('<div class="card mt-4" data-v-1dbf8a1a><div class="card-header bg-light" data-v-1dbf8a1a><h6 class="mb-0 fw-bold" data-v-1dbf8a1a><i class="bi bi-shield-check me-2" data-v-1dbf8a1a></i>System Generated Fields</h6></div><div class="card-body" data-v-1dbf8a1a><div class="alert alert-secondary mb-3" data-v-1dbf8a1a><i class="bi bi-info-circle me-2" data-v-1dbf8a1a></i> These fields are automatically included for all requestors. </div><div class="row g-3" data-v-1dbf8a1a><div class="col-md-6" data-v-1dbf8a1a><div class="field-preview-card" data-v-1dbf8a1a><label class="form-label fw-bold" data-v-1dbf8a1a>Requestor Name</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-1dbf8a1a></div></div><div class="col-md-6" data-v-1dbf8a1a><div class="field-preview-card" data-v-1dbf8a1a><label class="form-label fw-bold" data-v-1dbf8a1a>Requestor Email</label><input type="email" class="form-control" value="Auto-populated from user profile" disabled data-v-1dbf8a1a></div></div><div class="col-md-6" data-v-1dbf8a1a><div class="field-preview-card" data-v-1dbf8a1a><label class="form-label fw-bold" data-v-1dbf8a1a>Request Date</label><input type="text" class="form-control" value="Auto-populated on submission" disabled data-v-1dbf8a1a></div></div><div class="col-md-6" data-v-1dbf8a1a><div class="field-preview-card" data-v-1dbf8a1a><label class="form-label fw-bold" data-v-1dbf8a1a>Department</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-1dbf8a1a></div></div></div></div></div>',1))])])):m("",!0),x.value===4?(i(),n("div",si,[e[137]||(e[137]=t("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[t("div",null,[t("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),t("div")],-1)),L(yt,{blockArr:Ve.value},null,8,["blockArr"])])):m("",!0)])])])])])])]),t("div",oi,[t("div",ai,[t("div",ii,[e[141]||(e[141]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ni,[e[139]||(e[139]=t("label",{for:""},"Form Name",-1)),_(t("input",{"onUpdate:modelValue":e[38]||(e[38]=l=>Ae.value=l),multiple:!1,placeholder:S(b).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,ri),[[X,Ae.value]]),t("div",di,[t("div",ui,[_(t("input",{class:"font-12","onUpdate:modelValue":e[39]||(e[39]=l=>ce.value=l),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[K,ce.value]])]),e[138]||(e[138]=t("div",null,[t("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),t("div",{class:"modal-footer"},[e[140]||(e[140]=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),t("button",{type:"button",class:"btn btn-dark",onClick:ul},"Add Print Format")])])])]),t("div",ci,[t("div",pi,[t("div",mi,[e[142]||(e[142]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"formViewModalLabel"},"Form Preview"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",fi,[L(yt,{blockArr:Ve.value},null,8,["blockArr"])]),e[143]||(e[143]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])]),t("div",vi,[t("div",bi,[t("span",gi,v(C.value==0?"Add Requestors":`Approval Settings - Level ${C.value}`),1),e[144]||(e[144]=t("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),t("div",_i,[t("div",yi,[C.value!==0?(i(),n("div",hi,[e[146]||(e[146]=t("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),_(t("select",{"onUpdate:modelValue":e[40]||(e[40]=l=>ye.value=l),class:"form-select shadow-none font-12"},e[145]||(e[145]=[t("option",{value:""},"Any one of the selected approvers",-1),t("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),t("option",{value:"all_approvals_required"},"All of the selected approvers",-1),t("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[Je,ye.value]])])):m("",!0),t("div",wi,[t("div",ki,[t("span",xi," Select "+v(C.value===0?"Requestors":"Approvers"),1),t("span",Si,v(A.value.length)+" Selected ",1)]),ee.value.length?(i(),n("div",Fi,[t("div",Ci,[t("div",Di,[t("input",{type:"checkbox",id:"selectAll",checked:tl.value,onChange:ll,class:"form-check-input me-2 designationCheckBox"},null,40,qi),t("label",Ai," Select all designation ("+v(_e.value.length)+") ",1)]),C.value!==0?(i(),n("div",Li,[_(t("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":e[41]||(e[41]=l=>ge.value=l),class:"form-check-input me-2 designationCheckBox"},null,512),[[K,ge.value]]),e[147]||(e[147]=t("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):m("",!0),t("div",null,[A.value.length?(i(),n("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:sl},e[148]||(e[148]=[t("i",{class:"bi bi-x"},null,-1),d(" Clear all ")]))):m("",!0)])]),ee.value.length?(i(),Il(S(Nl),{key:0,multiple:!0,modelValue:A.value,"onUpdate:modelValue":e[42]||(e[42]=l=>A.value=l),options:_e.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):m("",!0)],512)):(i(),n("div",Vi,e[149]||(e[149]=[t("div",{class:"d-flex justify-content-center"},[t("span",null,"No Designations Found")],-1)])))]),C.value!==0?(i(),n("div",Ri,[e[150]||(e[150]=t("div",null,[t("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),_(t("select",{"onUpdate:modelValue":e[43]||(e[43]=l=>Se.value=l),class:"form-select shadow-none font-12 mt-1 me-2"},[(i(!0),n(U,null,P(Rt.value,l=>(i(),n("option",{key:l,value:l},v(l===0?"Requestor":"Approver Level "+l),9,$i))),128))],512),[[Je,Se.value,void 0,{number:!0}]])])):m("",!0),C.value!==0?(i(),n("div",Mi,[t("div",Ei,[t("div",Bi,[_(t("input",{"onUpdate:modelValue":e[44]||(e[44]=l=>Ee.value=l),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[K,Ee.value]]),e[151]||(e[151]=t("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),Ie.value===!0?(i(),n("div",Ii,[_(t("input",{"onUpdate:modelValue":e[45]||(e[45]=l=>Be.value=l),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[K,Be.value]]),e[152]||(e[152]=t("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):m("",!0)])])):m("",!0)]),t("div",Ni,[t("div",Oi,[L(Ol,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:ol,name:C.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},zi=Al(Ti,[["__scopeId","data-v-1dbf8a1a"]]);export{zi as default};
