var Cs=Object.defineProperty,Ds=Object.defineProperties;var Fs=Object.getOwnPropertyDescriptors;var rt=Object.getOwnPropertySymbols;var Yt=Object.prototype.hasOwnProperty,Gt=Object.prototype.propertyIsEnumerable;var Jt=(f,F,y)=>F in f?Cs(f,F,{enumerable:!0,configurable:!0,writable:!0,value:y}):f[F]=y,ne=(f,F)=>{for(var y in F||(F={}))Yt.call(F,y)&&Jt(f,y,F[y]);if(rt)for(var y of rt(F))Gt.call(F,y)&&Jt(f,y,F[y]);return f},_e=(f,F)=>Ds(f,Fs(F));var wt=(f,F)=>{var y={};for(var D in f)Yt.call(f,D)&&F.indexOf(D)<0&&(y[D]=f[D]);if(f!=null&&rt)for(var D of rt(f))F.indexOf(D)<0&&Gt.call(f,D)&&(y[D]=f[D]);return y};var dt=(f,F,y)=>new Promise((D,T)=>{var L=V=>{try{h(y.next(V))}catch(Z){T(Z)}},G=V=>{try{h(y.throw(V))}catch(Z){T(Z)}},h=V=>V.done?D(V.value):Promise.resolve(V.value).then(L,G);h((y=y.apply(f,F)).next())});import{_ as Be,r as _,x as Y,o as a,c as i,d as l,n as A,t as g,l as m,W as ct,X as de,b as ae,Q as Ct,i as S,F as O,h as B,Z as Oe,v as Me,T as $s,m as P,g as Ss,f as Qt,a6 as qs,u as Ts,M as As,e as ue,E as Ls,w as Se,a7 as Zt,K as me,y as le,z as se,L as E,a8 as Es,S as Kt,O as We,B as Vs,R as Qe,N as Re,j as J,k as Ue,a9 as Rs,aa as Us,U as ve,H as be,ab as kt,a2 as Ms,ac as Wt,ad as Os,D as Bs}from"./index-IlmQZByV.js";const Ps="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",zs=["draggable","aria-label","onKeydown"],Ns={class:"field-card-icon"},Hs={class:"field-card-content"},js={class:"field-card-title"},Js={class:"field-card-description"},Ys={key:0,class:"field-card-drag-preview"},Gs={__name:"FieldCard",props:{field:{type:Object,required:!0},disabled:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["dragstart","dragend","click","add"],setup(f,{emit:F}){const y=f,D=F,T=_(!1),L=_(!1),G=Y(()=>({"field-card--dragging":T.value,"field-card--disabled":y.disabled,"field-card--compact":y.compact,"field-card--hovered":L.value})),h=q=>{if(y.disabled)return;T.value=!0,q.dataTransfer.effectAllowed="copy",q.dataTransfer.setData("application/json",JSON.stringify({fieldType:y.field.id,fieldData:y.field}));const K=q.currentTarget.cloneNode(!0);K.style.opacity="0.8",K.style.transform="rotate(-2deg)",document.body.appendChild(K),q.dataTransfer.setDragImage(K,75,20),setTimeout(()=>{document.body.removeChild(K)},0),D("dragstart",{fieldType:y.field.id,fieldData:y.field,event:q})},V=q=>{T.value=!1,D("dragend",q)},Z=()=>{y.disabled||(D("click",y.field),D("add",y.field))};return(q,K)=>(a(),i("div",{class:A(["field-card",G.value]),draggable:!f.disabled,onDragstart:h,onDragend:V,onClick:Z,role:"button",tabindex:"0","aria-label":`Add ${f.field.name} field`,onKeydown:[ct(Z,["enter"]),ct(de(Z,["prevent"]),["space"])]},[l("div",Ns,[l("i",{class:A(f.field.icon)},null,2)]),l("div",Hs,[l("h4",js,g(f.field.name),1),l("p",Js,g(f.field.description),1)]),K[0]||(K[0]=l("div",{class:"field-card-actions"},[l("i",{class:"bi bi-plus-circle"})],-1)),T.value?(a(),i("div",Ys,[l("i",{class:A(f.field.icon)},null,2),l("span",null,g(f.field.name),1)])):m("",!0)],42,zs))}},Xt=Be(Gs,[["__scopeId","data-v-871ee6f1"]]),Zs=["aria-expanded","aria-controls","onKeydown"],Ks={class:"field-category-title"},Ws={class:"field-category-name"},Qs={class:"field-category-count"},Xs=["id"],xs={key:0,class:"field-category-description"},Is={class:"field-category-fields"},eo={key:1,class:"field-category-empty"},to={__name:"FieldCategory",props:{category:{type:Object,required:!0},fields:{type:Array,default:()=>[]},initiallyCollapsed:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["field-dragstart","field-dragend","field-click","field-add","toggle"],setup(f,{emit:F}){const y=f,D=F,T=_(y.initiallyCollapsed||y.category.collapsed||!1),L=()=>{T.value=!T.value,D("toggle",{categoryId:y.category.id,isCollapsed:T.value})},G=q=>{D("field-dragstart",_e(ne({},q),{categoryId:y.category.id}))},h=q=>{D("field-dragend",q)},V=q=>{D("field-click",{field:q,categoryId:y.category.id})},Z=q=>{D("field-add",{field:q,categoryId:y.category.id})};return(q,K)=>(a(),i("div",{class:A(["field-category",{"field-category--collapsed":T.value}])},[l("div",{class:"field-category-header",onClick:L,role:"button",tabindex:"0","aria-expanded":!T.value,"aria-controls":`category-${f.category.id}`,onKeydown:[ct(L,["enter"]),ct(de(L,["prevent"]),["space"])]},[l("div",Ks,[l("i",{class:A([f.category.icon,"field-category-icon"])},null,2),l("h3",Ws,g(f.category.name),1),l("span",Qs,"("+g(f.fields.length)+")",1)]),l("i",{class:A(["bi bi-chevron-down field-category-chevron",{"field-category-chevron--collapsed":T.value}])},null,2)],40,Zs),ae($s,{name:"category-expand"},{default:Ct(()=>[S(l("div",{id:`category-${f.category.id}`,class:"field-category-content"},[f.category.description?(a(),i("p",xs,g(f.category.description),1)):m("",!0),l("div",Is,[(a(!0),i(O,null,B(f.fields,x=>(a(),Oe(Xt,{key:x.id,field:x,compact:f.compact,onDragstart:G,onDragend:h,onClick:V,onAdd:Z},null,8,["field","compact"]))),128))]),f.fields.length===0?(a(),i("div",eo,K[0]||(K[0]=[l("i",{class:"bi bi-inbox"},null,-1),l("p",null,"No fields in this category",-1)]))):m("",!0)],8,Xs),[[Me,!T.value]])]),_:1})],2))}},lo=Be(to,[["__scopeId","data-v-8c30728f"]]),so=["for"],oo={key:0,class:"text-input-required"},ao={class:"text-input-container"},io={key:0,class:"text-input-icon text-input-icon--left"},no=["id","type","value","placeholder","disabled","readonly","required","maxlength","minlength","aria-describedby","aria-invalid"],ro={key:1,class:"text-input-icon text-input-icon--right"},co=["aria-label"],uo={key:1,class:"text-input-hint"},po=["id"],fo=["id"],mo={__name:"TextInput",props:{modelValue:{type:[String,Number],default:""},label:{type:String,default:""},type:{type:String,default:"text",validator:f=>["text","email","password","url","tel","number","search"].includes(f)},placeholder:{type:String,default:""},helpText:{type:String,default:""},errorMessage:{type:String,default:""},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},iconLeft:{type:String,default:""},iconRight:{type:String,default:""},size:{type:String,default:"md",validator:f=>["sm","md","lg"].includes(f)},maxLength:{type:Number,default:null},minLength:{type:Number,default:null}},emits:["update:modelValue","blur","focus","clear"],setup(f,{emit:F}){const y=f,D=F,T=Y(()=>`text-input-${Math.random().toString(36).substr(2,9)}`),L=_(!1),G=Y(()=>!!y.errorMessage),h=Y(()=>[`text-input-wrapper--${y.size}`,{"text-input-wrapper--disabled":y.disabled,"text-input-wrapper--readonly":y.readonly,"text-input-wrapper--error":G.value,"text-input-wrapper--focused":L.value}]),V=Y(()=>[`text-input--${y.size}`,{"text-input--with-icon-left":y.iconLeft,"text-input--with-icon-right":y.iconRight||y.clearable,"text-input--error":G.value}]),Z=N=>{D("update:modelValue",N.target.value)},q=N=>{L.value=!1,D("blur",N)},K=N=>{L.value=!0,D("focus",N)},x=()=>{D("update:modelValue",""),D("clear")};return(N,z)=>(a(),i("div",{class:A(["text-input-wrapper",h.value])},[f.label?(a(),i("label",{key:0,for:T.value,class:"text-input-label"},[P(g(f.label)+" ",1),f.required?(a(),i("span",oo,"*")):m("",!0)],8,so)):m("",!0),l("div",ao,[f.iconLeft?(a(),i("span",io,[l("i",{class:A(f.iconLeft)},null,2)])):m("",!0),l("input",{id:T.value,type:f.type,value:f.modelValue,placeholder:f.placeholder,disabled:f.disabled,readonly:f.readonly,required:f.required,maxlength:f.maxLength,minlength:f.minLength,class:A([V.value,"text-input"]),onInput:Z,onBlur:q,onFocus:K,"aria-describedby":f.helpText?`${T.value}-help`:void 0,"aria-invalid":G.value},null,42,no),f.iconRight||f.clearable?(a(),i("span",ro,[f.clearable&&f.modelValue&&!f.disabled?(a(),i("i",{key:0,class:"bi bi-x-circle text-input-clear",onClick:x,role:"button",tabindex:"0","aria-label":`Clear ${f.label||"input"}`},null,8,co)):f.iconRight?(a(),i("i",{key:1,class:A(f.iconRight)},null,2)):m("",!0)])):m("",!0)]),f.helpText||f.errorMessage?(a(),i("div",uo,[!G.value&&f.helpText?(a(),i("p",{key:0,id:`${T.value}-help`,class:"text-input-help"},g(f.helpText),9,po)):m("",!0),G.value&&f.errorMessage?(a(),i("p",{key:1,id:`${T.value}-error`,class:"text-input-error"},[z[0]||(z[0]=l("i",{class:"bi bi-exclamation-circle"},null,-1)),P(" "+g(f.errorMessage),1)],8,fo)):m("",!0)])):m("",!0)],2))}},vo=Be(mo,[["__scopeId","data-v-5d216934"]]),ho=["type","disabled","aria-label"],bo={__name:"IconButton",props:{type:{type:String,default:"button"},icon:{type:String,required:!0},variant:{type:String,default:"ghost",validator:f=>["solid","outline","ghost"].includes(f)},size:{type:String,default:"md",validator:f=>["sm","md","lg"].includes(f)},color:{type:String,default:"default",validator:f=>["default","primary","success","warning","error"].includes(f)},disabled:{type:Boolean,default:!1},ariaLabel:{type:String,required:!0},tooltip:{type:String,default:""}},emits:["click"],setup(f,{emit:F}){const y=f,D=F,T=Y(()=>[`icon-button--${y.variant}`,`icon-button--${y.size}`,`icon-button--${y.color}`,{"icon-button--disabled":y.disabled}]),L=G=>{y.disabled||D("click",G)};return(G,h)=>{const V=Ss("tooltip");return S((a(),i("button",{type:f.type,disabled:f.disabled,class:A([T.value,"icon-button"]),"aria-label":f.ariaLabel,onClick:L},[l("i",{class:A(f.icon)},null,2)],10,ho)),[[V,f.tooltip]])}}},go=Be(bo,[["__scopeId","data-v-b3b47a56"]]),yo=[{id:"basic",name:"Basic Fields",icon:"bi bi-input-cursor-text",collapsed:!1,description:"Essential form fields for text and numbers"},{id:"choice",name:"Choice Fields",icon:"bi bi-ui-checks",collapsed:!1,description:"Fields for selections and options"},{id:"datetime",name:"Date & Time",icon:"bi bi-calendar3",collapsed:!1,description:"Date, time, and datetime pickers"},{id:"file",name:"File & Media",icon:"bi bi-file-earmark-arrow-up",collapsed:!1,description:"Upload files, images, and signatures"},{id:"layout",name:"Layout Elements",icon:"bi bi-layout-text-sidebar",collapsed:!1,description:"Structure and organize your form"},{id:"advanced",name:"Advanced Fields",icon:"bi bi-gear",collapsed:!0,description:"Special purpose and computed fields"}],Xe={text:{id:"text",category:"basic",name:"Text Input",icon:"bi bi-input-cursor-text",description:"Single line text input",frappe_fieldtype:"Data",defaultProps:{label:"Text Field",placeholder:"Enter text...",required:!1,maxLength:255,width:"100%"},validation:{supportedRules:["required","minLength","maxLength","pattern"]}},textarea:{id:"textarea",category:"basic",name:"Textarea",icon:"bi bi-textarea-t",description:"Multi-line text input",frappe_fieldtype:"Text",defaultProps:{label:"Text Area",placeholder:"Enter text...",rows:4,required:!1,maxLength:5e3,width:"100%"},validation:{supportedRules:["required","minLength","maxLength"]}},number:{id:"number",category:"basic",name:"Number",icon:"bi bi-hash",description:"Numeric input field",frappe_fieldtype:"Int",defaultProps:{label:"Number Field",placeholder:"0",required:!1,min:null,max:null,step:1,width:"100%"},validation:{supportedRules:["required","min","max"]}},email:{id:"email",category:"basic",name:"Email",icon:"bi bi-envelope",description:"Email address input",frappe_fieldtype:"Data",defaultProps:{label:"Email Address",placeholder:"email@example.com",required:!1,width:"100%"},validation:{supportedRules:["required","email"]}},phone:{id:"phone",category:"basic",name:"Phone",icon:"bi bi-telephone",description:"Phone number input",frappe_fieldtype:"Data",defaultProps:{label:"Phone Number",placeholder:"+1 (555) 000-0000",required:!1,width:"100%"},validation:{supportedRules:["required","phone"]}},url:{id:"url",category:"basic",name:"URL",icon:"bi bi-link-45deg",description:"Website URL input",frappe_fieldtype:"Data",defaultProps:{label:"Website URL",placeholder:"https://example.com",required:!1,width:"100%"},validation:{supportedRules:["required","url"]}},select:{id:"select",category:"choice",name:"Select Dropdown",icon:"bi bi-chevron-down",description:"Single selection dropdown",frappe_fieldtype:"Select",defaultProps:{label:"Select Field",placeholder:"Choose an option...",required:!1,options:["Option 1","Option 2","Option 3"],width:"100%"},validation:{supportedRules:["required"]}},multiselect:{id:"multiselect",category:"choice",name:"Multi Select",icon:"bi bi-ui-checks-grid",description:"Multiple selection dropdown",frappe_fieldtype:"MultiSelect",defaultProps:{label:"Multi Select Field",placeholder:"Choose options...",required:!1,options:["Option 1","Option 2","Option 3"],width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},radio:{id:"radio",category:"choice",name:"Radio Buttons",icon:"bi bi-record-circle",description:"Single choice radio buttons",frappe_fieldtype:"Select",defaultProps:{label:"Radio Field",required:!1,options:["Option 1","Option 2","Option 3"],layout:"vertical",width:"100%"},validation:{supportedRules:["required"]}},checkbox:{id:"checkbox",category:"choice",name:"Checkboxes",icon:"bi bi-check-square",description:"Multiple choice checkboxes",frappe_fieldtype:"MultiSelect",defaultProps:{label:"Checkbox Field",required:!1,options:["Option 1","Option 2","Option 3"],layout:"vertical",width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},toggle:{id:"toggle",category:"choice",name:"Toggle Switch",icon:"bi bi-toggle-on",description:"On/off switch",frappe_fieldtype:"Check",defaultProps:{label:"Toggle Field",required:!1,default:!1,width:"100%"},validation:{supportedRules:["required"]}},date:{id:"date",category:"datetime",name:"Date Picker",icon:"bi bi-calendar-date",description:"Date selection",frappe_fieldtype:"Date",defaultProps:{label:"Date Field",placeholder:"Select date...",required:!1,format:"YYYY-MM-DD",width:"100%"},validation:{supportedRules:["required","minDate","maxDate"]}},time:{id:"time",category:"datetime",name:"Time Picker",icon:"bi bi-clock",description:"Time selection",frappe_fieldtype:"Time",defaultProps:{label:"Time Field",placeholder:"Select time...",required:!1,format:"HH:mm:ss",width:"100%"},validation:{supportedRules:["required"]}},datetime:{id:"datetime",category:"datetime",name:"DateTime Picker",icon:"bi bi-calendar3",description:"Date and time selection",frappe_fieldtype:"Datetime",defaultProps:{label:"DateTime Field",placeholder:"Select date and time...",required:!1,format:"YYYY-MM-DD HH:mm:ss",width:"100%"},validation:{supportedRules:["required","minDate","maxDate"]}},fileupload:{id:"fileupload",category:"file",name:"File Upload",icon:"bi bi-file-earmark-arrow-up",description:"Upload files",frappe_fieldtype:"Attach",defaultProps:{label:"File Upload",required:!1,acceptedTypes:["pdf","doc","docx","xls","xlsx","txt"],maxSize:10485760,multiple:!1,width:"100%"},validation:{supportedRules:["required","fileType","fileSize"]}},imageupload:{id:"imageupload",category:"file",name:"Image Upload",icon:"bi bi-image",description:"Upload images",frappe_fieldtype:"Attach Image",defaultProps:{label:"Image Upload",required:!1,acceptedTypes:["jpg","jpeg","png","gif"],maxSize:5242880,multiple:!1,width:"100%"},validation:{supportedRules:["required","fileType","fileSize","imageDimensions"]}},signature:{id:"signature",category:"file",name:"Signature Pad",icon:"bi bi-pen",description:"Digital signature capture",frappe_fieldtype:"Signature",defaultProps:{label:"Signature",required:!1,width:"100%",height:200},validation:{supportedRules:["required"]}},sectionbreak:{id:"sectionbreak",category:"layout",name:"Section Break",icon:"bi bi-layout-split",description:"Divide form into sections",frappe_fieldtype:"Section Break",defaultProps:{label:"Section Break",collapsible:!1,collapsed:!1,width:"100%"},validation:{supportedRules:[]}},columnbreak:{id:"columnbreak",category:"layout",name:"Column Break",icon:"bi bi-layout-three-columns",description:"Create columns",frappe_fieldtype:"Column Break",defaultProps:{width:"50%"},validation:{supportedRules:[]}},heading:{id:"heading",category:"layout",name:"Heading",icon:"bi bi-type-h1",description:"Add heading text",frappe_fieldtype:"HTML",defaultProps:{label:"Heading Text",level:2,text:"Heading",width:"100%"},validation:{supportedRules:[]}},paragraph:{id:"paragraph",category:"layout",name:"Paragraph",icon:"bi bi-paragraph",description:"Add description text",frappe_fieldtype:"HTML",defaultProps:{label:"Paragraph Text",text:"Your text here...",width:"100%"},validation:{supportedRules:[]}},divider:{id:"divider",category:"layout",name:"Divider",icon:"bi bi-dash-lg",description:"Horizontal divider line",frappe_fieldtype:"HTML",defaultProps:{width:"100%"},validation:{supportedRules:[]}},table:{id:"table",category:"advanced",name:"Table/Grid",icon:"bi bi-table",description:"Child table for multiple rows",frappe_fieldtype:"Table",defaultProps:{label:"Table Field",required:!1,columns:[],width:"100%"},validation:{supportedRules:["required","minRows","maxRows"]}},link:{id:"link",category:"advanced",name:"Link Field",icon:"bi bi-box-arrow-up-right",description:"Link to another DocType",frappe_fieldtype:"Link",defaultProps:{label:"Link Field",placeholder:"Select...",required:!1,doctype:"",width:"100%"},validation:{supportedRules:["required"]}},dynamiclist:{id:"dynamiclist",category:"advanced",name:"Dynamic List",icon:"bi bi-list-ul",description:"Repeatable list of items",frappe_fieldtype:"Dynamic Link",defaultProps:{label:"Dynamic List",required:!1,minItems:1,maxItems:null,width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},formula:{id:"formula",category:"advanced",name:"Formula Field",icon:"bi bi-calculator",description:"Calculated field",frappe_fieldtype:"Data",defaultProps:{label:"Formula Field",formula:"",readonly:!0,width:"100%"},validation:{supportedRules:[]}},qrcode:{id:"qrcode",category:"advanced",name:"QR Code",icon:"bi bi-qr-code",description:"Generate QR code",frappe_fieldtype:"Barcode",defaultProps:{label:"QR Code Field",data:"",size:200,width:"100%"},validation:{supportedRules:[]}}};function _o(f){return Object.values(Xe).filter(F=>F.category===f)}function wo(f){const F=f.toLowerCase();return Object.values(Xe).filter(y=>y.name.toLowerCase().includes(F)||y.description.toLowerCase().includes(F))}const ko={class:"field-library-header"},Co={class:"field-library-content"},Do={class:"field-library-search"},Fo={key:0,class:"field-library-results"},$o={key:0},So={key:1,class:"field-library-no-results"},qo={key:1,class:"field-library-search-results"},To={key:2,class:"field-library-categories"},Ao={key:0,class:"field-library-collapsed-indicator"},Lo={__name:"FieldLibraryPanel",props:{collapsible:{type:Boolean,default:!0},initiallyCollapsed:{type:Boolean,default:!1},compactMode:{type:Boolean,default:!1},hiddenCategories:{type:Array,default:()=>[]},hiddenFields:{type:Array,default:()=>[]}},emits:["field-dragstart","field-dragend","field-click","field-add","collapse","expand"],setup(f,{emit:F}){const y=f,D=F,T=_(""),L=_(y.initiallyCollapsed),G=_({}),h=Y(()=>yo.filter(U=>!y.hiddenCategories.includes(U.id))),V=Y(()=>T.value?wo(T.value).filter(j=>!y.hiddenFields.includes(j.id)):[]);function Z(U){return _o(U).filter(ce=>!y.hiddenFields.includes(ce.id))}function q(){L.value=!L.value,D(L.value?"collapse":"expand")}function K(U){}function x(U){D("field-dragstart",U)}function N(U){D("field-dragend",U)}function z(U){D("field-click",U)}function I(U){D("field-add",U)}function we(U){G.value[U.categoryId]=U.isCollapsed}function he(U){if((U.ctrlKey||U.metaKey)&&U.key==="k"){U.preventDefault();const j=document.querySelector(".field-library-search input");j&&j.focus()}}return Qt(()=>{document.addEventListener("keydown",he)}),qs(()=>{document.removeEventListener("keydown",he)}),(U,j)=>(a(),i("div",{class:A(["field-library-panel",{"field-library-panel--collapsed":L.value}])},[l("div",ko,[j[1]||(j[1]=l("div",{class:"field-library-title"},[l("i",{class:"bi bi-grid-3x3-gap"}),l("h2",null,"Add Fields")],-1)),f.collapsible?(a(),Oe(go,{key:0,icon:L.value?"bi bi-chevron-right":"bi bi-chevron-left",variant:"ghost",size:"sm","aria-label":"Toggle field library",onClick:q},null,8,["icon"])):m("",!0)]),S(l("div",Co,[l("div",Do,[ae(vo,{modelValue:T.value,"onUpdate:modelValue":[j[0]||(j[0]=ce=>T.value=ce),K],type:"search",placeholder:"Search fields...","icon-left":"bi bi-search",clearable:!0,size:"sm"},null,8,["modelValue"])]),T.value?(a(),i("div",Fo,[V.value.length>0?(a(),i("p",$o,g(V.value.length)+" field"+g(V.value.length!==1?"s":"")+" found ",1)):(a(),i("p",So,[j[2]||(j[2]=l("i",{class:"bi bi-search"},null,-1)),P(' No fields found matching "'+g(T.value)+'" ',1)]))])):m("",!0),T.value&&V.value.length>0?(a(),i("div",qo,[(a(!0),i(O,null,B(V.value,ce=>(a(),Oe(Xt,{key:ce.id,field:ce,compact:f.compactMode,onDragstart:x,onDragend:N,onClick:z,onAdd:I},null,8,["field","compact"]))),128))])):(a(),i("div",To,[(a(!0),i(O,null,B(h.value,ce=>(a(),Oe(lo,{key:ce.id,category:ce,fields:Z(ce.id),compact:f.compactMode,onFieldDragstart:x,onFieldDragend:N,onFieldClick:z,onFieldAdd:I,onToggle:we},null,8,["category","fields","compact"]))),128))])),j[3]||(j[3]=l("div",{class:"field-library-help"},[l("i",{class:"bi bi-info-circle"}),l("p",null,"Drag fields to the canvas or click to add")],-1))],512),[[Me,!L.value]]),L.value?(a(),i("div",Ao,j[4]||(j[4]=[l("i",{class:"bi bi-grid-3x3-gap"},null,-1),l("span",null,"Fields",-1)]))):m("",!0)],2))}},Eo=Be(Lo,[["__scopeId","data-v-12f238c7"]]),Vo={class:""},Ro={class:""},Uo={class:"d-flex justify-content-between align-items-center CancelNdSave"},Mo={class:"d-flex align-items-center"},Oo={key:0,class:"font-16"},Bo=["disabled"],Po={class:"form-container p-0 container-fluid mt-1"},zo={class:"row"},No={class:"col-lg-2 col-md-2 col-sm-12"},Ho={class:"steps-sticky-div"},jo={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},Jo=["onClick"],Yo={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},Go={class:"step-text"},Zo={class:"font-11"},Ko={class:"font-14"},Wo={class:"col-lg-10 col-md-10 col-sm-12 formbackground-color"},Qo={class:""},Xo={class:"form-content stepsDiv"},xo={key:0},Io={class:""},ea={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},ta={class:"container-fluid aboutFields p-0"},la={class:"row"},sa={class:"col-sm-12 col-md-12 mt-lg-3 p-lg-4"},oa={class:"container-fluid"},aa={class:"row g-3"},ia={class:"col-md-6"},na={class:"position-relative"},ra={key:0,class:"font-12 position-absolute PredefinedLabel"},da={key:1,class:"text-danger ErrorMsg ms-2"},ca={class:"col-md-6"},ua={key:0,class:"text-danger ErrorMsg ms-2"},pa={class:"col-md-6"},fa={class:"col-md-6"},ma={key:0,class:"text-danger"},va={class:"col-md-6"},ha={key:0,class:"text-danger"},ba={class:"col-md-6"},ga={key:0,class:"text-danger"},ya={class:"custom-option"},_a=["checked","onChange"],wa={class:"col-md-6"},ka={class:"col-md-6"},Ca={key:0,class:"col-md-6"},Da={key:1,class:"col-md-6"},Fa={key:2,class:"col-md-6"},$a={class:"form-check d-flex align-items-center p-0 pe-3"},Sa=["disabled"],qa={key:3,class:"col-md-6"},Ta=["disabled"],Aa={key:0,class:"list-group position-absolute w-100 z-3 formslist"},La=["onMousedown"],Ea={key:1,class:"zoho-form-builder"},Va={class:"zoho-toolbar"},Ra={class:"toolbar-left"},Ua={class:"zoho-tabs"},Ma=["onClick"],Oa=["onClick"],Ba={class:"toolbar-right"},Pa={class:"zoho-builder-container"},za={class:"d-flex align-items-center justify-content-between w-100"},Na={class:"mb-0 font-14 fw-bold"},Ha={class:"btn btn-sm btn-link p-0 text-dark"},ja={key:0,class:"library-content"},Ja={class:"zoho-form-canvas"},Ya={class:"requestandAppHeader"},Ga={class:"d-flex justify-content-between align-items-center"},Za={class:""},Ka={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},Wa={class:"text-center ms-2 mt-1"},Qa={key:0,class:"font-12 d-flex align-items-center"},Xa={class:"font-12 approver_type_div"},xa={class:"font-12 fw-bold"},Ia={class:"font-12 text-danger ms-1"},ei={class:"d-flex align-items-center"},ti={key:0,class:"role-container"},li={key:0,class:"role-text d-flex align-items-center"},si={class:"role-label fw-bold"},oi={class:"role-names"},ai=["onClick"],ii=["onClick"],ni=["onClick"],ri=["onClick"],di={class:"pt-0 section_block"},ci={class:"d-flex justify-content-between align-items-center"},ui={class:"d-flex flex-column"},pi=["onUpdate:modelValue","onChange","onInput"],fi={key:0,class:"text-danger ps-3 font-10"},mi={class:"d-flex align-items-center"},vi=["onClick"],hi={class:"container-fluid"},bi={class:"d-flex justify-content-between align-items-center"},gi={class:"rownames m-0"},yi=["onClick"],_i={class:"col"},wi={class:"row"},ki=["onMouseenter"],Ci={class:"column_name d-flex align-items-center justify-content-between"},Di={class:"d-flex flex-column ps-2"},Fi=["onUpdate:modelValue","onChange","onInput"],$i={key:0,class:"text-danger ps-2 font-10"},Si={class:"position-absolute top-0 end-0"},qi=["onClick"],Ti=["onDrop"],Ai=["onMouseenter","onDragstart","onDrop"],Li=["onDrop"],Ei=["onDragstart","onDrop"],Vi={class:"d-flex justify-content-between"},Ri={class:"flex-column d-flex"},Ui=["onUpdate:modelValue","onChange","onInput"],Mi={key:0,class:"text-danger font-10"},Oi={class:"FieldcopyRemove"},Bi=["onClick"],Pi=["onClick"],zi=["onUpdate:modelValue","onChange"],Ni=["value"],Hi={key:0},ji=["onUpdate:modelValue"],Ji={key:0,class:"text-danger font-10"},Yi={key:1},Gi=["for"],Zi=["id","onUpdate:modelValue","onInput","onFocus"],Ki={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},Wi=["onClick"],Qi={class:"d-flex align-items-center justify-content-between"},Xi={class:"d-flex align-items-center gap-2"},xi={class:"d-flex align-items-center"},Ii=["onUpdate:modelValue","id"],en=["for"],tn=["onClick"],ln=["onUpdate:modelValue"],sn={key:3,class:"text-danger font-10"},on=["onDrop"],an={class:"childtableShow"},nn={class:"mt-2"},rn={key:0,class:"childTableContainer"},dn={key:0,class:"font-13"},cn={key:1,class:"d-flex align-items-center gap-2"},un={class:"d-flex align-items-center"},pn=["onUpdate:modelValue"],fn=["onClick"],mn={key:2,class:"table table-bordered rounded-table"},vn=["onDrop"],hn=["draggable","onDragstart"],bn={key:0},gn=["onUpdate:modelValue","onInput"],yn={key:0,class:"text-danger font-11"},_n={key:1},wn={key:2},kn={class:"d-flex gap-1"},Cn=["onUpdate:modelValue","onChange"],Dn=["value"],Fn={class:"d-flex"},$n={class:"d-flex align-items-center gap-2"},Sn={class:"d-flex align-items-center"},qn=["onUpdate:modelValue"],Tn=["onClick"],An={key:0},Ln=["onUpdate:modelValue","onInput"],En={key:0,class:"text-danger font-10"},Vn={key:1,class:"font-11 text-danger"},Rn={key:3},Un={key:3,class:"mb-2 mt-3"},Mn=["onClick"],On=["onClick"],Bn=["onDrop"],Pn=["onDrop"],zn={class:"d-flex justify-content-center align-items-center my-2"},Nn=["onClick"],Hn={class:"font-13"},jn={key:0,class:"d-flex align-items-center gap-2"},Jn={class:"d-flex align-items-center"},Yn=["onUpdate:modelValue"],Gn=["onClick"],Zn={class:"table table-bordered rounded-table"},Kn={key:0},Wn=["onUpdate:modelValue","onBlur"],Qn={key:0,class:"text-danger font-11 mt-1"},Xn={key:1},xn={key:2},In={class:"d-flex gap-1 align-items-center"},er=["onUpdate:modelValue","onChange"],tr=["value"],lr=["onClick"],sr={key:0,class:"mt-1"},or=["onUpdate:modelValue","onInput"],ar={key:1,class:"text-danger font-11 mt-1"},ir={key:3},nr={class:"mb-2"},rr=["onClick"],dr=["onClick"],cr=["onClick"],ur={key:0},pr={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},fr=["onUpdate:modelValue","onBlur"],mr={key:0,class:"text-danger font-12"},vr={key:1,class:"text-danger font-12"},hr={class:"d-flex align-items-center gap-2"},br={class:"d-flex align-items-center"},gr=["onUpdate:modelValue"],yr=["onClick"],_r=["onClick"],wr={class:"px-1 field-border"},kr={class:"d-flex justify-content-between"},Cr=["onUpdate:modelValue","onBlur"],Dr={key:0,class:"text-danger font-12"},Fr={class:"d-flex align-items-center"},$r={class:"d-flex my-1"},Sr=["onUpdate:modelValue"],qr=["onClick"],Tr=["onClick"],Ar=["onUpdate:modelValue"],Lr=["value"],Er={key:0},Vr=["onUpdate:modelValue"],Rr={key:0,class:"text-danger font-10"},Ur={key:1,class:"text-danger font-12"},Mr=["onClick"],Or=["onClick"],Br={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},Pr=["onClick"],zr={key:0,class:"m-2"},Nr={key:0,class:"zoho-properties-panel"},Hr={class:"properties-header"},jr={key:2},Jr={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},Yr={class:"modal-dialog modal-dialog-centered"},Gr={class:"modal-content"},Zr={class:"modal-body"},Kr=["placeholder"],Wr={class:"d-flex align-items-center gap-2"},Qr={class:"d-flex align-items-center py-2"},Xr={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},xr={class:"offcanvas-header add_designationHeader"},Ir={id:"offcanvasRightLabel",class:"font-14 fw-bold"},ed={class:"offcanvas-body add_desig_offCanvas_body p-0"},td={class:""},ld={class:""},sd={key:0,class:"p-3 approval-border-bottom"},od={key:0,class:""},ad={class:"px-3 listofdesignations"},id={class:"my-1 d-flex justify-content-between"},nd={class:"font-12 fw-bold"},rd={class:"italic-style text-secondary font-12"},dd={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},cd={class:"d-flex align-items-center justify-content-between gap-1"},ud={class:"form-check ps-1 d-flex align-items-center m-0"},pd=["checked"],fd={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},md={key:0,class:"form-check d-flex align-items-center m-0"},vd={key:1},hd={key:0,class:"p-3"},bd=["value"],gd={key:1},yd={class:""},_d={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},wd={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},kd={class:"offcanvas-footer"},Cd={class:"text-end p-3"},qe="Select All",Dd={__name:"FormStepper",setup(f){const F=Ts(),y=As(),D=_(1),T=_([]);_([]);const L=_([]),G=_([]);ue([]);let h=ue([]),V=ue([]);const Z=_([]),q=_([]),K=_([]),x=_(""),N=_(""),z=_("");let I=ue([]);const we=_("");_(!1),_(!1),_(!1);const he=_(""),U=_(""),j=_(""),ce=_([]),xt=_([]),R=ue({}),re=_([]),ut=_(!1),xe=_([]),Ie=_(!1);let Dt=null;const It=_("");let H=_("");const ke=_(null),Ft=_(null),Te=_(!0),et=_(0),Ae=Y(()=>Ls);_(!1);const tt=ue([]),ie=_({routepath:F.query.routepath,business_unit:F.query.business_unit,formId:F.query.id}),lt=_(""),Le=_(!1),Ee=_(!1),$t=[{label:"Public",value:1},{label:"Private",value:0}],St=Y({get(){return $t.find(t=>t.value===b.value.as_web_view)},set(t){b.value.as_web_view=t?t.value:null}}),qt=Y({get(){return b.value.form_name||F.query.form_name||""},set(t){b.value.form_name=t}}),b=_({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${Ae.value.value||ie.value.business_unit||F.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:F.query.id?1:0,as_web_view:0,mail_id:""});Se(()=>F.query.form_name,t=>{t&&(b.value.form_name=t,b.value.form_short_name=t)},{immediate:!0});const st=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(t=>t.toLowerCase().trim()),Tt=["Approver","Approved on","Approved By"].map(t=>t.toLowerCase().trim());function el(t){return t.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}Y(()=>b.value),_(""),_(!1),Se(Ae,t=>{t&&t.value&&(b.value.business_unit=t.value)},{immediate:!0});function tl(t){if(H==null||H==="new")return!1;const e=W(t).roles;if(t===0)return e.length===0;const s=W(t-1).roles;return s.length>0&&s[0]!==null&&s[0]!==""&&e.length===0}Se(()=>b.value.form_name,t=>{b.value.form_name=t.trim()}),Se(()=>b.value.form_short_name,t=>{b.value.form_short_name=t.trim()}),Se(()=>b.value.series,t=>{b.value.series=t.trim()});const Pe=_(null),At=(t,e,s,o,n,r)=>{Pe.value={blockIndex:e,sectionIndex:s,rowIndex:o,columnIndex:n,fieldIndex:r}},Ce=(t,e,s,o,n,r)=>{if(t.preventDefault(),t.stopPropagation(),console.log("Field dropped at index:",{targetBlock:e,targetSection:s,targetRow:o,targetColumn:n,insertIndex:r,draggedField:Pe.value,draggedFieldType:ke.value}),ke.value){console.log("Dropping from field library:",ke.value);const w=jt(ke.value);if(!w){console.error("Failed to create field from type:",ke.value);return}const $=h[e];if(!$){ve("Target block not found");return}$.sections||($.sections=[]),$.sections[s]||($.sections[s]={label:"",rows:[]}),$.sections[s].rows||($.sections[s].rows=[]),$.sections[s].rows[o]||($.sections[s].rows[o]={label:"",columns:[]}),$.sections[s].rows[o].columns||($.sections[s].rows[o].columns=[]),$.sections[s].rows[o].columns[n]||($.sections[s].rows[o].columns[n]={label:"",fields:[]}),$.sections[s].rows[o].columns[n].fields.splice(r,0,w),console.log("Field added successfully:",w),be(`${w.label} field added`),ke.value=null;return}if(!Pe.value){console.log("No dragged field found");return}const{blockIndex:d,sectionIndex:u,rowIndex:v,columnIndex:c,fieldIndex:p}=Pe.value,C=h[d].sections[u].rows[v].columns[c].fields,M=h[e].sections[s].rows[o].columns[n].fields;if(d===e&&u===s&&v===o&&c===n&&p===r)return;const k=C.splice(p,1)[0];C===M&&p<r&&r--,M.splice(r,0,k),Pe.value=null},Ve=_(""),ll=t=>dt(this,null,function*(){const e=[["module","in",["User Forms"]],["istable","=",1]];t!=null&&t.trim()&&e.push(["name","=",`${t}`]);const s={fields:JSON.stringify(["name"]),filters:JSON.stringify(e),limit_page_length:"None",doctype:me.doctypesList};try{return(yield le.get(se.GetDoctypeData,{params:s})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),ot=_(null),Lt=t=>dt(this,null,function*(){if(Ve.value="",ot.value=null,t.tableName){let e=t.tableName.trim();if(e.length>64){Ve.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(e)){Ve.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield ll(e);ot.value=o.find(n=>n.name.toLowerCase()===e.toLowerCase()),ot.value&&(Ve.value="Table already exists"),t.tableName=e}t.label&&(t.fieldname=el(t.label))});function sl(){const t=b.value.is_linked_form;if(!t){xe.value=[];return}clearTimeout(Dt),Dt=setTimeout(()=>{const e=[["business_unit","=",`${Ae.value.value}`],["name","like",`%${t}%`]],s={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(e),doctype:me.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};le.get(`${se.GetDoctypeData}`,{params:s}).then(o=>{xe.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function ol(t){b.value.is_linked_form=t,Ie.value=!1}function al(){setTimeout(()=>{Ie.value=!1},200)}ue({query:"",key:""});function ge(t,e,s,o,n){return`${t}-${e}-${s}-${o}-${n}`}ue({});const ze=ue({}),pt=ue({});function il(t){pt[t]=!0}function nl(t,e,s,o,n,r){const d=ge(e,s,o,n,r),u=[["istable","=",0]];t!=null&&t.trim()&&u.push(["name","like",`%${t}%`]);const v={fields:JSON.stringify(["name"]),filters:JSON.stringify(u),limit_page_length:"none",doctype:me.doctypesList};le.get(se.GetDoctypeData,{params:v}).then(c=>{ze[d]=c.message.data||[]}).catch(c=>{console.error("Error fetching doctype list:",c),ze[d]=[]})}function rl(t,e,s,o,n,r){h[t].sections[e].rows[s].columns[o].fields[n].options=r;const d=ge(t,e,s,o,n);ze[d]=[],pt[d]=!1}const dl=Y(()=>h!=null&&h.length?z.value===1?[0]:Array.from({length:z.value},(t,e)=>e).filter(t=>t<z.value):[]),ye=_(null),De=_(null),cl=(t,e,s,o,n)=>{ye.value={blockIndex:t,sectionIndex:e,rowIndex:s,columnIndex:o,fieldIndex:n}},ul=()=>{ye.value=null},pl=(t,e,s,o,n)=>ye.value&&ye.value.blockIndex===t&&ye.value.sectionIndex===e&&ye.value.rowIndex===s&&ye.value.columnIndex===o&&ye.value.fieldIndex===n,fl=(t,e,s,o)=>{De.value={blockIndex:t,sectionIndex:e,rowIndex:s,columnIndex:o}},ml=()=>{De.value=null},vl=(t,e,s,o)=>De.value&&De.value.blockIndex===t&&De.value.sectionIndex===e&&De.value.rowIndex===s&&De.value.columnIndex===o,Et=_([{form_json:""}]),Fe=_("");Qt(()=>{Bt(),Fe.value=F.query.Clone,H.value=F.query.id||"new",Fe.value==="1"&&(b.value.series=""),H.value!=null&&H.value!=null&&H.value!="new"&&(Ot(),bt()),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?ut.value=!0:ut.value=!1;let t=localStorage.getItem("Bu");if(b.value.business_unit=t,F.query.preId==="PreDefine"){const e=localStorage.getItem("form_json");if(e){Et.value[0].form_json=e;const s=Et.value[0],o=JSON.parse(s.form_json),n=Zt(o.fields);re.value=o.child_table_fields,n.forEach(r=>{h.push(r)})}}});const $e=_(null),ee=ue({}),Vt=_(null),hl=t=>{$e.value=t},bl=()=>{$e.value=null},gl=t=>{t.preventDefault()},yl=(t,e)=>{const s=t.target.closest("tr");if(!s)return;const o=Array.from(s.parentNode.children).indexOf(s);if(o!==$e.value){const n=e[$e.value];e.splice($e.value,1),e.splice(o,0,n),$e.value=o}},_l=_([]),ft=t=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(t.fieldtype)&&t.options){const e=t.options.split(`
`).map(n=>n.trim()).filter(n=>n),s=[],o=new Set;return e.forEach(n=>{const r=n.toLowerCase();o.has(r)||(o.add(r),s.push(n))}),`
`+s.join(`
`)}else if(["Link","Table"].includes(t.fieldtype)&&t.options)return t.options.trim();return t.options},wl=(t,e)=>{const s=h[t].sections[e];s.childTables||(s.childTables=[]);const o=s.childTables.length;s.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[ne({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},tt.fieldtype==="Select"&&tt.options?{options:tt.options?`
${tt.options}`:`
`}:{})],newTable:!0})},kl=(t,e,s)=>{const o=h[t].sections[e].childTables[s];o.columns||(o.columns=[]),o.columns.push(ne({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},Cl=(t,e,s)=>{h[t].sections[e].childTables.splice(s,1)},Dl=(t,e,s,o)=>{h[t].sections[e].childTables[s].columns.splice(o,1)};function Fl(t,e,s,o,n,r){var c;const d=`${e}-${s}-${o}`;R[d]||(R[d]={columns:[]});const u={},v=((c=t.label)==null?void 0:c.trim())||"";if(!v)u.label="Field Label is required";else{const p=v.toLowerCase();if(st.includes(p)&&!Tt.includes(p))u.label=`"${v}" is a restricted field label`;else if(v.length>64)u.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(v))u.label="Field Label can only contain letters, numbers, and single spaces between words";else{const C=r.map((M,k)=>{var w;return{label:(w=M.label)==null?void 0:w.trim().toLowerCase(),index:k}}).filter(M=>M.label===p);if(C.length>1){const M=C[0].index;n!==M&&(u.label=`"${v}" is already used in this table`)}}}R[d].columns[n]=u}function at(t,e,s){var r;R[e]||(R[e]={});const o=[],n=((r=t.label)==null?void 0:r.trim())||"";n||o.push("Label is required"),n.length>64&&o.push("Label cannot exceed 64 characters"),n&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(n)&&o.push("No special characters allowed"),n&&st.includes(n.toLowerCase().trim())&&o.push("This label is restricted"),n&&re.value[e].map(v=>{var c;return(c=v.label)==null?void 0:c.trim().toLowerCase()}).filter(Boolean).filter(v=>v===n.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),t.fieldtype||o.push("Field type is required"),t.fieldtype==="Select"&&(!t.options||t.options.trim()==="")&&o.push("Options are required"),R[e][s]=o}const $l=(t,e,s)=>{var d;const o=h[t].sections[e].childTables[s],n={tableName:!1,columns:[]};let r=!1;return(d=o.tableName)!=null&&d.trim()||(n.tableName="Table name is required.",r=!0),o.columns.forEach((u,v)=>{var p,C;const c={};(p=u.label)!=null&&p.trim()||(c.label="Field Label is required",r=!0),(C=u.fieldtype)!=null&&C.trim()||(c.fieldtype="Please select field type",r=!0),n.columns[v]=c}),R[`${t}-${e}-${s}`]=n,r},Sl=(t,e,s)=>{var n,r;const o=(r=(n=h[t])==null?void 0:n.sections)==null?void 0:r[e];o&&!Array.isArray(o[s])&&(o[s]=[])},ql=t=>t?t.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",Tl=(t,e,s)=>{if($l(t,e,s)){ve("Please fix validation errors before creating the table",{transition:"zoom"});return}if(ot.value){ve("Table already exists",{transition:"zoom"});return}const n=h[t].sections[e].childTables[s],r=h[t].sections[e];n.columns=n.columns.map((u,v)=>_e(ne({},u),{idx:v,options:ft(u)})),n.newTable=!1;const d={form_short_name:n.tableName,fields:n.columns,idx:n.idx,as_a_block:n.as_a_block?n.as_a_block:"false"};le.post(se.childtable,d).then(u=>{var v,c,p;if(u){Sl(t,e,"afterCreated"),r.afterCreated[s]=ne({},n),be("Table created successfully!");const C=(p=(c=(v=u.message)==null?void 0:v[0])==null?void 0:c[0])==null?void 0:p.child_doc;C&&(h[t].sections[e].childTables[s]=_e(ne(ne({},h[t].sections[e].childTables[s]),C),{newTable:!1}))}}).catch(u=>{console.error("Error creating table:",u)})},Ne=(t,e,s,o=[])=>{var d;ee[e]||(ee[e]=[]),ee[e]=ee[e].filter(u=>u!==s),R[e]||(R[e]=[]),R[e][s]=[];const n=[],r=((d=t.label)==null?void 0:d.trim())||"";if(r?st.includes(r.toLowerCase())?n.push("This label is restricted"):r.length>64?n.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(r)||n.push("Only letters, numbers, and single spaces allowed"):n.push("Label is required"),o.length){const u=r.toLowerCase(),v=o.map((c,p)=>{var C;return{label:(C=c.label)==null?void 0:C.trim().toLowerCase(),idx:p}}).filter(c=>c.label===u);if(v.length>1){const c=v[0].idx;s!==c?(n.push("Duplicate label not allowed"),t._duplicate=!0):t._duplicate=!1}else t._duplicate=!1}return t.fieldtype||n.push("Field type is required"),t.fieldtype==="Select"&&(!t.options||!t.options.trim())&&n.push("Options are required"),R[e][s]=n,n.length>0&&ee[e].push(s),n.length===0},Al=(t,e,s)=>{const n=h[t].sections[e].afterCreated.find(u=>u.tableName===s);if(!n)return;const r=n.columns.length,d={fieldname:"",fieldtype:"",idx:r+1,label:"",value:"",isNew:!0,description:""};n.columns.push(d),Ne(d,s,r,n.columns)},Rt=_([]),Ll=(t,e,s,o)=>{const r=h[t].sections[e].afterCreated.find(u=>u.tableName===s);if(!r)return;r.columns.splice(o,1),r.columns.forEach((u,v)=>{u.idx=v+1});const d=ee.value[s];d&&(ee.value[s]=d.filter(u=>u!==o).map(u=>u>o?u-1:u))},El=(t,e,s)=>{const n=h[t].sections[e].afterCreated.find(r=>r.tableName===s);if(n){if(Q[s]){ee[s]=[];let r=!0;if(n.columns.forEach((v,c)=>{Ne(v,s,c,n.columns)||(r=!1)}),!r){ve("Please fix the errors in the highlighted fields before saving!");return}const d=n.columns.map((C,p)=>{var M=C,{isNew:v}=M,c=wt(M,["isNew"]);return _e(ne({},c),{idx:p+1,options:ft(c)})}),u={form_short_name:ql(s),fields:d,as_a_block:n.description};le.post(se.childtable,u).then(v=>{Rt.value=v.data,be("Fields updated successfully!")}).catch(v=>{console.error("❌ Saving fields failed:",v)})}Q[s]=!Q[s]}},Q=ue({}),Vl=t=>{re.value[t]||(re.value[t]=[]);const e=re.value[t].length+1;re.value[t].push({fieldname:"",fieldtype:"",idx:e,label:"",value:"",isNew:!0,description:"",options:re.value[t].options?`
${re.value[t].options}`:""})},Rl=(t,e)=>{re.value[t]&&re.value[t].splice(e,1)},Ul=(t,e)=>{if(!t)return;ee.value||(ee.value={}),ee.value[t]||(ee.value[t]=[]);const s=re.value[t];if(s){if(Q[t]){ee.value[t]=[];let o=!0;if(s.forEach((d,u)=>{var c;at(d,t,u);const v=(c=R[t])==null?void 0:c[u];v&&v.length>0&&(ee.value[t].push(u),o=!1),d.label&&(d.label=d.label.trim())}),!o){ve("Please fix the errors before saving");return}const n=s.map((c,v)=>{var p=c,{isNew:d}=p,u=wt(p,["isNew"]);return _e(ne({},u),{idx:v+1,options:ft(u)})}),r={form_short_name:t,fields:n,as_a_block:e};le.post(se.childtable,r).then(d=>{Rt.value=d.data,be("Fields updated successfully!")}).catch(d=>{console.error("❌ Saving fields failed:",d)})}Q[t]=!Q[t],Vt.value=Q[t]?t:null}},Ml=_([{id:1,label:"About Form",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Fields & Workflow",stepno:"Step 2",icon:"bi bi-question-circle"},{id:3,label:"Print Format",stepno:"Step 3",icon:"ri-checkbox-circle-line"}]),mt=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],Ol=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],Bl=Y(()=>[qe,...L.value]),Pl=Y(()=>{const t=b.value.accessible_departments;return t.includes(qe)?"All Selected":t.length>1?`${t[0]}.. +${t.length-1} more selected`:t.join(", ")}),zl=t=>t===qe?b.value.accessible_departments.length===L.value.length:b.value.accessible_departments.includes(t),Nl=(t,e)=>{t===qe?e.target.checked?b.value.accessible_departments=[...L.value]:b.value.accessible_departments=[]:(e.target.checked?b.value.accessible_departments.push(t):b.value.accessible_departments=b.value.accessible_departments.filter(s=>s!==t),b.value.accessible_departments.length===L.value.length?b.value.accessible_departments=[...L.value]:b.value.accessible_departments=b.value.accessible_departments.filter(s=>s!==qe))},Hl=t=>{t===qe&&(b.value.accessible_departments=[...L.value])},jl=t=>{t===qe&&(b.value.accessible_departments=[])},vt=_(!1),He=Y(()=>{var e;let t=[...Z.value];if(Ee.value&&(t=t.filter(s=>s.is_hod===1)),(e=we.value)!=null&&e.trim()){const s=we.value.toLowerCase();t=t.filter(o=>o.role.toLowerCase().includes(s))}return t.sort((s,o)=>s.role.localeCompare(o.role)),t.sort((s,o)=>{const n=q.value.includes(s.role),r=q.value.includes(o.role);return n===r?0:n?1:-1}),t.map(s=>s.role)}),Jl=Y(()=>{const t=He.value;return t.length>0&&t.every(e=>q.value.includes(e))});Se([q,He],()=>{const t=He.value;vt.value=t.length>0&&t.every(e=>q.value.includes(e))},{immediate:!0,deep:!0});function Yl(t){const e=t.target.checked,s=Z.value.filter(o=>{var n;return!(Ee.value&&o.is_hod!==1||(n=we.value)!=null&&n.trim()&&!o.role.toLowerCase().includes(we.value.toLowerCase()))}).map(o=>o.role);e?q.value=Array.from(new Set([...q.value,...s])):q.value=q.value.filter(o=>!s.includes(o)),vt.value=e}function Gl(){q.value=[],vt.value=!1,Ee.value=!1}const pe=_("");function Zl(){const t=h[z.value];if(!t||!t.sections){console.error("Error: Invalid block or sections not found.");return}let e={type:z.value==0?"requestor":"approver",roles:q.value,approval_required:U.value,approver_can_edit:j.value,fields:t.sections.flatMap(kt),idx:z.value};z.value!==0&&(e.view_only_reportee=pe.value==="ViewOnlyReportee"?1:0,e.all_approvals_required=pe.value==="all_approvals_required"?1:0,e.requester_as_a_approver=pe.value==="requester_as_a_approver"?1:0,e.on_rejection=he.value?he.value:0);const s=I.findIndex(o=>o.idx===e.idx);s!==-1?I[s]=e:I.push(e),Ql()}function W(t){return I.find(e=>e.idx===t)||{roles:[]}}function Kl(t){const e=W(t),s=e.roles||[];q.value=[...s],he.value=e.on_rejection,U.value=e.approval_required,j.value=e.approver_can_edit,e.view_only_reportee===1?pe.value="ViewOnlyReportee":e.all_approvals_required===1?pe.value="all_approvals_required":e.requester_as_a_approver===1?pe.value="requester_as_a_approver":pe.value=""}const ht=t=>{Ee.value=!1,we.value="",pe.value="",he.value="",b.value.accessible_departments.length&&Wl(t,b.value.accessible_departments),z.value=t,Kl(t)};function Wl(t,e){let s={index:t,departments:e,property:b.value.business_unit};le.post(se.addDesignationroles,s).then(o=>{o.message&&(Z.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function Ql(){le.post(se.add_roles_WF,{workflow_setup:I,doctype:b.value.form_short_name,business_unit:b.value.business_unit}).then(t=>{console.log(t),z.value==0?be("Requestor Added"):be(`Approver-${z.value} Added`)})}function Xl(){y.push({path:ie.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function xl(){b.value.form_name="",b.value.form_short_name="",b.value.owner_of_the_form="",b.value.business_unit="",b.value.form_category="",b.value.accessible_departments=[]}const Il=t=>{if(nt.value){ve("Please check all required fields before proceeding.");return}t<D.value?Mt():t>D.value&&Ut()},Ut=()=>{if(nt.value){ve("Please check all required fields before proceeding.");return}D.value<3&&(D.value+=1,D.value===3&&(_t.value=h))},Mt=()=>{D.value>1&&(D.value-=1)},es=_([]);function Ot(){const t={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:me.EzyFormDefinitions,doc_id:H.value};le.get(se.GetDoctypeData,{params:t}).then(e=>{var o;let s=e==null?void 0:e.message.data;if(s){s.accessible_departments&&(s.accessible_departments=s.accessible_departments.split(",")),b.value=_e(ne(ne({},b.value),s),{owner_of_the_form:s.owner_of_the_form||b.value.owner_of_the_form||""});const n=JSON.parse((o=e.message.data)==null?void 0:o.form_json);ce.value=n.workflow,It.value=n.fields.filter(d=>d.fieldtype==="Table"),es.value=n.fields.filter(d=>d.fieldtype==="Table"),Le.value=e.message.data.is_landscape;let r=Zt(JSON.parse(s==null?void 0:s.form_json).fields);re.value=JSON.parse(e.message.data.form_json).child_table_fields,_l.value=[],xt.value=[],r.forEach((d,u)=>{h.push(d)}),JSON.parse(s==null?void 0:s.form_json).workflow.forEach((d,u)=>{I.push(d)})}}).catch(e=>{console.error("Error fetching  data:",e)})}function ts(){const t={};lt.value&&(t.print_format=lt.value),Le.value!==void 0&&Le.value!==null&&(t.is_landscape=Le.value),le.put(se.resource+me.EzyFormDefinitions+`/${F.query.id}`,t).then(e=>{console.log(e),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),be("Print Format Added Successfully")}).catch(e=>{console.error("Error fetching  data:",e)})}function Bt(){const t={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${ie.value.business_unit||F.query.business_unit}`,doctype:me.departments};le.get(se.GetDoctypeData,{params:t}).then(e=>{var s;(s=e==null?void 0:e.message.data)!=null&&s.length&&(G.value=e.message.data.map(o=>o.name),L.value=e.message.data.map(o=>o.name))}).catch(e=>{console.error("Error fetching department data:",e)})}_(""),Se(()=>b.value.owner_of_the_form,t=>{t&&bt(t)});function bt(t){t&&typeof t=="string"&&t.trim()!==""&&ls(t)}function ls(t){const e={fields:JSON.stringify(["ezy_departments_items"]),doctype:me.departments,doc_id:t};le.get(se.GetDoctypeData,{params:e}).then(s=>{var o;(o=s==null?void 0:s.message.data)!=null&&o.ezy_departments_items&&(T.value=s.message.data.ezy_departments_items.map(n=>n.category))}).catch(s=>{console.error("Error fetching categories data:",s)})}function gt(t){let e=Os(h);const s=_e(ne({},b.value),{fields:e,doctype:me.EzyFormDefinitions,workflow_setup:I,form_status:t==="save"?"Created":"Draft"});s.accessible_departments=s.accessible_departments.toString(),le.post(se.savedata,s).then(o=>{if(o&&o.message&&o.message.message){let n=localStorage.getItem("preName");if(n){let r={installed:"Yes"};le.put(`${se.resource}${me.preDefinedForm}/${n}`,r).then(d=>{localStorage.removeItem("preName")}).catch(d=>{console.error("Error fetching ezyForms data:",d)})}if(y.push({params:{paramid:o.message.message},query:{id:o.message.message}}),H.value=o.message.message,H&&H!=="new"&&(h.splice(0,h.length),Ot()),I.length<h.length)Bs("Add Workflow");else if(Pt.value===!0){be("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let r=localStorage.getItem("routepath");t==="save"?y.push({path:r}):t==="Draft"&&y.push({path:r})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const it=_(""),ss=()=>{var s,o;const t=h.length,e={label:t===0?"requestor":`approver-${t}`,parent:`${(s=Ae.value)==null?void 0:s.value}-${(o=b.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${Ae.value.value}-${b.value.form_short_name}`,childTables:[],afterCreated:{},rows:t===0?[{label:`row_0_0_${t}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${t}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${t}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};h.push(e),Ms(()=>{it.value&&it.value.scrollTo({top:it.value.scrollHeight,behavior:"smooth"})})},Pt=_(!1),zt=t=>{let e=h[t];e.parent&&V.push(e);let s=[];I.length>t&&I[t].roles&&(s=[...I[t].roles]),h.splice(t,1),I.length>t&&I.splice(t,1),h.forEach((o,n)=>{o.sections.forEach((r,d)=>{r.rows.forEach((u,v)=>{u.columns.forEach((c,p)=>{fe(n,d,v,p)})})})}),s.length&&os(s,t)};function os(t,e){const s={role:t,level:e,document_type:b.value.form_name,short_name:b.value.form_short_name,property:b.value.business_unit};le.post(se.deleteAssigneRoles,s).then(o=>{o&&gt()})}const as=(t,e)=>{const s={label:"",parent:`${Ae.value.value}-${b.value.form_short_name}`,rows:[{label:`row_0_${e}_${t}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};h[t].sections.splice(e+1,0,s)},is=(t,e)=>{let s=h[t].sections[e];s.parent&&V.push(s),h[t].sections.splice(e,1),h[t].sections.forEach((o,n)=>{o.rows.forEach((r,d)=>{r.columns.forEach((u,v)=>{fe(t,n,d,v)})})})},ns=(t,e,s)=>{h[t].sections[e].rows[s].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},rs=(t,e,s,o)=>{const r=h[t].sections[e].rows[s].columns,d=r[o];d.parent&&V.push(d),r.length===1?h[t].sections[e].rows.splice(s,1):r.splice(o,1),h[t].sections.forEach((u,v)=>{u.rows.forEach((c,p)=>{c.columns.forEach((C,M)=>{fe(t,v,p,M)})})})},ds=(t,e,s,o)=>{h[t].sections[e].rows[s].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},cs=(t,e,s,o,n)=>{let r=h[t].sections[e].rows[s].columns[o].fields[n];r.parent&&V.push(r),h[t].sections[e].rows[s].columns[o].fields.splice(n,1)},us=(t,e,s,o,n)=>{const r=h[t].sections[e].rows[s].columns[o].fields[n],d=ne({},r);d.name=`${r.name} Name the field`,h[t].sections[e].rows[s].columns[o].fields.splice(n+1,0,d)},ps=(t,e,s,o,n)=>{const r=Wt(h);h.splice(0,h.length,...r);let d=h[t].sections[e].rows[s].columns[o].fields[n].fieldtype;(d!=="Select"||d!=="radio"||d!=="multiselect")&&(h[t].sections[e].rows[s].columns[o].fields[n].options="")};function fs(t){return st.includes(t==null?void 0:t.trim().toLowerCase())}function ms(t){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(t)||t.includes('"')||t.includes("'")}function vs(t){return t.flatMap(e=>{var s;return[(s=e.label)==null?void 0:s.trim().toLowerCase(),...e.sections.flatMap(o=>{var n;return[(n=o.label)==null?void 0:n.trim().toLowerCase(),...o.rows.flatMap(r=>r.columns.flatMap(d=>{var u;return[(u=d.label)==null?void 0:u.trim().toLowerCase(),...d.fields.map(v=>{var c;return(c=v.label)==null?void 0:c.trim().toLowerCase()})]}))]})]}).filter(e=>e!==""&&!Tt.includes(e))}function fe(t,e,s,o,n){const d=vs(h).filter((c,p,C)=>C.indexOf(c)!==p),u=Wt(h);h.splice(0,h.length,...u);function v(c,p){if(!c){p.errorMsg="";return}fs(c)?p.errorMsg="Entered label is restricted":ms(c)?p.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:c.length>64?p.errorMsg="Label should not exceed 64 characters":p.errorMsg=d.includes(c.trim().toLowerCase())?"Duplicate Label Name":""}n!==void 0&&v(h[t].sections[e].rows[s].columns[o].fields[n].label,h[t].sections[e].rows[s].columns[o].fields[n]),n===void 0&&o!==void 0&&v(h[t].sections[e].rows[s].columns[o].label,h[t].sections[e].rows[s].columns[o]),o===void 0&&n===void 0&&v(h[t].sections[e].label,h[t].sections[e]),h.forEach(c=>{c.sections.forEach(p=>{v(p.label,p),p.rows.forEach(C=>{C.columns.forEach(M=>{v(M.label,M),M.fields.forEach(k=>{v(k.label,k)})})})})})}const yt=Y(()=>{function t(e){return!e||typeof e!="object"?!1:"fieldtype"in e&&e.fieldtype===""||"error"in e&&e.error||"errorMsg"in e&&e.errorMsg||["Select","Table MultiSelect"].includes(e.fieldtype)&&(!e.options||e.options.trim()==="")?!0:Array.isArray(e)?e.some(t):Object.values(e).some(t)}return t(h)}),nt=Y(()=>x.value.length>0||N.value.length>0||!b.value.form_category||!b.value.owner_of_the_form||b.value.accessible_departments.length===0),hs=Y(()=>h.some(t=>t.sections.some(e=>e.rows.some(s=>s.columns.some(o=>o.fields.some(n=>n.label&&n.fieldtype))))));function Nt(t,e){let s=t.target.value.trim();if(!s){e==="form_name"?x.value="Input cannot be empty or only spaces":e==="form_short_name"&&(N.value="Input cannot be empty or only spaces");return}if(s.length>63){e==="form_name"?x.value="Name cannot exceed 63 characters":e==="form_short_name"&&(N.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(s)){e==="form_short_name"&&(N.value="First character must be a letter");return}else N.value="";if(e==="form_short_name"&&s.length<2){N.value="Short name must have at least 2 letters";return}if(e==="form_short_name"&&/[^a-zA-Z ]/.test(s)){N.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(s)){e==="form_name"?x.value="Special characters are not allowed":e==="form_short_name"&&(N.value="Special characters are not allowed");return}else e==="form_name"?x.value="":e==="form_short_name"&&(N.value="");const o=[[e,"=",`${s}`],["business_unit","=",`${b.value.business_unit}`]],n={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:me.EzyFormDefinitions};le.get(`${se.GetDoctypeData}`,{params:n}).then(r=>{K.value=r.message.data,e==="form_name"?x.value=s&&K.value.some(d=>d.form_name&&d.form_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":e==="form_short_name"&&(N.value=s&&K.value.some(d=>d.form_short_name&&d.form_short_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(r=>{console.error("Error fetching ezyForms data:",r),e==="form_name"?x.value="":e==="form_short_name"&&(N.value="")})}const bs=t=>t===0?"1st row":t===1?"2nd row":t===2?"3rd row":`${t+1}th row`,_t=_([]),gs=()=>{h.length&&(_t.value=h,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function ys(){le.post(se.delete_form_items,{deleted_fields:V.flatMap(kt),doctype:H}).then(t=>{var e;(e=t==null?void 0:t.message)!=null&&e.success&&gt()})}function Ht(t){return dt(this,null,function*(){if(yt.value){ve("Please fix the errors before proceeding.");return}Pt.value=!0;let e=V.flatMap(kt);H!=null&&H!=null&&H!="new"&&e.length?ys():gt(t)})}const _s=t=>{const e=typeof t=="string"?t:t.fieldType||t.id;console.log("Field added from library:",e,t);const s=et.value,o=h[s];if(!o){ve("Please create a block first before adding fields");return}const n=jt(e);if(!n)return;o.sections||(o.sections=[]),o.sections.length===0&&o.sections.push({label:"",rows:[[{fields:[]}]]});const u=o.sections[0].rows[0][0];u.fields||(u.fields=[]),u.fields.push(n),console.log("Field added successfully:",n),be(`${n.label} field added successfully`)},ws=t=>{const e=typeof t=="string"?t:t.fieldType||t.id;console.log("Drag started:",e,t),ke.value=e},jt=t=>{var r,d,u,v;console.log("Creating field from type:",t),console.log("Available field types:",Object.keys(Xe));const e=Xe[t];if(!e)return console.error("Field type not found:",t),console.error("Attempted to find:",t,"in",Xe),ve(`Field type "${t}" not found. Please try again.`),null;const s=Date.now(),o=Math.random().toString(36).substring(2,6),n=`${t}_${s}_${o}`;return{id:`field_${s}_${o}`,fieldname:n,label:e.name,fieldtype:e.frappe_fieldtype,options:((r=e.defaultProps)==null?void 0:r.options)||"",reqd:(d=e.defaultProps)!=null&&d.required?1:0,read_only:0,hidden:0,description:e.description||"",default:((u=e.defaultProps)==null?void 0:u.default)||"",placeholder:((v=e.defaultProps)==null?void 0:v.placeholder)||""}};return(t,e)=>(a(),i("div",null,[l("div",Vo,[l("div",Ro,[l("div",Uo,[l("div",Mo,[l("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:e[0]||(e[0]=s=>Xl())},e[37]||(e[37]=[l("button",{class:"btn font-13 ms-3"},[l("i",{class:"bi bi-arrow-left"}),l("span",{class:"ms-2"},"Back")],-1)])),t.$route.query.id||t.$route.query.preId?(a(),i("span",Oo,"("+g(ie.value.formId||E(F).query.form_name)+")",1)):m("",!0)]),l("div",null,[D.value===2&&E(h).length&&!t.$route.query.id?(a(),i("button",{key:0,disabled:yt.value||nt.value,style:Es({cursor:yt.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:e[1]||(e[1]=s=>Ht("Draft"))},e[38]||(e[38]=[l("i",{class:"bi bi-bookmark-check-fill"},null,-1),P(" Save As Draft ")]),12,Bo)):m("",!0)])]),l("div",Po,[l("div",zo,[l("div",No,[l("div",Ho,[l("ul",jo,[(a(!0),i(O,null,B(Ml.value,s=>(a(),i("li",{key:s.id,class:A({active:D.value===s.id,completed:D.value>s.id})},[l("div",{class:A(["d-flex gap-3 align-items-center",{"not-allowed":nt.value&&D.value+1===s.id}]),onClick:o=>Il(s.id)},[D.value>s.id?(a(),i("i",Yo)):(a(),i("i",{key:1,class:A(s.icon)},null,2)),l("div",Go,[l("span",Zo,g(s.stepno),1),e[39]||(e[39]=l("br",null,null,-1)),l("span",Ko,g(s.label),1)])],10,Jo)],2))),128))])])]),l("div",Wo,[l("div",Qo,[l("div",Xo,[D.value===1?(a(),i("div",xo,[l("div",Io,[l("div",ea,[e[40]||(e[40]=l("div",null,null,-1)),e[41]||(e[41]=l("h1",{class:"font-14 fw-bold m-0"},"About Form",-1)),l("div",null,[!t.$route.query.id&&!t.$route.query.preId?(a(),i("button",{key:0,class:"btn btn-light font-12 mx-2",type:"button",onClick:xl},"Clear Form")):m("",!0),D.value<3?(a(),Oe(Kt,{key:1,class:"btn btn-dark bg-dark text-white fw-bold font-13",name:"Next",onClick:Ut})):m("",!0)])])]),l("div",ta,[l("div",la,[e[55]||(e[55]=l("div",{class:"col-sm-none col-md-4"},null,-1)),l("div",sa,[l("div",oa,[l("div",aa,[l("div",ia,[l("div",na,[E(F).query.preId?(a(),i("span",ra,e[42]||(e[42]=[P("Predefined "),l("i",{class:"bi bi-check2-circle"},null,-1)]))):m("",!0),ae(We,{disabled:(ie.value.formId&&ie.value.formId.length>0||E(F).query.form_name)&&Fe.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Untitled Form",onChange:e[2]||(e[2]=s=>Nt(s,"form_name")),modelValue:qt.value,"onUpdate:modelValue":e[3]||(e[3]=s=>qt.value=s)},null,8,["disabled","modelValue"]),x.value?(a(),i("span",da,g(x.value),1)):m("",!0)])]),l("div",ca,[ae(We,{disabled:(ie.value.formId&&ie.value.formId.length>0||E(F).query.form_name)&&Fe.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Untitled Form",onChange:e[4]||(e[4]=s=>Nt(s,"form_short_name")),modelValue:b.value.form_short_name,"onUpdate:modelValue":e[5]||(e[5]=s=>b.value.form_short_name=s)},null,8,["disabled","modelValue"]),N.value?(a(),i("span",ua,g(N.value),1)):m("",!0)]),l("div",pa,[ae(We,{disabled:ie.value.formId&&ie.value.formId.length>0&&Fe.value!=="1",labeltext:"Form Naming series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Naming series",modelValue:b.value.series,"onUpdate:modelValue":e[6]||(e[6]=s=>b.value.series=s)},null,8,["disabled","modelValue"]),e[43]||(e[43]=Vs('<small class="text-muted" style="font-size:12px;" data-v-d2df88bb> Note : Enter <code data-v-d2df88bb>YY-YY</code>, <code data-v-d2df88bb>YYYY</code>, or <code data-v-d2df88bb>ABC</code>. The system will default to the format <code data-v-d2df88bb> 24-25-0001</code>, <code data-v-d2df88bb> 2025-0001</code>, or <code data-v-d2df88bb> ABC-0001</code> respectively. </small>',1))]),l("div",fa,[l("label",null,[e[44]||(e[44]=P("Owner Of The Form ")),b.value.owner_of_the_form?m("",!0):(a(),i("span",ma,"*"))]),ae(E(Qe),{disabled:ie.value.formId&&ie.value.formId.length>0&&Fe.value!=="1",onOpen:Bt,options:G.value,onChange:bt,modelValue:b.value.owner_of_the_form,"onUpdate:modelValue":e[7]||(e[7]=s=>b.value.owner_of_the_form=s),placeholder:"Select Department",multiple:!1,class:"font-11 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"])]),l("div",va,[l("label",null,[e[45]||(e[45]=P("Form Category ")),b.value.form_category?m("",!0):(a(),i("span",ha,"*"))]),ae(E(Qe),{disabled:ie.value.formId&&ie.value.formId.length>0&&Fe.value!=="1",options:T.value,modelValue:b.value.form_category,"onUpdate:modelValue":e[8]||(e[8]=s=>b.value.form_category=s),placeholder:"Select Category",multiple:!1,searchable:!0,class:"font-11 multiselect"},null,8,["disabled","options","modelValue"])]),l("div",ba,[l("label",null,[e[46]||(e[46]=P("Accessible to Department ")),b.value.accessible_departments.length?m("",!0):(a(),i("span",ga,"*"))]),ae(E(Qe),{modelValue:b.value.accessible_departments,"onUpdate:modelValue":e[10]||(e[10]=s=>b.value.accessible_departments=s),options:Bl.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Department",class:"font-11",onSelect:Hl,onRemove:jl,openDirection:"bottom"},{option:Ct(({option:s})=>[l("div",ya,[l("input",{type:"checkbox",checked:zl(s),class:"custom-checkbox",onChange:o=>Nl(s,o),onClick:e[9]||(e[9]=de(()=>{},["stop"]))},null,40,_a),l("span",null,g(s),1)])]),selection:Ct(({values:s,isOpen:o})=>[s.length?S((a(),i("span",{key:0,class:"multiselect__single font-10"},g(Pl.value),513)),[[Me,!o]]):m("",!0)]),_:1},8,["modelValue","options"])]),l("div",wa,[e[47]||(e[47]=l("label",null,"Form Type",-1)),ae(E(Qe),{options:$t,modelValue:St.value,"onUpdate:modelValue":e[11]||(e[11]=s=>St.value=s),placeholder:"Select Form Type",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:s=>s.value,class:"font-11 multiselect",openDirection:"top"},null,8,["modelValue","reduce"]),e[48]||(e[48]=l("small",{class:"text-muted font-12 ms-2"},"Note: Public form is accessible by anyone through QR code.",-1))]),l("div",ka,[e[49]||(e[49]=l("label",null,[P("Has Workflow "),l("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(E(Qe),{options:["Yes","No"],modelValue:b.value.has_workflow,"onUpdate:modelValue":e[12]||(e[12]=s=>b.value.has_workflow=s),placeholder:"Select",multiple:!1,class:"font-11 multiselect",searchable:!0},null,8,["modelValue"])]),b.value.as_web_view===1?(a(),i("div",Ca,[e[50]||(e[50]=l("label",null,[P("Form Submit Response "),l("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(We,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit Response",modelValue:b.value.public_form_response,"onUpdate:modelValue":e[13]||(e[13]=s=>b.value.public_form_response=s)},null,8,["modelValue"])])):m("",!0),b.value.as_web_view===1?(a(),i("div",Da,[e[51]||(e[51]=l("label",null,[P("Submit Notification Email "),l("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(We,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit mail",modelValue:b.value.mail_id,"onUpdate:modelValue":e[14]||(e[14]=s=>b.value.mail_id=s)},null,8,["modelValue"]),e[52]||(e[52]=l("small",{class:"text-muted font-12 ms-2"},"Note : If multiple Emails, separate with commas (,).",-1))])):m("",!0),E(F).query.preId?(a(),i("div",Fa,[l("div",$a,[S(l("input",{class:"form-check-input linketoCheck p-1",disabled:b.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":e[15]||(e[15]=s=>b.value.is_linked=s),"true-value":1,"false-value":0},null,8,Sa),[[Re,b.value.is_linked]]),e[53]||(e[53]=l("label",{class:"form-check-label font-12 mx-2 mb-0 ps-1",for:"is_linked"}," Link ",-1))])])):m("",!0),b.value.is_linked?(a(),i("div",qa,[e[54]||(e[54]=l("label",{for:"standardFormInput"},"Form",-1)),S(l("input",{type:"text",class:"form-control standardFormInput",id:"standardFormInput",disabled:b.value.is_predefined_doctype==1,"onUpdate:modelValue":e[16]||(e[16]=s=>b.value.is_linked_form=s),placeholder:"Type to search Form Name...",onInput:sl,onFocus:e[17]||(e[17]=s=>Ie.value=!0),onBlur:al},null,40,Ta),[[J,b.value.is_linked_form]]),Ie.value&&xe.value.length?(a(),i("ul",Aa,[(a(!0),i(O,null,B(xe.value,(s,o)=>(a(),i("li",{class:"list-group-item formlistitem",key:o,onMousedown:de(n=>ol(s.name),["prevent"])},g(s.name),41,La))),128))])):m("",!0)])):m("",!0)])])]),e[56]||(e[56]=l("div",{class:"col-sm-none col-md-4"},null,-1))])])])):m("",!0),D.value===2?(a(),i("div",Ea,[l("div",Va,[l("div",Ra,[l("button",{onClick:e[18]||(e[18]=s=>Mt()),class:"btn btn-sm btn-light"},e[57]||(e[57]=[l("i",{class:"bi bi-chevron-left"},null,-1),P(" Back ")]))]),l("div",Ua,[(a(!0),i(O,null,B(E(h),(s,o)=>(a(),i("button",{key:o,class:A(["zoho-tab",{active:et.value===o}]),onClick:n=>et.value=o},[e[58]||(e[58]=l("i",{class:"bi bi-file-earmark-text me-1"},null,-1)),P(" "+g(o===0?"Requestor Block":`Approver Block ${o}`)+" ",1),E(h).length>1?(a(),i("i",{key:0,class:"bi bi-x-lg ms-2",onClick:de(n=>zt(o),["stop"])},null,8,Oa)):m("",!0)],10,Ma))),128))]),l("div",Ba,[l("button",{class:"btn btn-sm btn-primary me-2",onClick:ss},e[59]||(e[59]=[l("i",{class:"bi bi-plus-lg me-1"},null,-1),P("Add Block ")])),hs.value?(a(),i("button",{key:0,class:"btn btn-sm btn-light me-2",onClick:gs},e[60]||(e[60]=[l("i",{class:"bi bi-eye me-1"},null,-1),P("Preview ")]))):m("",!0),E(h).length?(a(),i("button",{key:1,class:"btn btn-sm btn-dark",onClick:e[19]||(e[19]=s=>Ht("save"))},g(E(H)!=="new"?"Update Form":"Create Form"),1)):m("",!0)])]),l("div",Pa,[l("aside",{class:A(["zoho-field-library",{collapsed:!Te.value}])},[l("div",{class:"library-header",onClick:e[20]||(e[20]=s=>Te.value=!Te.value)},[l("div",za,[l("h6",Na,[e[61]||(e[61]=l("i",{class:"bi bi-grid-3x3-gap me-2"},null,-1)),P(" "+g(Te.value?"Field Types":"Fields"),1)]),l("button",Ha,[l("i",{class:A(Te.value?"bi bi-chevron-left":"bi bi-chevron-right")},null,2)])])]),Te.value?(a(),i("div",ja,[ae(Eo,{collapsible:!0,onFieldAdd:_s,onFieldDragstart:ws})])):m("",!0)],2),l("div",Ja,[l("div",{class:"canvas-inner",ref_key:"mainBlockRef",ref:it},[(a(!0),i(O,null,B(E(h),(s,o)=>S((a(),i("div",{class:"block-level",key:o},[l("div",Ya,[l("div",Ga,[l("div",Za,[l("h6",Ka,g(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),l("div",Wa,[o!==0&&W(o).view_only_reportee||W(o).all_approvals_required||W(o).requester_as_a_approver?(a(),i("div",Qa,[l("span",Xa,g(W(o).view_only_reportee===1?"Reporting Manager only":"")+" "+g(W(o).all_approvals_required===1?"All of the selected approvers":"")+" "+g(W(o).requester_as_a_approver===1?"Approval by Requestor":""),1),l("span",null,[e[62]||(e[62]=l("span",{class:"ms-1"}," on rejection escalating to ",-1)),l("span",xa,g(W(o).on_rejection?`Level ${W(o).on_rejection}`:"Requestor"),1)]),l("span",Ia,g(W(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):m("",!0)])]),l("div",ei,[E(H)&&E(I).length?(a(),i("div",ti,[W(o)?(a(),i("label",li,[l("span",si,g(W(o).roles.length>0?o===0?"Requestor: ":"Approver: ":""),1),l("span",oi,g(W(o).roles.slice(0,2).join(", ")),1),W(o).roles.length>2?(a(),i("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>ht(o),class:"more-count"}," +"+g(W(o).roles.length-2)+" more ",9,ai)):m("",!0)])):m("",!0)])):m("",!0),tl(o)&&E(H)!=null&&E(H)!=null&&E(H)!="new"&&W(o).roles.length===0?(a(),i("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>ht(o)},[e[63]||(e[63]=l("img",{src:Ps,alt:"Add",class:"me-1"},null,-1)),P(" "+g(o===0?"Add Requestors":"Add Approvers"),1)],8,ii)):m("",!0),E(H)!=null&&E(H)!=null&&E(H)!="new"&&W(o).roles.length>0?(a(),i("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>ht(o)},e[64]||(e[64]=[l("i",{class:"bi bi-pencil font-14"},null,-1)]),8,ni)):m("",!0),l("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:n=>zt(o)},e[65]||(e[65]=[l("i",{class:"bi bi-trash me-1"},null,-1),P(" Delete Block ")]),8,ri)])])]),l("div",di,[(a(!0),i(O,null,B(s.sections,(n,r)=>(a(),i("div",{key:"section-"+r,class:"dynamicSection mt-0 section"},[l("section",ci,[l("div",ui,[S(l("input",{"onUpdate:modelValue":d=>n.label=d,type:"text",class:A(["border-less-input","font-14",{"italic-style":!n.label},{"fw-medium":n.label}]),onChange:d=>fe(o,r),onInput:d=>fe(o,r),placeholder:"Untitled section"},null,42,pi),[[J,n.label]]),n.errorMsg?(a(),i("small",fi,g(n.errorMsg),1)):m("",!0)]),l("div",mi,[l("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:d=>is(o,r)},e[66]||(e[66]=[l("i",{class:"bi bi-trash me-1"},null,-1),P(" Delete Section ")]),8,vi)])]),l("div",hi,[(a(!0),i(O,null,B(n.rows,(d,u)=>(a(),i("section",{class:"row dynamicRow row-container",key:"row-"+u},[l("div",bi,[l("label",gi,g(bs(u)),1),l("div",null,[d.columns.length<3?(a(),i("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:v=>ns(o,r,u)},e[67]||(e[67]=[l("i",{class:"bi bi-plus font-14"},null,-1),P(" Add Column ")]),8,yi)):m("",!0)])]),l("div",_i,[l("div",wi,[(a(!0),i(O,null,B(d.columns,(v,c)=>(a(),i("div",{key:"column-"+c,onMouseenter:p=>fl(o,r,u,c),onMouseleave:ml,class:"col p-0 dynamicColumn position-relative column-container"},[l("div",Ci,[l("div",Di,[S(l("input",{"onUpdate:modelValue":p=>v.label=p,type:"text",class:A(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!v.label},{"fw-medium":v.label}]),onChange:p=>fe(o,r,u,c),onInput:p=>fe(o,r,u,c),placeholder:"Column Name"},null,42,Fi),[[J,v.label]]),v.errorMsg?(a(),i("small",$i,g(v.errorMsg),1)):m("",!0)]),S(l("div",Si,[l("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:p=>rs(o,r,u,c)},e[68]||(e[68]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,qi)],512),[[Me,vl(o,r,u,c)]])]),v.fields.length===0?(a(),i("div",{key:0,class:"empty-drop-zone",onDragover:e[21]||(e[21]=de(()=>{},["prevent"])),onDrop:p=>Ce(p,o,r,u,c,t.fieldIndex)},null,40,Ti)):m("",!0),(a(!0),i(O,null,B(v.fields,(p,C)=>{var M;return a(),i("div",{key:"field-"+C,onMouseenter:k=>cl(o,r,u,c,C),onMouseleave:ul,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:k=>At(k,o,r,u,c,C),onDragover:e[25]||(e[25]=de(()=>{},["prevent"])),onDrop:k=>Ce(k,o,r,u,c,C)},[l("div",{class:"drop-zone",onDragover:e[22]||(e[22]=de(()=>{},["prevent"])),onDrop:k=>Ce(k,o,r,u,c,C)},null,40,Li),p.fieldtype!=="Table"?(a(),i("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:k=>At(k,o,r,u,c,C),onDragover:e[23]||(e[23]=de(()=>{},["prevent"])),onDrop:k=>Ce(k,o,r,u,c,C)},[l("div",Vi,[l("div",Ri,[S(l("input",{"onUpdate:modelValue":k=>p.label=k,placeholder:"Name the field",class:A(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!p.label},{"fw-medium":p.label}]),onChange:k=>fe(o,r,u,c,C),onInput:k=>fe(o,r,u,c,C)},null,42,Ui),[[J,p.label]]),p.errorMsg?(a(),i("small",Mi,g(p.errorMsg),1)):m("",!0)]),S(l("div",Oi,[l("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:k=>us(o,r,u,c,C)},e[69]||(e[69]=[l("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,Bi),l("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:k=>{cs(o,r,u,c,C),fe(o,r,u,c)}},e[70]||(e[70]=[l("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,Pi)],512),[[Me,pl(o,r,u,c,C)]])]),S(l("select",{"onUpdate:modelValue":k=>p.fieldtype=k,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:k=>ps(o,r,u,c,C)},[e[71]||(e[71]=l("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(Ol,k=>l("option",{key:k,value:k.type},g(k.label),9,Ni)),64))],40,zi),[[Ue,p.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(p.fieldtype)?(a(),i("div",Hi,[e[72]||(e[72]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":k=>p.options=k,class:"form-control shadow-none mb-1 font-12"},null,8,ji),[[J,p.options]]),!p.options||p.options.trim()===""?(a(),i("small",Ji," Options are required for this field type. ")):m("",!0)])):m("",!0),p.fieldtype==="Link"?(a(),i("div",Yi,[l("label",{class:"font-11 fw-light",for:"link-search-"+ge(o,r,u,c,C)}," Search Doctype: ",8,Gi),S(l("input",{id:"link-search-"+ge(o,r,u,c,C),type:"text","onUpdate:modelValue":k=>E(h)[o].sections[r].rows[u].columns[c].fields[C].options=k,onInput:k=>nl(E(h)[o].sections[r].rows[u].columns[c].fields[C].options,o,r,u,c,C),onFocus:k=>il(ge(o,r,u,c,C)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,Zi),[[J,E(h)[o].sections[r].rows[u].columns[c].fields[C].options]]),(M=ze[ge(o,r,u,c,C)])!=null&&M.length&&pt[ge(o,r,u,c,C)]?(a(),i("ul",Ki,[(a(!0),i(O,null,B(ze[ge(o,r,u,c,C)],(k,w)=>(a(),i("li",{key:w,onClick:$=>rl(o,r,u,c,C,k.name),class:"list-group-item list-group-item-action"},g(k.name),9,Wi))),128))])):m("",!0)])):m("",!0),l("div",Qi,[l("div",Xi,[l("div",xi,[S(l("input",{class:"font-12","onUpdate:modelValue":k=>p.reqd=k,"true-value":1,id:"mandatory-"+o+"-"+r+"-"+u+"-"+c+"-"+C,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,Ii),[[Re,p.reqd]])]),l("div",null,[l("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+r+"-"+u+"-"+c+"-"+C},"Mandatory",8,en)])]),l("div",null,[l("button",{class:"btn btn-sm font-12",onClick:k=>p.showDescription=!p.showDescription},g(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,tn)])]),p.showDescription?S((a(),i("textarea",{key:2,"onUpdate:modelValue":k=>p.description=k,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,ln)),[[J,p.description]]):m("",!0),p.error?(a(),i("small",sn,g(p.error),1)):m("",!0)],40,Ei)):m("",!0),l("div",{class:"drop-zone",onDragover:e[24]||(e[24]=de(()=>{},["prevent"])),onDrop:k=>Ce(k,o,r,u,c,C)},null,40,on),l("div",an,[l("div",null,[l("div",null,[l("div",nn,[p.fieldtype==="Table"?(a(),i("div",rn,[(a(!0),i(O,null,B(re.value,(k,w)=>(a(),i("div",{key:w,class:"childTable"},[w===p.fieldname||w===p.options?(a(),i("h5",dn,g(w.replace(/_/g," ")),1)):m("",!0),Q[w]&&w===Vt.value?(a(),i("div",cn,[l("div",un,[p.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":$=>p.description=$,class:"form-control font-12",placeholder:"Enter field description"},null,8,pn)),[[J,p.description]]):m("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:$=>p.showDescription=!p.showDescription},g(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,fn)])])):m("",!0),w===p.options||w===p.fieldname?(a(),i("table",mn,[e[76]||(e[76]=l("thead",null,[l("tr",null,[l("th",null,"#"),l("th",null,"Label"),l("th",null,"Field Type")])],-1)),l("tbody",{onDragover:de(gl,["prevent"]),onDrop:$=>yl($,k)},[(a(!0),i(O,null,B(k,($,te)=>{var je,Je,Ye,Ge,Ze,Ke,oe;return a(),i("tr",{key:te,draggable:Q[w],onDragstart:X=>hl(te),onDragend:bl,class:A({dragging:$e.value===te})},[l("td",null,g(te+1),1),Q[w]?(a(),i("td",bn,[S(l("input",{"onUpdate:modelValue":X=>$.label=X,onInput:X=>at($,w,te),placeholder:"Field Label",class:A(["form-control",{"border-1 border-danger":(Je=(je=R[w])==null?void 0:je[te])==null?void 0:Je.length}])},null,42,gn),[[J,$.label]]),(Ge=(Ye=R[w])==null?void 0:Ye[te])!=null&&Ge.length?(a(),i("div",yn,[(a(!0),i(O,null,B(R[w][te],(X,ks)=>(a(),i("div",{key:ks},g(X),1))),128))])):m("",!0)])):(a(),i("td",_n,g($.label),1)),Q[w]?(a(),i("td",wn,[l("div",kn,[S(l("select",{"onUpdate:modelValue":X=>$.fieldtype=X,onChange:X=>at($,w,te),class:A(["form-select form-select-sm",{"border-1 border-danger":(Ke=(Ze=R[w])==null?void 0:Ze[te])==null?void 0:Ke.length}])},[e[73]||(e[73]=l("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(mt,X=>l("option",{key:X.type,value:X.type},g(X.label),9,Dn)),64))],42,Cn),[[Ue,$.fieldtype]]),l("div",Fn,[l("div",$n,[l("div",Sn,[S(l("input",{class:"font-12 form-control-sm","onUpdate:modelValue":X=>$.description=X,placeholder:"description",type:"text"},null,8,qn),[[J,$.description]])])]),l("button",{class:"btn btn-light btn-sm",onClick:X=>Rl(w,te)},e[74]||(e[74]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,Tn)])]),["Select"].includes($.fieldtype)?(a(),i("div",An,[e[75]||(e[75]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":X=>$.options=X,onInput:X=>at($,w,te),class:"form-control shadow-none mb-1 font-12"},null,40,Ln),[[J,$.options]]),!$.options||$.options.trim()===""?(a(),i("small",En," Options are required for this field type. ")):m("",!0)])):m("",!0),(oe=ee[w])!=null&&oe.includes(te)?(a(),i("span",Vn,"Type required**")):m("",!0)])):(a(),i("td",Rn,g($.fieldtype),1))],42,hn)}),128))],40,vn)])):m("",!0),p.fieldtype==="Table"&&(p.label===w||p.fieldname===w)?(a(),i("div",Un,[l("button",{class:"btn btn-light btn-sm mx-2",onClick:$=>Ul(w,p.description)},g(Q[w]?"Save":"Edit"),9,Mn),Q[w]?(a(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:$=>Vl(w)}," Add More Field ",8,On)):m("",!0)])):m("",!0)]))),128))])):m("",!0)])])])])],40,Ai)}),128)),l("div",{class:"drop-zone-bottom",onDragover:e[26]||(e[26]=de(()=>{},["prevent"])),onDrop:p=>Ce(p,o,r,u,c,v.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,Bn),l("div",{class:"drop-zone",onDragover:e[27]||(e[27]=de(()=>{},["prevent"])),onDrop:p=>Ce(p,o,r,u,c,t.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,Pn),l("div",zn,[l("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:p=>ds(o,r,u,c)},e[77]||(e[77]=[l("i",{class:"bi bi-plus fs-5"},null,-1),l("span",null,"Add Field",-1)]),8,Nn)])],40,ki))),128))])])]))),128)),l("div",null,[(a(!0),i(O,null,B(n.afterCreated,(d,u)=>(a(),i("div",{key:u,class:"childTable dynamicColumn m-0 p-2"},[l("h5",Hn,g(d.tableName),1),Q[d.tableName]?(a(),i("div",jn,[l("div",Jn,[d.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":v=>d.description=v,class:"form-control font-12",placeholder:"Enter field description"},null,8,Yn)),[[J,d.description]]):m("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:v=>d.showDescription=!d.showDescription},g(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,Gn)])])):m("",!0),l("table",Zn,[e[83]||(e[83]=l("thead",null,[l("tr",null,[l("th",null,"#"),l("th",null,"Label"),l("th",null,"Field Type")])],-1)),l("tbody",null,[(a(!0),i(O,null,B(d.columns,(v,c)=>{var p,C,M,k;return a(),i("tr",{key:c},[l("td",null,g(c+1),1),Q[d.tableName]?(a(),i("td",Kn,[S(l("input",{"onUpdate:modelValue":w=>v.label=w,placeholder:"Field Label",class:A(["form-control",{"border-1 border-danger":(p=ee[d.tableName])==null?void 0:p.includes(c)}]),onBlur:w=>{var $;v.label=($=v.label)==null?void 0:$.trim(),Ne(v,d.tableName,c,d.columns)}},null,42,Wn),[[J,v.label]]),(C=R[d.tableName])!=null&&C[c]?(a(),i("div",Qn,[(a(!0),i(O,null,B(R[d.tableName][c],(w,$)=>(a(),i("span",{key:$},[P(g(w)+" ",1),e[78]||(e[78]=l("br",null,null,-1))]))),128))])):m("",!0)])):(a(),i("td",Xn,g(v.label),1)),Q[d.tableName]?(a(),i("td",xn,[l("div",In,[S(l("select",{"onUpdate:modelValue":w=>v.fieldtype=w,class:A(["form-select form-select-sm",{"border-1 border-danger":(M=ee[d.tableName])==null?void 0:M.includes(c)}]),onChange:w=>Ne(v,d.tableName,c,d.columns)},[e[79]||(e[79]=l("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(mt,w=>l("option",{key:w.type,value:w.type},g(w.label),9,tr)),64))],42,er),[[Ue,v.fieldtype]]),l("button",{class:"btn btn-light btn-sm",onClick:w=>Ll(o,r,d.tableName,c)},e[80]||(e[80]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,lr)]),v.fieldtype==="Select"?(a(),i("div",sr,[e[81]||(e[81]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":w=>v.options=w,class:"form-control shadow-none mb-1 font-12",onInput:w=>Ne(v,d.tableName,c,d.columns)},null,40,or),[[J,v.options]])])):m("",!0),(k=R[d.tableName])!=null&&k[c]?(a(),i("div",ar,[(a(!0),i(O,null,B(R[d.tableName][c],(w,$)=>(a(),i("span",{key:$},[P(g(w),1),e[82]||(e[82]=l("br",null,null,-1))]))),128))])):m("",!0)])):(a(),i("td",ir,g(v.fieldtype),1))])}),128))])]),l("div",nr,[l("button",{class:"btn btn-light btn-sm mx-2",onClick:v=>El(o,r,d.tableName)},g(Q[d.tableName]?"Save":"Edit"),9,rr),Q[d.tableName]?(a(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:v=>Al(o,r,d.tableName)}," Add More Field ",8,dr)):m("",!0)])]))),128))])]),l("div",null,[l("div",null,[o==0?(a(),i("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:d=>wl(o,r)}," Add New Table ",8,cr)):m("",!0),(a(!0),i(O,null,B(n.childTables,(d,u)=>{var v;return a(),i("div",{key:`table-${o}-${r}-${u}`,class:"child-table"},[d.newTable?(a(),i("div",ur,[l("div",pr,[l("div",null,[l("span",{class:A(d.tableName?"d-none":"text-danger")},"*",2),S(l("input",{"onUpdate:modelValue":c=>d.tableName=c,placeholder:"Table Name",onBlur:c=>Lt(d),class:A(["border-less-input font-14 p-0 inputHeight",{"italic-style":!d.tableName,"fw-medium":d.tableName}])},null,42,fr),[[J,d.tableName]]),(v=R[`${o}-${r}-${u}`])!=null&&v.tableName?(a(),i("div",mr,g(R[`${o}-${r}-${u}`].tableName),1)):m("",!0),Ve.value?(a(),i("div",vr,g(Ve.value),1)):m("",!0),l("div",hr,[l("div",br,[d.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":c=>d.as_a_block=c,class:"form-control font-12",placeholder:"Enter field description"},null,8,gr)),[[J,d.as_a_block]]):m("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:c=>d.showDescription=!d.showDescription},g(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,yr)])])]),l("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:c=>Cl(o,r,u)},e[84]||(e[84]=[l("i",{class:"bi bi-trash"},null,-1),P(" Remove Table ")]),8,_r)]),(a(!0),i(O,null,B(d.columns,(c,p)=>{var C,M,k,w,$,te,je,Je,Ye,Ge,Ze,Ke;return a(),i("div",{key:p,class:"dynamicField"},[l("div",wr,[l("div",kr,[l("div",null,[l("span",{class:A(c.label?"d-none":"text-danger")},"*",2),S(l("input",{"onUpdate:modelValue":oe=>c.label=oe,placeholder:"Name the field",onBlur:()=>{Lt(c),Fl(c,o,r,u,p,d.columns)},class:A(["border-less-input font-14 p-0 inputHeight",{"italic-style":!c.label,"fw-medium":c.label,"is-invalid":(k=(M=(C=R[`${o}-${r}-${u}`])==null?void 0:C.columns)==null?void 0:M[p])==null?void 0:k.label}])},null,42,Cr),[[J,c.label]]),(te=($=(w=R[`${o}-${r}-${u}`])==null?void 0:w.columns)==null?void 0:$[p])!=null&&te.label?(a(),i("div",Dr,g(R[`${o}-${r}-${u}`].columns[p].label),1)):m("",!0)]),l("div",Fr,[l("div",$r,[c.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":oe=>c.description=oe,class:"form-control font-12",placeholder:"Enter field description"},null,8,Sr)),[[J,c.description]]):m("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:oe=>c.showDescription=!c.showDescription},g(c.showDescription?"Hide Description":c.description?"Edit Description":"Add Description"),9,qr)]),l("button",{class:"btn btn-sm trash-btn py-0",onClick:oe=>Dl(o,r,u,p)},e[85]||(e[85]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,Tr)])]),S(l("select",{"onUpdate:modelValue":oe=>c.fieldtype=oe,class:A(["form-select font-13 mb-1",{"is-invalid":(Ye=(Je=(je=R[`${o}-${r}-${u}`])==null?void 0:je.columns)==null?void 0:Je[p])==null?void 0:Ye.fieldtype}])},[e[86]||(e[86]=l("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(mt,oe=>l("option",{key:oe.type,value:oe.type},g(oe.label),9,Lr)),64))],10,Ar),[[Ue,c.fieldtype]]),["Select"].includes(c.fieldtype)?(a(),i("div",Er,[e[87]||(e[87]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":oe=>c.options=oe,class:"form-control shadow-none mb-1 font-12"},null,8,Vr),[[J,c.options]]),!c.options||c.options.trim()===""?(a(),i("small",Rr," Options are required for this field type. ")):m("",!0)])):m("",!0),(Ke=(Ze=(Ge=R[`${o}-${r}-${u}`])==null?void 0:Ge.columns)==null?void 0:Ze[p])!=null&&Ke.fieldtype?(a(),i("div",Ur,g(R[`${o}-${r}-${u}`].columns[p].fieldtype),1)):m("",!0)])])}),128)),l("button",{class:"btn btn-light btn-sm addField mx-1",onClick:c=>kl(o,r,u)},e[88]||(e[88]=[l("i",{class:"bi bi-plus"},null,-1),P(" Add Field ")]),8,Mr),l("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:c=>Tl(o,r,u)}," Create Table ",8,Or),e[89]||(e[89]=l("hr",null,null,-1))])):m("",!0)])}),128))])]),l("div",Br,[l("button",{class:"btn btn-light border font-12",onClick:d=>as(o,r)},e[90]||(e[90]=[l("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),P(" Add Section ")]),8,Pr)])]))),128)),o===0?(a(),i("div",zr)):m("",!0)])])),[[Me,o===et.value]])),128))],512)]),Ft.value?(a(),i("aside",Nr,[l("div",Hr,[e[92]||(e[92]=l("h6",{class:"mb-0"},"Field Properties",-1)),l("button",{class:"btn btn-sm btn-link p-0",onClick:e[28]||(e[28]=s=>Ft.value=null)},e[91]||(e[91]=[l("i",{class:"bi bi-x-lg"},null,-1)]))]),e[93]||(e[93]=l("div",{class:"properties-content"},[l("p",{class:"text-muted small"},"Select a field to edit its properties")],-1))])):m("",!0)])])):m("",!0),D.value===3?(a(),i("div",jr,[e[94]||(e[94]=l("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[l("div",null,[l("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),l("div")],-1)),ae(Rs,{blockArr:_t.value},null,8,["blockArr"])])):m("",!0)])])])])])])]),l("div",Jr,[l("div",Yr,[l("div",Gr,[e[98]||(e[98]=l("div",{class:"modal-header"},[l("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),l("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),l("div",Zr,[e[96]||(e[96]=l("label",{for:""},"Form Name",-1)),S(l("input",{"onUpdate:modelValue":e[29]||(e[29]=s=>lt.value=s),multiple:!1,placeholder:E(F).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,Kr),[[J,lt.value]]),l("div",Wr,[l("div",Qr,[S(l("input",{class:"font-12","onUpdate:modelValue":e[30]||(e[30]=s=>Le.value=s),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[Re,Le.value]])]),e[95]||(e[95]=l("div",null,[l("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),l("div",{class:"modal-footer"},[e[97]||(e[97]=l("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),l("button",{type:"button",class:"btn btn-dark",onClick:ts},"Add Print Format")])])])]),l("div",Xr,[l("div",xr,[l("span",Ir,g(z.value==0?"Add designation for Requestors":`Approval Settings For
          Level-${z.value}`),1),e[99]||(e[99]=l("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),l("div",ed,[l("div",td,[l("div",ld,[z.value!==0?(a(),i("div",sd,[z.value!==0?(a(),i("div",od,[e[101]||(e[101]=l("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),S(l("select",{"onUpdate:modelValue":e[31]||(e[31]=s=>pe.value=s),class:"form-select shadow-none font-12"},e[100]||(e[100]=[l("option",{value:""},"Any one of the selected approvers",-1),l("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),l("option",{value:"all_approvals_required"},"All of the selected approvers",-1),l("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[Ue,pe.value]])])):m("",!0)])):m("",!0)])]),l("div",ad,[l("div",id,[l("span",nd," Select "+g(z.value===0?"Requestors":"Approvers"),1),l("span",rd,g(q.value.length)+" Selected ",1)]),Z.value.length?(a(),i("div",dd,[l("div",cd,[l("div",ud,[l("input",{type:"checkbox",id:"selectAll",checked:Jl.value,onChange:Yl,class:"form-check-input me-2 designationCheckBox"},null,40,pd),l("label",fd," Select all designation ("+g(He.value.length)+") ",1)]),z.value!==0?(a(),i("div",md,[S(l("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":e[32]||(e[32]=s=>Ee.value=s),class:"form-check-input me-2 designationCheckBox"},null,512),[[Re,Ee.value]]),e[102]||(e[102]=l("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):m("",!0),l("div",null,[q.value.length?(a(),i("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:Gl},e[103]||(e[103]=[l("i",{class:"bi bi-x"},null,-1),P(" Clear all ")]))):m("",!0)])]),Z.value.length?(a(),Oe(E(Us),{key:0,multiple:!0,modelValue:q.value,"onUpdate:modelValue":e[33]||(e[33]=s=>q.value=s),options:He.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):m("",!0)],512)):(a(),i("div",vd,e[104]||(e[104]=[l("div",{class:"d-flex justify-content-center"},[l("span",null,"No Designations Found")],-1)])))]),z.value!==0?(a(),i("div",hd,[e[105]||(e[105]=l("div",null,[l("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),S(l("select",{"onUpdate:modelValue":e[34]||(e[34]=s=>he.value=s),class:"form-select shadow-none font-12 mt-1 me-2"},[(a(!0),i(O,null,B(dl.value,s=>(a(),i("option",{key:s,value:s},g(s===0?"Requestor":"Approver Level "+s),9,bd))),128))],512),[[Ue,he.value,void 0,{number:!0}]])])):m("",!0),z.value!==0?(a(),i("div",gd,[l("div",yd,[l("div",_d,[S(l("input",{"onUpdate:modelValue":e[35]||(e[35]=s=>U.value=s),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Re,U.value]]),e[106]||(e[106]=l("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),ut.value===!0?(a(),i("div",wd,[S(l("input",{"onUpdate:modelValue":e[36]||(e[36]=s=>j.value=s),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Re,j.value]]),e[107]||(e[107]=l("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):m("",!0)])])):m("",!0)]),l("div",kd,[l("div",Cd,[l("div",null,[ae(Kt,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:Zl,name:z.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},Sd=Be(Dd,[["__scopeId","data-v-d2df88bb"]]);export{Sd as default};
