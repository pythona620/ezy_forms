import{_ as q,r as o,L as O,e as $,E as U,I as V,u as B,i as I,w as J,f as m,g as f,h as p,o as j,c as M,d as u,t as G,b as v,G as H,P as w,M as K,m as C}from"./index-DxID15hf.js";const Q={class:"d-flex formsticky align-items-center justify-content-between py-2"},W={class:"m-0 font-11 pt-1"},X={class:"mt-2"},Y={__name:"TrashComp",setup(Z){const d=o(0),E=o({}),c=o([]),b=o([]);o([]);const P=o([]),_=O(),S=o(null),h=$(()=>U.value);V([]);const g=B();I(()=>{});function T(e,t,r){const n=e.enable=="1"||e.enable===1,s=n?"delete":"restore";confirm(`Are you sure you want to ${s} this Form?`)&&(e.enable=n?0:1,m.put(`${f.resource}${p.EzyFormDefinitions}/${e.name}`,e).then(l=>{C.success(`Form ${s}d successfully`,{autoClose:700}),setTimeout(()=>{a()},1e3)}).catch(l=>{console.error("Error updating toggle:",l)}))}function x(e,t){if(t.name==="View form"&&(e!=null&&e.form_json?_.push({name:"FormPreviewComp",query:{routepath:g.path,form_short_name:e.form_short_name}}):(console.warn(" There is no form fields "),k(e))),t.name==="Edit Form"&&k(e),t.name==="Active this form"&&e){const r=e.enable=="1"||e.enable===1,n=r?"delete":"Active";confirm(`Are you sure you want to ${n}  ${e.name} Form?`)&&(e.enable=r?0:1,m.put(`${f.resource}${p.EzyFormDefinitions}/${e.name}`,e).then(s=>{C.success(`Form ${n}d successfully`,{autoClose:700}),setTimeout(()=>{a()},1e3)}).catch(s=>{console.error("Error updating toggle:",s)}))}}const A=o([{name:"View form",icon:"fa-solid fa-eye"}]),i=o({limit_start:0,limitPageLength:20,form_name:"",form_short_name:"",accessible_departments:"[]",business_unit:"",form_category:"",owner_of_the_form:"",search:""});J(h,e=>{i.value.business_unit=e,e.length&&(c.value=[],a())},{immediate:!0});const F=o([{th:"Name",td_key:"name"},{th:"Form name",td_key:"form_name"},{th:"Form category",td_key:"form_category"},{th:"Accessible departments",td_key:"accessible_departments"},{th:"Status",td_key:"form_status"},{th:"Enable/Disable",td_key:"enable"}]);function k(e=null){e==null?_.push({name:"FormStepper",query:{routepath:g.path,business_unit:h.value}}):_.push({name:"FormStepper",params:{paramid:e.name},query:{routepath:g.path,business_unit:h.value,id:e.name}})}const L=e=>{i.value.limitPageLength=e,i.value.limit_start=0,a()},z=([e,t])=>{i.value.limitPageLength=e,i.value.limit_start=t,a()};function N(e){const t=[];F.value.forEach(r=>{const n=r.td_key;e[n]&&t.push(n,"like",`%${e[n]}%`)}),t.length?a(t):a()}function a(e){const t=[["business_unit","like",`%${i.value.business_unit}%`],["enable","=",0]];e&&t.push(e);const r={fields:JSON.stringify(["*"]),filters:JSON.stringify(t),limit_page_length:i.value.limitPageLength,limit_start:i.value.limit_start,order_by:"`tabEzy Form Definitions`.`creation` desc"},n={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(t)};m.get(`${f.resource}${p.EzyFormDefinitions}`,{params:n}).then(s=>{d.value=s.data[0].total_count}).catch(s=>{console.error("Error fetching ezyForms data:",s)}),m.get(`${f.resource}${p.EzyFormDefinitions}`,{params:r}).then(s=>{const l=s.data;i.value.limit_start===0?(c.value=l,b.value=[...new Set(l.map(y=>y.form_category))],P.value=[...new Set(l.map(y=>y.owner_of_the_form))]):c.value=c.value.concat(l)}).catch(s=>{console.error("Error fetching ezyForms data:",s)})}const R=$(()=>({form_category:{type:"select",options:b.value},name:{type:"input"},owner_of_the_form:{type:"input"}}));return(e,t)=>(j(),M("div",null,[u("div",Q,[u("div",null,[t[0]||(t[0]=u("h1",{class:"m-0 font-13"},"Forms in Trash",-1)),u("p",W,G(d.value)+" forms available",1)]),t[1]||(t[1]=u("div",{class:"d-flex align-items-center gap-2"},null,-1))]),u("div",X,[v(H,{tHeaders:F.value,tData:c.value,isAction:"true",actionType:"dropdown",enableDisable:"true",onActionClicked:x,onToggleClick:T,isFiltersoption:"true","field-mapping":R.value,actions:A.value,onUpdateFilters:N,isCheckbox:"true"},null,8,["tHeaders","tData","field-mapping","actions"]),v(w,{currentRecords:c.value.length,totalRecords:d.value,onUpdateValue:L,onLimitStart:z},null,8,["currentRecords","totalRecords"])]),v(K,{blockArr:S.value,formDescriptions:E.value},null,8,["blockArr","formDescriptions"])]))}},ee=q(Y,[["__scopeId","data-v-134bdf4f"]]);export{ee as default};
