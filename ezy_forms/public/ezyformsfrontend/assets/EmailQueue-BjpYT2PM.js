var U=Object.defineProperty,$=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var k=(r,s,l)=>s in r?U(r,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[s]=l,E=(r,s)=>{for(var l in s||(s={}))V.call(s,l)&&k(r,l,s[l]);if(D)for(var l of D(s))G.call(s,l)&&k(r,l,s[l]);return r},P=(r,s)=>$(r,z(s));import{_ as I,r as o,x as O,E as H,f as J,w as q,K as m,y as S,z as w,o as g,c as p,d as e,b as x,G as A,P as K,t as v,F as W,h as X}from"./index-BC-2e37w.js";const Y={class:""},Z={class:"modal fade",id:"CreateDesignationModal","data-bs-backdrop":"static",tabindex:"-1","aria-hidden":"true"},ee={class:"modal-dialog modal-dialog-centered modal-lg"},te={class:"modal-content"},ae={class:"modal-body"},se={class:"mb-3 sender-div"},ie={type:"text",class:"font-13 m-0 text-secondary"},ne={class:"table table-bordered font-12"},le={class:"font-13"},oe={__name:"EmailQueue",setup(r){const s=o(0),l=o("");o("");const L=o(""),_=o(""),f=o(""),u=o([]),h=o([{th:"message",td_key:"message"},{th:"Sender",td_key:"sender"},{th:"creation",td_key:"creation"},{th:"Status",td_key:"status"}]),C=O(()=>H.value),a=o({limitPageLength:20,limit_start:0,filters:[]});J(()=>{c()});function Q(){l.value="",L.value=""}const M=o({ezy_business_unit:""}),R=o({message:{type:"input"},sender:{type:"input"},creation:{type:"date"},status:{type:"select",options:["Sent","Not Sent","Partially Sent","Sending","Error","Expired"]}}),b=o(null);function j(i){clearTimeout(b.value),b.value=setTimeout(()=>{a.value.filters=[],h.value.forEach(t=>{const n=t.td_key;i[n]&&a.value.filters.push([n,"like",`%${i[n]}%`])}),a.value.limitPageLength=20,a.value.limit_start=0,c(a.value.filters)},500)}const B=i=>{a.value.limitPageLength=i,a.value.limit_start=0,c(a.value.filters)},F=([i,t])=>{a.value.limitPageLength=i,a.value.limit_start=t,c(a.value.filters)};q(C,i=>{M.value.ezy_business_unit=i},{immediate:!0});function c(){const i={fields:JSON.stringify(["name","message","sender","creation","status"]),filters:JSON.stringify(a.value.filters),limit_page_length:a.value.limitPageLength,limit_start:a.value.limit_start,doctype:m.emailQueue,order_by:`\`tab${m.emailQueue}\`.\`creation\` desc`};S.get(w.GetDoctypeData,{params:i}).then(t=>{if(t.message){s.value=t.message.total_count;const n=t.message.data.map(d=>{const y=d.message.match(/Subject:\s*(.*)/),T=y?y[1].trim():"";return P(E({},d),{message:T})});a.value.limit_start===0?u.value=n:u.value=u.value.concat(n)}}).catch(t=>{console.error("Error fetching designations data:",t)})}function N(i,t){f.value=i,S.get(`${w.resource}${m.emailQueue}/${i.name}`).then(n=>{n.data&&(_.value=n.data.recipients,new bootstrap.Modal(document.getElementById("CreateDesignationModal"),{}).show())}).catch(n=>{console.error("Error fetching system settings:",n)})}return(i,t)=>(g(),p("div",null,[t[3]||(t[3]=e("div",{class:"d-flex align-items-center justify-content-between py-3"},[e("div",null,[e("h1",{class:"m-0 font-13"},"Email Queue")])],-1)),e("div",Y,[x(A,{tHeaders:h.value,tData:u.value,isCheckbox:"true",onCellClick:N,isAction:"true",viewType:"viewPdf",isFiltersoption:"true","field-mapping":R.value,onUpdateFilters:j},null,8,["tHeaders","tData","field-mapping"]),x(K,{currentRecords:u.value.length,totalRecords:s.value,onLimitStart:F,"items-per-page":a.value.limitPageLength,onUpdateValue:B},null,8,["currentRecords","totalRecords","items-per-page"])]),e("div",Z,[e("div",ee,[e("div",te,[e("div",{class:"modal-header"},[t[0]||(t[0]=e("h6",{class:"modal-title"},"Email Queue",-1)),e("button",{type:"button",class:"btn-close shadow-none","data-bs-dismiss":"modal",onClick:Q,"aria-label":"Close"})]),e("div",ae,[e("div",se,[t[1]||(t[1]=e("label",{class:"font-13 pe-2 ms-1"},"Sender : ",-1)),e("span",ie,v(f.value.sender),1)]),e("table",ne,[t[2]||(t[2]=e("thead",{class:"emailTable"},[e("tr",null,[e("th",null,"Recipient"),e("th",null,"Status")])],-1)),e("tbody",le,[(g(!0),p(W,null,X(_.value,(n,d)=>(g(),p("tr",{key:d},[e("td",null,v(n.recipient),1),e("td",null,v(n.status),1)]))),128))])])])])])])]))}},de=I(oe,[["__scopeId","data-v-d1eb5309"]]);export{de as default};
