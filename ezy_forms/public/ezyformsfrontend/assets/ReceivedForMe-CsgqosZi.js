import{_ as A,M as S,u as B,x as c,E as F,r as t,f as I,w as U,o as V,c as M,d as u,t as O,b as f,G as T,P as E,y as N,z as j}from"./index-WKIkaBT2.js";const z={class:"d-flex justify-content-between align-items-center py-2"},G={class:"m-0 font-11 pt-1"},H={class:"mt-2"},J={__name:"ReceivedForMe",setup(W){const d=S(),m=B(),y=c(()=>F.value),h=t({business_unit:""}),a=t({limitPageLength:20,limit_start:0,filters:[]}),o=t(0);t([]),t("");const R=t([]);t([]);const p=t([{th:"Request ID",td_key:"name"},{th:"Requested By",td_key:"requester_name"},{th:"Requested on",td_key:"requested_on"},{th:"Requested Department",td_key:"department_name"},{th:"Last Action On",td_key:"modified"},{th:"Approval Status",td_key:"status"},{th:"Pending With",td_key:"assigned_to_users"},{th:"Linked ID",td_key:"linked_form_id"}]),k=t([{name:"View Request",icon:"fa-solid fa-eye"}]);t({}),t(null),t([]);const v=t([]);t([]);const s=t([]);I(()=>{const e=localStorage.getItem("employeeData");v.value=JSON.parse(e)});function q(e,n){n.name==="View Request"&&console.log(e,"rowData")}function P(e,n,l){l==="view"&&d.push({name:"ApproveRequest",query:{routepath:m.path,name:e.name,doctype_name:e.doctype_name,type:"mytasks",designation:v.value.designation}}),l==="td_key"&&e.linked_form_id&&d.push({name:"ApproveRequest",query:{routepath:m.path,name:e.linked_form_id,business_unit:e.property,type:"linkedForm",readOnly:"true"}})}c(()=>R.value.some(e=>e.action==="Request Cancelled")),t([]);const L=c(()=>({name:{type:"input"},requester_name:{type:"input"},department_name:{type:"input"},requested_on:{type:"date"},status:{type:"select",options:["Request Raised","In Progress"]}})),i=t([]),_=t(null),g=t([]);function w(){N.post(j.view_only_reportee).then(e=>{const n=(e.message||[]).filter(l=>l.status!=="Completed"&&l.status!=="Request Cancelled");g.value=n,s.value=[...n],o.value=s.value.length,a.value.limit_start=0,i.value=s.value.slice(0,a.value.limitPageLength)}).catch(e=>{console.error(e)})}t(20);function D(e=s.value){const n=e.slice(a.value.limit_start,a.value.limit_start+a.value.limitPageLength);i.value=n,o.value=e.length}function b(e){clearTimeout(_.value),_.value=setTimeout(()=>{s.value=g.value.filter(n=>p.value.every(l=>{const r=l.td_key;return e[r]?String(n[r]||"").toLowerCase().includes(String(e[r]).toLowerCase()):!0})),o.value=s.value.length,a.value.limitPageLength=20,a.value.limit_start=0,i.value=s.value.slice(0,a.value.limitPageLength)},500)}function C(e){a.value.limitPageLength=e,a.value.limit_start=0,D()}function x(){a.value.limit_start+=a.value.limitPageLength;const e=s.value.slice(a.value.limit_start,a.value.limit_start+a.value.limitPageLength);i.value=[...i.value,...e]}return U(y,e=>{h.value.business_unit=e,e.length&&w()},{immediate:!0}),(e,n)=>(V(),M("div",null,[u("div",z,[u("div",null,[n[0]||(n[0]=u("h1",{class:"m-0 font-13"},"Requests Assigned to me",-1)),u("p",G,O(o.value)+" request",1)])]),u("div",H,[f(T,{tHeaders:p.value,tData:i.value,isAging:"true",isAction:"true",viewType:"viewPdf",isCheckbox:"true",onUpdateFilters:b,"field-mapping":L.value,onCellClick:P,isFiltersoption:"true",actions:k.value,onActionClicked:q},null,8,["tHeaders","tData","field-mapping","actions"]),f(E,{currentRecords:i.value.length,totalRecords:o.value,"items-per-page":a.value.limitPageLength,onUpdateValue:C,onLimitStart:x},null,8,["currentRecords","totalRecords","items-per-page"])])]))}},Q=A(J,[["__scopeId","data-v-b36e12c1"]]);export{Q as default};
