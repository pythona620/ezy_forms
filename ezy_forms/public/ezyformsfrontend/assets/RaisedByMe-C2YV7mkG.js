var Y=Object.defineProperty;var A=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var D=(_,u,i)=>u in _?Y(_,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):_[u]=i,J=(_,u)=>{for(var i in u||(u={}))Z.call(u,i)&&D(_,i,u[i]);if(A)for(var i of A(u))ee.call(u,i)&&D(_,i,u[i]);return _};import{p as te,f as W,d as r,e as se,w as ae,q as oe,o as l,c as n,b as s,t as f,g as c,h as d,a as b,F as R,_ as le,P as ne,E as de,j as ie,l as O,m as V,n as j}from"./index-B-ZWE6ER.js";import{_ as re}from"./ApproverPreview-D5zSuqt1.js";const ue={class:"d-flex justify-content-between align-items-center"},pe={class:"m-0 font-11 pt-1"},ce={class:"d-flex gap-3 align-items-center"},me={class:"d-flex align-items-center"},fe={class:"me-2"},_e={key:0,class:"process-date font-12 m-0"},be={key:1,class:"process-date font-12 m-0"},ve={key:2,class:"process-date font-12 m-0"},ye={key:3,class:"process-date font-12 m-0"},ge={key:4,class:"process-date font-12 m-0"},qe={key:5,class:"process-date font-12 m-0"},we={key:6,class:"process-date font-12 m-0"},ke={type:"button",class:"filterbtn d-flex align-items-center position-relative","data-bs-toggle":"modal","data-bs-target":"#fileterModal"},he={key:0,class:"badge badge-light colorappiled"},Re={class:"modal fade",id:"fileterModal",tabindex:"-1","aria-labelledby":"fileterModalLabel","aria-hidden":"true"},xe={class:"modal-dialog modal-lg"},Se={class:"modal-content"},Fe={class:"modal-body"},Oe={class:"row"},Ve={class:"col-6"},Ce={class:"col-6"},Ne={class:"col-6"},$e={class:"col-6"},Be={class:"col-6"},Ee={class:"modal-footer"},Pe={class:"mt-2"},Me={class:"modal fade",id:"viewRequest","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"viewRequestLabel","aria-hidden":"true"},Ue={class:"modal-dialog modal-dialog-centered modal-lg"},Le={class:"modal-content"},Ae={class:"modal-header py-2 d-block"},De={class:"d-flex justify-content-between align-items-center"},Je={class:""},We={class:"modal-body approvermodalbody"},je={__name:"RaisedByMe",setup(_){const u=W(()=>de.value),i=r({business_unit:""}),y=r({limitPageLength:"None",limit_start:0}),C=r(0),g=r({}),x=r(null),S=r([]),$=r([]),B=r([]),E=r([]),P=r([]),N=r([]),e=se({appliedname:!1,applieddoctype_name:!1,appliedaccessible_departments:!1,appliedStatus:!1,appliedrequest_id:!1,appiedrequestedOn:!1,appliedowner:!1,name:"",doctype_name:"",accessible_departments:"",status:"",request_id:"",requested_on:"",owner:""}),I=r([{th:"Request ID",td_key:"name"},{th:"Form name",td_key:"doctype_name"},{th:"Owner of form",td_key:"owner"},{th:"Requested on",td_key:"requested_on"},{th:"Approval Status",td_key:"status"}]);function T(a,t){var o;if(t.name==="View Request")if(a){g.value=J({},a),x.value=ie(JSON.parse((o=g.value)==null?void 0:o.json_columns).fields),console.log(x.value,"selected Request");const w=[["wf_generated_request_id","like",`%${g.value.name}%`]],q={fields:JSON.stringify(["*"]),limit_page_length:"None",limit_start:0,filters:JSON.stringify(w),order_by:`\`tab${g.value.doctype_name}\`.\`creation\` desc`};O.get(`${V.resource}${g.value.doctype_name}`,{params:q}).then(p=>{p.data&&(S.value=p.data,G(S.value[0],x.value))}).catch(p=>{console.error("Error fetching categories data:",p)}),new bootstrap.Modal(document.getElementById("viewRequest"),{}).show()}else console.warn(" There is no form fields ")}function H(){console.log(S.value[0].name,"ppp");const a={form_short_name:g.value.doctype_name,name:S.value[0].name};O.post(V.download_pdf_form,a).then(t=>{console.log(t,"download pdf")}).catch(t=>{console.error("Error fetching data:",t)})}const z=a=>{P.value=P.value.concat(a)};function G(a,t){t.forEach(o=>{o.sections.forEach(w=>{w.rows.forEach(q=>{q.columns.forEach(k=>{k.fields.forEach(p=>{a.hasOwnProperty(p.fieldname)&&(p.value=a[p.fieldname])})})})})})}const K=r([{name:"View Request",icon:"fa-solid fa-eye"}]),M=W(()=>[{value:e.doctype_name,applied:e.applieddoctype_name},{value:e.name,applied:e.appliedname},{value:e.status,applied:e.appliedStatus},{value:e.accessible_departments,applied:e.appliedaccessible_departments},{value:e.request_id,applied:e.appliedrequest_id},{value:e.requested_on,applied:e.appiedrequestedOn},{value:e.owner,applied:e.appliedowner}].filter(a=>a.applied&&a.value).length);function v(a){a==="name"?(e.name="",e.appliedname=!1):a==="doctype_name"?(e.doctype_name="",e.applieddoctype_name=!1):a==="accessible_departments"?(e.accessible_departments="",e.appliedaccessible_departments=!1):a==="status"?(e.status="",e.appliedStatus=!1):a==="request_id"?(e.request_id="",e.appliedrequest_id=!1):a==="requested_on"?(e.requested_on="",e.appiedrequestedOn=!1):a==="owner"&&(e.owner="",e.appliedowner=!1),U()}function U(){e.appliedname=!!e.name,e.applieddoctype_name=!!e.doctype_name,e.appliedaccessible_departments=!!e.accessible_departments,e.appliedStatus=!!e.status,e.appliedrequest_id=!!e.request_id,e.appiedrequestedOn=!!e.requested_on,e.appliedowner=!!e.owner,F()}const Q=a=>{y.value.limitPageLength=a,y.value.limit_start=0,F()},X=([a,t])=>{y.value.limitPageLength=a,y.value.limit_start=t,F()};function F(){var q,k,p,L;const t=[["requested_by","like",JSON.parse(localStorage.getItem("employeeData")).emp_mail_id],["property","like",`%${i.value.business_unit}%`]];e.name&&t.push(["name","=",e.name]),e.doctype_name&&t.push(["doctype_name","=",e.doctype_name]),e.accessible_departments&&t.push(["accessible_departments","like",e.accessible_departments]),e.status&&t.push(["status","like",e.status]),e.request_id&&t.push(["request_id","like",e.request_id]),e.requested_on&&t.push(["requested_on","like",e.requested_on]),e.owner&&t.push(["owner","like",e.owner]);const o={fields:JSON.stringify(["*"]),limit_page_length:(q=y.value)==null?void 0:q.limitPageLength,limit_start:(k=y.value)==null?void 0:k.limit_start,filters:JSON.stringify(t),order_by:"`tabWF Workflow Requests`.`creation` desc"},w={fields:JSON.stringify(["count(`tabWF Workflow Requests`.`name`) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(t)};O.get(`${(p=V)==null?void 0:p.resource}${(L=j)==null?void 0:L.WFWorkflowRequests}`,{params:w}).then(m=>{C.value=m.data[0].total_count}).catch(m=>{console.error("Error fetching total count:",m)}),O.get(`${V.resource}${j.WFWorkflowRequests}`,{params:o}).then(m=>{N.value=m.data,$.value=[...new Set(m.data.map(h=>h.name))],B.value=[...new Set(m.data.map(h=>h.doctype_name))],E.value=[...new Set(m.data.map(h=>h.status))]}).catch(m=>{console.error("Error fetching records:",m)})}return ae(u,a=>{i.value.business_unit=a,a.length&&(console.log(a,"new value of business unit"),F())},{immediate:!0}),oe(()=>{}),(a,t)=>(l(),n("div",null,[s("div",ue,[s("div",null,[t[14]||(t[14]=s("h1",{class:"m-0 font-13"}," Requests raised for me ",-1)),s("p",pe,f(C.value)+" request ",1)]),s("div",ce,[s("div",me,[s("div",null,[s("div",fe,[e.name&&e.appliedname?(l(),n("span",_e,[c(f(e.name)+" ",1),e.name?(l(),n("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[0]||(t[0]=o=>v("name"))},t[15]||(t[15]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0),e.doctype_name&&e.applieddoctype_name?(l(),n("span",be,[c(f(e.doctype_name)+" ",1),e.doctype_name?(l(),n("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[1]||(t[1]=o=>v("doctype_name"))},t[16]||(t[16]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0),e.accessible_departments&&e.appliedaccessible_departments?(l(),n("span",ve,[c(f(e.accessible_departments)+" ",1),e.accessible_departments?(l(),n("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[2]||(t[2]=o=>v("accessible_departments"))},t[17]||(t[17]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0),e.status&&e.appliedStatus?(l(),n("span",ye,[c(f(e.status)+" ",1),e.status?(l(),n("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[3]||(t[3]=o=>v("status"))},t[18]||(t[18]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0),e.request_id&&e.appliedrequest_id?(l(),n("span",ge,[c(f(e.request_id)+" ",1),e.request_id?(l(),n("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[4]||(t[4]=o=>v("request_id"))},t[19]||(t[19]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0),e.requested_on&&e.appiedrequestedOn?(l(),n("span",qe,[c(f(e.requested_on)+" ",1),e.requested_on?(l(),n("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[5]||(t[5]=o=>v("requested_on"))},t[20]||(t[20]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0),e.owner&&e.appliedowner?(l(),n("span",we,[c(f(e.owner)+" ",1),e.owner?(l(),n("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[6]||(t[6]=o=>v("owner"))},t[21]||(t[21]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0)])]),s("div",null,[s("button",ke,[t[22]||(t[22]=s("span",null,[s("i",{class:"ri-filter-2-line"})],-1)),M.value!==0?(l(),n("span",he," ( "+f(M.value)+") ",1)):d("",!0)])])]),s("div",Re,[s("div",xe,[s("div",Se,[s("div",Fe,[s("div",Oe,[s("div",Ve,[t[23]||(t[23]=s("label",{class:"font-13 ps-1",for:"Requested"},"Request Id:",-1)),b(R,{tag:"select",placeholder:"Requested Id",class:"mb-3",name:"dept",modelValue:e.name,"onUpdate:modelValue":t[7]||(t[7]=o=>e.name=o),id:"id",Required:!1,options:$.value},null,8,["modelValue","options"])]),s("div",Ce,[t[24]||(t[24]=s("label",{class:"font-13 ps-1",for:"Requested"},"Form Name:",-1)),b(R,{tag:"select",placeholder:"Form Name",class:"mb-3",name:"dept",modelValue:e.doctype_name,"onUpdate:modelValue":t[8]||(t[8]=o=>e.doctype_name=o),id:"id",Required:!1,options:B.value},null,8,["modelValue","options"])]),s("div",Ne,[t[25]||(t[25]=s("label",{class:"font-13 ps-1",for:"dept"},"Requested On:",-1)),b(R,{class:"",tag:"input",type:"search",name:"Requested",id:"Requested",placeholder:"Search",modelValue:e.requested_on,"onUpdate:modelValue":t[9]||(t[9]=o=>e.requested_on=o)},null,8,["modelValue"])]),s("div",$e,[t[26]||(t[26]=s("label",{class:"font-13 ps-1",for:"status"},"Status:",-1)),b(R,{tag:"select",placeholder:"Status",class:"mb-3",name:"status",modelValue:e.status,"onUpdate:modelValue":t[10]||(t[10]=o=>e.status=o),id:"status",Required:!1,options:E.value},null,8,["modelValue","options"])]),s("div",Be,[t[27]||(t[27]=s("label",{class:"font-13 ps-1",for:"Requested"},"Owner Of Form:",-1)),b(R,{class:"mb-3",tag:"input",type:"search",name:"Requested",id:"Requested",placeholder:"Search",modelValue:e.owner,"onUpdate:modelValue":t[11]||(t[11]=o=>e.owner=o)},null,8,["modelValue"])])])]),s("div",Ee,[s("button",{type:"button",class:"cancelfilter border-0 text-nowrap font-10",onClick:t[12]||(t[12]=(...o)=>a.resetFilters&&a.resetFilters(...o)),"data-bs-dismiss":"modal"},t[28]||(t[28]=[s("span",{class:"font-14 me-1"},"x",-1),c("Cancel Filter")])),s("button",{type:"button",class:"applyfilter text-nowrap border-0 btn btn-dark text-white font-10 d-flex justify-content-center align-items-center","data-bs-dismiss":"modal",onClick:U},t[29]||(t[29]=[s("span",{class:"font-16 me-1"},[s("i",{class:"bi bi-check2"})],-1),c(" Apply Filter")]))])])])])])]),s("div",Pe,[b(le,{tHeaders:I.value,tData:N.value,isAction:"true",actionType:"dropdown",isCheckbox:"true",actions:K.value,onActionClicked:T},null,8,["tHeaders","tData","actions"]),b(ne,{currentRecords:N.value.length,totalRecords:C.value,onUpdateValue:Q,onLimitStart:X},null,8,["currentRecords","totalRecords"])]),s("div",Me,[s("div",Ue,[s("div",Le,[s("div",Ae,[s("div",De,[t[32]||(t[32]=s("div",null,[s("h5",{class:"m-0 font-13",id:"viewRequest"}," Request ")],-1)),s("div",Je,[s("button",{button:"button",class:"btn btn-white text-dark font-13",onClick:H},t[30]||(t[30]=[c("Download Pdf"),s("span",{class:"ms-2"},[s("i",{class:"bi bi-download"})],-1)])),s("button",{type:"button",class:"btn btn-white text-dark font-13",onClick:t[13]||(t[13]=(...o)=>a.closemodal&&a.closemodal(...o)),"data-bs-dismiss":"modal"},t[31]||(t[31]=[c("Close "),s("i",{class:"bi bi-x"},null,-1)]))])])]),s("div",We,[b(re,{blockArr:x.value,onUpdateField:z},null,8,["blockArr"])])])])])]))}},ze=te(je,[["__scopeId","data-v-c376e680"]]);export{ze as default};
