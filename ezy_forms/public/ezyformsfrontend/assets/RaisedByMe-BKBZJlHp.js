import{_ as E,x as g,E as T,M as U,r as n,u as I,w as O,o as N,c as j,d as a,t as H,b as h,G,P as z,m as b,y as k,z as w,J}from"./index-qwBzNCai.js";const W={class:"d-flex justify-content-between align-items-center py-2"},K={class:"m-0 font-11 pt-1"},Q={class:"mt-2"},X={class:"modal fade",id:"pdfView",tabindex:"-1","aria-labelledby":"pdfViewLabel","aria-hidden":"true"},Y={class:"modal-dialog modal-xl"},Z={class:"modal-content"},$={class:"modal-header py-2 d-block bg-dark text-white"},ee={class:"d-flex justify-content-between align-items-center"},te={class:""},ae={class:"modal-body pdf-body"},se=["innerHTML"],ie={__name:"RaisedByMe",setup(ne){const c=g(()=>T.value),p=U(),v=n({business_unit:""}),s=n({limitPageLength:20,limit_start:0,filters:{}}),d=n(0),P=n({}),R=n([]);n([]);const o=n([]),q=n(""),_=I(),f=n(null),y=n([{th:"Request ID",td_key:"name"},{th:"Form Name",td_key:"doctype_name"},{th:"Requested on",td_key:"requested_on"},{th:"Last Action On",td_key:"modified"},{th:"Approval Status",td_key:"status"},{th:"Pending With",td_key:"assigned_to_users"},{th:"Linked ID",td_key:"linked_form_id"}]),L=n([{name:"View Request",icon:"fa-solid fa-eye"},{name:"PDF Format",icon:"bi bi-filetype-pdf"}]);function x(e,t,i){i==="view"&&p.push({name:"ApproveRequest",query:{routepath:_.path,name:e.name,doctype_name:e.doctype_name,business_unit:e.property,status:e.status,type:"myforms",readOnly:"true"}}),i==="td_key"&&e.linked_form_id&&p.push({name:"ApproveRequest",query:{routepath:_.path,name:e.linked_form_id,business_unit:e.property,type:"linkedForm",readOnly:"true"}})}function D(e,t){t.name==="View Request"?console.log(e,"rowData"):t.name}function C(){var t;const e={form_short_name:P.value.doctype_name,name:(t=R.value[0])==null?void 0:t.name,business_unit:c.value};k.post(w.download_pdf_form,e).then(i=>{let u=J+i.message;u=u.replace("/api","");const m=document.createElement("a");m.href=u,m.download=i.message.split("/").pop(),m.click()}).catch(i=>{console.error("Error fetching data:",i)})}const r=n([]),l=n([]);function F(){const t={employee:JSON.parse(localStorage.getItem("employeeData")).emp_mail_id,requested_by_me:"1",property_field:v.value.business_unit};k.get(w.GetEmployeeForms,{params:t}).then(i=>{r.value=i.message||[],l.value=[...r.value],d.value=l.value.length,s.value.limit_start=0,o.value=l.value.slice(0,s.value.limitPageLength)}).catch(i=>{console.error(i)})}function M(e=l.value){const t=e.slice(s.value.limit_start,s.value.limit_start+s.value.limitPageLength);o.value=t,d.value=e.length}function S(e){clearTimeout(f.value),f.value=setTimeout(()=>{l.value=r.value.filter(t=>y.value.every(i=>{const u=i.td_key;return e[u]?String(t[u]||"").toLowerCase().includes(String(e[u]).toLowerCase()):!0})),d.value=l.value.length,s.value.limitPageLength=20,s.value.limit_start=0,o.value=l.value.slice(0,s.value.limitPageLength)},500)}function B(e){s.value.limitPageLength=e,s.value.limit_start=0,M()}function V(){s.value.limit_start+=s.value.limitPageLength;const e=l.value.slice(s.value.limit_start,s.value.limit_start+s.value.limitPageLength);o.value=[...o.value,...e]}const A=g(()=>({status:{type:"select",options:["Request Raised","In Progress","Completed","Request Cancelled"]},name:{type:"input"},doctype_name:{type:"input"},requested_on:{type:"date"},role:{type:"input"},modified:{type:"date"},requester_name:{type:"input"},department_name:{type:"input"}}));return O(c,e=>{v.value.business_unit=e,e.length&&F()},{immediate:!0}),(e,t)=>(N(),j("div",null,[a("div",W,[a("div",null,[t[1]||(t[1]=a("h1",{class:"m-0 font-13"},"Requests Submitted",-1)),a("p",K,H(d.value)+" request",1)])]),a("div",Q,[h(G,{tHeaders:y.value,tData:o.value,isAging:"true",isAction:"true",isCheckbox:"true",viewType:"viewPdf",onCellClick:x,actions:L.value,onActionClicked:D,isFiltersoption:"true","field-mapping":A.value,onUpdateFilters:S},null,8,["tHeaders","tData","actions","field-mapping"]),h(z,{currentRecords:o.value.length,totalRecords:d.value,"items-per-page":s.value.limitPageLength,onUpdateValue:B,onLimitStart:V},null,8,["currentRecords","totalRecords","items-per-page"])]),a("div",X,[a("div",Y,[a("div",Z,[a("div",$,[a("div",ee,[t[4]||(t[4]=a("div",null,[a("h5",{class:"m-0 text-white font-13",id:"exampleModalLabel"}," PDF format ")],-1)),a("div",te,[a("button",{button:"button",class:"btn btn-dark text-white font-13",onClick:C},t[2]||(t[2]=[b(" Download Pdf"),a("span",{class:"ms-2"},[a("i",{class:"bi bi-download"})],-1)])),a("button",{type:"button",class:"btn btn-dark text-white font-13",onClick:t[0]||(t[0]=(...i)=>e.closemodal&&e.closemodal(...i)),"data-bs-dismiss":"modal"},t[3]||(t[3]=[b(" Close "),a("i",{class:"bi bi-x"},null,-1)]))])])]),a("div",ae,[a("div",{innerHTML:q.value},null,8,se)]),t[5]||(t[5]=a("div",{class:"modal-footer"},null,-1))])])])]))}},oe=E(ie,[["__scopeId","data-v-46003215"]]);export{oe as default};
