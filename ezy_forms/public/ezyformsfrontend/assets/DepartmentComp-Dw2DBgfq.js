var le=Object.defineProperty,oe=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var F=(p,d,u)=>d in p?le(p,d,{enumerable:!0,configurable:!0,writable:!0,value:u}):p[d]=u,L=(p,d)=>{for(var u in d||(d={}))re.call(d,u)&&F(p,u,d[u]);if(U)for(var u of U(d))de.call(d,u)&&F(p,u,d[u]);return p},B=(p,d)=>oe(p,ie(d));import{q as me,e as ue,d as m,D as ce,w as pe,o as i,c as r,b as t,a as v,F as z,v as _e,x as w,t as h,h as E,s as ve,B as $,z as P,A,G as I,j,_ as ye,P as fe,E as ge,l as C,m as k,p as b,k as O,C as be}from"./index-DXneRfP_.js";import{s as he}from"./vue-multiselect.min.css_vue_type_style_index_0_src_true_lang-BBX7B8I1.js";const Ce={class:"d-flex justify-content-between align-items-center py-2"},ke={class:"d-flex gap-2 align-items-center"},De={class:"modal fade",id:"createDepartments",tabindex:"-1","aria-labelledby":"createDepartmentsLabel","aria-hidden":"true"},ze={class:"modal-dialog modal-lg"},Ve={class:"modal-content"},we={class:"modal-body"},Ee={class:"d-flex align-items-center gap-2"},$e={class:"w-100"},xe={key:0},Ne={class:"table mt-3 global-table"},Se={key:0},Ue={key:1},Fe=["onChange"],Le={class:"text-center"},Be=["onClick"],Pe=["onClick"],Ae=["onClick"],Ie={class:"modal-footer"},je=["disabled"],Oe={class:"mt-2"},Re={class:"modal fade",id:"viewCategory","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"viewCategoryLabel","aria-hidden":"true"},Te={class:"modal-dialog"},qe={class:"modal-content"},Je={class:"modal-body"},Me={class:"d-flex w-100 gap-3"},He={key:0,class:"table mt-3 global-table"},Ge={key:0},Ke={key:1},Qe=["onChange"],We={class:"text-center"},Xe=["onClick"],Ye=["onClick"],Ze=["onClick"],et={class:"modal-footer"},tt={__name:"DepartmentComp",setup(p){const d=ue(()=>ge.value),u=m(0),V=m([]);m(["yes","no"]);const R=m([]),_=m(""),y=m(null),c=m("");m([]);const f=m({ezy_departments_items:[]}),T=m([]),q=m([{name:"View Categories",icon:"fa-solid fa-eye"}]),g=m({limitPageLength:"None",limit_start:0}),J=a=>{g.value.limitPageLength=a,g.value.limit_start=0,fetchTable()},M=([a,e])=>{g.value.limitPageLength=a,g.value.limit_start=e,fetchTable()};function H(a,e){e.name==="View Categories"&&(a?(C.get(`${k.resource}${b.departments}/${a.name}`).then(s=>{s.data&&(f.value=s.data)}).catch(s=>{console.error("Error fetching categories data:",s)}),new bootstrap.Modal(document.getElementById("viewCategory"),{}).show()):(console.warn("No form fields provided."),formCreation(a)))}const x=m([{th:"Name",td_key:"name"},{th:"Department Code",td_key:"department_code"},{th:"Department Name",td_key:"department_name"},{th:"Business Unit",td_key:"business_unit"}]),G=m({department_code:{type:"input"},department_name:{type:"input"},form_category:{type:"select",options:["Software","Hardware"]}}),o=m({department_code:"",department_name:"",business_unit:"",ezy_departments_items:[]});ce({applieddepartment_name:!1,applieddepartment_code:!1,department_name:"",department_code:""}),pe(d,a=>{o.value.business_unit=a,a.length&&D()},{immediate:!0});function K(){_.value&&(o.value.ezy_departments_items.push({category:_.value,parentfield:"ezy_departments_items"}),_.value="")}function Q(){_.value&&(f.value.ezy_departments_items.push({category:_.value,parentfield:"ezy_departments_items"}),_.value="")}function W(a,e){y.value=a,c.value=e}function N(a){c.value.trim()&&(o.value.ezy_departments_items[a].category=c.value,y.value=null,c.value="")}function X(a){o.value.ezy_departments_items.splice(a,1)}function Y(a,e){y.value=a,c.value=e}function S(a){c.value.trim()&&(f.value.ezy_departments_items[a].category=c.value,y.value=null,c.value="")}function Z(a){f.value.ezy_departments_items.splice(a,1)}function ee(){C.put(`${k.resource}${b.departments}/${f.value.name}`,f.value).then(a=>{O.success("Changes Saved",{autoClose:500,transition:"zoom"}),bootstrap.Modal.getInstance(document.getElementById("viewCategory")).hide()}).catch(a=>{console.error("Error saving categories:",a)})}function te(a){const e=[];x.value.forEach(n=>{const s=n.td_key;a[s]&&e.push(s,"like",`%${a[s]}%`)}),e.length?D(e):D()}function D(a){const e=[["business_unit","like",`%${o.value.business_unit}%`]];a&&e.push(a);const n={fields:JSON.stringify(["*"]),filters:JSON.stringify(e),limit_page_length:g.value.limitPageLength,limit_start:g.value.limit_start,order_by:"`tabEzy Departments`.`creation` desc"},s={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(e)};C.get(`${k.resource}${b.departments}`,{params:s}).then(l=>{u.value=l.data[0].total_count}).catch(l=>{console.error("Error fetching ezyForms data:",l)}),C.get(k.resource+b.departments,{params:n}).then(l=>{l.data&&(V.value=l.data,T.value=[...new Set(l.data.map(ne=>ne.department_name))])}).catch(l=>{console.error("Error fetching department data:",l)})}function ae(){o.value={department_code:"",department_name:"",ezy_departments_items:[]},o.value.business_unit=d.value}function se(){const a=B(L({},o.value),{doctype:b.departments});C.post(k.resource+b.departments,a).then(e=>{e.data&&(O.success("Department Created",{autoClose:500,transition:"zoom"}),D(),o.value={department_code:"",department_name:"",ezy_departments_items:[]})})}return(a,e)=>(i(),r("div",null,[t("div",Ce,[e[16]||(e[16]=t("div",null,[t("h1",{class:"m-0 font-13"}," Departments ")],-1)),t("div",ke,[e[15]||(e[15]=t("div",{class:"d-flex align-items-center"},[t("button",{type:"button",class:"btn btn-dark buttoncomp CreateDepartments d-flex align-items-center","data-bs-toggle":"modal","data-bs-target":"#createDepartments"}," Create Department ")],-1)),t("div",De,[t("div",ze,[t("div",Ve,[t("div",we,[e[10]||(e[10]=t("label",{class:"font-13 ps-1",for:"DepartmentCode"},"Department Code",-1)),v(z,{class:"mb-3",tag:"input",type:"text",name:"DepartmentCode",id:"DepartmentCode",placeholder:"Enter department code",modelValue:o.value.department_code,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.department_code=n)},null,8,["modelValue"]),e[11]||(e[11]=t("label",{class:"font-13 ps-1",for:"Requedepartment_namested"},"Department name",-1)),v(z,{class:"mb-3",tag:"input",type:"text",name:"department_name",id:"department_name",placeholder:"Enter department name",modelValue:o.value.department_name,"onUpdate:modelValue":e[1]||(e[1]=n=>o.value.department_name=n)},null,8,["modelValue"]),e[12]||(e[12]=t("label",{class:"font-13 ps-1",for:"business_unit"},"Business Unit",-1)),v(ve(he),{modelValue:o.value.business_unit,"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.business_unit=n),options:R.value,multiple:!1,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Business unit",class:"font-11 mb-3"},{selection:_e(({values:n,isOpen:s})=>[n.length?w((i(),r("span",{key:0,class:"multiselect__single font-10"},h(n.join(", ")),513)),[[be,!s]]):E("",!0)]),_:1},8,["modelValue","options"]),t("div",Ee,[t("div",$e,[e[8]||(e[8]=t("label",{class:"font-13 ps-1",for:"ezy_departments_items"},"ADD Department Categories ",-1)),v(z,{class:"mb-3",tag:"input",type:"text",name:"ezy_departments_items",id:"ezy_departments_items",placeholder:"Enter category",modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=n=>_.value=n)},null,8,["modelValue"])]),v($,{class:"buttoncomp mt-2",name:"Add",onClick:K})]),o.value.ezy_departments_items.length>0?(i(),r("div",xe,[t("table",Ne,[e[9]||(e[9]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Category Name"),t("th",{class:"text-center"},"Actions")])],-1)),t("tbody",null,[(i(!0),r(P,null,A(o.value.ezy_departments_items,(n,s)=>(i(),r("tr",{key:s},[t("td",null,h(s+1),1),y.value!==s?(i(),r("td",Se,h(n.category),1)):(i(),r("td",Ue,[w(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=l=>c.value=l),onChange:l=>N(s),placeholder:"Edit Category"},null,40,Fe),[[I,c.value]])])),t("td",Le,[y.value!==s?(i(),r("i",{key:0,class:"bi bi-pencil",onClick:l=>W(s,n.category)},null,8,Be)):(i(),r("i",{key:1,class:"bi bi-check font-20",onClick:l=>N(s)},null,8,Pe)),t("i",{class:"bi bi-trash ms-2",onClick:l=>X(s)},null,8,Ae)])]))),128))])])])):E("",!0)]),t("div",Ie,[t("button",{type:"button",class:"cancelfilter border-1 text-nowrap font-10 d-flex justify-content-center align-items-center",onClick:ae,"data-bs-dismiss":"modal"},e[13]||(e[13]=[t("span",{class:"font-16 me-1"},[t("i",{class:"bi bi-x"})],-1),j("Cancel ")])),t("button",{type:"button",class:"applyfilter btn btn-dark text-nowrap font-10 d-flex justify-content-center align-items-center","data-bs-dismiss":"modal",disabled:!o.value.department_code||!o.value.department_name||!o.value.business_unit,onClick:se},e[14]||(e[14]=[t("span",{class:"font-16 me-1"},[t("i",{class:"bi bi-check2"})],-1),j(" Create Department")]),8,je)])])])])])]),t("div",Oe,[v(ye,{tHeaders:x.value,tData:V.value,onActionClicked:H,isAction:"true",actions:q.value,actionType:"dropdown",isCheckbox:"true",isFiltersoption:"true","field-mapping":G.value,onUpdateFilters:te},null,8,["tHeaders","tData","actions","field-mapping"]),v(fe,{currentRecords:V.value.length,totalRecords:u.value,onUpdateValue:J,onLimitStart:M},null,8,["currentRecords","totalRecords"])]),t("div",Re,[t("div",Te,[t("div",qe,[e[18]||(e[18]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"viewCategoryLabel"},"Departments Items"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Je,[t("div",Me,[v(z,{class:"w-100",tag:"input",type:"text",name:"ezy_departments_items",id:"ezy_departments_items",placeholder:"Enter category",modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=n=>_.value=n)},null,8,["modelValue"]),v($,{class:"buttoncomp",name:"Add",onClick:Q})]),f.value.ezy_departments_items.length>0?(i(),r("table",He,[e[17]||(e[17]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Category Name"),t("th",{class:"text-center"},"Actions")])],-1)),t("tbody",null,[(i(!0),r(P,null,A(f.value.ezy_departments_items,(n,s)=>(i(),r("tr",{key:s},[t("td",null,h(s+1),1),y.value!==s?(i(),r("td",Ge,h(n.category),1)):(i(),r("td",Ke,[w(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=l=>c.value=l),onChange:l=>S(s),placeholder:"Edit Category"},null,40,Qe),[[I,c.value]])])),t("td",We,[y.value!==s?(i(),r("i",{key:0,class:"bi bi-pencil",onClick:l=>Y(s,n.category)},null,8,Xe)):(i(),r("i",{key:1,class:"bi bi-check font-20",onClick:l=>S(s)},null,8,Ye)),t("i",{class:"bi bi-trash ms-2",onClick:l=>Z(s)},null,8,Ze)])]))),128))])])):E("",!0)]),t("div",et,[v($,{class:"btn btn-dark font-11",name:"Save Categories",onClick:e[7]||(e[7]=n=>ee())})])])])])]))}},lt=me(tt,[["__scopeId","data-v-80b11c4b"]]);export{lt as default};
