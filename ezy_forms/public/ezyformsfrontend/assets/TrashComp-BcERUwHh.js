import{_ as q,r as o,M as O,x as $,E as U,e as V,u as B,f as J,w as j,y as m,z as f,K as p,o as H,c as I,d as u,t as M,b as v,G,P as w,Y as K,H as E}from"./index-D_k4ZnJS.js";const Y={class:"d-flex formsticky align-items-center justify-content-between py-2"},Q={class:"m-0 font-11 pt-1"},W={class:"mt-2"},X={__name:"TrashComp",setup(Z){const d=o(0),S=o({}),c=o([]),b=o([]);o([]);const C=o([]),_=O(),P=o(null),h=$(()=>U.value);V([]);const y=B();J(()=>{});function T(e,t,i){const n=e.enable=="1"||e.enable===1,s=n?"delete":"restore";confirm(`Are you sure you want to ${s} this Form?`)&&(e.enable=n?0:1,m.put(`${f.resource}${p.EzyFormDefinitions}/${e.name}`,e).then(l=>{E(`Form ${s}d successfully`),setTimeout(()=>{r()},1e3)}).catch(l=>{console.error("Error updating toggle:",l)}))}function x(e,t){if(t.name==="View form"&&(e!=null&&e.form_json?_.push({name:"FormPreviewComp",query:{routepath:y.path,form_short_name:e.form_short_name}}):(console.warn(" There is no form fields "),k(e))),t.name==="Edit Form"&&k(e),t.name==="Active this form"&&e){const i=e.enable=="1"||e.enable===1,n=i?"delete":"Active";confirm(`Are you sure you want to ${n}  ${e.name} Form?`)&&(e.enable=i?0:1,m.put(`${f.resource}${p.EzyFormDefinitions}/${e.name}`,e).then(s=>{E(`Form ${n}d successfully`),setTimeout(()=>{r()},1e3)}).catch(s=>{console.error("Error updating toggle:",s)}))}}const A=o([{name:"View form",icon:"fa-solid fa-eye"}]),a=o({limit_start:0,limitPageLength:20,form_name:"",form_short_name:"",accessible_departments:"[]",business_unit:"",form_category:"",owner_of_the_form:"",search:""});j(h,e=>{a.value.business_unit=e,e.length&&(c.value=[],r())},{immediate:!0});const F=o([{th:"Name",td_key:"name"},{th:"Form name",td_key:"form_name"},{th:"Form category",td_key:"form_category"},{th:"Accessible departments",td_key:"accessible_departments"},{th:"Status",td_key:"form_status"},{th:"Enable/Disable",td_key:"enable"}]);function k(e=null){e==null?_.push({name:"FormStepper",query:{routepath:y.path,business_unit:h.value}}):_.push({name:"FormStepper",params:{paramid:e.name},query:{routepath:y.path,business_unit:h.value,id:e.name}})}const z=e=>{a.value.limitPageLength=e,a.value.limit_start=0,r()},L=([e,t])=>{a.value.limitPageLength=e,a.value.limit_start=t,r()};function N(e){const t=[];F.value.forEach(i=>{const n=i.td_key;e[n]&&t.push(n,"like",`%${e[n]}%`)}),t.length?r(t):r()}function r(e){const t=[["business_unit","=",`${a.value.business_unit}`],["enable","=",0]];e&&t.push(e);const i={fields:JSON.stringify(["*"]),filters:JSON.stringify(t),limit_page_length:a.value.limitPageLength,limit_start:a.value.limit_start,order_by:"`tabEzy Form Definitions`.`creation` desc"},n={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(t)};m.get(`${f.resource}${p.EzyFormDefinitions}`,{params:n}).then(s=>{d.value=s.data[0].total_count}).catch(s=>{console.error("Error fetching ezyForms data:",s)}),m.get(`${f.resource}${p.EzyFormDefinitions}`,{params:i}).then(s=>{const l=s.data;a.value.limit_start===0?(c.value=l,b.value=[...new Set(l.map(g=>g.form_category))],C.value=[...new Set(l.map(g=>g.owner_of_the_form))]):c.value=c.value.concat(l)}).catch(s=>{console.error("Error fetching ezyForms data:",s)})}const R=$(()=>({form_category:{type:"select",options:b.value},name:{type:"input"},owner_of_the_form:{type:"input"}}));return(e,t)=>(H(),I("div",null,[u("div",Y,[u("div",null,[t[0]||(t[0]=u("h1",{class:"m-0 font-13"},"Forms in Trash",-1)),u("p",Q,M(d.value)+" forms available",1)]),t[1]||(t[1]=u("div",{class:"d-flex align-items-center gap-2"},null,-1))]),u("div",W,[v(G,{tHeaders:F.value,tData:c.value,isAction:"true",actionType:"dropdown",enableDisable:"true",onActionClicked:x,onToggleClick:T,isFiltersoption:"true","field-mapping":R.value,actions:A.value,onUpdateFilters:N,isCheckbox:"true"},null,8,["tHeaders","tData","field-mapping","actions"]),v(w,{currentRecords:c.value.length,totalRecords:d.value,onUpdateValue:z,onLimitStart:L},null,8,["currentRecords","totalRecords"])]),v(K,{blockArr:P.value,formDescriptions:S.value},null,8,["blockArr","formDescriptions"])]))}},ee=q(X,[["__scopeId","data-v-0733a90d"]]);export{ee as default};
