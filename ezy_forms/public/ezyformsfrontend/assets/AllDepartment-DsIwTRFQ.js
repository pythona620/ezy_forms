var T=Object.defineProperty;var N=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var $=(n,o,i)=>o in n?T(n,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[o]=i,P=(n,o)=>{for(var i in o||(o={}))J.call(o,i)&&$(n,i,o[i]);if(N)for(var i of N(o))D.call(o,i)&&$(n,i,o[i]);return n};import{d as c,e as H,f as w,w as I,o as r,c as d,b as s,t as f,g as b,h as m,a as u,F as y,_ as Y,P as G,i as K,E as Q,j as W,k as X,l as A,m as q,n as E}from"./index-B-ZWE6ER.js";import{F as Z}from"./FormPreview-BWxa4xB1.js";const ee={class:"d-flex justify-content-between align-items-center"},te={class:"m-0 font-13"},se={class:"m-0 font-11 pt-1"},ae={class:"d-flex gap-2 align-items-center"},le={class:"d-flex align-items-center"},oe={class:"me-2"},ie={key:0,class:"process-date font-12 m-0"},ne={key:1,class:"process-date font-12 m-0"},re={key:2,class:"process-date font-12 m-0"},de={key:3,class:"process-date font-12 m-0"},ce={type:"button",class:"filterbtn d-flex align-items-center position-relative","data-bs-toggle":"modal","data-bs-target":"#fileterModal"},me={key:0,class:"badge badge-light colorappiled"},pe={class:"modal fade",id:"fileterModal",tabindex:"-1","aria-labelledby":"fileterModalLabel","aria-hidden":"true"},fe={class:"modal-dialog modal-lg"},ue={class:"modal-content"},ve={class:"modal-body"},be={class:"row"},_e={class:"col-6"},ge={class:"col-6"},ye={class:"col-6"},he={class:"col-6"},ke={class:"modal-footer"},xe={class:"mt-3"},Ce={__name:"AllDepartment",props:["id"],setup(n){const o=c(0),i=c([{th:"Form name",td_key:"form_name"},{th:"Form category",td_key:"form_category"},{th:"Accessible departments",td_key:"accessible_departments"},{th:"Status",td_key:"active"}]),_=n,k=c({}),x=c(null),h=c([]),F=c([]),t=H({appliedform_name:!1,appliedform_category:!1,appliedaccessible_departments:!1,appliedStatus:!1,form_name:"",form_category:"",accessible_departments:"",active:""}),S=w(()=>[{value:t.form_category,applied:t.appliedform_category},{value:t.form_name,applied:t.appliedform_name},{value:t.active,applied:t.appliedStatus},{value:t.accessible_departments,applied:t.appliedaccessible_departments}].filter(a=>a.applied&&a.value).length);function g(a){a==="form_name"?(t.form_name="",t.appliedform_name=!1):a==="form_category"?(t.form_category="",t.appliedform_category=!1):a==="accessible_departments"?(t.accessible_departments="",t.appliedaccessible_departments=!1):a==="active"&&(t.active="",t.appliedStatus=!1),C()}const L=w(()=>Q.value),V=c({business_unit:""}),v=c({limitPageLength:"None",limit_start:0}),B=c([{name:"View form",icon:"fa-solid fa-eye"}]);function U(a,e){e.name==="View form"&&(a!=null&&a.form_json?(k.value=P({},a),x.value=W(JSON.parse(a==null?void 0:a.form_json).fields),new bootstrap.Modal(document.getElementById("formViewModal"),{}).show()):X.warn(" There is no form fields "))}function C(){t.appliedform_name=!!t.form_name,t.appliedform_category=!!t.form_category,t.appliedaccessible_departments=!!t.accessible_departments,t.appliedStatus=!!t.active,R()}I([()=>L.value,()=>_.id],([a,e])=>{V.value.business_unit=a,a.length&&e&&R(e||_.id)},{immediate:!0});const O=a=>{v.value.limitPageLength=a,v.value.limit_start=0,fetchTable()},j=([a,e])=>{v.value.limitPageLength=a,v.value.limit_start=e,fetchTable()};function R(a){const e=[["business_unit","like",`%${V.value.business_unit}%`]];_.id&&e.push(["owner_of_the_form","like",`%${_.id}%`]),t.form_name&&e.push(["form_name","like",`${t.form_name}`]),t.form_category&&e.push(["form_category","like",`${t.form_category}`]),t.accessible_departments&&e.push(["accessible_departments","like",`${t.accessible_departments}`]),t.active&&e.push(["active","=",`${t.active}`]);const l={fields:JSON.stringify(["*"]),limit_page_length:v.value.limitPageLength,limit_start:v.value.limit_start,filters:JSON.stringify(e),order_by:"`tabEzy Form Definitions`.`creation` desc"},z={fields:JSON.stringify(["count( `tabEzy Form Definitions`.`name`) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(e)};A.get(`${q.resource}${E.EzyFormDefinitions}`,{params:z}).then(p=>{o.value=p.data[0].total_count}).catch(p=>{console.error("Error fetching ezyForms data:",p)}),A.get(`${q.resource}${E.EzyFormDefinitions}`,{params:l}).then(p=>{h.value=p.data,F.value=[...new Set(p.data.map(M=>M.form_category))]}).catch(p=>{console.error("Error fetching department details:",p)})}return(a,e)=>(r(),d("div",null,[s("div",null,[s("div",ee,[s("div",null,[s("h1",te," Forms in "+f(n.id),1),s("p",se,f(o.value)+" forms available ",1)]),s("div",ae,[s("div",le,[s("div",null,[s("div",oe,[t.form_name&&t.appliedform_name?(r(),d("span",ie,[b(f(t.form_name)+" ",1),t.form_name?(r(),d("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:e[0]||(e[0]=l=>g("form_name"))},e[9]||(e[9]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):m("",!0)])):m("",!0),t.form_category&&t.appliedform_category?(r(),d("span",ne,[b(f(t.form_category)+" ",1),t.form_category?(r(),d("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:e[1]||(e[1]=l=>g("form_category"))},e[10]||(e[10]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):m("",!0)])):m("",!0),t.accessible_departments&&t.appliedaccessible_departments?(r(),d("span",re,[b(f(t.accessible_departments)+" ",1),t.accessible_departments?(r(),d("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:e[2]||(e[2]=l=>g("accessible_departments"))},e[11]||(e[11]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):m("",!0)])):m("",!0),t.active&&t.appliedStatus?(r(),d("span",de,[b(f(t.active)+" ",1),t.active?(r(),d("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:e[3]||(e[3]=l=>g("active"))},e[12]||(e[12]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):m("",!0)])):m("",!0)])]),s("div",null,[s("button",ce,[e[13]||(e[13]=s("span",null,[s("i",{class:"ri-filter-2-line"})],-1)),S.value!==0?(r(),d("span",me," ( "+f(S.value)+") ",1)):m("",!0)])])]),s("div",pe,[s("div",fe,[s("div",ue,[s("div",ve,[s("div",be,[s("div",_e,[e[14]||(e[14]=s("label",{class:"font-13 ps-1",for:"Requested"},"Form Name:",-1)),u(y,{class:"mb-3",tag:"input",type:"search",name:"Requested",id:"Requested",placeholder:"Search",modelValue:t.form_name,"onUpdate:modelValue":e[4]||(e[4]=l=>t.form_name=l)},null,8,["modelValue"])]),s("div",ge,[e[15]||(e[15]=s("label",{class:"font-13 ps-1",for:"dept"},"Form Category:",-1)),u(y,{tag:"select",placeholder:"Form Category",class:"mb-3",name:"dept",modelValue:t.form_category,"onUpdate:modelValue":e[5]||(e[5]=l=>t.form_category=l),id:"dept",Required:!1,options:F.value},null,8,["modelValue","options"])]),s("div",ye,[e[16]||(e[16]=s("label",{class:"font-13 ps-1",for:"dept"},"Accessible departments:",-1)),u(y,{class:"",tag:"input",type:"search",name:"Requested",id:"Requested",placeholder:"Search",modelValue:t.accessible_departments,"onUpdate:modelValue":e[6]||(e[6]=l=>t.accessible_departments=l)},null,8,["modelValue"]),e[17]||(e[17]=s("span",{class:"m-0 font-10 ps-2"},"Note:Please seperate departments with commas",-1))]),s("div",he,[e[18]||(e[18]=s("label",{class:"font-13 ps-1",for:"dept"},"Status:",-1)),u(y,{tag:"select",placeholder:"Status",class:"mb-3",name:"dept",modelValue:t.active,"onUpdate:modelValue":e[7]||(e[7]=l=>t.active=l),id:"dept",Required:!1,options:["Yes","No"]},null,8,["modelValue"])])])]),s("div",ke,[s("button",{type:"button",class:"cancelfilter border-0 text-nowrap font-10",onClick:e[8]||(e[8]=(...l)=>a.resetFilters&&a.resetFilters(...l)),"data-bs-dismiss":"modal"},e[19]||(e[19]=[s("span",{class:"font-14 me-1"},"x",-1),b("Cancel Filter")])),s("button",{type:"button",class:"applyfilter btn btn-dark text-nowrap border-0 text-white font-10 d-flex justify-content-center align-items-center","data-bs-dismiss":"modal",onClick:C},e[20]||(e[20]=[s("span",{class:"font-16 me-1"},[s("i",{class:"bi bi-check2"})],-1),b(" Apply Filter")]))])])])])])]),s("div",xe,[u(Y,{tHeaders:i.value,tData:h.value,isCheckbox:"true",isAction:"true",actionType:"dropdown",onActionClicked:U,actions:B.value},null,8,["tHeaders","tData","actions"]),u(G,{currentRecords:h.value.length,totalRecords:o.value,onUpdateValue:O,onLimitStart:j},null,8,["currentRecords","totalRecords"])])]),e[21]||(e[21]=K('<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel"><div class="offcanvas-header"><h5 class="offcanvas-title" id="offcanvasRightLabel">Asset Request Form</h5><button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button></div><div class="offcanvas-body"><div class="d-flex gap-3 align-items-baseline position-relative"><div class="d-flex flex-column"><span><i class="ri-checkbox-blank-circle-fill dashedcircle"></i></span><div class="dashed_line mt-4"></div></div><div>data</div></div></div></div>',1)),u(Z,{blockArr:x.value,formDescriptions:k.value},null,8,["blockArr","formDescriptions"])]))}};export{Ce as default};
