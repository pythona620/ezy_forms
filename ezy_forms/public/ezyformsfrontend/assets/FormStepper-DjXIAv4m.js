var Hl=Object.defineProperty,jl=Object.defineProperties;var Wl=Object.getOwnPropertyDescriptors;var gt=Object.getOwnPropertySymbols;var as=Object.prototype.hasOwnProperty,ns=Object.prototype.propertyIsEnumerable;var os=(H,U,B)=>U in H?Hl(H,U,{enumerable:!0,configurable:!0,writable:!0,value:B}):H[U]=B,re=(H,U)=>{for(var B in U||(U={}))as.call(U,B)&&os(H,B,U[B]);if(gt)for(var B of gt(U))ns.call(U,B)&&os(H,B,U[B]);return H},Ne=(H,U)=>jl(H,Wl(U));var Lt=(H,U)=>{var B={};for(var T in H)as.call(H,T)&&U.indexOf(T)<0&&(B[T]=H[T]);if(H!=null&&gt)for(var T of gt(H))U.indexOf(T)<0&&ns.call(H,T)&&(B[T]=H[T]);return B};var Qe=(H,U,B)=>new Promise((T,q)=>{var ne=ee=>{try{h(B.next(ee))}catch(le){q(le)}},ye=ee=>{try{h(B.throw(ee))}catch(le){q(le)}},h=ee=>ee.done?T(ee.value):Promise.resolve(ee.value).then(ne,ye);h((B=B.apply(H,U)).next())});import{_ as Rt,r as k,x as pe,o as a,c as n,d as e,i as $,j as L,F as O,h as z,t as w,m as y,l as v,Z as ms,Q as Mt,n as N,k as $e,N as I,L as M,a6 as Jl,U as x,H as me,u as Yl,M as Zl,e as fe,E as Gl,w as Ve,f as Kl,a7 as is,K as ve,y as Q,z as X,a8 as Ql,b as ae,O as it,R as Pe,X as be,v as yt,a9 as rs,B as Xl,aa as ds,ab as xl,S as Il,ac as Et,a2 as cs,ad as us,D as ps,ae as eo}from"./index-LxNlTeir.js";const to="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",so={class:"simple-field-library"},lo={class:"field-search"},oo={class:"field-types-grid"},ao=["onDragstart","onClick"],no={__name:"SimpleFieldLibrary",props:{fields:{type:Array,required:!0}},emits:["field-add","field-dragstart","field-dragend"],setup(H,{emit:U}){const B=H,T=U,q=k(""),ne=k(!1),ye=pe(()=>{if(!q.value)return B.fields;const P=q.value.toLowerCase();return B.fields.filter(de=>de.label.toLowerCase().includes(P))}),h=(P,de)=>{ne.value=!0,P.dataTransfer.effectAllowed="copy",P.dataTransfer.setData("text/plain",de.type),T("field-dragstart",de.type)},ee=()=>{ne.value=!1,T("field-dragend")},le=P=>{T("field-add",P.type)};return(P,de)=>(a(),n("div",so,[e("div",lo,[de[1]||(de[1]=e("i",{class:"bi bi-search"},null,-1)),$(e("input",{"onUpdate:modelValue":de[0]||(de[0]=Z=>q.value=Z),type:"text",placeholder:"Search fields",class:"search-input"},null,512),[[L,q.value]])]),e("div",oo,[(a(!0),n(O,null,z(ye.value,Z=>(a(),n("button",{key:Z.type,class:"field-type-btn",draggable:!0,onDragstart:j=>h(j,Z),onDragend:ee,onClick:j=>le(Z)},w(Z.label),41,ao))),128))])]))}},io=Rt(no,[["__scopeId","data-v-cb64d6f9"]]),ro={class:"frappe-form-builder"},co={class:"builder-toolbar"},uo={class:"d-flex gap-2 align-items-center flex-wrap"},po=["disabled"],mo=["disabled"],fo={class:"ms-auto"},vo={class:"badge bg-secondary"},bo={class:"fields-container"},_o={key:0,class:"empty-state"},ho=["onMouseenter"],go={class:"field-index-badge"},yo=["title"],ko={class:"field-content"},wo={class:"field-editor"},$o={class:"row g-2 mb-2"},Co={class:"col-md-4"},Fo=["onUpdate:modelValue","placeholder","onInput"],Do={class:"col-md-3"},So=["onUpdate:modelValue","onChange"],Vo={key:0,class:"col-md-3"},Ao={class:"input-group input-group-sm"},qo=["onUpdate:modelValue","readonly"],To={class:"col-md-2"},Uo={class:"d-flex gap-2"},Lo=["onClick"],Eo=["onClick"],Mo=["onClick"],Ro={key:0,class:"quick-options mb-2"},Bo={class:"row g-2"},Oo={key:0,class:"col-md-6"},zo=["onUpdate:modelValue","placeholder"],No=["onUpdate:modelValue","placeholder"],Po={class:"col-md-6"},Ho={class:"d-flex gap-3 flex-wrap"},jo={class:"form-check"},Wo=["onUpdate:modelValue","id"],Jo=["for"],Yo={class:"form-check"},Zo=["onUpdate:modelValue","id"],Go=["for"],Ko={class:"form-check"},Qo=["onUpdate:modelValue","id"],Xo=["for"],xo={class:"form-check"},Io=["onUpdate:modelValue","id"],ea=["for"],ta={class:"form-check"},sa=["onUpdate:modelValue","id"],la=["for"],oa={key:0,class:"form-check"},aa=["onUpdate:modelValue","id"],na=["for"],ia={key:1,class:"mb-2"},ra=["onUpdate:modelValue"],da={key:2,class:"advanced-panel"},ca={class:"nav nav-tabs nav-tabs-sm mb-2"},ua={class:"nav-item"},pa=["onClick"],ma={class:"nav-item"},fa=["onClick"],va={class:"nav-item"},ba=["onClick"],_a={class:"nav-item"},ha=["onClick"],ga={key:0,class:"tab-content"},ya={class:"row g-2"},ka={class:"col-md-6"},wa=["onUpdate:modelValue"],$a={class:"col-md-6"},Ca=["onUpdate:modelValue"],Fa={key:0,class:"col-md-6"},Da=["onUpdate:modelValue"],Sa={key:1,class:"col-md-6"},Va=["onUpdate:modelValue"],Aa={class:"col-md-6"},qa=["onUpdate:modelValue"],Ta={class:"col-md-6"},Ua=["onUpdate:modelValue"],La={class:"col-md-12"},Ea={class:"form-check"},Ma=["onUpdate:modelValue","id"],Ra=["for"],Ba={class:"form-check"},Oa=["onUpdate:modelValue","id"],za=["for"],Na={class:"form-check"},Pa=["onUpdate:modelValue","id"],Ha=["for"],ja={key:1,class:"tab-content"},Wa={class:"row g-2"},Ja={class:"col-md-12"},Ya=["onUpdate:modelValue"],Za={class:"col-md-12"},Ga=["onUpdate:modelValue"],Ka={class:"col-md-12"},Qa=["onUpdate:modelValue"],Xa={key:0,class:"col-md-12"},xa=["onUpdate:modelValue"],Ia={key:2,class:"tab-content"},en={class:"row g-2"},tn={class:"col-md-12"},sn={class:"input-group input-group-sm mb-2"},ln=["onUpdate:modelValue"],on={class:"dropdown-menu dropdown-menu-end"},an=["onClick"],nn=["onClick"],rn=["onClick"],dn=["onClick"],cn=["onClick"],un={class:"col-md-12"},pn=["onUpdate:modelValue"],mn={key:0,class:"col-md-6"},fn={class:"form-check"},vn=["onUpdate:modelValue","id"],bn=["for"],_n={key:3,class:"tab-content"},hn={class:"row g-2"},gn={key:0,class:"col-md-6"},yn=["onUpdate:modelValue"],kn={key:1,class:"col-md-6"},wn=["onUpdate:modelValue"],$n={class:"col-md-12"},Cn={class:"form-check"},Fn=["onUpdate:modelValue","id"],Dn=["for"],Sn={class:"form-check"},Vn=["onUpdate:modelValue","id"],An=["for"],qn={__name:"FrappeFormBuilder",props:{formName:{type:String,default:""},existingFields:{type:Array,default:()=>[]},currentBlockIndex:{type:Number,default:0}},emits:["save","update","addFields"],setup(H,{expose:U,emit:B}){const T=B,q=k([]),ne=k(!1),ye=k(null),h=k(1),ee=(S="Data")=>({id:`field_${h.value++}`,idx:q.value.length+1,fieldname:"",fieldtype:S,label:"",description:"",options:"",reqd:0,unique:0,read_only:0,hidden:0,default:"",depends_on:"",mandatory_depends_on:"",read_only_depends_on:"",bold:0,placeholder:"",collapsible:0,collapsible_depends_on:"",precision:"",length:0,non_negative:0,in_list_view:0,in_standard_filter:0,in_global_search:0,allow_bulk_edit:0,columns:0,permlevel:0,allow_on_submit:0,ignore_user_permissions:0,ignore_xss_filter:0,translatable:0,fetch_from:"",fetch_if_empty:0,report_hide:0,print_hide:0,print_hide_if_no_value:0,sort_options:0,remember_last_selected_value:0,is_virtual:0,search_index:0,documentation_url:"",validation_regex:"",validation_message:"",text_transform:"",auto_trim:"",showAdvanced:!1,advancedTab:"config"}),le=(S="field")=>{let p="Data";S==="section_break"?p="Section Break":S==="column_break"?p="Column Break":S==="html"&&(p="HTML");const d=ee(p);q.value.push(d),j(),T("update",q.value)},P=S=>{const p=q.value[S].label||q.value[S].fieldtype;confirm(`Delete "${p}"?`)&&(q.value.splice(S,1),j(),T("update",q.value))},de=S=>{const p=re({},q.value[S]);p.id=`field_${h.value++}`,p.fieldname=`${p.fieldname}_copy`,p.label=`${p.label} (Copy)`,q.value.splice(S+1,0,p),j(),T("update",q.value)},Z=()=>{confirm("Clear all fields?")&&(q.value=[],T("update",[]))},j=()=>{q.value.forEach((S,p)=>{S.idx=p+1})},J=()=>{ne.value=!1,j(),T("update",q.value)},W=S=>{const p=q.value[S];!p.label||_e(p.fieldtype)||(p.fieldname=p.label.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),T("update",q.value))},Ae=S=>{const p=q.value[S];Fe(p.fieldtype)||(p.options=""),_e(p.fieldtype)&&(p.fieldname=""),T("update",q.value)},Ce=S=>{q.value[S].showAdvanced=!q.value[S].showAdvanced},Fe=S=>["Select","Link","Table","Table MultiSelect","Small Text","Autocomplete"].includes(S),_e=S=>["Section Break","Column Break","HTML"].includes(S),rt=S=>["Int","Float","Currency","Percent"].includes(S),dt=S=>S==="Select"||S==="Small Text"||S==="Autocomplete"?`Option 1
Option 2
Option 3`:S==="Link"?"DocType Name (e.g., Customer)":S==="Table"||S==="Table MultiSelect"?"Child DocType Name":"Enter options",R=S=>S==="Section Break"?"Section Label":S==="Column Break"?"Column Label (optional)":S==="HTML"?"HTML Field Label":"Field Label",ce=S=>({Data:"bi bi-fonts","Small Text":"bi bi-textarea-t",Text:"bi bi-textarea","Long Text":"bi bi-file-text","Text Editor":"bi bi-file-richtext",Int:"bi bi-hash",Float:"bi bi-123",Currency:"bi bi-currency-dollar",Percent:"bi bi-percent",Date:"bi bi-calendar-date",Datetime:"bi bi-calendar-event",Time:"bi bi-clock",Link:"bi bi-link-45deg","Dynamic Link":"bi bi-diagram-3",Table:"bi bi-table",Select:"bi bi-list-ul",Autocomplete:"bi bi-search",Check:"bi bi-check-square",Attach:"bi bi-paperclip","Attach Image":"bi bi-image","Section Break":"bi bi-layout-split","Column Break":"bi bi-layout-three-columns",HTML:"bi bi-code-square",Button:"bi bi-mouse",Rating:"bi bi-star",Signature:"bi bi-pen",Color:"bi bi-palette",Barcode:"bi bi-upc"})[S]||"bi bi-question-circle",Xe=S=>/^[a-z_][a-z0-9_]*$/.test(S),je=()=>{const S=[];let p=null,d=null,A=null;return q.value.forEach((g,Bt)=>{g.fieldtype==="Section Break"?(p={label:g.label||"",collapsible:g.collapsible,collapsible_depends_on:g.collapsible_depends_on,depends_on:g.depends_on,rows:[]},d={columns:[]},A={fields:[]},d.columns.push(A),p.rows.push(d),S.push(p)):g.fieldtype==="Column Break"?d&&(A={fields:[]},d.columns.push(A)):g.fieldtype!=="HTML"&&(p||(p={label:"",rows:[]},d={columns:[]},A={fields:[]},d.columns.push(A),p.rows.push(d),S.push(p)),A||(A={fields:[]},d.columns.push(A)),A.fields.push(g))}),S},qe=()=>{for(const p of q.value)if(!_e(p.fieldtype)){if(!p.label||!p.fieldname||!p.fieldtype){x("All fields must have a label, fieldname, and type");return}if(!Xe(p.fieldname)){x(`Invalid fieldname: ${p.fieldname}. Use lowercase letters, numbers, and underscores only.`);return}if(Fe(p.fieldtype)&&(!p.options||!p.options.trim())){x(`Options required for ${p.fieldtype} field: ${p.label}`);return}}const S=je();T("addFields",S),me(`${q.value.length} field(s) added to form!`),q.value=[]};return U({fields:q,addFieldsToBlock:qe,addField:le}),(S,p)=>(a(),n("div",ro,[e("div",co,[e("div",uo,[e("button",{onClick:p[0]||(p[0]=d=>le("field")),class:"btn btn-primary btn-sm"},p[7]||(p[7]=[e("i",{class:"bi bi-plus-circle"},null,-1),y(" Add Field ")])),e("button",{onClick:p[1]||(p[1]=d=>le("section_break")),class:"btn btn-outline-primary btn-sm"},p[8]||(p[8]=[e("i",{class:"bi bi-layout-split"},null,-1),y(" Section Break ")])),e("button",{onClick:p[2]||(p[2]=d=>le("column_break")),class:"btn btn-outline-primary btn-sm"},p[9]||(p[9]=[e("i",{class:"bi bi-layout-three-columns"},null,-1),y(" Column Break ")])),e("button",{onClick:p[3]||(p[3]=d=>le("html")),class:"btn btn-outline-primary btn-sm"},p[10]||(p[10]=[e("i",{class:"bi bi-code-square"},null,-1),y(" HTML ")])),p[13]||(p[13]=e("div",{class:"vr"},null,-1)),e("button",{onClick:qe,class:"btn btn-success btn-sm",disabled:q.value.length===0},[p[11]||(p[11]=e("i",{class:"bi bi-check-circle"},null,-1)),y(" Add to Form ("+w(q.value.length)+") ",1)],8,po),e("button",{onClick:Z,class:"btn btn-outline-secondary btn-sm",disabled:q.value.length===0},p[12]||(p[12]=[e("i",{class:"bi bi-trash"},null,-1),y(" Clear All ")]),8,mo),e("div",fo,[e("span",vo,w(q.value.length)+" field(s)",1)])])]),e("div",bo,[q.value.length===0?(a(),n("div",_o,p[14]||(p[14]=[e("i",{class:"bi bi-inbox"},null,-1),e("p",null,'No fields yet. Click "Add Field" or add Section/Column breaks to start.',-1)]))):v("",!0),q.value.length>0?(a(),ms(M(Jl),{key:1,modelValue:q.value,"onUpdate:modelValue":p[5]||(p[5]=d=>q.value=d),"item-key":d=>d.id,handle:".field-drag-handle",onStart:p[6]||(p[6]=d=>ne.value=!0),onEnd:J,animation:200,"ghost-class":"ghost-field"},{item:Mt(({element:d,index:A})=>[e("div",{class:N(["field-item",{dragging:ne.value,"field-section-break":d.fieldtype==="Section Break","field-column-break":d.fieldtype==="Column Break","field-html":d.fieldtype==="HTML"}]),onMouseenter:g=>ye.value=A,onMouseleave:p[4]||(p[4]=g=>ye.value=null)},[e("div",go,w(d.idx),1),e("div",{class:"field-type-indicator",title:d.fieldtype},[e("i",{class:N(ce(d.fieldtype))},null,2)],8,yo),e("div",ko,[p[39]||(p[39]=e("div",{class:"field-drag-handle"},[e("i",{class:"bi bi-grip-vertical"})],-1)),e("div",wo,[e("div",$o,[e("div",Co,[$(e("input",{"onUpdate:modelValue":g=>d.label=g,placeholder:R(d.fieldtype),class:"form-control form-control-sm",onInput:g=>W(A)},null,40,Fo),[[L,d.label]])]),e("div",Do,[$(e("select",{"onUpdate:modelValue":g=>d.fieldtype=g,class:"form-select form-select-sm",onChange:g=>Ae(A)},p[15]||(p[15]=[e("option",{value:""},"Select Type",-1),e("optgroup",{label:"Text"},[e("option",{value:"Data"},"Data (Single Line)"),e("option",{value:"Small Text"},"Small Text (Multi-select)"),e("option",{value:"Text"},"Text (Multi Line)"),e("option",{value:"Long Text"},"Long Text (Large)"),e("option",{value:"Text Editor"},"Text Editor (Rich Text)"),e("option",{value:"Markdown Editor"},"Markdown Editor"),e("option",{value:"HTML Editor"},"HTML Editor"),e("option",{value:"Code"},"Code")],-1),e("optgroup",{label:"Number"},[e("option",{value:"Int"},"Int (Integer)"),e("option",{value:"Float"},"Float (Decimal)"),e("option",{value:"Currency"},"Currency"),e("option",{value:"Percent"},"Percent"),e("option",{value:"Duration"},"Duration"),e("option",{value:"Rating"},"Rating")],-1),e("optgroup",{label:"Date & Time"},[e("option",{value:"Date"},"Date"),e("option",{value:"Datetime"},"Datetime"),e("option",{value:"Time"},"Time")],-1),e("optgroup",{label:"Link"},[e("option",{value:"Link"},"Link (Foreign Key)"),e("option",{value:"Dynamic Link"},"Dynamic Link"),e("option",{value:"Table"},"Table (Child Table)"),e("option",{value:"Table MultiSelect"},"Table MultiSelect")],-1),e("optgroup",{label:"Select"},[e("option",{value:"Select"},"Select (Dropdown)"),e("option",{value:"Autocomplete"},"Autocomplete")],-1),e("optgroup",{label:"Boolean"},[e("option",{value:"Check"},"Check (Checkbox)")],-1),e("optgroup",{label:"Attachment"},[e("option",{value:"Attach"},"Attach (File)"),e("option",{value:"Attach Image"},"Attach Image")],-1),e("optgroup",{label:"Layout"},[e("option",{value:"Section Break"},"Section Break"),e("option",{value:"Column Break"},"Column Break"),e("option",{value:"HTML"},"HTML")],-1),e("optgroup",{label:"Other"},[e("option",{value:"Button"},"Button"),e("option",{value:"Geolocation"},"Geolocation"),e("option",{value:"Barcode"},"Barcode"),e("option",{value:"Color"},"Color"),e("option",{value:"Icon"},"Icon"),e("option",{value:"Signature"},"Signature"),e("option",{value:"JSON"},"JSON")],-1)]),40,So),[[$e,d.fieldtype]])]),_e(d.fieldtype)?v("",!0):(a(),n("div",Vo,[e("div",Ao,[p[16]||(p[16]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-tag"})],-1)),$(e("input",{"onUpdate:modelValue":g=>d.fieldname=g,type:"text",class:"form-control form-control-sm font-monospace",placeholder:"fieldname",readonly:!d.label},null,8,qo),[[L,d.fieldname]])])])),e("div",To,[e("div",Uo,[e("button",{class:"btn btn-sm btn-outline-primary flex-fill",onClick:g=>Ce(A),title:"Advanced Options"},p[17]||(p[17]=[e("i",{class:"bi bi-sliders"},null,-1)]),8,Lo),e("button",{class:"btn btn-sm btn-outline-secondary",onClick:g=>de(A),title:"Duplicate"},p[18]||(p[18]=[e("i",{class:"bi bi-files"},null,-1)]),8,Eo),e("button",{class:"btn btn-sm btn-outline-danger",onClick:g=>P(A),title:"Delete"},p[19]||(p[19]=[e("i",{class:"bi bi-trash"},null,-1)]),8,Mo)])])]),_e(d.fieldtype)?v("",!0):(a(),n("div",Ro,[e("div",Bo,[Fe(d.fieldtype)?(a(),n("div",Oo,[d.fieldtype==="Select"||d.fieldtype==="Small Text"?$((a(),n("textarea",{key:0,"onUpdate:modelValue":g=>d.options=g,class:"form-control form-control-sm",rows:"2",placeholder:dt(d.fieldtype)},null,8,zo)),[[L,d.options]]):$((a(),n("input",{key:1,"onUpdate:modelValue":g=>d.options=g,type:"text",class:"form-control form-control-sm",placeholder:dt(d.fieldtype)},null,8,No)),[[L,d.options]])])):v("",!0),e("div",Po,[e("div",Ho,[e("div",jo,[$(e("input",{"onUpdate:modelValue":g=>d.reqd=g,type:"checkbox",class:"form-check-input",id:`reqd-${A}`,"true-value":1,"false-value":0},null,8,Wo),[[I,d.reqd]]),e("label",{class:"form-check-label small",for:`reqd-${A}`},"Mandatory",8,Jo)]),e("div",Yo,[$(e("input",{"onUpdate:modelValue":g=>d.read_only=g,type:"checkbox",class:"form-check-input",id:`ro-${A}`,"true-value":1,"false-value":0},null,8,Zo),[[I,d.read_only]]),e("label",{class:"form-check-label small",for:`ro-${A}`},"Read Only",8,Go)]),e("div",Ko,[$(e("input",{"onUpdate:modelValue":g=>d.hidden=g,type:"checkbox",class:"form-check-input",id:`hide-${A}`,"true-value":1,"false-value":0},null,8,Qo),[[I,d.hidden]]),e("label",{class:"form-check-label small",for:`hide-${A}`},"Hidden",8,Xo)]),e("div",xo,[$(e("input",{"onUpdate:modelValue":g=>d.unique=g,type:"checkbox",class:"form-check-input",id:`uniq-${A}`,"true-value":1,"false-value":0},null,8,Io),[[I,d.unique]]),e("label",{class:"form-check-label small",for:`uniq-${A}`},"Unique",8,ea)]),e("div",ta,[$(e("input",{"onUpdate:modelValue":g=>d.bold=g,type:"checkbox",class:"form-check-input",id:`bold-${A}`,"true-value":1,"false-value":0},null,8,sa),[[I,d.bold]]),e("label",{class:"form-check-label small",for:`bold-${A}`},"Bold",8,la)]),d.fieldtype==="Section Break"?(a(),n("div",oa,[$(e("input",{"onUpdate:modelValue":g=>d.collapsible=g,type:"checkbox",class:"form-check-input",id:`coll-${A}`,"true-value":1,"false-value":0},null,8,aa),[[I,d.collapsible]]),e("label",{class:"form-check-label small",for:`coll-${A}`},"Collapsible",8,na)])):v("",!0)])])])])),d.fieldtype==="HTML"?(a(),n("div",ia,[$(e("textarea",{"onUpdate:modelValue":g=>d.options=g,class:"form-control form-control-sm font-monospace",rows:"4",placeholder:"Enter HTML content here..."},null,8,ra),[[L,d.options]])])):v("",!0),d.showAdvanced?(a(),n("div",da,[e("ul",ca,[e("li",ua,[e("a",{class:N(["nav-link",{active:d.advancedTab==="config"}]),onClick:g=>d.advancedTab="config",href:"javascript:void(0)"}," Config ",10,pa)]),e("li",ma,[e("a",{class:N(["nav-link",{active:d.advancedTab==="conditional"}]),onClick:g=>d.advancedTab="conditional",href:"javascript:void(0)"}," Conditional ",10,fa)]),e("li",va,[e("a",{class:N(["nav-link",{active:d.advancedTab==="validation"}]),onClick:g=>d.advancedTab="validation",href:"javascript:void(0)"}," Validation ",10,ba)]),e("li",_a,[e("a",{class:N(["nav-link",{active:d.advancedTab==="formatting"}]),onClick:g=>d.advancedTab="formatting",href:"javascript:void(0)"}," Formatting ",10,ha)])]),d.advancedTab==="config"?(a(),n("div",ga,[e("div",ya,[e("div",ka,[p[20]||(p[20]=e("label",{class:"form-label small"},"Description",-1)),$(e("textarea",{"onUpdate:modelValue":g=>d.description=g,class:"form-control form-control-sm",rows:"2",placeholder:"Help text for this field"},null,8,wa),[[L,d.description]])]),e("div",$a,[p[21]||(p[21]=e("label",{class:"form-label small"},"Default Value",-1)),$(e("input",{"onUpdate:modelValue":g=>d.default=g,type:"text",class:"form-control form-control-sm",placeholder:"Default value"},null,8,Ca),[[L,d.default]])]),rt(d.fieldtype)?(a(),n("div",Fa,[p[22]||(p[22]=e("label",{class:"form-label small"},"Precision",-1)),$(e("input",{"onUpdate:modelValue":g=>d.precision=g,type:"number",class:"form-control form-control-sm",placeholder:"Decimal places"},null,8,Da),[[L,d.precision,void 0,{number:!0}]])])):v("",!0),d.fieldtype==="Data"?(a(),n("div",Sa,[p[23]||(p[23]=e("label",{class:"form-label small"},"Max Length",-1)),$(e("input",{"onUpdate:modelValue":g=>d.length=g,type:"number",class:"form-control form-control-sm",placeholder:"Maximum characters"},null,8,Va),[[L,d.length,void 0,{number:!0}]])])):v("",!0),e("div",Aa,[p[24]||(p[24]=e("label",{class:"form-label small"},"Placeholder",-1)),$(e("input",{"onUpdate:modelValue":g=>d.placeholder=g,type:"text",class:"form-control form-control-sm",placeholder:"Placeholder text"},null,8,qa),[[L,d.placeholder]])]),e("div",Ta,[p[25]||(p[25]=e("label",{class:"form-label small"},"Columns (Grid Width)",-1)),$(e("input",{"onUpdate:modelValue":g=>d.columns=g,type:"number",class:"form-control form-control-sm",placeholder:"1-12",min:"1",max:"12"},null,8,Ua),[[L,d.columns,void 0,{number:!0}]])]),e("div",La,[e("div",Ea,[$(e("input",{"onUpdate:modelValue":g=>d.in_list_view=g,type:"checkbox",class:"form-check-input",id:`list-${A}`,"true-value":1,"false-value":0},null,8,Ma),[[I,d.in_list_view]]),e("label",{class:"form-check-label small",for:`list-${A}`},"Show in List View",8,Ra)]),e("div",Ba,[$(e("input",{"onUpdate:modelValue":g=>d.in_standard_filter=g,type:"checkbox",class:"form-check-input",id:`filt-${A}`,"true-value":1,"false-value":0},null,8,Oa),[[I,d.in_standard_filter]]),e("label",{class:"form-check-label small",for:`filt-${A}`},"In Standard Filter",8,za)]),e("div",Na,[$(e("input",{"onUpdate:modelValue":g=>d.allow_on_submit=g,type:"checkbox",class:"form-check-input",id:`subm-${A}`,"true-value":1,"false-value":0},null,8,Pa),[[I,d.allow_on_submit]]),e("label",{class:"form-check-label small",for:`subm-${A}`},"Allow on Submit",8,Ha)])])])])):v("",!0),d.advancedTab==="conditional"?(a(),n("div",ja,[e("div",Wa,[e("div",Ja,[p[26]||(p[26]=e("label",{class:"form-label small"},"Depends On (Visibility)",-1)),$(e("input",{"onUpdate:modelValue":g=>d.depends_on=g,type:"text",class:"form-control form-control-sm font-monospace",placeholder:"eval:doc.field_name=='value'"},null,8,Ya),[[L,d.depends_on]]),p[27]||(p[27]=e("small",{class:"text-muted"},"Example: eval:doc.status=='Active'",-1))]),e("div",Za,[p[28]||(p[28]=e("label",{class:"form-label small"},"Mandatory Depends On",-1)),$(e("input",{"onUpdate:modelValue":g=>d.mandatory_depends_on=g,type:"text",class:"form-control form-control-sm font-monospace",placeholder:"eval:doc.field_name=='value'"},null,8,Ga),[[L,d.mandatory_depends_on]])]),e("div",Ka,[p[29]||(p[29]=e("label",{class:"form-label small"},"Read Only Depends On",-1)),$(e("input",{"onUpdate:modelValue":g=>d.read_only_depends_on=g,type:"text",class:"form-control form-control-sm font-monospace",placeholder:"eval:doc.field_name=='value'"},null,8,Qa),[[L,d.read_only_depends_on]])]),d.fieldtype==="Section Break"?(a(),n("div",Xa,[p[30]||(p[30]=e("label",{class:"form-label small"},"Collapsible Depends On",-1)),$(e("input",{"onUpdate:modelValue":g=>d.collapsible_depends_on=g,type:"text",class:"form-control form-control-sm font-monospace",placeholder:"eval:doc.field_name=='value'"},null,8,xa),[[L,d.collapsible_depends_on]])])):v("",!0)])])):v("",!0),d.advancedTab==="validation"?(a(),n("div",Ia,[e("div",en,[e("div",tn,[p[32]||(p[32]=e("label",{class:"form-label small"},"Validation Rule (Regex)",-1)),e("div",sn,[$(e("input",{"onUpdate:modelValue":g=>d.validation_regex=g,type:"text",class:"form-control font-monospace",placeholder:"^[A-Z0-9]+$"},null,8,ln),[[L,d.validation_regex]]),p[31]||(p[31]=e("button",{class:"btn btn-outline-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown"}," Presets ",-1)),e("ul",on,[e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:g=>d.validation_regex="^[A-Za-z ]+$"},"Letters Only",8,an)]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:g=>d.validation_regex="^[0-9]+$"},"Numbers Only",8,nn)]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:g=>d.validation_regex="^[A-Z0-9]+$"},"Uppercase Alphanumeric",8,rn)]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:g=>d.validation_regex="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"},"Email",8,dn)]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:g=>d.validation_regex="^[0-9]{10}$"},"Phone (10 digits)",8,cn)])])]),p[33]||(p[33]=e("small",{class:"text-muted"},"Regex pattern for validation",-1))]),e("div",un,[p[34]||(p[34]=e("label",{class:"form-label small"},"Validation Message",-1)),$(e("input",{"onUpdate:modelValue":g=>d.validation_message=g,type:"text",class:"form-control form-control-sm",placeholder:"Custom error message"},null,8,pn),[[L,d.validation_message]])]),rt(d.fieldtype)?(a(),n("div",mn,[e("div",fn,[$(e("input",{"onUpdate:modelValue":g=>d.non_negative=g,type:"checkbox",class:"form-check-input",id:`nonneg-${A}`,"true-value":1,"false-value":0},null,8,vn),[[I,d.non_negative]]),e("label",{class:"form-check-label small",for:`nonneg-${A}`},"Non-Negative Only",8,bn)])])):v("",!0)])])):v("",!0),d.advancedTab==="formatting"?(a(),n("div",_n,[e("div",hn,[d.fieldtype==="Data"?(a(),n("div",gn,[p[36]||(p[36]=e("label",{class:"form-label small"},"Text Transform",-1)),$(e("select",{"onUpdate:modelValue":g=>d.text_transform=g,class:"form-select form-select-sm"},p[35]||(p[35]=[e("option",{value:""},"None",-1),e("option",{value:"uppercase"},"UPPERCASE",-1),e("option",{value:"lowercase"},"lowercase",-1),e("option",{value:"titlecase"},"Title Case",-1)]),8,yn),[[$e,d.text_transform]])])):v("",!0),d.fieldtype==="Data"?(a(),n("div",kn,[p[38]||(p[38]=e("label",{class:"form-label small"},"Auto Trim",-1)),$(e("select",{"onUpdate:modelValue":g=>d.auto_trim=g,class:"form-select form-select-sm"},p[37]||(p[37]=[e("option",{value:""},"No Trim",-1),e("option",{value:"trim"},"Trim Both Ends",-1),e("option",{value:"trim_start"},"Trim Start",-1),e("option",{value:"trim_end"},"Trim End",-1)]),8,wn),[[$e,d.auto_trim]])])):v("",!0),e("div",$n,[e("div",Cn,[$(e("input",{"onUpdate:modelValue":g=>d.translatable=g,type:"checkbox",class:"form-check-input",id:`trans-${A}`,"true-value":1,"false-value":0},null,8,Fn),[[I,d.translatable]]),e("label",{class:"form-check-label small",for:`trans-${A}`},"Translatable",8,Dn)]),e("div",Sn,[$(e("input",{"onUpdate:modelValue":g=>d.print_hide=g,type:"checkbox",class:"form-check-input",id:`prthide-${A}`,"true-value":1,"false-value":0},null,8,Vn),[[I,d.print_hide]]),e("label",{class:"form-check-label small",for:`prthide-${A}`},"Hide in Print",8,An)])])])])):v("",!0)])):v("",!0)])])],42,ho)]),_:1},8,["modelValue","item-key"])):v("",!0)])]))}},Tn=Rt(qn,[["__scopeId","data-v-bba5d51b"]]),Un={class:""},Ln={class:""},En={class:"d-flex justify-content-between align-items-center CancelNdSave"},Mn={class:"d-flex align-items-center"},Rn={key:0,class:"font-16"},Bn=["disabled"],On={class:"form-container p-0 container-fluid mt-3"},zn={class:"row g-4"},Nn={class:"col-lg-2 col-md-3 col-sm-12"},Pn={class:"steps-sticky-div"},Hn={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},jn=["onClick"],Wn={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},Jn={class:"step-text"},Yn={class:"font-11"},Zn={class:"font-14"},Gn={class:"col-lg-10 col-md-9 col-sm-12 formbackground-color"},Kn={class:"px-2"},Qn={class:"form-content stepsDiv"},Xn={key:0},xn={class:""},In={class:"stepperbackground ps-3 pe-3 py-2 m-0 d-flex justify-content-between align-items-center"},ei={class:"d-flex gap-2 align-items-center"},ti=["disabled"],si={class:"container-fluid aboutFields p-0"},li={class:"row"},oi={class:"col-12"},ai={class:"p-4"},ni={class:"card border-0 shadow-sm mb-4"},ii={class:"card-body p-4"},ri={class:"row g-4"},di={class:"col-md-6"},ci={class:"position-relative"},ui={key:0,class:"badge bg-success position-absolute",style:{top:"-8px",right:"10px","z-index":"10"}},pi={key:1,class:"text-danger font-12 ms-1"},mi={class:"col-md-6"},fi={key:0,class:"text-danger font-12 ms-1"},vi={class:"col-md-6"},bi={class:"card border-0 shadow-sm mb-4"},_i={class:"card-body p-4"},hi={class:"row g-4"},gi={class:"col-md-6"},yi={class:"form-label font-13 fw-medium"},ki={key:0,class:"text-danger"},wi={class:"col-md-6"},$i={class:"form-label font-13 fw-medium"},Ci={key:0,class:"text-danger"},Fi={class:"col-md-12"},Di={class:"form-label font-13 fw-medium"},Si={key:0,class:"text-danger"},Vi={class:"custom-option"},Ai=["checked","onChange"],qi={class:"card border-0 shadow-sm mb-4"},Ti={class:"card-body p-4"},Ui={class:"row g-4"},Li={class:"col-md-6"},Ei={class:"text-muted font-11 ms-1"},Mi={key:0,class:"text-success"},Ri={key:1},Bi={class:"col-md-6"},Oi={key:0,class:"col-md-6"},zi={key:0,class:"card border-0 shadow-sm mb-4"},Ni={class:"card-body p-4"},Pi={class:"row g-4"},Hi={class:"col-md-6"},ji={class:"col-md-6"},Wi={key:1,class:"card border-0 shadow-sm mb-4"},Ji={class:"card-body p-4"},Yi={class:"row g-4"},Zi={class:"col-md-12"},Gi={class:"form-check"},Ki=["disabled"],Qi={key:0,class:"col-md-12"},Xi={class:"position-relative"},xi=["disabled"],Ii={key:0,class:"list-group position-absolute w-100 z-3",style:{"max-height":"200px","overflow-y":"auto"}},er=["onMousedown"],tr={key:1,class:"zoho-form-builder"},sr={class:"zoho-toolbar"},lr={class:"toolbar-left"},or={class:"zoho-tabs"},ar=["onClick"],nr=["onClick"],ir={class:"toolbar-right"},rr={class:"zoho-builder-container"},dr={key:0,class:"advanced-builder-wrapper"},cr={class:"d-flex align-items-center justify-content-between w-100"},ur={class:"mb-0 font-14 fw-bold"},pr={class:"btn btn-sm btn-link p-0 text-dark"},mr={key:0,class:"library-content"},fr={class:"zoho-form-canvas"},vr={class:"requestandAppHeader"},br={class:"d-flex justify-content-between align-items-center"},_r={class:""},hr={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},gr={class:"text-center ms-2 mt-1"},yr={key:0,class:"font-12 d-flex align-items-center"},kr={class:"font-12 approver_type_div"},wr={class:"font-12 fw-bold"},$r={class:"font-12 text-danger ms-1"},Cr={class:"d-flex align-items-center"},Fr={key:0,class:"role-container"},Dr={key:0,class:"role-text d-flex align-items-center"},Sr={class:"role-label fw-bold"},Vr={class:"role-names text-primary"},Ar=["onClick"],qr=["onClick"],Tr=["onClick"],Ur=["onClick"],Lr={class:"pt-0 section_block"},Er={class:"d-flex justify-content-between align-items-center"},Mr={class:"d-flex flex-column"},Rr=["onUpdate:modelValue","onChange","onInput"],Br={key:0,class:"text-danger ps-3 font-10"},Or={class:"d-flex align-items-center"},zr=["onClick"],Nr={class:"container-fluid"},Pr={class:"d-flex justify-content-between align-items-center"},Hr={class:"rownames m-0"},jr=["onClick"],Wr={class:"col"},Jr={class:"row"},Yr=["onMouseenter"],Zr={class:"column_name d-flex align-items-center justify-content-between"},Gr={class:"d-flex flex-column ps-2"},Kr=["onUpdate:modelValue","onChange","onInput"],Qr={key:0,class:"text-danger ps-2 font-10"},Xr={class:"position-absolute top-0 end-0"},xr=["onClick"],Ir=["onDrop"],ed=["onMouseenter","onDragstart","onDrop"],td=["onDrop"],sd=["onDragstart","onDrop"],ld={class:"d-flex justify-content-between"},od={class:"flex-column d-flex"},ad=["onUpdate:modelValue","onChange","onInput"],nd={key:0,class:"text-danger font-10"},id={class:"FieldcopyRemove"},rd=["onClick"],dd=["onClick"],cd=["onUpdate:modelValue","onChange"],ud=["value"],pd={key:0},md=["onUpdate:modelValue"],fd={key:0,class:"text-danger font-10"},vd={key:1},bd=["for"],_d=["id","onUpdate:modelValue","onInput","onFocus"],hd={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},gd=["onClick"],yd={class:"d-flex align-items-center justify-content-between"},kd={class:"d-flex align-items-center gap-2"},wd={class:"d-flex align-items-center"},$d=["onUpdate:modelValue","id"],Cd=["for"],Fd=["onClick"],Dd=["onUpdate:modelValue"],Sd={key:3,class:"text-danger font-10"},Vd=["onDrop"],Ad={class:"childtableShow"},qd={class:"mt-2"},Td={key:0,class:"childTableContainer"},Ud={key:0,class:"font-13"},Ld={key:1,class:"d-flex align-items-center gap-2"},Ed={class:"d-flex align-items-center"},Md=["onUpdate:modelValue"],Rd=["onClick"],Bd={key:2,class:"table table-bordered rounded-table"},Od=["onDrop"],zd=["draggable","onDragstart"],Nd={key:0},Pd=["onUpdate:modelValue","onInput"],Hd={key:0,class:"text-danger font-11"},jd={key:1},Wd={key:2},Jd={class:"d-flex gap-1"},Yd=["onUpdate:modelValue","onChange"],Zd=["value"],Gd={class:"d-flex"},Kd={class:"d-flex align-items-center gap-2"},Qd={class:"d-flex align-items-center"},Xd=["onUpdate:modelValue"],xd=["onClick"],Id={key:0},ec=["onUpdate:modelValue","onInput"],tc={key:0,class:"text-danger font-10"},sc={key:1,class:"font-11 text-danger"},lc={key:3},oc={key:3,class:"mb-2 mt-3"},ac=["onClick"],nc=["onClick"],ic=["onDrop"],rc=["onDrop"],dc={class:"d-flex justify-content-center align-items-center my-2"},cc=["onClick"],uc={class:"font-13"},pc={key:0,class:"d-flex align-items-center gap-2"},mc={class:"d-flex align-items-center"},fc=["onUpdate:modelValue"],vc=["onClick"],bc={class:"table table-bordered rounded-table"},_c={key:0},hc=["onUpdate:modelValue","onBlur"],gc={key:0,class:"text-danger font-11 mt-1"},yc={key:1},kc={key:2},wc={class:"d-flex gap-1 align-items-center"},$c=["onUpdate:modelValue","onChange"],Cc=["value"],Fc=["onClick"],Dc={key:0,class:"mt-1"},Sc=["onUpdate:modelValue","onInput"],Vc={key:1,class:"text-danger font-11 mt-1"},Ac={key:3},qc={class:"mb-2"},Tc=["onClick"],Uc=["onClick"],Lc=["onClick"],Ec={key:0},Mc={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},Rc=["onUpdate:modelValue","onBlur"],Bc={key:0,class:"text-danger font-12"},Oc={key:1,class:"text-danger font-12"},zc={class:"d-flex align-items-center gap-2"},Nc={class:"d-flex align-items-center"},Pc=["onUpdate:modelValue"],Hc=["onClick"],jc=["onClick"],Wc={class:"px-1 field-border"},Jc={class:"d-flex justify-content-between"},Yc=["onUpdate:modelValue","onBlur"],Zc={key:0,class:"text-danger font-12"},Gc={class:"d-flex align-items-center"},Kc={class:"d-flex my-1"},Qc=["onUpdate:modelValue"],Xc=["onClick"],xc=["onClick"],Ic=["onUpdate:modelValue"],eu=["value"],tu={key:0},su=["onUpdate:modelValue"],lu={key:0,class:"text-danger font-10"},ou={key:1,class:"text-danger font-12"},au=["onClick"],nu=["onClick"],iu={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},ru=["onClick"],du={key:0,class:"m-2"},cu={key:0,class:"zoho-properties-panel"},uu={class:"properties-header"},pu={key:2},mu={class:"stepperbackground d-flex align-items-center justify-content-between p-3"},fu={class:"container-fluid mt-4 p-4"},vu={class:"card mb-4"},bu={class:"card-body"},_u={class:"row g-3"},hu={class:"col-md-6"},gu={class:"btn-group w-100",role:"group"},yu={key:0,class:"col-md-6"},ku={key:0,class:"card mb-4"},wu={class:"card-body"},$u={key:0,class:"table-responsive"},Cu={class:"table table-bordered"},Fu=["onUpdate:modelValue"],Du={class:"form-check form-switch"},Su=["onUpdate:modelValue"],Vu={class:"form-check-label font-12"},Au=["onClick"],qu=["onClick"],Tu={key:1,class:"card mb-4"},Uu={class:"card-body"},Lu={class:"alert alert-success"},Eu={class:"table-responsive"},Mu={class:"table table-bordered"},Ru={key:0,class:"badge bg-success"},Bu={key:1,class:"badge bg-secondary"},Ou={class:"text-muted"},zu={key:2,class:"card mb-4"},Nu={class:"card-body"},Pu={class:"alert alert-success"},Hu={class:"table-responsive"},ju={class:"table table-bordered table-hover"},Wu={class:"badge bg-dark"},Ju={key:0,class:"badge bg-danger"},Yu={key:1,class:"badge bg-secondary"},Zu={key:0,class:"badge bg-info"},Gu={key:1,class:"badge bg-warning text-dark"},Ku={key:2,class:"badge bg-success"},Qu={key:3,class:"badge bg-secondary"},Xu={class:"text-muted"},xu={key:3},Iu={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},ep={class:"modal-dialog modal-dialog-centered"},tp={class:"modal-content"},sp={class:"modal-body"},lp=["placeholder"],op={class:"d-flex align-items-center gap-2"},ap={class:"d-flex align-items-center py-2"},np={class:"modal fade",id:"formViewModal",tabindex:"-1","aria-labelledby":"formViewModalLabel","aria-hidden":"true"},ip={class:"modal-dialog modal-xl modal-dialog-scrollable"},rp={class:"modal-content"},dp={class:"modal-body"},cp={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},up={class:"offcanvas-header add_designationHeader"},pp={id:"offcanvasRightLabel",class:"font-14 fw-bold"},mp={class:"offcanvas-body add_desig_offCanvas_body p-0"},fp={class:""},vp={key:0,class:"p-3 approval-border-bottom"},bp={class:"px-3 listofdesignations"},_p={class:"my-1 d-flex justify-content-between"},hp={class:"font-12 fw-bold"},gp={class:"italic-style text-secondary font-12"},yp={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},kp={class:"d-flex align-items-center justify-content-between gap-1"},wp={class:"form-check ps-1 d-flex align-items-center m-0"},$p=["checked"],Cp={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},Fp={key:0,class:"form-check d-flex align-items-center m-0"},Dp={key:1},Sp={key:1,class:"p-3"},Vp=["value"],Ap={key:2},qp={class:""},Tp={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},Up={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},Lp={class:"offcanvas-footer"},Ep={class:"text-end p-3"},He="Select All",Mp={__name:"FormStepper",setup(H){const U=Yl(),B=Zl(),T=k(1),q=k([]);k([]);const ne=k([]),ye=k([]);fe([]);let h=fe([]),ee=fe([]);const le=k([]),P=k([]),de=k([]),Z=k(""),j=k(""),J=k("");let W=fe([]);const Ae=k("");k(!1),k(!1),k(!1);const Ce=k(""),Fe=k(""),_e=k(""),rt=k([]),dt=k([]),R=fe({}),ce=k([]),Xe=k(!1),je=k([]),qe=k(!1);let S=null;const p=k("");let d=k("");const A=k(null),g=k(null),Bt=k(null),Te=k(0),Ue=k(!1),We=k(!0),Ot=k(!1),zt=k(!1),Nt=k(!1);k(!1);const xe=k([]),ke=k(null),we=k("new"),ct=k([]),Je=k([]);k([]);const Le=k([]),Ee=pe(()=>Gl);k(!1);const ut=fe([]),ue=k({routepath:U.query.routepath,business_unit:U.query.business_unit,formId:U.query.id}),pt=k(""),Ye=k(!1),Ze=k(!1),Pt=[{label:"Public",value:1},{label:"Private",value:0}],kt=pe({get(){return Pt.find(s=>s.value===_.value.as_web_view)},set(s){_.value.as_web_view=s?s.value:null}}),wt=pe({get(){return _.value.form_name||U.query.form_name||""},set(s){_.value.form_name=s}}),_=k({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${Ee.value.value||ue.value.business_unit||U.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:U.query.id?1:0,as_web_view:0,mail_id:""});Ve(()=>U.query.form_name,s=>{s&&(_.value.form_name=s,_.value.form_short_name=s)},{immediate:!0});const mt=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(s=>s.toLowerCase().trim()),Ht=["Approver","Approved on","Approved By"].map(s=>s.toLowerCase().trim());function fs(s){return s.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}pe(()=>_.value),k(""),k(!1),Ve(Ee,s=>{s&&s.value&&(_.value.business_unit=s.value)},{immediate:!0});function vs(s){if(d==null||d==="new")return!1;const t=G(s).roles;if(s===0)return t.length===0;const l=G(s-1).roles;return l.length>0&&l[0]!==null&&l[0]!==""&&t.length===0}Ve(()=>_.value.form_name,s=>{_.value.form_name=s.trim()}),Ve(()=>_.value.form_short_name,s=>{_.value.form_short_name=s.trim()}),Ve(()=>_.value.series,s=>{_.value.series=s.trim()}),Ve(()=>we.value,s=>{s==="existing"&&(h.splice(0,h.length),Le.value=[],W.length=0)});const Ie=k(null),jt=(s,t,l,o,i,r)=>{Ie.value={blockIndex:t,sectionIndex:l,rowIndex:o,columnIndex:i,fieldIndex:r}},Me=(s,t,l,o,i,r)=>{if(s.preventDefault(),s.stopPropagation(),console.log("Field dropped at index:",{targetBlock:t,targetSection:l,targetRow:o,targetColumn:i,insertIndex:r,draggedField:Ie.value,draggedFieldType:A.value}),A.value){console.log("Dropping from field library:",A.value);const D=ls(A.value);if(!D){console.error("Failed to create field from type:",A.value);return}const V=h[t];if(!V){x("Target block not found");return}V.sections||(V.sections=[]),V.sections[l]||(V.sections[l]={label:"",rows:[]}),V.sections[l].rows||(V.sections[l].rows=[]),V.sections[l].rows[o]||(V.sections[l].rows[o]={label:"",columns:[]}),V.sections[l].rows[o].columns||(V.sections[l].rows[o].columns=[]),V.sections[l].rows[o].columns[i]||(V.sections[l].rows[o].columns[i]={label:"",fields:[]}),V.sections[l].rows[o].columns[i].fields.splice(r,0,D),console.log("Field added successfully:",D),me(`${D.label} field added`),A.value=null;return}if(!Ie.value){console.log("No dragged field found");return}const{blockIndex:u,sectionIndex:m,rowIndex:b,columnIndex:c,fieldIndex:f}=Ie.value,F=h[u].sections[m].rows[b].columns[c].fields,E=h[t].sections[l].rows[o].columns[i].fields;if(u===t&&m===l&&b===o&&c===i&&f===r)return;const C=F.splice(f,1)[0];F===E&&f<r&&r--,E.splice(r,0,C),Ie.value=null},Ge=k(""),bs=s=>Qe(this,null,function*(){const t=[["module","in",["User Forms"]],["istable","=",1]];s!=null&&s.trim()&&t.push(["name","=",`${s}`]);const l={fields:JSON.stringify(["name"]),filters:JSON.stringify(t),limit_page_length:"None",doctype:ve.doctypesList};try{return(yield Q.get(X.GetDoctypeData,{params:l})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),ft=k(null),Wt=s=>Qe(this,null,function*(){if(Ge.value="",ft.value=null,s.tableName){let t=s.tableName.trim();if(t.length>64){Ge.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(t)){Ge.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield bs(t);ft.value=o.find(i=>i.name.toLowerCase()===t.toLowerCase()),ft.value&&(Ge.value="Table already exists"),s.tableName=t}s.label&&(s.fieldname=fs(s.label))});function _s(){const s=_.value.is_linked_form;if(!s){je.value=[];return}clearTimeout(S),S=setTimeout(()=>{const t=[["business_unit","=",`${Ee.value.value}`],["name","like",`%${s}%`]],l={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(t),doctype:ve.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};Q.get(`${X.GetDoctypeData}`,{params:l}).then(o=>{je.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function hs(s){_.value.is_linked_form=s,qe.value=!1}function gs(){setTimeout(()=>{qe.value=!1},200)}fe({query:"",key:""});function De(s,t,l,o,i){return`${s}-${t}-${l}-${o}-${i}`}fe({});const et=fe({}),$t=fe({});function ys(s){$t[s]=!0}function ks(s,t,l,o,i,r){const u=De(t,l,o,i,r),m=[["istable","=",0]];s!=null&&s.trim()&&m.push(["name","like",`%${s}%`]);const b={fields:JSON.stringify(["name"]),filters:JSON.stringify(m),limit_page_length:"none",doctype:ve.doctypesList};Q.get(X.GetDoctypeData,{params:b}).then(c=>{et[u]=c.message.data||[]}).catch(c=>{console.error("Error fetching doctype list:",c),et[u]=[]})}function ws(s,t,l,o,i,r){h[s].sections[t].rows[l].columns[o].fields[i].options=r;const u=De(s,t,l,o,i);et[u]=[],$t[u]=!1}const $s=pe(()=>h!=null&&h.length?J.value===1?[0]:Array.from({length:J.value},(s,t)=>t).filter(s=>s<J.value):[]),Se=k(null),Re=k(null),Cs=(s,t,l,o,i)=>{Se.value={blockIndex:s,sectionIndex:t,rowIndex:l,columnIndex:o,fieldIndex:i}},Fs=()=>{Se.value=null},Ds=(s,t,l,o,i)=>Se.value&&Se.value.blockIndex===s&&Se.value.sectionIndex===t&&Se.value.rowIndex===l&&Se.value.columnIndex===o&&Se.value.fieldIndex===i,Ss=(s,t,l,o)=>{Re.value={blockIndex:s,sectionIndex:t,rowIndex:l,columnIndex:o}},Vs=()=>{Re.value=null},As=(s,t,l,o)=>Re.value&&Re.value.blockIndex===s&&Re.value.sectionIndex===t&&Re.value.rowIndex===l&&Re.value.columnIndex===o,Jt=k([{form_json:""}]),Be=k("");Kl(()=>{Kt(),Be.value=U.query.Clone,d.value=U.query.id||"new",Be.value==="1"&&(_.value.series=""),d.value!=null&&d.value!=null&&d.value!="new"&&Gt(),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?Xe.value=!0:Xe.value=!1;let s=localStorage.getItem("Bu");if(_.value.business_unit=s,U.query.preId==="PreDefine"){const t=localStorage.getItem("form_json");if(t){Jt.value[0].form_json=t;const l=Jt.value[0],o=JSON.parse(l.form_json),i=is(o.fields);ce.value=o.child_table_fields,i.forEach(r=>{h.push(r)})}}});const Oe=k(null),oe=fe({}),Yt=k(null),qs=s=>{Oe.value=s},Ts=()=>{Oe.value=null},Us=s=>{s.preventDefault()},Ls=(s,t)=>{const l=s.target.closest("tr");if(!l)return;const o=Array.from(l.parentNode.children).indexOf(l);if(o!==Oe.value){const i=t[Oe.value];t.splice(Oe.value,1),t.splice(o,0,i),Oe.value=o}},Es=k([]),Ct=s=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(s.fieldtype)&&s.options){const t=s.options.split(`
`).map(i=>i.trim()).filter(i=>i),l=[],o=new Set;return t.forEach(i=>{const r=i.toLowerCase();o.has(r)||(o.add(r),l.push(i))}),`
`+l.join(`
`)}else if(["Link","Table"].includes(s.fieldtype)&&s.options)return s.options.trim();return s.options},Ms=(s,t)=>{const l=h[s].sections[t];l.childTables||(l.childTables=[]);const o=l.childTables.length;l.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[re({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},ut.fieldtype==="Select"&&ut.options?{options:ut.options?`
${ut.options}`:`
`}:{})],newTable:!0})},Rs=(s,t,l)=>{const o=h[s].sections[t].childTables[l];o.columns||(o.columns=[]),o.columns.push(re({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},Bs=(s,t,l)=>{h[s].sections[t].childTables.splice(l,1)},Os=(s,t,l,o)=>{h[s].sections[t].childTables[l].columns.splice(o,1)};function zs(s,t,l,o,i,r){var c;const u=`${t}-${l}-${o}`;R[u]||(R[u]={columns:[]});const m={},b=((c=s.label)==null?void 0:c.trim())||"";if(!b)m.label="Field Label is required";else{const f=b.toLowerCase();if(mt.includes(f)&&!Ht.includes(f))m.label=`"${b}" is a restricted field label`;else if(b.length>64)m.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(b))m.label="Field Label can only contain letters, numbers, and single spaces between words";else{const F=r.map((E,C)=>{var D;return{label:(D=E.label)==null?void 0:D.trim().toLowerCase(),index:C}}).filter(E=>E.label===f);if(F.length>1){const E=F[0].index;i!==E&&(m.label=`"${b}" is already used in this table`)}}}R[u].columns[i]=m}function vt(s,t,l){var r;R[t]||(R[t]={});const o=[],i=((r=s.label)==null?void 0:r.trim())||"";i||o.push("Label is required"),i.length>64&&o.push("Label cannot exceed 64 characters"),i&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(i)&&o.push("No special characters allowed"),i&&mt.includes(i.toLowerCase().trim())&&o.push("This label is restricted"),i&&ce.value[t].map(b=>{var c;return(c=b.label)==null?void 0:c.trim().toLowerCase()}).filter(Boolean).filter(b=>b===i.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),s.fieldtype||o.push("Field type is required"),s.fieldtype==="Select"&&(!s.options||s.options.trim()==="")&&o.push("Options are required"),R[t][l]=o}const Ns=(s,t,l)=>{var u;const o=h[s].sections[t].childTables[l],i={tableName:!1,columns:[]};let r=!1;return(u=o.tableName)!=null&&u.trim()||(i.tableName="Table name is required.",r=!0),o.columns.forEach((m,b)=>{var f,F;const c={};(f=m.label)!=null&&f.trim()||(c.label="Field Label is required",r=!0),(F=m.fieldtype)!=null&&F.trim()||(c.fieldtype="Please select field type",r=!0),i.columns[b]=c}),R[`${s}-${t}-${l}`]=i,r},Ps=(s,t,l)=>{var i,r;const o=(r=(i=h[s])==null?void 0:i.sections)==null?void 0:r[t];o&&!Array.isArray(o[l])&&(o[l]=[])},Hs=s=>s?s.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",js=(s,t,l)=>{if(Ns(s,t,l)){x("Please fix validation errors before creating the table",{transition:"zoom"});return}if(ft.value){x("Table already exists",{transition:"zoom"});return}const i=h[s].sections[t].childTables[l],r=h[s].sections[t];i.columns=i.columns.map((m,b)=>Ne(re({},m),{idx:b,options:Ct(m)})),i.newTable=!1;const u={form_short_name:i.tableName,fields:i.columns,idx:i.idx,as_a_block:i.as_a_block?i.as_a_block:"false"};Q.post(X.childtable,u).then(m=>{var b,c,f;if(m){Ps(s,t,"afterCreated"),r.afterCreated[l]=re({},i),me("Table created successfully!");const F=(f=(c=(b=m.message)==null?void 0:b[0])==null?void 0:c[0])==null?void 0:f.child_doc;F&&(h[s].sections[t].childTables[l]=Ne(re(re({},h[s].sections[t].childTables[l]),F),{newTable:!1}))}}).catch(m=>{console.error("Error creating table:",m)})},tt=(s,t,l,o=[])=>{var u;oe[t]||(oe[t]=[]),oe[t]=oe[t].filter(m=>m!==l),R[t]||(R[t]=[]),R[t][l]=[];const i=[],r=((u=s.label)==null?void 0:u.trim())||"";if(r?mt.includes(r.toLowerCase())?i.push("This label is restricted"):r.length>64?i.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(r)||i.push("Only letters, numbers, and single spaces allowed"):i.push("Label is required"),o.length){const m=r.toLowerCase(),b=o.map((c,f)=>{var F;return{label:(F=c.label)==null?void 0:F.trim().toLowerCase(),idx:f}}).filter(c=>c.label===m);if(b.length>1){const c=b[0].idx;l!==c?(i.push("Duplicate label not allowed"),s._duplicate=!0):s._duplicate=!1}else s._duplicate=!1}return s.fieldtype||i.push("Field type is required"),s.fieldtype==="Select"&&(!s.options||!s.options.trim())&&i.push("Options are required"),R[t][l]=i,i.length>0&&oe[t].push(l),i.length===0},Ws=(s,t,l)=>{const i=h[s].sections[t].afterCreated.find(m=>m.tableName===l);if(!i)return;const r=i.columns.length,u={fieldname:"",fieldtype:"",idx:r+1,label:"",value:"",isNew:!0,description:""};i.columns.push(u),tt(u,l,r,i.columns)},Zt=k([]),Js=(s,t,l,o)=>{const r=h[s].sections[t].afterCreated.find(m=>m.tableName===l);if(!r)return;r.columns.splice(o,1),r.columns.forEach((m,b)=>{m.idx=b+1});const u=oe.value[l];u&&(oe.value[l]=u.filter(m=>m!==o).map(m=>m>o?m-1:m))},Ys=(s,t,l)=>{const i=h[s].sections[t].afterCreated.find(r=>r.tableName===l);if(i){if(te[l]){oe[l]=[];let r=!0;if(i.columns.forEach((b,c)=>{tt(b,l,c,i.columns)||(r=!1)}),!r){x("Please fix the errors in the highlighted fields before saving!");return}const u=i.columns.map((F,f)=>{var E=F,{isNew:b}=E,c=Lt(E,["isNew"]);return Ne(re({},c),{idx:f+1,options:Ct(c)})}),m={form_short_name:Hs(l),fields:u,as_a_block:i.description};Q.post(X.childtable,m).then(b=>{Zt.value=b.data,me("Fields updated successfully!")}).catch(b=>{console.error("âŒ Saving fields failed:",b)})}te[l]=!te[l]}},te=fe({}),Zs=s=>{ce.value[s]||(ce.value[s]=[]);const t=ce.value[s].length+1;ce.value[s].push({fieldname:"",fieldtype:"",idx:t,label:"",value:"",isNew:!0,description:"",options:ce.value[s].options?`
${ce.value[s].options}`:""})},Gs=(s,t)=>{ce.value[s]&&ce.value[s].splice(t,1)},Ks=(s,t)=>{if(!s)return;oe.value||(oe.value={}),oe.value[s]||(oe.value[s]=[]);const l=ce.value[s];if(l){if(te[s]){oe.value[s]=[];let o=!0;if(l.forEach((u,m)=>{var c;vt(u,s,m);const b=(c=R[s])==null?void 0:c[m];b&&b.length>0&&(oe.value[s].push(m),o=!1),u.label&&(u.label=u.label.trim())}),!o){x("Please fix the errors before saving");return}const i=l.map((c,b)=>{var f=c,{isNew:u}=f,m=Lt(f,["isNew"]);return Ne(re({},m),{idx:b+1,options:Ct(m)})}),r={form_short_name:s,fields:i,as_a_block:t};Q.post(X.childtable,r).then(u=>{Zt.value=u.data,me("Fields updated successfully!")}).catch(u=>{console.error("âŒ Saving fields failed:",u)})}te[s]=!te[s],Yt.value=te[s]?s:null}},Qs=k([{id:1,label:"Form Info",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Form Fields",stepno:"Step 2",icon:"bi bi-grid-3x3-gap"},{id:3,label:"Workflow Setup",stepno:"Step 3",icon:"bi bi-diagram-3"},{id:4,label:"Print Format",stepno:"Step 4",icon:"ri-checkbox-circle-line"}]),Ft=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],bt=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],Xs=pe(()=>[He,...ne.value]),xs=pe(()=>{const s=_.value.accessible_departments;return s.includes(He)?"All Selected":s.length>1?`${s[0]}.. +${s.length-1} more selected`:s.join(", ")}),Is=s=>s===He?_.value.accessible_departments.length===ne.value.length:_.value.accessible_departments.includes(s),el=(s,t)=>{s===He?t.target.checked?_.value.accessible_departments=[...ne.value]:_.value.accessible_departments=[]:(t.target.checked?_.value.accessible_departments.push(s):_.value.accessible_departments=_.value.accessible_departments.filter(l=>l!==s),_.value.accessible_departments.length===ne.value.length?_.value.accessible_departments=[...ne.value]:_.value.accessible_departments=_.value.accessible_departments.filter(l=>l!==He))},tl=s=>{s===He&&(_.value.accessible_departments=[...ne.value])},sl=s=>{s===He&&(_.value.accessible_departments=[])},Dt=k(!1),st=pe(()=>{var t;let s=[...le.value];if(Ze.value&&(s=s.filter(l=>l.is_hod===1)),(t=Ae.value)!=null&&t.trim()){const l=Ae.value.toLowerCase();s=s.filter(o=>o.role.toLowerCase().includes(l))}return s.sort((l,o)=>l.role.localeCompare(o.role)),s.sort((l,o)=>{const i=P.value.includes(l.role),r=P.value.includes(o.role);return i===r?0:i?1:-1}),s.map(l=>l.role)}),ll=pe(()=>{const s=st.value;return s.length>0&&s.every(t=>P.value.includes(t))});Ve([P,st],()=>{const s=st.value;Dt.value=s.length>0&&s.every(t=>P.value.includes(t))},{immediate:!0,deep:!0});function ol(s){const t=s.target.checked,l=le.value.filter(o=>{var i;return!(Ze.value&&o.is_hod!==1||(i=Ae.value)!=null&&i.trim()&&!o.role.toLowerCase().includes(Ae.value.toLowerCase()))}).map(o=>o.role);t?P.value=Array.from(new Set([...P.value,...l])):P.value=P.value.filter(o=>!l.includes(o)),Dt.value=t}function al(){P.value=[],Dt.value=!1,Ze.value=!1}const he=k("");function nl(){const s=h[J.value];if(!s||!s.sections){console.error("Error: Invalid block or sections not found.");return}let t={type:J.value==0?"requestor":"approver",roles:P.value,approval_required:Fe.value,approver_can_edit:_e.value,fields:s.sections.flatMap(Et),idx:J.value};J.value!==0&&(t.view_only_reportee=he.value==="ViewOnlyReportee"?1:0,t.all_approvals_required=he.value==="all_approvals_required"?1:0,t.requester_as_a_approver=he.value==="requester_as_a_approver"?1:0,t.on_rejection=Ce.value?Ce.value:0);const l=W.findIndex(o=>o.idx===t.idx);l!==-1?W[l]=t:W.push(t),dl()}function G(s){const t=W.filter(i=>i.idx===s);if(t.length===0)return{roles:[]};if(t.length===1)return t[0];const l=re({},t[0]),o=[];return t.forEach(i=>{i.roles&&Array.isArray(i.roles)&&o.push(...i.roles)}),l.roles=o,console.log(`getWorkflowSetup(${s}): Found ${t.length} entries, merged roles:`,o),l}function il(s){const t=G(s),l=t.roles||[];P.value=[...l],Ce.value=t.on_rejection,Fe.value=t.approval_required,_e.value=t.approver_can_edit,t.view_only_reportee===1?he.value="ViewOnlyReportee":t.all_approvals_required===1?he.value="all_approvals_required":t.requester_as_a_approver===1?he.value="requester_as_a_approver":he.value=""}const St=s=>{Ze.value=!1,Ae.value="",he.value="",Ce.value="",_.value.accessible_departments.length&&rl(s,_.value.accessible_departments),J.value=s,il(s)};function rl(s,t){let l={index:s,departments:t,property:_.value.business_unit};Q.post(X.addDesignationroles,l).then(o=>{o.message&&(le.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function dl(){Q.post(X.add_roles_WF,{workflow_setup:W,doctype:_.value.form_short_name,business_unit:_.value.business_unit}).then(s=>{console.log(s),J.value==0?me("Requestor Added"):me(`Approver-${J.value} Added`)})}function cl(){B.push({path:ue.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function ul(){_.value.form_name="",_.value.form_short_name="",_.value.owner_of_the_form="",_.value.form_category="",_.value.accessible_departments=[],_.value.series="",_.value.has_workflow="",_.value.is_linked=0,_.value.is_linked_form="",_.value.mail_id="",_.value.public_form_response="",Z.value="",j.value="",q.value=[],ke.value=null}const pl=s=>{if(lt.value){x("Please check all required fields before proceeding.");return}s<T.value?At():s>T.value&&Vt()},Vt=()=>{if(lt.value){x("Please check all required fields before proceeding.");return}T.value<4&&(T.value+=1,T.value===4&&(ht.value=h))},At=()=>{T.value>1&&(T.value-=1)},ml=k([]);function Gt(){Nt.value=!0;const s={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:ve.EzyFormDefinitions,doc_id:d.value};Q.get(X.GetDoctypeData,{params:s}).then(t=>{var o;let l=t==null?void 0:t.message.data;if(l){l.accessible_departments&&typeof l.accessible_departments=="string"?l.accessible_departments=l.accessible_departments.split(",").filter(u=>u.trim()!==""):l.accessible_departments=[],_.value=Ne(re(re({},_.value),l),{owner_of_the_form:l.owner_of_the_form||_.value.owner_of_the_form||""}),_.value.owner_of_the_form&&qt(_.value.owner_of_the_form);const i=JSON.parse((o=t.message.data)==null?void 0:o.form_json);rt.value=i.workflow,p.value=i.fields.filter(u=>u.fieldtype==="Table"),ml.value=i.fields.filter(u=>u.fieldtype==="Table"),Ye.value=t.message.data.is_landscape;let r=is(JSON.parse(l==null?void 0:l.form_json).fields);ce.value=JSON.parse(t.message.data.form_json).child_table_fields,Es.value=[],dt.value=[],r.forEach((u,m)=>{h.push(u)}),JSON.parse(l==null?void 0:l.form_json).workflow.forEach((u,m)=>{W.push(u)})}}).catch(t=>{console.error("Error fetching data:",t),x("Failed to load form data. Please try again.")}).finally(()=>{Nt.value=!1})}function fl(){const s={};pt.value&&(s.print_format=pt.value),Ye.value!==void 0&&Ye.value!==null&&(s.is_landscape=Ye.value),Q.put(X.resource+ve.EzyFormDefinitions+`/${U.query.id}`,s).then(t=>{console.log(t),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),me("Print Format Added Successfully")}).catch(t=>{console.error("Error fetching  data:",t)})}function Kt(){const s={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${ue.value.business_unit||U.query.business_unit}`,doctype:ve.departments};Ot.value=!0,Q.get(X.GetDoctypeData,{params:s}).then(t=>{var l;(l=t==null?void 0:t.message.data)!=null&&l.length&&(ye.value=t.message.data.map(o=>o.name),ne.value=t.message.data.map(o=>o.name))}).catch(t=>{console.error("Error fetching department data:",t),x("Failed to load departments. Please refresh the page.")}).finally(()=>{Ot.value=!1})}k(""),Ve(()=>_.value.owner_of_the_form,s=>{s&&qt(s)});function qt(s){s&&typeof s=="string"&&s.trim()!==""&&vl(s)}function vl(s){zt.value=!0;const t={fields:JSON.stringify(["ezy_departments_items"]),doctype:ve.departments,doc_id:s};Q.get(X.GetDoctypeData,{params:t}).then(l=>{var o;(o=l==null?void 0:l.message.data)!=null&&o.ezy_departments_items&&(q.value=l.message.data.ezy_departments_items.map(i=>i.category))}).catch(l=>{console.error("Error fetching categories data:",l),x("Failed to load form categories. Please try again.")}).finally(()=>{zt.value=!1})}function Tt(s){let t=eo(h);const l=Ne(re({},_.value),{fields:t,doctype:ve.EzyFormDefinitions,workflow_setup:W,form_status:s==="save"?"Created":"Draft"});l.accessible_departments=l.accessible_departments.toString(),Q.post(X.savedata,l).then(o=>{if(o&&o.message&&o.message.message){let i=localStorage.getItem("preName");if(i){let r={installed:"Yes"};Q.put(`${X.resource}${ve.preDefinedForm}/${i}`,r).then(u=>{localStorage.removeItem("preName")}).catch(u=>{console.error("Error fetching ezyForms data:",u)})}if(B.push({params:{paramid:o.message.message},query:{id:o.message.message}}),d.value=o.message.message,d&&d!=="new"&&(h.splice(0,h.length),Gt()),W.length<h.length)ps("Add Workflow");else if(Xt.value===!0){me("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let r=localStorage.getItem("routepath");s==="save"?B.push({path:r}):s==="Draft"&&B.push({path:r})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const _t=k(""),Qt=()=>{var l,o;const s=h.length,t={label:s===0?"requestor":`approver-${s}`,parent:`${(l=Ee.value)==null?void 0:l.value}-${(o=_.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${Ee.value.value}-${_.value.form_short_name}`,childTables:[],afterCreated:{},rows:s===0?[{label:`row_0_0_${s}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${s}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${s}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};h.push(t),cs(()=>{_t.value&&_t.value.scrollTo({top:_t.value.scrollHeight,behavior:"smooth"})})},Xt=k(!1),xt=s=>{let t=h[s];t.parent&&ee.push(t);let l=[];W.length>s&&W[s].roles&&(l=[...W[s].roles]),h.splice(s,1),W.length>s&&W.splice(s,1),h.forEach((o,i)=>{o.sections.forEach((r,u)=>{r.rows.forEach((m,b)=>{m.columns.forEach((c,f)=>{ge(i,u,b,f)})})})}),l.length&&bl(l,s)};function bl(s,t){const l={role:s,level:t,document_type:_.value.form_name,short_name:_.value.form_short_name,property:_.value.business_unit};Q.post(X.deleteAssigneRoles,l).then(o=>{o&&Tt()})}const _l=(s,t)=>{const l={label:"",parent:`${Ee.value.value}-${_.value.form_short_name}`,rows:[{label:`row_0_${t}_${s}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};h[s].sections.splice(t+1,0,l)},hl=(s,t)=>{let l=h[s].sections[t];l.parent&&ee.push(l),h[s].sections.splice(t,1),h[s].sections.forEach((o,i)=>{o.rows.forEach((r,u)=>{r.columns.forEach((m,b)=>{ge(s,i,u,b)})})})},gl=(s,t,l)=>{h[s].sections[t].rows[l].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},yl=(s,t,l,o)=>{const r=h[s].sections[t].rows[l].columns,u=r[o];u.parent&&ee.push(u),r.length===1?h[s].sections[t].rows.splice(l,1):r.splice(o,1),h[s].sections.forEach((m,b)=>{m.rows.forEach((c,f)=>{c.columns.forEach((F,E)=>{ge(s,b,f,E)})})})},kl=(s,t,l,o)=>{h[s].sections[t].rows[l].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},wl=(s,t,l,o,i)=>{let r=h[s].sections[t].rows[l].columns[o].fields[i];r.parent&&ee.push(r),h[s].sections[t].rows[l].columns[o].fields.splice(i,1)},$l=(s,t,l,o,i)=>{const r=h[s].sections[t].rows[l].columns[o].fields[i],u=re({},r);u.name=`${r.name} Name the field`,h[s].sections[t].rows[l].columns[o].fields.splice(i+1,0,u)},Cl=(s,t,l,o,i)=>{const r=us(h);h.splice(0,h.length,...r);let u=h[s].sections[t].rows[l].columns[o].fields[i].fieldtype;(u!=="Select"||u!=="radio"||u!=="multiselect")&&(h[s].sections[t].rows[l].columns[o].fields[i].options="")};function Fl(s){return mt.includes(s==null?void 0:s.trim().toLowerCase())}function Dl(s){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(s)||s.includes('"')||s.includes("'")}function Sl(s){return s.flatMap(t=>{var l;return[(l=t.label)==null?void 0:l.trim().toLowerCase(),...t.sections.flatMap(o=>{var i;return[(i=o.label)==null?void 0:i.trim().toLowerCase(),...o.rows.flatMap(r=>r.columns.flatMap(u=>{var m;return[(m=u.label)==null?void 0:m.trim().toLowerCase(),...u.fields.map(b=>{var c;return(c=b.label)==null?void 0:c.trim().toLowerCase()})]}))]})]}).filter(t=>t!==""&&!Ht.includes(t))}function ge(s,t,l,o,i){const u=Sl(h).filter((c,f,F)=>F.indexOf(c)!==f),m=us(h);h.splice(0,h.length,...m);function b(c,f){if(!c){f.errorMsg="";return}Fl(c)?f.errorMsg="Entered label is restricted":Dl(c)?f.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:c.length>64?f.errorMsg="Label should not exceed 64 characters":f.errorMsg=u.includes(c.trim().toLowerCase())?"Duplicate Label Name":""}i!==void 0&&b(h[s].sections[t].rows[l].columns[o].fields[i].label,h[s].sections[t].rows[l].columns[o].fields[i]),i===void 0&&o!==void 0&&b(h[s].sections[t].rows[l].columns[o].label,h[s].sections[t].rows[l].columns[o]),o===void 0&&i===void 0&&b(h[s].sections[t].label,h[s].sections[t]),h.forEach(c=>{c.sections.forEach(f=>{b(f.label,f),f.rows.forEach(F=>{F.columns.forEach(E=>{b(E.label,E),E.fields.forEach(C=>{b(C.label,C)})})})})})}const Ut=pe(()=>{function s(t){return!t||typeof t!="object"?!1:"fieldtype"in t&&t.fieldtype===""||"error"in t&&t.error||"errorMsg"in t&&t.errorMsg||["Select","Table MultiSelect"].includes(t.fieldtype)&&(!t.options||t.options.trim()==="")?!0:Array.isArray(t)?t.some(s):Object.values(t).some(s)}return s(h)}),lt=pe(()=>Z.value.length>0||j.value.length>0||!_.value.form_category||!_.value.owner_of_the_form||_.value.accessible_departments.length===0),Vl=pe(()=>h.some(s=>s.sections.some(t=>t.rows.some(l=>l.columns.some(o=>o.fields.some(i=>i.label&&i.fieldtype))))));function It(s,t){let l=s.target.value.trim();if(!l){t==="form_name"?Z.value="Input cannot be empty or only spaces":t==="form_short_name"&&(j.value="Input cannot be empty or only spaces");return}if(l.length>63){t==="form_name"?Z.value="Name cannot exceed 63 characters":t==="form_short_name"&&(j.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(l)){t==="form_short_name"&&(j.value="First character must be a letter");return}else j.value="";if(t==="form_short_name"&&l.length<2){j.value="Short name must have at least 2 letters";return}if(t==="form_short_name"&&/[^a-zA-Z ]/.test(l)){j.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(l)){t==="form_name"?Z.value="Special characters are not allowed":t==="form_short_name"&&(j.value="Special characters are not allowed");return}else t==="form_name"?Z.value="":t==="form_short_name"&&(j.value="");const o=[[t,"=",`${l}`],["business_unit","=",`${_.value.business_unit}`]],i={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:ve.EzyFormDefinitions};Q.get(`${X.GetDoctypeData}`,{params:i}).then(r=>{de.value=r.message.data,t==="form_name"?Z.value=l&&de.value.some(u=>u.form_name&&u.form_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":t==="form_short_name"&&(j.value=l&&de.value.some(u=>u.form_short_name&&u.form_short_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(r=>{console.error("Error fetching ezyForms data:",r),t==="form_name"?Z.value="":t==="form_short_name"&&(j.value="")})}const Al=s=>s===0?"1st row":s===1?"2nd row":s===2?"3rd row":`${s+1}th row`,ht=k([]),ql=()=>{h.length&&(ht.value=h,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function Tl(){Q.post(X.delete_form_items,{deleted_fields:ee.flatMap(Et),doctype:d}).then(s=>{var t;(t=s==null?void 0:s.message)!=null&&t.success&&Tt()})}function es(s){return Qe(this,null,function*(){if(Ut.value){x("Please fix the errors before proceeding.");return}Xt.value=!0;let t=ee.flatMap(Et);d!=null&&d!=null&&d!="new"&&t.length?Tl():Tt(s)})}const Ul=()=>{ct.value.push({role:"",autoApproval:!1,permissions:{}})},Ll=s=>{ct.value.splice(s,1)},El=s=>{ps("Permission configuration modal will be implemented here")},ts=()=>Qe(this,null,function*(){var s;if(!(xe.value.length>0))try{const t={doctype:"WF Roadmap",fields:JSON.stringify(["name","roadmap_title","document_type","workflow_levels","property","cluster_name"]),filters:JSON.stringify([])},l=yield Q.get(X.GetDoctypeData,{params:t});(s=l==null?void 0:l.message)!=null&&s.data&&(xe.value=l.message.data.map(o=>({roadmap_title:o.name,display_name:`${o.roadmap_title} (${o.document_type})`,document_type:o.document_type,workflow_levels:o.workflow_levels,property:o.property,cluster_name:o.cluster_name})),console.log("Fetched WF Road Maps:",xe.value))}catch(t){console.error("Error fetching WF Road Maps:",t),x("Failed to fetch workflow road maps")}}),ss=s=>Qe(this,null,function*(){var t;try{console.log("Selected WF Road Map:",s);const l=yield Q.get(`${X.resource}${ve.wfRoadmap}/${s.roadmap_title}`),o=((t=l==null?void 0:l.data)==null?void 0:t.data)||(l==null?void 0:l.data)||{};console.log("WF Road Map Data:",o);const i=(o.wf_requestors&&o.wf_requestors.length>0,1),r={};o.wf_level_setup&&o.wf_level_setup.length>0&&o.wf_level_setup.forEach(c=>{r[c.level]||(r[c.level]=[]),r[c.level].push(c)});const u=Object.keys(r).length,m=i+u;for(console.log(`Required blocks: ${m} (1 requestor + ${u} approver levels)`),W=[],Je.value=[],Le.value=[];h.length>m;)h.pop();for(;h.length<m;)Qt();console.log(`Block adjustment complete: ${h.length} blocks`);let b=0;o.wf_requestors&&o.wf_requestors.length>0?(Je.value=o.wf_requestors,console.log(`Loaded ${o.wf_requestors.length} requestor role(s)`),o.wf_requestors.forEach(c=>{W.push({type:"requestor",roles:[c.requestor],auto_approval:c.auto_approval||0,columns_allowed:c.columns_allowed||"",fields:[],idx:0})})):console.warn("No Requestors found in roadmap, creating default requestor setup"),b=1,o.wf_level_setup&&o.wf_level_setup.length>0?(Le.value=o.wf_level_setup.sort((f,F)=>f.level-F.level),console.log(`Loaded ${o.wf_level_setup.length} approver level(s)`),Object.keys(r).sort((f,F)=>parseInt(f)-parseInt(F)).forEach(f=>{const F=r[f],E=b;console.log(`Level ${f} â†’ Block Index ${E}, Roles: ${F.length}`),F.forEach(C=>{W.push({type:"approver",level:parseInt(f),roles:[C.role],approval_required:C.mandatory?1:0,approver_can_edit:0,view_only_reportee:C.view_only_reportee||0,all_approvals_required:C.all_approvals_required||0,requester_as_a_approver:C.requester_as_a_approver||0,on_rejection:C.on_rejection||0,columns_allowed:C.columns_allowed||"",fields:[],idx:E})}),b++})):console.warn("No approver levels found in roadmap"),console.log("Final blockArr length:",h.length),console.log("Final workflowSetup:",W),me(`Workflow configured! ${Je.value.length} requestor role(s), ${Le.value.length} approver level(s) across ${h.length} blocks.`),cs(()=>{Te.value=0})}catch(l){console.error("Error in handleWFRoadMapSelect:",l),x("Failed to load workflow. Please try again.")}}),Ml=s=>{console.log("Field added from library:",s);const t=Te.value,l=h[t];if(!l){x("Please create a block first before adding fields");return}const o=ls(s);if(!o)return;l.sections||(l.sections=[]),l.sections.length===0&&l.sections.push({label:"",rows:[[{label:"",fields:[]}]]});const u=l.sections[0].rows[0][0];u.fields||(u.fields=[]),u.fields.push(o),console.log("Field added successfully:",o),me(`${o.label} field added successfully`)},Rl=s=>{console.log("Drag started:",s),A.value=s},Bl=()=>{console.log("Drag ended")},Ol=s=>{console.log("Advanced builder fields saved:",s),me(`${s.length} field(s) saved successfully!`)},zl=s=>{console.log("Advanced builder fields updated:",s)},Nl=s=>{const t=Te.value,l=h[t];if(!l){x("Please create a block first");return}l.sections||(l.sections=[]);let o=0;s.forEach(i=>{var F,E;const r=l.sections.length,u={label:i.label||"",parent:`${(F=Ee.value)==null?void 0:F.value}-${(E=_.value)==null?void 0:E.form_short_name}`,rows:[]},b={label:`row_0_${r}_${t}`,columns:[]},c=i.columns||1,f=Math.ceil(i.fields.length/c);for(let C=0;C<c;C++){const D={label:"",fields:[]},V=C*f,K=Math.min(V+f,i.fields.length);i.fields.slice(V,K).forEach(Y=>{const ze=re({label:Y.label,fieldname:Y.fieldname,fieldtype:Y.fieldtype,options:Y.options||"",reqd:Y.reqd||0,unique:Y.unique||0,description:Y.description||"",default:Y.default||"",read_only:Y.read_only||0,hidden:Y.hidden||0,depends_on:Y.depends_on||"",mandatory_depends_on:Y.mandatory_depends_on||"",read_only_depends_on:Y.read_only_depends_on||""},Y);D.fields.push(ze),o++}),b.columns.push(D)}u.rows.push(b),l.sections.push(u)}),me(`Added ${s.length} section(s) with ${o} field(s) to ${t===0?"Requestor":`Approver ${t}`} Block`),Ue.value=!1},ls=s=>{console.log("Creating field from Frappe type:",s);const t=bt.find(r=>r.type===s);if(!t)return console.error("Field type not found:",s),console.error("Available types:",bt.map(r=>r.type)),x(`Field type "${s}" not found. Please try again.`),null;const l=Date.now(),o=Math.random().toString(36).substring(2,6),i=`field_${l}_${o}`;return{id:`field_${l}_${o}`,fieldname:i,label:t.label,fieldtype:t.type,options:"",reqd:0,read_only:0,hidden:0,description:"",default:"",placeholder:""}};return(s,t)=>(a(),n("div",null,[e("div",Un,[e("div",Ln,[e("div",En,[e("div",Mn,[e("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:t[0]||(t[0]=l=>cl())},t[43]||(t[43]=[e("button",{class:"btn font-13 ms-3"},[e("i",{class:"bi bi-arrow-left"}),e("span",{class:"ms-2"},"Back")],-1)])),s.$route.query.id||s.$route.query.preId?(a(),n("span",Rn,"("+w(ue.value.formId||M(U).query.form_name)+")",1)):v("",!0)]),e("div",null,[T.value===2&&M(h).length&&!s.$route.query.id?(a(),n("button",{key:0,disabled:Ut.value||lt.value,style:Ql({cursor:Ut.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:t[1]||(t[1]=l=>es("Draft"))},t[44]||(t[44]=[e("i",{class:"bi bi-bookmark-check-fill"},null,-1),y(" Save As Draft ")]),12,Bn)):v("",!0)])]),e("div",On,[e("div",zn,[e("div",Nn,[e("div",Pn,[e("ul",Hn,[(a(!0),n(O,null,z(Qs.value,l=>(a(),n("li",{key:l.id,class:N({active:T.value===l.id,completed:T.value>l.id})},[e("div",{class:N(["d-flex gap-3 align-items-center",{"not-allowed":lt.value&&T.value+1===l.id}]),onClick:o=>pl(l.id)},[T.value>l.id?(a(),n("i",Wn)):(a(),n("i",{key:1,class:N(l.icon)},null,2)),e("div",Jn,[e("span",Yn,w(l.stepno),1),t[45]||(t[45]=e("br",null,null,-1)),e("span",Zn,w(l.label),1)])],10,jn)],2))),128))])])]),e("div",Gn,[e("div",Kn,[e("div",Qn,[T.value===1?(a(),n("div",Xn,[e("div",xn,[e("div",In,[t[48]||(t[48]=e("div",null,[e("h1",{class:"font-16 fw-bold m-0"},"Form Information"),e("p",{class:"font-12 text-muted m-0"},"Configure basic form settings and permissions")],-1)),e("div",ei,[!s.$route.query.id&&!s.$route.query.preId?(a(),n("button",{key:0,class:"btn btn-outline-secondary font-13",type:"button",onClick:ul},t[46]||(t[46]=[e("i",{class:"bi bi-x-circle me-1"},null,-1),y("Clear Form ")]))):v("",!0),T.value<5?(a(),n("button",{key:1,class:"btn btn-dark font-13 px-4",disabled:lt.value,onClick:Vt},t[47]||(t[47]=[y(" Next "),e("i",{class:"bi bi-arrow-right ms-1"},null,-1)]),8,ti)):v("",!0)])])]),e("div",si,[e("div",li,[e("div",oi,[e("div",ai,[e("div",ni,[t[53]||(t[53]=e("div",{class:"card-header bg-light border-bottom"},[e("h6",{class:"m-0 fw-bold font-14"},[e("i",{class:"bi bi-file-earmark-text me-2"}),y("Form Details")])],-1)),e("div",ii,[e("div",ri,[e("div",di,[e("div",ci,[M(U).query.preId?(a(),n("span",ui,t[49]||(t[49]=[e("i",{class:"bi bi-check2-circle me-1"},null,-1),y("Predefined ")]))):v("",!0),ae(it,{disabled:(ue.value.formId&&ue.value.formId.length>0||M(U).query.form_name)&&Be.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Enter form name (e.g., Leave Request)",onChange:t[2]||(t[2]=l=>It(l,"form_name")),modelValue:wt.value,"onUpdate:modelValue":t[3]||(t[3]=l=>wt.value=l)},null,8,["disabled","modelValue"]),Z.value?(a(),n("span",pi,[t[50]||(t[50]=e("i",{class:"bi bi-exclamation-circle me-1"},null,-1)),y(w(Z.value),1)])):v("",!0)])]),e("div",mi,[ae(it,{disabled:(ue.value.formId&&ue.value.formId.length>0||M(U).query.form_name)&&Be.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Enter short code (e.g., LR, PR)",onChange:t[4]||(t[4]=l=>It(l,"form_short_name")),modelValue:_.value.form_short_name,"onUpdate:modelValue":t[5]||(t[5]=l=>_.value.form_short_name=l)},null,8,["disabled","modelValue"]),j.value?(a(),n("span",fi,[t[51]||(t[51]=e("i",{class:"bi bi-exclamation-circle me-1"},null,-1)),y(w(j.value),1)])):v("",!0)]),e("div",vi,[ae(it,{disabled:ue.value.formId&&ue.value.formId.length>0&&Be.value!=="1",labeltext:"Form Naming Series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"e.g., YY-YY, YYYY, or ABC",modelValue:_.value.series,"onUpdate:modelValue":t[6]||(t[6]=l=>_.value.series=l)},null,8,["disabled","modelValue"]),t[52]||(t[52]=e("small",{class:"text-muted font-11 ms-1"},[e("i",{class:"bi bi-info-circle me-1"}),y(" Format examples: "),e("code",null,"YY-YY"),y(" â†’ 24-25-0001, "),e("code",null,"YYYY"),y(" â†’ 2025-0001, "),e("code",null,"ABC"),y(" â†’ ABC-0001 ")],-1))])])])]),e("div",bi,[t[60]||(t[60]=e("div",{class:"card-header bg-light border-bottom"},[e("h6",{class:"m-0 fw-bold font-14"},[e("i",{class:"bi bi-building me-2"}),y("Department & Permissions")])],-1)),e("div",_i,[e("div",hi,[e("div",gi,[e("label",yi,[t[54]||(t[54]=y(" Owner Department ")),_.value.owner_of_the_form?v("",!0):(a(),n("span",ki,"*"))]),ae(M(Pe),{disabled:ue.value.formId&&ue.value.formId.length>0&&Be.value!=="1",onOpen:Kt,options:ye.value,onChange:qt,modelValue:_.value.owner_of_the_form,"onUpdate:modelValue":t[7]||(t[7]=l=>_.value.owner_of_the_form=l),placeholder:"Select owning department",multiple:!1,class:"font-12 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"]),t[55]||(t[55]=e("small",{class:"text-muted font-11 ms-1"},[e("i",{class:"bi bi-info-circle me-1"}),y("Department that owns and manages this form ")],-1))]),e("div",wi,[e("label",$i,[t[56]||(t[56]=y(" Form Category ")),_.value.form_category?v("",!0):(a(),n("span",Ci,"*"))]),ae(M(Pe),{disabled:ue.value.formId&&ue.value.formId.length>0&&Be.value!=="1",options:q.value,modelValue:_.value.form_category,"onUpdate:modelValue":t[8]||(t[8]=l=>_.value.form_category=l),placeholder:"Select a category",multiple:!1,searchable:!0,class:"font-12 multiselect"},null,8,["disabled","options","modelValue"]),t[57]||(t[57]=e("small",{class:"text-muted font-11 ms-1"},[e("i",{class:"bi bi-info-circle me-1"}),y("Categorize this form for better organization ")],-1))]),e("div",Fi,[e("label",Di,[t[58]||(t[58]=y(" Accessible to Departments ")),_.value.accessible_departments.length?v("",!0):(a(),n("span",Si,"*"))]),ae(M(Pe),{modelValue:_.value.accessible_departments,"onUpdate:modelValue":t[10]||(t[10]=l=>_.value.accessible_departments=l),options:Xs.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select departments that can access this form",class:"font-12",onSelect:tl,onRemove:sl,openDirection:"bottom"},{option:Mt(({option:l})=>[e("div",Vi,[e("input",{type:"checkbox",checked:Is(l),class:"custom-checkbox",onChange:o=>el(l,o),onClick:t[9]||(t[9]=be(()=>{},["stop"]))},null,40,Ai),e("span",null,w(l),1)])]),selection:Mt(({values:l,isOpen:o})=>[l.length?$((a(),n("span",{key:0,class:"multiselect__single font-11"},w(xs.value),513)),[[yt,!o]]):v("",!0)]),_:1},8,["modelValue","options"]),t[59]||(t[59]=e("small",{class:"text-muted font-11 ms-1"},[e("i",{class:"bi bi-info-circle me-1"}),y("Users from these departments can raise requests using this form ")],-1))])])])]),e("div",qi,[t[67]||(t[67]=e("div",{class:"card-header bg-light border-bottom"},[e("h6",{class:"m-0 fw-bold font-14"},[e("i",{class:"bi bi-gear me-2"}),y("Form Settings")])],-1)),e("div",Ti,[e("div",Ui,[e("div",Li,[t[62]||(t[62]=e("label",{class:"form-label font-13 fw-medium"},"Form Type",-1)),ae(M(Pe),{options:Pt,modelValue:kt.value,"onUpdate:modelValue":t[11]||(t[11]=l=>kt.value=l),placeholder:"Select form visibility",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:l=>l.value,class:"font-12 multiselect",openDirection:"bottom"},null,8,["modelValue","reduce"]),e("small",Ei,[t[61]||(t[61]=e("i",{class:"bi bi-info-circle me-1"},null,-1)),kt.value===1?(a(),n("span",Mi,"Public forms are accessible via QR code without login")):(a(),n("span",Ri,"Private forms require authentication to access"))])]),e("div",Bi,[t[63]||(t[63]=e("label",{class:"form-label font-13 fw-medium"},[y(" Enable Workflow "),e("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(M(Pe),{options:["Yes","No"],modelValue:_.value.has_workflow,"onUpdate:modelValue":t[12]||(t[12]=l=>_.value.has_workflow=l),placeholder:"Enable approval workflow?",multiple:!1,class:"font-12 multiselect",searchable:!0},null,8,["modelValue"]),t[64]||(t[64]=e("small",{class:"text-muted font-11 ms-1"},[e("i",{class:"bi bi-info-circle me-1"}),y("Enable if this form requires multi-level approvals ")],-1))]),_.value.has_workflow==="Yes"?(a(),n("div",Oi,[t[65]||(t[65]=e("label",{class:"form-label font-13 fw-medium"},[y(" Use Existing Workflow "),e("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(M(Pe),{onOpen:ts,options:xe.value,modelValue:ke.value,"onUpdate:modelValue":t[13]||(t[13]=l=>ke.value=l),placeholder:"Select a workflow roadmap",multiple:!1,class:"font-12 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:ss,openDirection:"bottom"},null,8,["options","modelValue"]),t[66]||(t[66]=e("small",{class:"text-muted font-11 ms-1"},[e("i",{class:"bi bi-info-circle me-1"}),y(" Auto-populates requestor and approver configurations from existing workflow ")],-1))])):v("",!0)])])]),_.value.as_web_view===1?(a(),n("div",zi,[t[72]||(t[72]=e("div",{class:"card-header bg-light border-bottom"},[e("h6",{class:"m-0 fw-bold font-14"},[e("i",{class:"bi bi-qr-code me-2"}),y("Public Form Settings")])],-1)),e("div",Ni,[e("div",Pi,[e("div",Hi,[t[68]||(t[68]=e("label",{class:"form-label font-13 fw-medium"},[y(" Submit Response Message "),e("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(it,{class:"formHeight",type:"text",tag:"input",name:"Value",id:"formSubmitResponse",placeholder:"e.g., Thank you! Your request has been submitted.",modelValue:_.value.public_form_response,"onUpdate:modelValue":t[14]||(t[14]=l=>_.value.public_form_response=l)},null,8,["modelValue"]),t[69]||(t[69]=e("small",{class:"text-muted font-11 ms-1"},[e("i",{class:"bi bi-info-circle me-1"}),y("Message shown to users after successful form submission ")],-1))]),e("div",ji,[t[70]||(t[70]=e("label",{class:"form-label font-13 fw-medium"},[y(" Notification Email(s) "),e("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(it,{class:"formHeight",type:"text",tag:"input",name:"Value",id:"formSubmitEmail",placeholder:"email1@example.com, email2@example.com",modelValue:_.value.mail_id,"onUpdate:modelValue":t[15]||(t[15]=l=>_.value.mail_id=l)},null,8,["modelValue"]),t[71]||(t[71]=e("small",{class:"text-muted font-11 ms-1"},[e("i",{class:"bi bi-info-circle me-1"}),y("Email addresses to notify on form submission (comma-separated) ")],-1))])])])])):v("",!0),M(U).query.preId?(a(),n("div",Wi,[t[76]||(t[76]=e("div",{class:"card-header bg-light border-bottom"},[e("h6",{class:"m-0 fw-bold font-14"},[e("i",{class:"bi bi-link-45deg me-2"}),y("Advanced Options")])],-1)),e("div",Ji,[e("div",Yi,[e("div",Zi,[e("div",Gi,[$(e("input",{class:"form-check-input",disabled:_.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":t[16]||(t[16]=l=>_.value.is_linked=l),"true-value":1,"false-value":0},null,8,Ki),[[I,_.value.is_linked]]),t[73]||(t[73]=e("label",{class:"form-check-label font-13",for:"is_linked"}," Link this form to another form ",-1))]),t[74]||(t[74]=e("small",{class:"text-muted font-11 ms-4"},[e("i",{class:"bi bi-info-circle me-1"}),y("Create a relationship between this form and an existing form ")],-1))]),_.value.is_linked?(a(),n("div",Qi,[t[75]||(t[75]=e("label",{class:"form-label font-13 fw-medium"},"Linked Form",-1)),e("div",Xi,[$(e("input",{type:"text",class:"form-control font-13",id:"standardFormInput",disabled:_.value.is_predefined_doctype==1,"onUpdate:modelValue":t[17]||(t[17]=l=>_.value.is_linked_form=l),placeholder:"Type to search and select a form...",onInput:_s,onFocus:t[18]||(t[18]=l=>qe.value=!0),onBlur:gs},null,40,xi),[[L,_.value.is_linked_form]]),qe.value&&je.value.length?(a(),n("ul",Ii,[(a(!0),n(O,null,z(je.value,(l,o)=>(a(),n("li",{class:"list-group-item list-group-item-action font-12",key:o,onMousedown:be(i=>hs(l.name),["prevent"]),style:{cursor:"pointer"}},w(l.name),41,er))),128))])):v("",!0)])])):v("",!0)])])])):v("",!0)])])])])])):v("",!0),T.value===2?(a(),n("div",tr,[e("div",sr,[e("div",lr,[e("button",{onClick:t[19]||(t[19]=l=>At()),class:"btn btn-sm btn-light"},t[77]||(t[77]=[e("i",{class:"bi bi-chevron-left"},null,-1),y(" Back ")]))]),e("div",or,[(a(!0),n(O,null,z(M(h),(l,o)=>(a(),n("button",{key:o,class:N(["zoho-tab",{active:Te.value===o}]),onClick:i=>Te.value=o},[t[78]||(t[78]=e("i",{class:"bi bi-file-earmark-text me-1"},null,-1)),y(" "+w(o===0?"Requestor Block":`Approver Block ${o}`)+" ",1),M(h).length>1?(a(),n("i",{key:0,class:"bi bi-x-lg ms-2",onClick:be(i=>xt(o),["stop"])},null,8,nr)):v("",!0)],10,ar))),128))]),e("div",ir,[e("button",{class:N(["btn btn-sm me-2",Ue.value?"btn-dark":"btn-outline-dark"]),onClick:t[20]||(t[20]=l=>Ue.value=!Ue.value),title:"Toggle Advanced Field Builder"},[e("i",{class:N(Ue.value?"bi bi-tools":"bi bi-grid-3x3-gap")},null,2),y(" "+w(Ue.value?"Advanced":"Simple"),1)],2),e("button",{class:"btn btn-sm btn-primary me-2",onClick:Qt},t[79]||(t[79]=[e("i",{class:"bi bi-plus-lg me-1"},null,-1),y("Add Block ")])),Vl.value?(a(),n("button",{key:0,class:"btn btn-sm btn-light me-2",onClick:ql},t[80]||(t[80]=[e("i",{class:"bi bi-eye me-1"},null,-1),y("Preview ")]))):v("",!0),M(h).length?(a(),n("button",{key:1,class:"btn btn-sm btn-dark",onClick:t[21]||(t[21]=l=>es("save"))},w(M(d)!=="new"?"Update Form":"Create Form"),1)):v("",!0)])]),e("div",rr,[Ue.value?(a(),n("div",dr,[t[81]||(t[81]=e("div",{class:"alert alert-info mb-3"},[e("i",{class:"bi bi-info-circle me-2"}),e("strong",null,"Advanced Mode:"),y(" Use this mode to access all Frappe field types and advanced field properties. Fields created here will be added to the current block. ")],-1)),ae(Tn,{ref_key:"frappeBuilderRef",ref:Bt,formName:wt.value,currentBlockIndex:Te.value,onSave:Ol,onUpdate:zl,onAddFields:Nl},null,8,["formName","currentBlockIndex"])])):(a(),n(O,{key:1},[e("aside",{class:N(["zoho-field-library",{collapsed:!We.value}])},[e("div",{class:"library-header",onClick:t[22]||(t[22]=l=>We.value=!We.value)},[e("div",cr,[e("h6",ur,[t[82]||(t[82]=e("i",{class:"bi bi-grid-3x3-gap me-2"},null,-1)),y(" "+w(We.value?"Field Types":"Fields"),1)]),e("button",pr,[e("i",{class:N(We.value?"bi bi-chevron-left":"bi bi-chevron-right")},null,2)])])]),We.value?(a(),n("div",mr,[ae(io,{fields:bt,onFieldAdd:Ml,onFieldDragstart:Rl,onFieldDragend:Bl})])):v("",!0)],2),e("div",fr,[e("div",{class:"canvas-inner",ref_key:"mainBlockRef",ref:_t},[(a(!0),n(O,null,z(M(h),(l,o)=>$((a(),n("div",{class:"block-level",key:o},[e("div",vr,[e("div",br,[e("div",_r,[e("h6",hr,w(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),e("div",gr,[o!==0&&G(o).view_only_reportee||G(o).all_approvals_required||G(o).requester_as_a_approver?(a(),n("div",yr,[e("span",kr,w(G(o).view_only_reportee===1?"Reporting Manager only":"")+" "+w(G(o).all_approvals_required===1?"All of the selected approvers":"")+" "+w(G(o).requester_as_a_approver===1?"Approval by Requestor":""),1),e("span",null,[t[83]||(t[83]=e("span",{class:"ms-1"}," on rejection escalating to ",-1)),e("span",wr,w(G(o).on_rejection?`Level ${G(o).on_rejection}`:"Requestor"),1)]),e("span",$r,w(G(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):v("",!0)])]),e("div",Cr,[M(d)&&M(W).length?(a(),n("div",Fr,[G(o)?(a(),n("label",Dr,[e("span",Sr,w(G(o).roles.length>0?o===0?"Requestor Roles: ":"Approver Roles: ":""),1),e("span",Vr,w(G(o).roles.slice(0,2).join(", ")),1),G(o).roles.length>2?(a(),n("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:i=>St(o),class:"more-count badge bg-primary ms-2",style:{cursor:"pointer"}}," +"+w(G(o).roles.length-2)+" more ",9,Ar)):v("",!0)])):v("",!0)])):v("",!0),vs(o)&&M(d)!=null&&M(d)!=null&&M(d)!="new"&&G(o).roles.length===0?(a(),n("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:i=>St(o)},[t[84]||(t[84]=e("img",{src:to,alt:"Add",class:"me-1"},null,-1)),y(" "+w(o===0?"Add Requestors":"Add Approvers"),1)],8,qr)):v("",!0),M(d)!=null&&M(d)!=null&&M(d)!="new"&&G(o).roles.length>0?(a(),n("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:i=>St(o)},t[85]||(t[85]=[e("i",{class:"bi bi-pencil font-14"},null,-1)]),8,Tr)):v("",!0),e("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:i=>xt(o)},t[86]||(t[86]=[e("i",{class:"bi bi-trash me-1"},null,-1),y(" Delete Block ")]),8,Ur)])])]),e("div",Lr,[(a(!0),n(O,null,z(l.sections,(i,r)=>(a(),n("div",{key:"section-"+r,class:"dynamicSection mt-0 section"},[e("section",Er,[e("div",Mr,[$(e("input",{"onUpdate:modelValue":u=>i.label=u,type:"text",class:N(["border-less-input","font-14",{"italic-style":!i.label},{"fw-medium":i.label}]),onChange:u=>ge(o,r),onInput:u=>ge(o,r),placeholder:"Untitled section"},null,42,Rr),[[L,i.label]]),i.errorMsg?(a(),n("small",Br,w(i.errorMsg),1)):v("",!0)]),e("div",Or,[e("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:u=>hl(o,r)},t[87]||(t[87]=[e("i",{class:"bi bi-trash me-1"},null,-1),y(" Delete Section ")]),8,zr)])]),e("div",Nr,[(a(!0),n(O,null,z(i.rows,(u,m)=>(a(),n("section",{class:"row dynamicRow row-container",key:"row-"+m},[e("div",Pr,[e("label",Hr,w(Al(m)),1),e("div",null,[u.columns.length<3?(a(),n("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:b=>gl(o,r,m)},t[88]||(t[88]=[e("i",{class:"bi bi-plus font-14"},null,-1),y(" Add Column ")]),8,jr)):v("",!0)])]),e("div",Wr,[e("div",Jr,[(a(!0),n(O,null,z(u.columns,(b,c)=>(a(),n("div",{key:"column-"+c,onMouseenter:f=>Ss(o,r,m,c),onMouseleave:Vs,class:"col p-0 dynamicColumn position-relative column-container"},[e("div",Zr,[e("div",Gr,[$(e("input",{"onUpdate:modelValue":f=>b.label=f,type:"text",class:N(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!b.label},{"fw-medium":b.label}]),onChange:f=>ge(o,r,m,c),onInput:f=>ge(o,r,m,c),placeholder:"Column Name"},null,42,Kr),[[L,b.label]]),b.errorMsg?(a(),n("small",Qr,w(b.errorMsg),1)):v("",!0)]),$(e("div",Xr,[e("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:f=>yl(o,r,m,c)},t[89]||(t[89]=[e("i",{class:"bi bi-x-lg"},null,-1)]),8,xr)],512),[[yt,As(o,r,m,c)]])]),b.fields.length===0?(a(),n("div",{key:0,class:"empty-drop-zone",onDragover:t[23]||(t[23]=be(()=>{},["prevent"])),onDrop:f=>Me(f,o,r,m,c,s.fieldIndex)},null,40,Ir)):v("",!0),(a(!0),n(O,null,z(b.fields,(f,F)=>{var E;return a(),n("div",{key:"field-"+F,onMouseenter:C=>Cs(o,r,m,c,F),onMouseleave:Fs,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:C=>jt(C,o,r,m,c,F),onDragover:t[27]||(t[27]=be(()=>{},["prevent"])),onDrop:C=>Me(C,o,r,m,c,F)},[e("div",{class:"drop-zone",onDragover:t[24]||(t[24]=be(()=>{},["prevent"])),onDrop:C=>Me(C,o,r,m,c,F)},null,40,td),f.fieldtype!=="Table"?(a(),n("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:C=>jt(C,o,r,m,c,F),onDragover:t[25]||(t[25]=be(()=>{},["prevent"])),onDrop:C=>Me(C,o,r,m,c,F)},[e("div",ld,[e("div",od,[$(e("input",{"onUpdate:modelValue":C=>f.label=C,placeholder:"Name the field",class:N(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!f.label},{"fw-medium":f.label}]),onChange:C=>ge(o,r,m,c,F),onInput:C=>ge(o,r,m,c,F)},null,42,ad),[[L,f.label]]),f.errorMsg?(a(),n("small",nd,w(f.errorMsg),1)):v("",!0)]),$(e("div",id,[e("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:C=>$l(o,r,m,c,F)},t[90]||(t[90]=[e("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,rd),e("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:C=>{wl(o,r,m,c,F),ge(o,r,m,c)}},t[91]||(t[91]=[e("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,dd)],512),[[yt,Ds(o,r,m,c,F)]])]),$(e("select",{"onUpdate:modelValue":C=>f.fieldtype=C,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:C=>Cl(o,r,m,c,F)},[t[92]||(t[92]=e("option",{value:""},"Select Type",-1)),(a(),n(O,null,z(bt,C=>e("option",{key:C,value:C.type},w(C.label),9,ud)),64))],40,cd),[[$e,f.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(f.fieldtype)?(a(),n("div",pd,[t[93]||(t[93]=e("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),$(e("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":C=>f.options=C,class:"form-control shadow-none mb-1 font-12"},null,8,md),[[L,f.options]]),!f.options||f.options.trim()===""?(a(),n("small",fd," Options are required for this field type. ")):v("",!0)])):v("",!0),f.fieldtype==="Link"?(a(),n("div",vd,[e("label",{class:"font-11 fw-light",for:"link-search-"+De(o,r,m,c,F)}," Search Doctype: ",8,bd),$(e("input",{id:"link-search-"+De(o,r,m,c,F),type:"text","onUpdate:modelValue":C=>M(h)[o].sections[r].rows[m].columns[c].fields[F].options=C,onInput:C=>ks(M(h)[o].sections[r].rows[m].columns[c].fields[F].options,o,r,m,c,F),onFocus:C=>ys(De(o,r,m,c,F)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,_d),[[L,M(h)[o].sections[r].rows[m].columns[c].fields[F].options]]),(E=et[De(o,r,m,c,F)])!=null&&E.length&&$t[De(o,r,m,c,F)]?(a(),n("ul",hd,[(a(!0),n(O,null,z(et[De(o,r,m,c,F)],(C,D)=>(a(),n("li",{key:D,onClick:V=>ws(o,r,m,c,F,C.name),class:"list-group-item list-group-item-action"},w(C.name),9,gd))),128))])):v("",!0)])):v("",!0),e("div",yd,[e("div",kd,[e("div",wd,[$(e("input",{class:"font-12","onUpdate:modelValue":C=>f.reqd=C,"true-value":1,id:"mandatory-"+o+"-"+r+"-"+m+"-"+c+"-"+F,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,$d),[[I,f.reqd]])]),e("div",null,[e("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+r+"-"+m+"-"+c+"-"+F},"Mandatory",8,Cd)])]),e("div",null,[e("button",{class:"btn btn-sm font-12",onClick:C=>f.showDescription=!f.showDescription},w(f.showDescription?"Hide Description":f.description?"Edit Description":"Add Description"),9,Fd)])]),f.showDescription?$((a(),n("textarea",{key:2,"onUpdate:modelValue":C=>f.description=C,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,Dd)),[[L,f.description]]):v("",!0),f.error?(a(),n("small",Sd,w(f.error),1)):v("",!0)],40,sd)):v("",!0),e("div",{class:"drop-zone",onDragover:t[26]||(t[26]=be(()=>{},["prevent"])),onDrop:C=>Me(C,o,r,m,c,F)},null,40,Vd),e("div",Ad,[e("div",null,[e("div",null,[e("div",qd,[f.fieldtype==="Table"?(a(),n("div",Td,[(a(!0),n(O,null,z(ce.value,(C,D)=>(a(),n("div",{key:D,class:"childTable"},[D===f.fieldname||D===f.options?(a(),n("h5",Ud,w(D.replace(/_/g," ")),1)):v("",!0),te[D]&&D===Yt.value?(a(),n("div",Ld,[e("div",Ed,[f.showDescription?$((a(),n("input",{key:0,"onUpdate:modelValue":V=>f.description=V,class:"form-control font-12",placeholder:"Enter field description"},null,8,Md)),[[L,f.description]]):v("",!0),e("button",{class:"btn btn-sm text-nowrap font-12",onClick:V=>f.showDescription=!f.showDescription},w(f.showDescription?"Hide Description":f.description?"Edit Description":"Add Description"),9,Rd)])])):v("",!0),D===f.options||D===f.fieldname?(a(),n("table",Bd,[t[97]||(t[97]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Label"),e("th",null,"Field Type")])],-1)),e("tbody",{onDragover:be(Us,["prevent"]),onDrop:V=>Ls(V,C)},[(a(!0),n(O,null,z(C,(V,K)=>{var Ke,Y,ze,ot,at,nt,ie;return a(),n("tr",{key:K,draggable:te[D],onDragstart:se=>qs(K),onDragend:Ts,class:N({dragging:Oe.value===K})},[e("td",null,w(K+1),1),te[D]?(a(),n("td",Nd,[$(e("input",{"onUpdate:modelValue":se=>V.label=se,onInput:se=>vt(V,D,K),placeholder:"Field Label",class:N(["form-control",{"border-1 border-danger":(Y=(Ke=R[D])==null?void 0:Ke[K])==null?void 0:Y.length}])},null,42,Pd),[[L,V.label]]),(ot=(ze=R[D])==null?void 0:ze[K])!=null&&ot.length?(a(),n("div",Hd,[(a(!0),n(O,null,z(R[D][K],(se,Pl)=>(a(),n("div",{key:Pl},w(se),1))),128))])):v("",!0)])):(a(),n("td",jd,w(V.label),1)),te[D]?(a(),n("td",Wd,[e("div",Jd,[$(e("select",{"onUpdate:modelValue":se=>V.fieldtype=se,onChange:se=>vt(V,D,K),class:N(["form-select form-select-sm",{"border-1 border-danger":(nt=(at=R[D])==null?void 0:at[K])==null?void 0:nt.length}])},[t[94]||(t[94]=e("option",{value:""},"Select Type",-1)),(a(),n(O,null,z(Ft,se=>e("option",{key:se.type,value:se.type},w(se.label),9,Zd)),64))],42,Yd),[[$e,V.fieldtype]]),e("div",Gd,[e("div",Kd,[e("div",Qd,[$(e("input",{class:"font-12 form-control-sm","onUpdate:modelValue":se=>V.description=se,placeholder:"description",type:"text"},null,8,Xd),[[L,V.description]])])]),e("button",{class:"btn btn-light btn-sm",onClick:se=>Gs(D,K)},t[95]||(t[95]=[e("i",{class:"bi bi-x-lg"},null,-1)]),8,xd)])]),["Select"].includes(V.fieldtype)?(a(),n("div",Id,[t[96]||(t[96]=e("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),$(e("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":se=>V.options=se,onInput:se=>vt(V,D,K),class:"form-control shadow-none mb-1 font-12"},null,40,ec),[[L,V.options]]),!V.options||V.options.trim()===""?(a(),n("small",tc," Options are required for this field type. ")):v("",!0)])):v("",!0),(ie=oe[D])!=null&&ie.includes(K)?(a(),n("span",sc,"Type required**")):v("",!0)])):(a(),n("td",lc,w(V.fieldtype),1))],42,zd)}),128))],40,Od)])):v("",!0),f.fieldtype==="Table"&&(f.label===D||f.fieldname===D)?(a(),n("div",oc,[e("button",{class:"btn btn-light btn-sm mx-2",onClick:V=>Ks(D,f.description)},w(te[D]?"Save":"Edit"),9,ac),te[D]?(a(),n("button",{key:0,class:"btn btn-light btn-sm",onClick:V=>Zs(D)}," Add More Field ",8,nc)):v("",!0)])):v("",!0)]))),128))])):v("",!0)])])])])],40,ed)}),128)),e("div",{class:"drop-zone-bottom",onDragover:t[28]||(t[28]=be(()=>{},["prevent"])),onDrop:f=>Me(f,o,r,m,c,b.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,ic),e("div",{class:"drop-zone",onDragover:t[29]||(t[29]=be(()=>{},["prevent"])),onDrop:f=>Me(f,o,r,m,c,s.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,rc),e("div",dc,[e("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:f=>kl(o,r,m,c)},t[98]||(t[98]=[e("i",{class:"bi bi-plus fs-5"},null,-1),e("span",null,"Add Field",-1)]),8,cc)])],40,Yr))),128))])])]))),128)),e("div",null,[(a(!0),n(O,null,z(i.afterCreated,(u,m)=>(a(),n("div",{key:m,class:"childTable dynamicColumn m-0 p-2"},[e("h5",uc,w(u.tableName),1),te[u.tableName]?(a(),n("div",pc,[e("div",mc,[u.showDescription?$((a(),n("input",{key:0,"onUpdate:modelValue":b=>u.description=b,class:"form-control font-12",placeholder:"Enter field description"},null,8,fc)),[[L,u.description]]):v("",!0),e("button",{class:"btn btn-sm text-nowrap font-12",onClick:b=>u.showDescription=!u.showDescription},w(u.showDescription?"Hide Description":u.description?"Edit Description":"Add Description"),9,vc)])])):v("",!0),e("table",bc,[t[104]||(t[104]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Label"),e("th",null,"Field Type")])],-1)),e("tbody",null,[(a(!0),n(O,null,z(u.columns,(b,c)=>{var f,F,E,C;return a(),n("tr",{key:c},[e("td",null,w(c+1),1),te[u.tableName]?(a(),n("td",_c,[$(e("input",{"onUpdate:modelValue":D=>b.label=D,placeholder:"Field Label",class:N(["form-control",{"border-1 border-danger":(f=oe[u.tableName])==null?void 0:f.includes(c)}]),onBlur:D=>{var V;b.label=(V=b.label)==null?void 0:V.trim(),tt(b,u.tableName,c,u.columns)}},null,42,hc),[[L,b.label]]),(F=R[u.tableName])!=null&&F[c]?(a(),n("div",gc,[(a(!0),n(O,null,z(R[u.tableName][c],(D,V)=>(a(),n("span",{key:V},[y(w(D)+" ",1),t[99]||(t[99]=e("br",null,null,-1))]))),128))])):v("",!0)])):(a(),n("td",yc,w(b.label),1)),te[u.tableName]?(a(),n("td",kc,[e("div",wc,[$(e("select",{"onUpdate:modelValue":D=>b.fieldtype=D,class:N(["form-select form-select-sm",{"border-1 border-danger":(E=oe[u.tableName])==null?void 0:E.includes(c)}]),onChange:D=>tt(b,u.tableName,c,u.columns)},[t[100]||(t[100]=e("option",{value:""},"Select Type",-1)),(a(),n(O,null,z(Ft,D=>e("option",{key:D.type,value:D.type},w(D.label),9,Cc)),64))],42,$c),[[$e,b.fieldtype]]),e("button",{class:"btn btn-light btn-sm",onClick:D=>Js(o,r,u.tableName,c)},t[101]||(t[101]=[e("i",{class:"bi bi-x-lg"},null,-1)]),8,Fc)]),b.fieldtype==="Select"?(a(),n("div",Dc,[t[102]||(t[102]=e("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),$(e("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":D=>b.options=D,class:"form-control shadow-none mb-1 font-12",onInput:D=>tt(b,u.tableName,c,u.columns)},null,40,Sc),[[L,b.options]])])):v("",!0),(C=R[u.tableName])!=null&&C[c]?(a(),n("div",Vc,[(a(!0),n(O,null,z(R[u.tableName][c],(D,V)=>(a(),n("span",{key:V},[y(w(D),1),t[103]||(t[103]=e("br",null,null,-1))]))),128))])):v("",!0)])):(a(),n("td",Ac,w(b.fieldtype),1))])}),128))])]),e("div",qc,[e("button",{class:"btn btn-light btn-sm mx-2",onClick:b=>Ys(o,r,u.tableName)},w(te[u.tableName]?"Save":"Edit"),9,Tc),te[u.tableName]?(a(),n("button",{key:0,class:"btn btn-light btn-sm",onClick:b=>Ws(o,r,u.tableName)}," Add More Field ",8,Uc)):v("",!0)])]))),128))])]),e("div",null,[e("div",null,[o==0?(a(),n("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:u=>Ms(o,r)}," Add New Table ",8,Lc)):v("",!0),(a(!0),n(O,null,z(i.childTables,(u,m)=>{var b;return a(),n("div",{key:`table-${o}-${r}-${m}`,class:"child-table"},[u.newTable?(a(),n("div",Ec,[e("div",Mc,[e("div",null,[e("span",{class:N(u.tableName?"d-none":"text-danger")},"*",2),$(e("input",{"onUpdate:modelValue":c=>u.tableName=c,placeholder:"Table Name",onBlur:c=>Wt(u),class:N(["border-less-input font-14 p-0 inputHeight",{"italic-style":!u.tableName,"fw-medium":u.tableName}])},null,42,Rc),[[L,u.tableName]]),(b=R[`${o}-${r}-${m}`])!=null&&b.tableName?(a(),n("div",Bc,w(R[`${o}-${r}-${m}`].tableName),1)):v("",!0),Ge.value?(a(),n("div",Oc,w(Ge.value),1)):v("",!0),e("div",zc,[e("div",Nc,[u.showDescription?$((a(),n("input",{key:0,"onUpdate:modelValue":c=>u.as_a_block=c,class:"form-control font-12",placeholder:"Enter field description"},null,8,Pc)),[[L,u.as_a_block]]):v("",!0),e("button",{class:"btn btn-sm text-nowrap font-12",onClick:c=>u.showDescription=!u.showDescription},w(u.showDescription?"Hide Description":u.description?"Edit Description":"Add Description"),9,Hc)])])]),e("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:c=>Bs(o,r,m)},t[105]||(t[105]=[e("i",{class:"bi bi-trash"},null,-1),y(" Remove Table ")]),8,jc)]),(a(!0),n(O,null,z(u.columns,(c,f)=>{var F,E,C,D,V,K,Ke,Y,ze,ot,at,nt;return a(),n("div",{key:f,class:"dynamicField"},[e("div",Wc,[e("div",Jc,[e("div",null,[e("span",{class:N(c.label?"d-none":"text-danger")},"*",2),$(e("input",{"onUpdate:modelValue":ie=>c.label=ie,placeholder:"Name the field",onBlur:()=>{Wt(c),zs(c,o,r,m,f,u.columns)},class:N(["border-less-input font-14 p-0 inputHeight",{"italic-style":!c.label,"fw-medium":c.label,"is-invalid":(C=(E=(F=R[`${o}-${r}-${m}`])==null?void 0:F.columns)==null?void 0:E[f])==null?void 0:C.label}])},null,42,Yc),[[L,c.label]]),(K=(V=(D=R[`${o}-${r}-${m}`])==null?void 0:D.columns)==null?void 0:V[f])!=null&&K.label?(a(),n("div",Zc,w(R[`${o}-${r}-${m}`].columns[f].label),1)):v("",!0)]),e("div",Gc,[e("div",Kc,[c.showDescription?$((a(),n("input",{key:0,"onUpdate:modelValue":ie=>c.description=ie,class:"form-control font-12",placeholder:"Enter field description"},null,8,Qc)),[[L,c.description]]):v("",!0),e("button",{class:"btn btn-sm text-nowrap font-12",onClick:ie=>c.showDescription=!c.showDescription},w(c.showDescription?"Hide Description":c.description?"Edit Description":"Add Description"),9,Xc)]),e("button",{class:"btn btn-sm trash-btn py-0",onClick:ie=>Os(o,r,m,f)},t[106]||(t[106]=[e("i",{class:"bi bi-x-lg"},null,-1)]),8,xc)])]),$(e("select",{"onUpdate:modelValue":ie=>c.fieldtype=ie,class:N(["form-select font-13 mb-1",{"is-invalid":(ze=(Y=(Ke=R[`${o}-${r}-${m}`])==null?void 0:Ke.columns)==null?void 0:Y[f])==null?void 0:ze.fieldtype}])},[t[107]||(t[107]=e("option",{value:""},"Select Type",-1)),(a(),n(O,null,z(Ft,ie=>e("option",{key:ie.type,value:ie.type},w(ie.label),9,eu)),64))],10,Ic),[[$e,c.fieldtype]]),["Select"].includes(c.fieldtype)?(a(),n("div",tu,[t[108]||(t[108]=e("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),$(e("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":ie=>c.options=ie,class:"form-control shadow-none mb-1 font-12"},null,8,su),[[L,c.options]]),!c.options||c.options.trim()===""?(a(),n("small",lu," Options are required for this field type. ")):v("",!0)])):v("",!0),(nt=(at=(ot=R[`${o}-${r}-${m}`])==null?void 0:ot.columns)==null?void 0:at[f])!=null&&nt.fieldtype?(a(),n("div",ou,w(R[`${o}-${r}-${m}`].columns[f].fieldtype),1)):v("",!0)])])}),128)),e("button",{class:"btn btn-light btn-sm addField mx-1",onClick:c=>Rs(o,r,m)},t[109]||(t[109]=[e("i",{class:"bi bi-plus"},null,-1),y(" Add Field ")]),8,au),e("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:c=>js(o,r,m)}," Create Table ",8,nu),t[110]||(t[110]=e("hr",null,null,-1))])):v("",!0)])}),128))])]),e("div",iu,[e("button",{class:"btn btn-light border font-12",onClick:u=>_l(o,r)},t[111]||(t[111]=[e("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),y(" Add Section ")]),8,ru)])]))),128)),o===0?(a(),n("div",du)):v("",!0)])])),[[yt,o===Te.value]])),128))],512)]),g.value?(a(),n("aside",cu,[e("div",uu,[t[113]||(t[113]=e("h6",{class:"mb-0"},"Field Properties",-1)),e("button",{class:"btn btn-sm btn-link p-0",onClick:t[30]||(t[30]=l=>g.value=null)},t[112]||(t[112]=[e("i",{class:"bi bi-x-lg"},null,-1)]))]),t[114]||(t[114]=e("div",{class:"properties-content"},[e("p",{class:"text-muted small"},"Select a field to edit its properties")],-1))])):v("",!0)],64))])])):v("",!0),T.value===3?(a(),n("div",pu,[e("div",mu,[e("button",{onClick:t[31]||(t[31]=l=>At()),class:"btn btn-sm btn-light"},t[115]||(t[115]=[e("i",{class:"bi bi-chevron-left"},null,-1),y(" Back ")])),t[117]||(t[117]=e("h1",{class:"font-14 fw-bold m-0"},"Workflow Setup",-1)),e("button",{class:"btn btn-sm btn-dark",onClick:Vt},t[116]||(t[116]=[y(" Next "),e("i",{class:"bi bi-chevron-right"},null,-1)]))]),e("div",fu,[e("div",vu,[t[123]||(t[123]=e("div",{class:"card-header bg-light"},[e("h6",{class:"mb-0 fw-bold"},[e("i",{class:"bi bi-diagram-3 me-2"}),y("Workflow Configuration")])],-1)),e("div",bu,[e("div",_u,[e("div",hu,[t[120]||(t[120]=e("label",{class:"form-label fw-bold"},"Workflow Type",-1)),e("div",gu,[$(e("input",{type:"radio",class:"btn-check",name:"workflowType",id:"existingWorkflow",value:"existing","onUpdate:modelValue":t[32]||(t[32]=l=>we.value=l)},null,512),[[rs,we.value]]),t[118]||(t[118]=e("label",{class:"btn btn-outline-primary",for:"existingWorkflow"},[e("i",{class:"bi bi-folder me-1"}),y("Use Existing ")],-1)),$(e("input",{type:"radio",class:"btn-check",name:"workflowType",id:"newWorkflow",value:"new","onUpdate:modelValue":t[33]||(t[33]=l=>we.value=l),checked:""},null,512),[[rs,we.value]]),t[119]||(t[119]=e("label",{class:"btn btn-outline-primary",for:"newWorkflow"},[e("i",{class:"bi bi-plus-circle me-1"}),y("Create New ")],-1))])]),we.value==="existing"?(a(),n("div",yu,[t[121]||(t[121]=e("label",{class:"form-label fw-bold"},"Select Workflow",-1)),ae(M(Pe),{onOpen:ts,options:xe.value,modelValue:ke.value,"onUpdate:modelValue":t[34]||(t[34]=l=>ke.value=l),placeholder:"Select WF Road Map",multiple:!1,class:"font-11 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:ss,openDirection:"bottom"},null,8,["options","modelValue"]),t[122]||(t[122]=e("small",{class:"text-muted font-12 mt-1 d-block"},[e("i",{class:"bi bi-info-circle me-1"}),y("Auto-populates requestors and approvers ")],-1))])):v("",!0)])])]),we.value==="new"?(a(),n("div",ku,[t[129]||(t[129]=e("div",{class:"card-header bg-light"},[e("h6",{class:"mb-0 fw-bold"},[e("i",{class:"bi bi-person-plus me-2"}),y("Requestor Configuration")])],-1)),e("div",wu,[t[128]||(t[128]=e("p",{class:"text-muted font-12 mb-3"},[e("i",{class:"bi bi-info-circle me-1"}),y(" Define who can submit requests for this form based on WF Requestors ")],-1)),e("button",{class:"btn btn-primary btn-sm mb-3",onClick:Ul},t[124]||(t[124]=[e("i",{class:"bi bi-plus-lg me-1"},null,-1),y("Add Requestor Role ")])),ct.value.length>0?(a(),n("div",$u,[e("table",Cu,[t[127]||(t[127]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{width:"40%"},"Role"),e("th",{width:"30%"},"Auto Approval"),e("th",{width:"20%"},"Permissions"),e("th",{width:"10%"},"Action")])],-1)),e("tbody",null,[(a(!0),n(O,null,z(ct.value,(l,o)=>(a(),n("tr",{key:o},[e("td",null,[$(e("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":i=>l.role=i,placeholder:"Enter role name"},null,8,Fu),[[L,l.role]])]),e("td",null,[e("div",Du,[$(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":i=>l.autoApproval=i},null,8,Su),[[I,l.autoApproval]]),e("label",Vu,w(l.autoApproval?"Yes":"No"),1)])]),e("td",null,[e("button",{class:"btn btn-sm btn-outline-secondary",onClick:i=>El()},t[125]||(t[125]=[e("i",{class:"bi bi-gear"},null,-1),y(" Configure ")]),8,Au)]),e("td",null,[e("button",{class:"btn btn-sm btn-danger",onClick:i=>Ll(o)},t[126]||(t[126]=[e("i",{class:"bi bi-trash"},null,-1)]),8,qu)])]))),128))])])])):v("",!0)])])):v("",!0),we.value==="existing"&&ke.value&&Je.value.length>0?(a(),n("div",Tu,[t[135]||(t[135]=e("div",{class:"card-header bg-success text-white"},[e("h6",{class:"mb-0 fw-bold"},[e("i",{class:"bi bi-check-circle me-2"}),y("Loaded Requestors")])],-1)),e("div",Uu,[e("div",Lu,[t[130]||(t[130]=e("i",{class:"bi bi-check-circle me-1"},null,-1)),e("strong",null,w(Je.value.length),1),t[131]||(t[131]=y(" requestor role(s) loaded from ")),e("strong",null,w(ke.value.display_name),1)]),e("div",Eu,[e("table",Mu,[t[133]||(t[133]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Role"),e("th",null,"Auto Approval"),e("th",null,"Columns Allowed")])],-1)),e("tbody",null,[(a(!0),n(O,null,z(Je.value,(l,o)=>(a(),n("tr",{key:o},[e("td",null,[e("strong",null,w(l.requestor),1)]),e("td",null,[l.auto_approval?(a(),n("span",Ru,t[132]||(t[132]=[e("i",{class:"bi bi-check-circle me-1"},null,-1),y("Yes ")]))):(a(),n("span",Bu,"No"))]),e("td",null,[e("small",Ou,w(l.columns_allowed||"All fields"),1)])]))),128))])])]),t[134]||(t[134]=e("div",{class:"alert alert-info mt-3"},[e("i",{class:"bi bi-info-circle me-1"}),y(" Go to "),e("strong",null,"Step 2"),y(" and click "),e("strong",null,'"Add Requestors"'),y(" to select specific designations for these roles ")],-1))])])):v("",!0),we.value==="existing"&&ke.value&&Le.value.length>0?(a(),n("div",zu,[t[144]||(t[144]=e("div",{class:"card-header bg-primary text-white"},[e("h6",{class:"mb-0 fw-bold"},[e("i",{class:"bi bi-diagram-3 me-2"}),y("Loaded Approval Workflow")])],-1)),e("div",Nu,[e("div",Pu,[t[136]||(t[136]=e("i",{class:"bi bi-check-circle me-1"},null,-1)),e("strong",null,w(Le.value.length),1),t[137]||(t[137]=y(" approval level(s) loaded from ")),e("strong",null,w(ke.value.display_name),1)]),e("div",Hu,[e("table",ju,[t[142]||(t[142]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{width:"10%"},"Level"),e("th",{width:"25%"},"Role"),e("th",{width:"15%"},"Mandatory"),e("th",{width:"20%"},"Approval Type"),e("th",{width:"30%"},"Columns Allowed")])],-1)),e("tbody",null,[(a(!0),n(O,null,z(Le.value,(l,o)=>(a(),n("tr",{key:o},[e("td",null,[e("span",Wu,"Level "+w(l.level),1)]),e("td",null,[e("strong",null,w(l.role),1)]),e("td",null,[l.mandatory?(a(),n("span",Ju,t[138]||(t[138]=[e("i",{class:"bi bi-exclamation-circle me-1"},null,-1),y("Required ")]))):(a(),n("span",Yu,"Optional"))]),e("td",null,[l.view_only_reportee?(a(),n("span",Zu,t[139]||(t[139]=[e("i",{class:"bi bi-person me-1"},null,-1),y("Reporting Manager ")]))):l.all_approvals_required?(a(),n("span",Gu,t[140]||(t[140]=[e("i",{class:"bi bi-people me-1"},null,-1),y("All Users ")]))):l.requester_as_a_approver?(a(),n("span",Ku,t[141]||(t[141]=[e("i",{class:"bi bi-person-check me-1"},null,-1),y("Requestor ")]))):(a(),n("span",Qu," Any One "))]),e("td",null,[e("small",Xu,w(l.columns_allowed||"All fields"),1)])]))),128))])])]),t[143]||(t[143]=e("div",{class:"alert alert-info mt-3"},[e("i",{class:"bi bi-info-circle me-1"}),y(" Go to "),e("strong",null,"Step 2"),y(" and click "),e("strong",null,'"Add Approvers"'),y(" for each level to select specific designations ")],-1))])])):v("",!0),t[145]||(t[145]=Xl('<div class="card mt-4" data-v-17a9891b><div class="card-header bg-light" data-v-17a9891b><h6 class="mb-0 fw-bold" data-v-17a9891b><i class="bi bi-shield-check me-2" data-v-17a9891b></i>System Generated Fields</h6></div><div class="card-body" data-v-17a9891b><div class="alert alert-secondary mb-3" data-v-17a9891b><i class="bi bi-info-circle me-2" data-v-17a9891b></i> These fields are automatically included for all requestors. </div><div class="row g-3" data-v-17a9891b><div class="col-md-6" data-v-17a9891b><div class="field-preview-card" data-v-17a9891b><label class="form-label fw-bold" data-v-17a9891b>Requestor Name</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-17a9891b></div></div><div class="col-md-6" data-v-17a9891b><div class="field-preview-card" data-v-17a9891b><label class="form-label fw-bold" data-v-17a9891b>Requestor Email</label><input type="email" class="form-control" value="Auto-populated from user profile" disabled data-v-17a9891b></div></div><div class="col-md-6" data-v-17a9891b><div class="field-preview-card" data-v-17a9891b><label class="form-label fw-bold" data-v-17a9891b>Request Date</label><input type="text" class="form-control" value="Auto-populated on submission" disabled data-v-17a9891b></div></div><div class="col-md-6" data-v-17a9891b><div class="field-preview-card" data-v-17a9891b><label class="form-label fw-bold" data-v-17a9891b>Department</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-17a9891b></div></div></div></div></div>',1))])])):v("",!0),T.value===4?(a(),n("div",xu,[t[146]||(t[146]=e("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[e("div",null,[e("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),e("div")],-1)),ae(ds,{blockArr:ht.value},null,8,["blockArr"])])):v("",!0)])])])])])])]),e("div",Iu,[e("div",ep,[e("div",tp,[t[150]||(t[150]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",sp,[t[148]||(t[148]=e("label",{for:""},"Form Name",-1)),$(e("input",{"onUpdate:modelValue":t[35]||(t[35]=l=>pt.value=l),multiple:!1,placeholder:M(U).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,lp),[[L,pt.value]]),e("div",op,[e("div",ap,[$(e("input",{class:"font-12","onUpdate:modelValue":t[36]||(t[36]=l=>Ye.value=l),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[I,Ye.value]])]),t[147]||(t[147]=e("div",null,[e("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),e("div",{class:"modal-footer"},[t[149]||(t[149]=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),e("button",{type:"button",class:"btn btn-dark",onClick:fl},"Add Print Format")])])])]),e("div",np,[e("div",ip,[e("div",rp,[t[151]||(t[151]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"formViewModalLabel"},"Form Preview"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",dp,[ae(ds,{blockArr:ht.value},null,8,["blockArr"])]),t[152]||(t[152]=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])]),e("div",cp,[e("div",up,[e("span",pp,w(J.value==0?"Add Requestors":`Approval Settings - Level ${J.value}`),1),t[153]||(t[153]=e("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),e("div",mp,[e("div",fp,[J.value!==0?(a(),n("div",vp,[t[155]||(t[155]=e("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),$(e("select",{"onUpdate:modelValue":t[37]||(t[37]=l=>he.value=l),class:"form-select shadow-none font-12"},t[154]||(t[154]=[e("option",{value:""},"Any one of the selected approvers",-1),e("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),e("option",{value:"all_approvals_required"},"All of the selected approvers",-1),e("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[$e,he.value]])])):v("",!0),e("div",bp,[e("div",_p,[e("span",hp," Select "+w(J.value===0?"Requestors":"Approvers"),1),e("span",gp,w(P.value.length)+" Selected ",1)]),le.value.length?(a(),n("div",yp,[e("div",kp,[e("div",wp,[e("input",{type:"checkbox",id:"selectAll",checked:ll.value,onChange:ol,class:"form-check-input me-2 designationCheckBox"},null,40,$p),e("label",Cp," Select all designation ("+w(st.value.length)+") ",1)]),J.value!==0?(a(),n("div",Fp,[$(e("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":t[38]||(t[38]=l=>Ze.value=l),class:"form-check-input me-2 designationCheckBox"},null,512),[[I,Ze.value]]),t[156]||(t[156]=e("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):v("",!0),e("div",null,[P.value.length?(a(),n("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:al},t[157]||(t[157]=[e("i",{class:"bi bi-x"},null,-1),y(" Clear all ")]))):v("",!0)])]),le.value.length?(a(),ms(M(xl),{key:0,multiple:!0,modelValue:P.value,"onUpdate:modelValue":t[39]||(t[39]=l=>P.value=l),options:st.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):v("",!0)],512)):(a(),n("div",Dp,t[158]||(t[158]=[e("div",{class:"d-flex justify-content-center"},[e("span",null,"No Designations Found")],-1)])))]),J.value!==0?(a(),n("div",Sp,[t[159]||(t[159]=e("div",null,[e("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),$(e("select",{"onUpdate:modelValue":t[40]||(t[40]=l=>Ce.value=l),class:"form-select shadow-none font-12 mt-1 me-2"},[(a(!0),n(O,null,z($s.value,l=>(a(),n("option",{key:l,value:l},w(l===0?"Requestor":"Approver Level "+l),9,Vp))),128))],512),[[$e,Ce.value,void 0,{number:!0}]])])):v("",!0),J.value!==0?(a(),n("div",Ap,[e("div",qp,[e("div",Tp,[$(e("input",{"onUpdate:modelValue":t[41]||(t[41]=l=>Fe.value=l),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[I,Fe.value]]),t[160]||(t[160]=e("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),Xe.value===!0?(a(),n("div",Up,[$(e("input",{"onUpdate:modelValue":t[42]||(t[42]=l=>_e.value=l),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[I,_e.value]]),t[161]||(t[161]=e("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):v("",!0)])])):v("",!0)]),e("div",Lp,[e("div",Ep,[ae(Il,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:nl,name:J.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},Op=Rt(Mp,[["__scopeId","data-v-17a9891b"]]);export{Op as default};
