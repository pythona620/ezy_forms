import{f as F,d as r,e as U,w as L,q as M,o as n,c as o,b as s,t as u,g as p,h as i,a as m,F as b,_ as W,P as D,s as E,E as T,l as S,m as V,n as O}from"./index-B-ZWE6ER.js";const A={class:"d-flex justify-content-between align-items-center"},I={class:"m-0 font-11 pt-1"},J={class:"d-flex gap-3 align-items-center"},j={class:"d-flex align-items-center"},H={class:"me-2"},z={key:0,class:"process-date font-12 m-0"},G={key:1,class:"process-date font-12 m-0"},K={key:2,class:"process-date font-12 m-0"},Q={key:3,class:"process-date font-12 m-0"},X={key:4,class:"process-date font-12 m-0"},Y={key:5,class:"process-date font-12 m-0"},Z={key:6,class:"process-date font-12 m-0"},ee={type:"button",class:"filterbtn d-flex align-items-center position-relative","data-bs-toggle":"modal","data-bs-target":"#fileterModal"},te={key:0,class:"badge badge-light colorappiled"},se={class:"modal fade",id:"fileterModal",tabindex:"-1","aria-labelledby":"fileterModalLabel","aria-hidden":"true"},ae={class:"modal-dialog modal-lg"},le={class:"modal-content"},ne={class:"modal-body"},oe={class:"row"},ie={class:"col-6"},de={class:"col-6"},re={class:"col-6"},ue={class:"col-6"},pe={class:"col-6"},ce={class:"modal-footer"},me={class:"mt-2"},be={__name:"MyTeam",setup(fe){const C=F(()=>T.value),q=r({business_unit:""}),f=r({limitPageLength:"None",limit_start:0}),v=r(0),N=r([{th:"Request ID",td_key:"name"},{th:"Form name",td_key:"doctype_name"},{th:"Owner of form",td_key:"owner"},{th:"Requested on",td_key:"requested_on"},{th:"Approval Status",td_key:"status"}]),$=r([{name:"View Request",icon:"fa-solid fa-eye"},{name:"Share this form",icon:"fa-solid fa-share-alt"},{name:"Download Form",icon:"fa-solid fa-download"},{name:"Edit Form",icon:"fa-solid fa-edit"}]),y=r([]),e=U({appliedname:!1,applieddoctype_name:!1,appliedaccessible_departments:!1,appliedStatus:!1,appliedrequest_id:!1,appiedrequestedOn:!1,appliedowner:!1,name:"",doctype_name:"",accessible_departments:"",status:"",request_id:"",requested_on:"",owner:""}),k=F(()=>[{value:e.doctype_name,applied:e.applieddoctype_name},{value:e.name,applied:e.appliedname},{value:e.status,applied:e.appliedStatus},{value:e.accessible_departments,applied:e.appliedaccessible_departments},{value:e.request_id,applied:e.appliedrequest_id},{value:e.requested_on,applied:e.appiedrequestedOn},{value:e.owner,applied:e.appliedowner}].filter(a=>a.applied&&a.value).length);function c(a){a==="name"?(e.name="",e.appliedname=!1):a==="doctype_name"?(e.doctype_name="",e.applieddoctype_name=!1):a==="accessible_departments"?(e.accessible_departments="",e.appliedaccessible_departments=!1):a==="status"?(e.status="",e.appliedStatus=!1):a==="request_id"?(e.request_id="",e.appliedrequest_id=!1):a==="requested_on"?(e.requested_on="",e.appiedrequestedOn=!1):a==="owner"&&(e.owner="",e.appliedowner=!1),w()}function w(){e.appliedname=!!e.name,e.applieddoctype_name=!!e.doctype_name,e.appliedaccessible_departments=!!e.accessible_departments,e.appliedStatus=!!e.status,e.appliedrequest_id=!!e.request_id,e.appiedrequestedOn=!!e.requested_on,e.appliedowner=!!e.owner,g()}const B=a=>{f.value.limitPageLength=a,f.value.limit_start=0,g()},P=([a,t])=>{f.value.limitPageLength=a,f.value.limit_start=t,g()},x=r([]),R=r([]),h=r([]);function g(){const a=[["property","like",`%${q.value.business_unit}%`]];e.name&&a.push(["name","=",e.name]),e.doctype_name&&a.push(["doctype_name","=",e.doctype_name]),e.accessible_departments&&a.push(["accessible_departments","like",e.accessible_departments]),e.status&&a.push(["status","like",e.status]),e.request_id&&a.push(["request_id","like",e.request_id]),e.requested_on&&a.push(["requested_on","like",e.requested_on]),e.owner&&a.push(["owner","like",e.owner]);const t={fields:JSON.stringify(["*"]),limit_page_length:f.value.limitPageLength,limit_start:f.value.limit_start,filters:JSON.stringify(a),order_by:"`tabWF Workflow Requests`.`creation` desc"},l={fields:JSON.stringify(["count(`tabWF Workflow Requests`.`name`) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(a)};S.get(`${V.resource}${O.WFWorkflowRequests}`,{params:l}).then(d=>{v.value=d.data[0].total_count}).catch(d=>{console.error("Error fetching total count:",d)}),S.get(`${V.resource}${O.WFWorkflowRequests}`,{params:t}).then(d=>{console.log("output-res",d),y.value=d.data,x.value=[...new Set(d.data.map(_=>_.name))],R.value=[...new Set(d.data.map(_=>_.doctype_name))],h.value=[...new Set(d.data.map(_=>_.status))]}).catch(d=>{console.error("Error fetching records:",d)})}return L(C,a=>{q.value.business_unit=a,a.length&&(console.log(a,"new value of business unit"),g())},{immediate:!0}),M(()=>{}),(a,t)=>(n(),o(E,null,[s("div",A,[s("div",null,[t[13]||(t[13]=s("h1",{class:"m-0 font-13"}," Requests raised for My Team ",-1)),s("p",I,u(v.value)+" request ",1)]),s("div",J,[s("div",j,[s("div",null,[s("div",H,[e.name&&e.appliedname?(n(),o("span",z,[p(u(e.name)+" ",1),e.name?(n(),o("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[0]||(t[0]=l=>c("name"))},t[14]||(t[14]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):i("",!0)])):i("",!0),e.doctype_name&&e.applieddoctype_name?(n(),o("span",G,[p(u(e.doctype_name)+" ",1),e.doctype_name?(n(),o("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[1]||(t[1]=l=>c("doctype_name"))},t[15]||(t[15]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):i("",!0)])):i("",!0),e.accessible_departments&&e.appliedaccessible_departments?(n(),o("span",K,[p(u(e.accessible_departments)+" ",1),e.accessible_departments?(n(),o("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[2]||(t[2]=l=>c("accessible_departments"))},t[16]||(t[16]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):i("",!0)])):i("",!0),e.status&&e.appliedStatus?(n(),o("span",Q,[p(u(e.status)+" ",1),e.status?(n(),o("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[3]||(t[3]=l=>c("status"))},t[17]||(t[17]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):i("",!0)])):i("",!0),e.request_id&&e.appliedrequest_id?(n(),o("span",X,[p(u(e.request_id)+" ",1),e.request_id?(n(),o("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[4]||(t[4]=l=>c("request_id"))},t[18]||(t[18]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):i("",!0)])):i("",!0),e.requested_on&&e.appiedrequestedOn?(n(),o("span",Y,[p(u(e.requested_on)+" ",1),e.requested_on?(n(),o("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[5]||(t[5]=l=>c("requested_on"))},t[19]||(t[19]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):i("",!0)])):i("",!0),e.owner&&e.appliedowner?(n(),o("span",Z,[p(u(e.owner)+" ",1),e.owner?(n(),o("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[6]||(t[6]=l=>c("owner"))},t[20]||(t[20]=[s("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):i("",!0)])):i("",!0)])]),s("div",null,[s("button",ee,[t[21]||(t[21]=s("span",null,[s("i",{class:"ri-filter-2-line"})],-1)),k.value!==0?(n(),o("span",te," ( "+u(k.value)+") ",1)):i("",!0)])])]),s("div",se,[s("div",ae,[s("div",le,[s("div",ne,[s("div",oe,[s("div",ie,[t[22]||(t[22]=s("label",{class:"font-13 ps-1",for:"Requested"},"Request Id:",-1)),m(b,{tag:"select",placeholder:"Requested Id",class:"mb-3",name:"dept",modelValue:e.name,"onUpdate:modelValue":t[7]||(t[7]=l=>e.name=l),id:"id",Required:!1,options:x.value},null,8,["modelValue","options"])]),s("div",de,[t[23]||(t[23]=s("label",{class:"font-13 ps-1",for:"Requested"},"Form Name:",-1)),m(b,{tag:"select",placeholder:"Form Name",class:"mb-3",name:"dept",modelValue:e.doctype_name,"onUpdate:modelValue":t[8]||(t[8]=l=>e.doctype_name=l),id:"id",Required:!1,options:R.value},null,8,["modelValue","options"])]),s("div",re,[t[24]||(t[24]=s("label",{class:"font-13 ps-1",for:"dept"},"Requested On:",-1)),m(b,{class:"",tag:"input",type:"search",name:"Requested",id:"Requested",placeholder:"Search",modelValue:e.requested_on,"onUpdate:modelValue":t[9]||(t[9]=l=>e.requested_on=l)},null,8,["modelValue"])]),s("div",ue,[t[25]||(t[25]=s("label",{class:"font-13 ps-1",for:"status"},"Status:",-1)),m(b,{tag:"select",placeholder:"Status",class:"mb-3",name:"status",modelValue:e.status,"onUpdate:modelValue":t[10]||(t[10]=l=>e.status=l),id:"status",Required:!1,options:h.value},null,8,["modelValue","options"])]),s("div",pe,[t[26]||(t[26]=s("label",{class:"font-13 ps-1",for:"Requested"},"Owner Of Form:",-1)),m(b,{class:"mb-3",tag:"input",type:"search",name:"Requested",id:"Requested",placeholder:"Search",modelValue:e.owner,"onUpdate:modelValue":t[11]||(t[11]=l=>e.owner=l)},null,8,["modelValue"])])])]),s("div",ce,[s("button",{type:"button",class:"cancelfilter border-0 text-nowrap font-10",onClick:t[12]||(t[12]=(...l)=>a.resetFilters&&a.resetFilters(...l)),"data-bs-dismiss":"modal"},t[27]||(t[27]=[s("span",{class:"font-14 me-1"},"x",-1),p("Cancel Filter")])),s("button",{type:"button",class:"applyfilter text-nowrap border-0 btn btn-dark text-white font-10 d-flex justify-content-center align-items-center","data-bs-dismiss":"modal",onClick:w},t[28]||(t[28]=[s("span",{class:"font-16 me-1"},[s("i",{class:"bi bi-check2"})],-1),p(" Apply Filter")]))])])])])])]),s("div",me,[m(W,{tHeaders:N.value,tData:y.value,isAction:"true",actionType:"dropdown",isCheckbox:"true",actions:$.value},null,8,["tHeaders","tData","actions"]),m(D,{currentRecords:y.value.length,totalRecords:v.value,onUpdateValue:B,onLimitStart:P},null,8,["currentRecords","totalRecords"])])],64))}};export{be as default};
