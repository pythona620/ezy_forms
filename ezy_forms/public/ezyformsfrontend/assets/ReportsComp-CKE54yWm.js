import{_ as N,d as a,f as B,M as L,o as u,c as p,C as k,b as o,a as f,G as C,i as $,I as j,k as _,l as i,n as P}from"./index-LfV3iEDw.js";const U={class:"d-flex justify-content-between align-content-center py-3"},F={class:"btn-group dropdown"},H={class:"dropdown-menu font-12",style:{transform:"translate(-124px, 42px) !important"}},T={__name:"ReportsComp",setup(A){const c=a(!1),m=a([]);a([]);function x(){const t=[["module","=","ezy_custom_forms"]],e={fields:JSON.stringify(["*"]),filters:JSON.stringify(t)};_.get(i.resource+P.reportsApi,{params:e}).then(n=>{n.data&&(m.value=n.data)}).catch(n=>{console.error("Error:",n)})}const v=a([]),b=a([]);a([]);const l=a("");function D(t){console.log("data===",t),l.value=t.name,c.value=!0,_.get(i.repostListData,{params:{report_name:l.value}}).then(e=>{var n,s,g;e&&(n=e==null?void 0:e.message)!=null&&n.columns&&(v.value=(s=e==null?void 0:e.message)==null?void 0:s.result,b.value=(g=e==null?void 0:e.message)==null?void 0:g.columns.map(r=>{let d={};return d.th=r==null?void 0:r.label,d.td_key=r==null?void 0:r.fieldname,d}))}).catch(e=>{console.error("Error",e)})}function E(){const t=document.getElementById("datatable");if(t){t.focus();const e=new KeyboardEvent("keydown",{key:"f",keyCode:70,ctrlKey:!0,bubbles:!0});t.dispatchEvent(e)}}function y(t){t.ctrlKey&&t.key==="f"&&(t.preventDefault(),E())}function R(){c.value=!1}const h=a([{th:"Name",td_key:"name"}]);function w(t){const e=l.value,n=t,s=i.ExportReport+`?report_name=${encodeURIComponent(e)}&file_format_type=${encodeURIComponent(n)}`;window.open(s,"_blank")}function I(t){if(!(t!=null&&t.name)||!(l!=null&&l.value)){console.error("Missing required data for PDF download");return}const e=l.value,n=t.name||t.Name||t.id||t.report_name;console.log(e,n,"ooooo",i.getReportData,"lll");const s=i.getReportData+`?doctype=${encodeURIComponent(e)}&name=${encodeURIComponent(n)}`;window.open(s,"_blank")}return B(()=>{x(),document.addEventListener("keydown",y)}),L(()=>{document.removeEventListener("keydown",y)}),(t,e)=>(u(),p("section",null,[c.value?(u(),p(k,{key:1},[e[4]||(e[4]=o("div",{class:"d-flex justify-content-between align-items-center py-2"},null,-1)),o("section",null,[o("div",U,[o("button",{type:"button",class:"font-12 btn btn-light backtoListbtn",onClick:R},e[3]||(e[3]=[o("i",{class:"bi bi-chevron-left"},null,-1),$(" Back to Report List ")])),o("div",F,[f(j,{class:"btn-outline-primary m-0 dropdown-toggle d-flex justify-content-center align-items-center bg-white",name:"Export",type:"button",id:"exportDropdown","data-bs-toggle":"dropdown","aria-expanded":"false"}),o("ul",H,[o("li",null,[o("a",{class:"dropdown-item",onClick:e[0]||(e[0]=n=>w("Csv"))},"Download Csv")]),o("li",null,[o("a",{class:"dropdown-item",onClick:e[1]||(e[1]=n=>w("Excel"))},"Download Excel")])])])])]),o("section",null,[f(C,{class:"newtable",tHeaders:b.value,tData:v.value,onCellClick:I,isAction:"true",download:"true"},null,8,["tHeaders","tData"])])],64)):(u(),p(k,{key:0},[e[2]||(e[2]=o("div",{class:"d-flex justify-content-between align-items-center py-2"},[o("div")],-1)),o("div",null,[f(C,{tHeaders:h.value,tData:m.value,onCellClick:D,isAction:"true",viewType:"viewPdf",isCheckbox:"true"},null,8,["tHeaders","tData"])])],64))]))}},M=N(T,[["__scopeId","data-v-45fb680f"]]);export{M as default};
