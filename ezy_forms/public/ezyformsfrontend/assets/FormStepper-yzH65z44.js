var Cs=Object.defineProperty,Ds=Object.defineProperties;var Fs=Object.getOwnPropertyDescriptors;var nt=Object.getOwnPropertySymbols;var jt=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable;var Ht=(f,F,y)=>F in f?Cs(f,F,{enumerable:!0,configurable:!0,writable:!0,value:y}):f[F]=y,ne=(f,F)=>{for(var y in F||(F={}))jt.call(F,y)&&Ht(f,y,F[y]);if(nt)for(var y of nt(F))Jt.call(F,y)&&Ht(f,y,F[y]);return f},ye=(f,F)=>Ds(f,Fs(F));var _t=(f,F)=>{var y={};for(var C in f)jt.call(f,C)&&F.indexOf(C)<0&&(y[C]=f[C]);if(f!=null&&nt)for(var C of nt(f))F.indexOf(C)<0&&Jt.call(f,C)&&(y[C]=f[C]);return y};var rt=(f,F,y)=>new Promise((C,q)=>{var L=V=>{try{h(y.next(V))}catch(Z){q(Z)}},G=V=>{try{h(y.throw(V))}catch(Z){q(Z)}},h=V=>V.done?C(V.value):Promise.resolve(V.value).then(L,G);h((y=y.apply(f,F)).next())});import{_ as Oe,r as _,x as Y,o as a,c as i,d as l,n as A,t as g,l as m,W as dt,X as de,b as ae,Q as kt,i as S,F as O,h as B,Z as Me,v as Ue,T as Ss,m as P,g as $s,f as Kt,a6 as qs,u as Ts,M as As,e as ue,E as Ls,w as Se,a7 as Yt,K as me,y as te,z as le,L as E,a8 as Es,S as Gt,O as Ze,B as Vs,R as Ke,N as Ve,j as J,k as Re,a9 as Rs,aa as Us,U as he,H as _e,ab as wt,a2 as Ms,ac as Zt,ad as Os,D as Bs}from"./index--K5kCziY.js";const Ps="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",zs=["draggable","aria-label","onKeydown"],Ns={class:"field-card-icon"},Hs={class:"field-card-content"},js={class:"field-card-title"},Js={class:"field-card-description"},Ys={key:0,class:"field-card-drag-preview"},Gs={__name:"FieldCard",props:{field:{type:Object,required:!0},disabled:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["dragstart","dragend","click","add"],setup(f,{emit:F}){const y=f,C=F,q=_(!1),L=_(!1),G=Y(()=>({"field-card--dragging":q.value,"field-card--disabled":y.disabled,"field-card--compact":y.compact,"field-card--hovered":L.value})),h=$=>{if(y.disabled)return;q.value=!0,$.dataTransfer.effectAllowed="copy",$.dataTransfer.setData("application/json",JSON.stringify({fieldType:y.field.id,fieldData:y.field}));const K=$.currentTarget.cloneNode(!0);K.style.opacity="0.8",K.style.transform="rotate(-2deg)",document.body.appendChild(K),$.dataTransfer.setDragImage(K,75,20),setTimeout(()=>{document.body.removeChild(K)},0),C("dragstart",{fieldType:y.field.id,fieldData:y.field,event:$})},V=$=>{q.value=!1,C("dragend",$)},Z=()=>{y.disabled||(C("click",y.field),C("add",y.field))};return($,K)=>(a(),i("div",{class:A(["field-card",G.value]),draggable:!f.disabled,onDragstart:h,onDragend:V,onClick:Z,role:"button",tabindex:"0","aria-label":`Add ${f.field.name} field`,onKeydown:[dt(Z,["enter"]),dt(de(Z,["prevent"]),["space"])]},[l("div",Ns,[l("i",{class:A(f.field.icon)},null,2)]),l("div",Hs,[l("h4",js,g(f.field.name),1),l("p",Js,g(f.field.description),1)]),K[0]||(K[0]=l("div",{class:"field-card-actions"},[l("i",{class:"bi bi-plus-circle"})],-1)),q.value?(a(),i("div",Ys,[l("i",{class:A(f.field.icon)},null,2),l("span",null,g(f.field.name),1)])):m("",!0)],42,zs))}},Wt=Oe(Gs,[["__scopeId","data-v-871ee6f1"]]),Zs=["aria-expanded","aria-controls","onKeydown"],Ks={class:"field-category-title"},Ws={class:"field-category-name"},Qs={class:"field-category-count"},Xs=["id"],xs={key:0,class:"field-category-description"},Is={class:"field-category-fields"},eo={key:1,class:"field-category-empty"},to={__name:"FieldCategory",props:{category:{type:Object,required:!0},fields:{type:Array,default:()=>[]},initiallyCollapsed:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["field-dragstart","field-dragend","field-click","field-add","toggle"],setup(f,{emit:F}){const y=f,C=F,q=_(y.initiallyCollapsed||y.category.collapsed||!1),L=()=>{q.value=!q.value,C("toggle",{categoryId:y.category.id,isCollapsed:q.value})},G=$=>{C("field-dragstart",ye(ne({},$),{categoryId:y.category.id}))},h=$=>{C("field-dragend",$)},V=$=>{C("field-click",{field:$,categoryId:y.category.id})},Z=$=>{C("field-add",{field:$,categoryId:y.category.id})};return($,K)=>(a(),i("div",{class:A(["field-category",{"field-category--collapsed":q.value}])},[l("div",{class:"field-category-header",onClick:L,role:"button",tabindex:"0","aria-expanded":!q.value,"aria-controls":`category-${f.category.id}`,onKeydown:[dt(L,["enter"]),dt(de(L,["prevent"]),["space"])]},[l("div",Ks,[l("i",{class:A([f.category.icon,"field-category-icon"])},null,2),l("h3",Ws,g(f.category.name),1),l("span",Qs,"("+g(f.fields.length)+")",1)]),l("i",{class:A(["bi bi-chevron-down field-category-chevron",{"field-category-chevron--collapsed":q.value}])},null,2)],40,Zs),ae(Ss,{name:"category-expand"},{default:kt(()=>[S(l("div",{id:`category-${f.category.id}`,class:"field-category-content"},[f.category.description?(a(),i("p",xs,g(f.category.description),1)):m("",!0),l("div",Is,[(a(!0),i(O,null,B(f.fields,x=>(a(),Me(Wt,{key:x.id,field:x,compact:f.compact,onDragstart:G,onDragend:h,onClick:V,onAdd:Z},null,8,["field","compact"]))),128))]),f.fields.length===0?(a(),i("div",eo,K[0]||(K[0]=[l("i",{class:"bi bi-inbox"},null,-1),l("p",null,"No fields in this category",-1)]))):m("",!0)],8,Xs),[[Ue,!q.value]])]),_:1})],2))}},lo=Oe(to,[["__scopeId","data-v-8c30728f"]]),so=["for"],oo={key:0,class:"text-input-required"},ao={class:"text-input-container"},io={key:0,class:"text-input-icon text-input-icon--left"},no=["id","type","value","placeholder","disabled","readonly","required","maxlength","minlength","aria-describedby","aria-invalid"],ro={key:1,class:"text-input-icon text-input-icon--right"},co=["aria-label"],uo={key:1,class:"text-input-hint"},po=["id"],fo=["id"],mo={__name:"TextInput",props:{modelValue:{type:[String,Number],default:""},label:{type:String,default:""},type:{type:String,default:"text",validator:f=>["text","email","password","url","tel","number","search"].includes(f)},placeholder:{type:String,default:""},helpText:{type:String,default:""},errorMessage:{type:String,default:""},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},iconLeft:{type:String,default:""},iconRight:{type:String,default:""},size:{type:String,default:"md",validator:f=>["sm","md","lg"].includes(f)},maxLength:{type:Number,default:null},minLength:{type:Number,default:null}},emits:["update:modelValue","blur","focus","clear"],setup(f,{emit:F}){const y=f,C=F,q=Y(()=>`text-input-${Math.random().toString(36).substr(2,9)}`),L=_(!1),G=Y(()=>!!y.errorMessage),h=Y(()=>[`text-input-wrapper--${y.size}`,{"text-input-wrapper--disabled":y.disabled,"text-input-wrapper--readonly":y.readonly,"text-input-wrapper--error":G.value,"text-input-wrapper--focused":L.value}]),V=Y(()=>[`text-input--${y.size}`,{"text-input--with-icon-left":y.iconLeft,"text-input--with-icon-right":y.iconRight||y.clearable,"text-input--error":G.value}]),Z=N=>{C("update:modelValue",N.target.value)},$=N=>{L.value=!1,C("blur",N)},K=N=>{L.value=!0,C("focus",N)},x=()=>{C("update:modelValue",""),C("clear")};return(N,z)=>(a(),i("div",{class:A(["text-input-wrapper",h.value])},[f.label?(a(),i("label",{key:0,for:q.value,class:"text-input-label"},[P(g(f.label)+" ",1),f.required?(a(),i("span",oo,"*")):m("",!0)],8,so)):m("",!0),l("div",ao,[f.iconLeft?(a(),i("span",io,[l("i",{class:A(f.iconLeft)},null,2)])):m("",!0),l("input",{id:q.value,type:f.type,value:f.modelValue,placeholder:f.placeholder,disabled:f.disabled,readonly:f.readonly,required:f.required,maxlength:f.maxLength,minlength:f.minLength,class:A([V.value,"text-input"]),onInput:Z,onBlur:$,onFocus:K,"aria-describedby":f.helpText?`${q.value}-help`:void 0,"aria-invalid":G.value},null,42,no),f.iconRight||f.clearable?(a(),i("span",ro,[f.clearable&&f.modelValue&&!f.disabled?(a(),i("i",{key:0,class:"bi bi-x-circle text-input-clear",onClick:x,role:"button",tabindex:"0","aria-label":`Clear ${f.label||"input"}`},null,8,co)):f.iconRight?(a(),i("i",{key:1,class:A(f.iconRight)},null,2)):m("",!0)])):m("",!0)]),f.helpText||f.errorMessage?(a(),i("div",uo,[!G.value&&f.helpText?(a(),i("p",{key:0,id:`${q.value}-help`,class:"text-input-help"},g(f.helpText),9,po)):m("",!0),G.value&&f.errorMessage?(a(),i("p",{key:1,id:`${q.value}-error`,class:"text-input-error"},[z[0]||(z[0]=l("i",{class:"bi bi-exclamation-circle"},null,-1)),P(" "+g(f.errorMessage),1)],8,fo)):m("",!0)])):m("",!0)],2))}},vo=Oe(mo,[["__scopeId","data-v-5d216934"]]),ho=["type","disabled","aria-label"],bo={__name:"IconButton",props:{type:{type:String,default:"button"},icon:{type:String,required:!0},variant:{type:String,default:"ghost",validator:f=>["solid","outline","ghost"].includes(f)},size:{type:String,default:"md",validator:f=>["sm","md","lg"].includes(f)},color:{type:String,default:"default",validator:f=>["default","primary","success","warning","error"].includes(f)},disabled:{type:Boolean,default:!1},ariaLabel:{type:String,required:!0},tooltip:{type:String,default:""}},emits:["click"],setup(f,{emit:F}){const y=f,C=F,q=Y(()=>[`icon-button--${y.variant}`,`icon-button--${y.size}`,`icon-button--${y.color}`,{"icon-button--disabled":y.disabled}]),L=G=>{y.disabled||C("click",G)};return(G,h)=>{const V=$s("tooltip");return S((a(),i("button",{type:f.type,disabled:f.disabled,class:A([q.value,"icon-button"]),"aria-label":f.ariaLabel,onClick:L},[l("i",{class:A(f.icon)},null,2)],10,ho)),[[V,f.tooltip]])}}},go=Oe(bo,[["__scopeId","data-v-b3b47a56"]]),yo=[{id:"basic",name:"Basic Fields",icon:"bi bi-input-cursor-text",collapsed:!1,description:"Essential form fields for text and numbers"},{id:"choice",name:"Choice Fields",icon:"bi bi-ui-checks",collapsed:!1,description:"Fields for selections and options"},{id:"datetime",name:"Date & Time",icon:"bi bi-calendar3",collapsed:!1,description:"Date, time, and datetime pickers"},{id:"file",name:"File & Media",icon:"bi bi-file-earmark-arrow-up",collapsed:!1,description:"Upload files, images, and signatures"},{id:"layout",name:"Layout Elements",icon:"bi bi-layout-text-sidebar",collapsed:!1,description:"Structure and organize your form"},{id:"advanced",name:"Advanced Fields",icon:"bi bi-gear",collapsed:!0,description:"Special purpose and computed fields"}],We={text:{id:"text",category:"basic",name:"Text Input",icon:"bi bi-input-cursor-text",description:"Single line text input",frappe_fieldtype:"Data",defaultProps:{label:"Text Field",placeholder:"Enter text...",required:!1,maxLength:255,width:"100%"},validation:{supportedRules:["required","minLength","maxLength","pattern"]}},textarea:{id:"textarea",category:"basic",name:"Textarea",icon:"bi bi-textarea-t",description:"Multi-line text input",frappe_fieldtype:"Text",defaultProps:{label:"Text Area",placeholder:"Enter text...",rows:4,required:!1,maxLength:5e3,width:"100%"},validation:{supportedRules:["required","minLength","maxLength"]}},number:{id:"number",category:"basic",name:"Number",icon:"bi bi-hash",description:"Numeric input field",frappe_fieldtype:"Int",defaultProps:{label:"Number Field",placeholder:"0",required:!1,min:null,max:null,step:1,width:"100%"},validation:{supportedRules:["required","min","max"]}},email:{id:"email",category:"basic",name:"Email",icon:"bi bi-envelope",description:"Email address input",frappe_fieldtype:"Data",defaultProps:{label:"Email Address",placeholder:"email@example.com",required:!1,width:"100%"},validation:{supportedRules:["required","email"]}},phone:{id:"phone",category:"basic",name:"Phone",icon:"bi bi-telephone",description:"Phone number input",frappe_fieldtype:"Data",defaultProps:{label:"Phone Number",placeholder:"+1 (555) 000-0000",required:!1,width:"100%"},validation:{supportedRules:["required","phone"]}},url:{id:"url",category:"basic",name:"URL",icon:"bi bi-link-45deg",description:"Website URL input",frappe_fieldtype:"Data",defaultProps:{label:"Website URL",placeholder:"https://example.com",required:!1,width:"100%"},validation:{supportedRules:["required","url"]}},select:{id:"select",category:"choice",name:"Select Dropdown",icon:"bi bi-chevron-down",description:"Single selection dropdown",frappe_fieldtype:"Select",defaultProps:{label:"Select Field",placeholder:"Choose an option...",required:!1,options:["Option 1","Option 2","Option 3"],width:"100%"},validation:{supportedRules:["required"]}},multiselect:{id:"multiselect",category:"choice",name:"Multi Select",icon:"bi bi-ui-checks-grid",description:"Multiple selection dropdown",frappe_fieldtype:"MultiSelect",defaultProps:{label:"Multi Select Field",placeholder:"Choose options...",required:!1,options:["Option 1","Option 2","Option 3"],width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},radio:{id:"radio",category:"choice",name:"Radio Buttons",icon:"bi bi-record-circle",description:"Single choice radio buttons",frappe_fieldtype:"Select",defaultProps:{label:"Radio Field",required:!1,options:["Option 1","Option 2","Option 3"],layout:"vertical",width:"100%"},validation:{supportedRules:["required"]}},checkbox:{id:"checkbox",category:"choice",name:"Checkboxes",icon:"bi bi-check-square",description:"Multiple choice checkboxes",frappe_fieldtype:"MultiSelect",defaultProps:{label:"Checkbox Field",required:!1,options:["Option 1","Option 2","Option 3"],layout:"vertical",width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},toggle:{id:"toggle",category:"choice",name:"Toggle Switch",icon:"bi bi-toggle-on",description:"On/off switch",frappe_fieldtype:"Check",defaultProps:{label:"Toggle Field",required:!1,default:!1,width:"100%"},validation:{supportedRules:["required"]}},date:{id:"date",category:"datetime",name:"Date Picker",icon:"bi bi-calendar-date",description:"Date selection",frappe_fieldtype:"Date",defaultProps:{label:"Date Field",placeholder:"Select date...",required:!1,format:"YYYY-MM-DD",width:"100%"},validation:{supportedRules:["required","minDate","maxDate"]}},time:{id:"time",category:"datetime",name:"Time Picker",icon:"bi bi-clock",description:"Time selection",frappe_fieldtype:"Time",defaultProps:{label:"Time Field",placeholder:"Select time...",required:!1,format:"HH:mm:ss",width:"100%"},validation:{supportedRules:["required"]}},datetime:{id:"datetime",category:"datetime",name:"DateTime Picker",icon:"bi bi-calendar3",description:"Date and time selection",frappe_fieldtype:"Datetime",defaultProps:{label:"DateTime Field",placeholder:"Select date and time...",required:!1,format:"YYYY-MM-DD HH:mm:ss",width:"100%"},validation:{supportedRules:["required","minDate","maxDate"]}},fileupload:{id:"fileupload",category:"file",name:"File Upload",icon:"bi bi-file-earmark-arrow-up",description:"Upload files",frappe_fieldtype:"Attach",defaultProps:{label:"File Upload",required:!1,acceptedTypes:["pdf","doc","docx","xls","xlsx","txt"],maxSize:10485760,multiple:!1,width:"100%"},validation:{supportedRules:["required","fileType","fileSize"]}},imageupload:{id:"imageupload",category:"file",name:"Image Upload",icon:"bi bi-image",description:"Upload images",frappe_fieldtype:"Attach Image",defaultProps:{label:"Image Upload",required:!1,acceptedTypes:["jpg","jpeg","png","gif"],maxSize:5242880,multiple:!1,width:"100%"},validation:{supportedRules:["required","fileType","fileSize","imageDimensions"]}},signature:{id:"signature",category:"file",name:"Signature Pad",icon:"bi bi-pen",description:"Digital signature capture",frappe_fieldtype:"Signature",defaultProps:{label:"Signature",required:!1,width:"100%",height:200},validation:{supportedRules:["required"]}},sectionbreak:{id:"sectionbreak",category:"layout",name:"Section Break",icon:"bi bi-layout-split",description:"Divide form into sections",frappe_fieldtype:"Section Break",defaultProps:{label:"Section Break",collapsible:!1,collapsed:!1,width:"100%"},validation:{supportedRules:[]}},columnbreak:{id:"columnbreak",category:"layout",name:"Column Break",icon:"bi bi-layout-three-columns",description:"Create columns",frappe_fieldtype:"Column Break",defaultProps:{width:"50%"},validation:{supportedRules:[]}},heading:{id:"heading",category:"layout",name:"Heading",icon:"bi bi-type-h1",description:"Add heading text",frappe_fieldtype:"HTML",defaultProps:{label:"Heading Text",level:2,text:"Heading",width:"100%"},validation:{supportedRules:[]}},paragraph:{id:"paragraph",category:"layout",name:"Paragraph",icon:"bi bi-paragraph",description:"Add description text",frappe_fieldtype:"HTML",defaultProps:{label:"Paragraph Text",text:"Your text here...",width:"100%"},validation:{supportedRules:[]}},divider:{id:"divider",category:"layout",name:"Divider",icon:"bi bi-dash-lg",description:"Horizontal divider line",frappe_fieldtype:"HTML",defaultProps:{width:"100%"},validation:{supportedRules:[]}},table:{id:"table",category:"advanced",name:"Table/Grid",icon:"bi bi-table",description:"Child table for multiple rows",frappe_fieldtype:"Table",defaultProps:{label:"Table Field",required:!1,columns:[],width:"100%"},validation:{supportedRules:["required","minRows","maxRows"]}},link:{id:"link",category:"advanced",name:"Link Field",icon:"bi bi-box-arrow-up-right",description:"Link to another DocType",frappe_fieldtype:"Link",defaultProps:{label:"Link Field",placeholder:"Select...",required:!1,doctype:"",width:"100%"},validation:{supportedRules:["required"]}},dynamiclist:{id:"dynamiclist",category:"advanced",name:"Dynamic List",icon:"bi bi-list-ul",description:"Repeatable list of items",frappe_fieldtype:"Dynamic Link",defaultProps:{label:"Dynamic List",required:!1,minItems:1,maxItems:null,width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},formula:{id:"formula",category:"advanced",name:"Formula Field",icon:"bi bi-calculator",description:"Calculated field",frappe_fieldtype:"Data",defaultProps:{label:"Formula Field",formula:"",readonly:!0,width:"100%"},validation:{supportedRules:[]}},qrcode:{id:"qrcode",category:"advanced",name:"QR Code",icon:"bi bi-qr-code",description:"Generate QR code",frappe_fieldtype:"Barcode",defaultProps:{label:"QR Code Field",data:"",size:200,width:"100%"},validation:{supportedRules:[]}}};function _o(f){return Object.values(We).filter(F=>F.category===f)}function wo(f){const F=f.toLowerCase();return Object.values(We).filter(y=>y.name.toLowerCase().includes(F)||y.description.toLowerCase().includes(F))}const ko={class:"field-library-header"},Co={class:"field-library-content"},Do={class:"field-library-search"},Fo={key:0,class:"field-library-results"},So={key:0},$o={key:1,class:"field-library-no-results"},qo={key:1,class:"field-library-search-results"},To={key:2,class:"field-library-categories"},Ao={key:0,class:"field-library-collapsed-indicator"},Lo={__name:"FieldLibraryPanel",props:{collapsible:{type:Boolean,default:!0},initiallyCollapsed:{type:Boolean,default:!1},compactMode:{type:Boolean,default:!1},hiddenCategories:{type:Array,default:()=>[]},hiddenFields:{type:Array,default:()=>[]}},emits:["field-dragstart","field-dragend","field-click","field-add","collapse","expand"],setup(f,{emit:F}){const y=f,C=F,q=_(""),L=_(y.initiallyCollapsed),G=_({}),h=Y(()=>yo.filter(U=>!y.hiddenCategories.includes(U.id))),V=Y(()=>q.value?wo(q.value).filter(j=>!y.hiddenFields.includes(j.id)):[]);function Z(U){return _o(U).filter(ce=>!y.hiddenFields.includes(ce.id))}function $(){L.value=!L.value,C(L.value?"collapse":"expand")}function K(U){}function x(U){C("field-dragstart",U)}function N(U){C("field-dragend",U)}function z(U){C("field-click",U)}function I(U){C("field-add",U)}function we(U){G.value[U.categoryId]=U.isCollapsed}function ve(U){if((U.ctrlKey||U.metaKey)&&U.key==="k"){U.preventDefault();const j=document.querySelector(".field-library-search input");j&&j.focus()}}return Kt(()=>{document.addEventListener("keydown",ve)}),qs(()=>{document.removeEventListener("keydown",ve)}),(U,j)=>(a(),i("div",{class:A(["field-library-panel",{"field-library-panel--collapsed":L.value}])},[l("div",ko,[j[1]||(j[1]=l("div",{class:"field-library-title"},[l("i",{class:"bi bi-grid-3x3-gap"}),l("h2",null,"Add Fields")],-1)),f.collapsible?(a(),Me(go,{key:0,icon:L.value?"bi bi-chevron-right":"bi bi-chevron-left",variant:"ghost",size:"sm","aria-label":"Toggle field library",onClick:$},null,8,["icon"])):m("",!0)]),S(l("div",Co,[l("div",Do,[ae(vo,{modelValue:q.value,"onUpdate:modelValue":[j[0]||(j[0]=ce=>q.value=ce),K],type:"search",placeholder:"Search fields...","icon-left":"bi bi-search",clearable:!0,size:"sm"},null,8,["modelValue"])]),q.value?(a(),i("div",Fo,[V.value.length>0?(a(),i("p",So,g(V.value.length)+" field"+g(V.value.length!==1?"s":"")+" found ",1)):(a(),i("p",$o,[j[2]||(j[2]=l("i",{class:"bi bi-search"},null,-1)),P(' No fields found matching "'+g(q.value)+'" ',1)]))])):m("",!0),q.value&&V.value.length>0?(a(),i("div",qo,[(a(!0),i(O,null,B(V.value,ce=>(a(),Me(Wt,{key:ce.id,field:ce,compact:f.compactMode,onDragstart:x,onDragend:N,onClick:z,onAdd:I},null,8,["field","compact"]))),128))])):(a(),i("div",To,[(a(!0),i(O,null,B(h.value,ce=>(a(),Me(lo,{key:ce.id,category:ce,fields:Z(ce.id),compact:f.compactMode,onFieldDragstart:x,onFieldDragend:N,onFieldClick:z,onFieldAdd:I,onToggle:we},null,8,["category","fields","compact"]))),128))])),j[3]||(j[3]=l("div",{class:"field-library-help"},[l("i",{class:"bi bi-info-circle"}),l("p",null,"Drag fields to the canvas or click to add")],-1))],512),[[Ue,!L.value]]),L.value?(a(),i("div",Ao,j[4]||(j[4]=[l("i",{class:"bi bi-grid-3x3-gap"},null,-1),l("span",null,"Fields",-1)]))):m("",!0)],2))}},Eo=Oe(Lo,[["__scopeId","data-v-12f238c7"]]),Vo={class:""},Ro={class:""},Uo={class:"d-flex justify-content-between align-items-center CancelNdSave"},Mo={class:"d-flex align-items-center"},Oo={key:0,class:"font-16"},Bo=["disabled"],Po={class:"form-container p-0 container-fluid mt-1"},zo={class:"row"},No={class:"col-lg-2 col-md-2 col-sm-12"},Ho={class:"steps-sticky-div"},jo={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},Jo=["onClick"],Yo={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},Go={class:"step-text"},Zo={class:"font-11"},Ko={class:"font-14"},Wo={class:"col-lg-10 col-md-10 col-sm-12 formbackground-color"},Qo={class:""},Xo={class:"form-content stepsDiv"},xo={key:0},Io={class:""},ea={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},ta={class:"container-fluid aboutFields p-0"},la={class:"row"},sa={class:"col-sm-12 col-md-12 mt-lg-3 p-lg-4"},oa={class:"container-fluid"},aa={class:"row g-3"},ia={class:"col-md-6"},na={class:"position-relative"},ra={key:0,class:"font-12 position-absolute PredefinedLabel"},da={key:1,class:"text-danger ErrorMsg ms-2"},ca={class:"col-md-6"},ua={key:0,class:"text-danger ErrorMsg ms-2"},pa={class:"col-md-6"},fa={class:"col-md-6"},ma={key:0,class:"text-danger"},va={class:"col-md-6"},ha={key:0,class:"text-danger"},ba={class:"col-md-6"},ga={key:0,class:"text-danger"},ya={class:"custom-option"},_a=["checked","onChange"],wa={class:"col-md-6"},ka={class:"col-md-6"},Ca={key:0,class:"col-md-6"},Da={key:1,class:"col-md-6"},Fa={key:2,class:"col-md-6"},Sa={class:"form-check d-flex align-items-center p-0 pe-3"},$a=["disabled"],qa={key:3,class:"col-md-6"},Ta=["disabled"],Aa={key:0,class:"list-group position-absolute w-100 z-3 formslist"},La=["onMousedown"],Ea={key:1,class:"zoho-form-builder"},Va={class:"zoho-toolbar"},Ra={class:"toolbar-left"},Ua={class:"zoho-tabs"},Ma=["onClick"],Oa=["onClick"],Ba={class:"toolbar-right"},Pa={class:"zoho-builder-container"},za={class:"d-flex align-items-center justify-content-between w-100"},Na={class:"mb-0 font-14 fw-bold"},Ha={class:"btn btn-sm btn-link p-0 text-dark"},ja={key:0,class:"library-content"},Ja={class:"zoho-form-canvas"},Ya={class:"requestandAppHeader"},Ga={class:"d-flex justify-content-between align-items-center"},Za={class:""},Ka={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},Wa={class:"text-center ms-2 mt-1"},Qa={key:0,class:"font-12 d-flex align-items-center"},Xa={class:"font-12 approver_type_div"},xa={class:"font-12 fw-bold"},Ia={class:"font-12 text-danger ms-1"},ei={class:"d-flex align-items-center"},ti={key:0,class:"role-container"},li={key:0,class:"role-text d-flex align-items-center"},si={class:"role-label fw-bold"},oi={class:"role-names"},ai=["onClick"],ii=["onClick"],ni=["onClick"],ri=["onClick"],di={class:"pt-0 section_block"},ci={class:"d-flex justify-content-between align-items-center"},ui={class:"d-flex flex-column"},pi=["onUpdate:modelValue","onChange","onInput"],fi={key:0,class:"text-danger ps-3 font-10"},mi={class:"d-flex align-items-center"},vi=["onClick"],hi={class:"container-fluid"},bi={class:"d-flex justify-content-between align-items-center"},gi={class:"rownames m-0"},yi=["onClick"],_i={class:"col"},wi={class:"row"},ki=["onMouseenter"],Ci={class:"column_name d-flex align-items-center justify-content-between"},Di={class:"d-flex flex-column ps-2"},Fi=["onUpdate:modelValue","onChange","onInput"],Si={key:0,class:"text-danger ps-2 font-10"},$i={class:"position-absolute top-0 end-0"},qi=["onClick"],Ti=["onDrop"],Ai=["onMouseenter","onDragstart","onDrop"],Li=["onDrop"],Ei=["onDragstart","onDrop"],Vi={class:"d-flex justify-content-between"},Ri={class:"flex-column d-flex"},Ui=["onUpdate:modelValue","onChange","onInput"],Mi={key:0,class:"text-danger font-10"},Oi={class:"FieldcopyRemove"},Bi=["onClick"],Pi=["onClick"],zi=["onUpdate:modelValue","onChange"],Ni=["value"],Hi={key:0},ji=["onUpdate:modelValue"],Ji={key:0,class:"text-danger font-10"},Yi={key:1},Gi=["for"],Zi=["id","onUpdate:modelValue","onInput","onFocus"],Ki={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},Wi=["onClick"],Qi={class:"d-flex align-items-center justify-content-between"},Xi={class:"d-flex align-items-center gap-2"},xi={class:"d-flex align-items-center"},Ii=["onUpdate:modelValue","id"],en=["for"],tn=["onClick"],ln=["onUpdate:modelValue"],sn={key:3,class:"text-danger font-10"},on=["onDrop"],an={class:"childtableShow"},nn={class:"mt-2"},rn={key:0,class:"childTableContainer"},dn={key:0,class:"font-13"},cn={key:1,class:"d-flex align-items-center gap-2"},un={class:"d-flex align-items-center"},pn=["onUpdate:modelValue"],fn=["onClick"],mn={key:2,class:"table table-bordered rounded-table"},vn=["onDrop"],hn=["draggable","onDragstart"],bn={key:0},gn=["onUpdate:modelValue","onInput"],yn={key:0,class:"text-danger font-11"},_n={key:1},wn={key:2},kn={class:"d-flex gap-1"},Cn=["onUpdate:modelValue","onChange"],Dn=["value"],Fn={class:"d-flex"},Sn={class:"d-flex align-items-center gap-2"},$n={class:"d-flex align-items-center"},qn=["onUpdate:modelValue"],Tn=["onClick"],An={key:0},Ln=["onUpdate:modelValue","onInput"],En={key:0,class:"text-danger font-10"},Vn={key:1,class:"font-11 text-danger"},Rn={key:3},Un={key:3,class:"mb-2 mt-3"},Mn=["onClick"],On=["onClick"],Bn=["onDrop"],Pn=["onDrop"],zn={class:"d-flex justify-content-center align-items-center my-2"},Nn=["onClick"],Hn={class:"font-13"},jn={key:0,class:"d-flex align-items-center gap-2"},Jn={class:"d-flex align-items-center"},Yn=["onUpdate:modelValue"],Gn=["onClick"],Zn={class:"table table-bordered rounded-table"},Kn={key:0},Wn=["onUpdate:modelValue","onBlur"],Qn={key:0,class:"text-danger font-11 mt-1"},Xn={key:1},xn={key:2},In={class:"d-flex gap-1 align-items-center"},er=["onUpdate:modelValue","onChange"],tr=["value"],lr=["onClick"],sr={key:0,class:"mt-1"},or=["onUpdate:modelValue","onInput"],ar={key:1,class:"text-danger font-11 mt-1"},ir={key:3},nr={class:"mb-2"},rr=["onClick"],dr=["onClick"],cr=["onClick"],ur={key:0},pr={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},fr=["onUpdate:modelValue","onBlur"],mr={key:0,class:"text-danger font-12"},vr={key:1,class:"text-danger font-12"},hr={class:"d-flex align-items-center gap-2"},br={class:"d-flex align-items-center"},gr=["onUpdate:modelValue"],yr=["onClick"],_r=["onClick"],wr={class:"px-1 field-border"},kr={class:"d-flex justify-content-between"},Cr=["onUpdate:modelValue","onBlur"],Dr={key:0,class:"text-danger font-12"},Fr={class:"d-flex align-items-center"},Sr={class:"d-flex my-1"},$r=["onUpdate:modelValue"],qr=["onClick"],Tr=["onClick"],Ar=["onUpdate:modelValue"],Lr=["value"],Er={key:0},Vr=["onUpdate:modelValue"],Rr={key:0,class:"text-danger font-10"},Ur={key:1,class:"text-danger font-12"},Mr=["onClick"],Or=["onClick"],Br={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},Pr=["onClick"],zr={key:0,class:"m-2"},Nr={key:0,class:"zoho-properties-panel"},Hr={class:"properties-header"},jr={key:2},Jr={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},Yr={class:"modal-dialog modal-dialog-centered"},Gr={class:"modal-content"},Zr={class:"modal-body"},Kr=["placeholder"],Wr={class:"d-flex align-items-center gap-2"},Qr={class:"d-flex align-items-center py-2"},Xr={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},xr={class:"offcanvas-header add_designationHeader"},Ir={id:"offcanvasRightLabel",class:"font-14 fw-bold"},ed={class:"offcanvas-body add_desig_offCanvas_body p-0"},td={class:""},ld={class:""},sd={key:0,class:"p-3 approval-border-bottom"},od={key:0,class:""},ad={class:"px-3 listofdesignations"},id={class:"my-1 d-flex justify-content-between"},nd={class:"font-12 fw-bold"},rd={class:"italic-style text-secondary font-12"},dd={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},cd={class:"d-flex align-items-center justify-content-between gap-1"},ud={class:"form-check ps-1 d-flex align-items-center m-0"},pd=["checked"],fd={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},md={key:0,class:"form-check d-flex align-items-center m-0"},vd={key:1},hd={key:0,class:"p-3"},bd=["value"],gd={key:1},yd={class:""},_d={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},wd={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},kd={class:"offcanvas-footer"},Cd={class:"text-end p-3"},$e="Select All",Dd={__name:"FormStepper",setup(f){const F=Ts(),y=As(),C=_(1),q=_([]);_([]);const L=_([]),G=_([]);ue([]);let h=ue([]),V=ue([]);const Z=_([]),$=_([]),K=_([]),x=_(""),N=_(""),z=_("");let I=ue([]);const we=_("");_(!1),_(!1),_(!1);const ve=_(""),U=_(""),j=_(""),ce=_([]),Qt=_([]),R=ue({}),re=_([]),ct=_(!1),Qe=_([]),Xe=_(!1);let Ct=null;const Xt=_("");let H=_("");const xt=_(null),Dt=_(null),qe=_(!0),xe=_(0),Te=Y(()=>Ls);_(!1);const Ie=ue([]),ie=_({routepath:F.query.routepath,business_unit:F.query.business_unit,formId:F.query.id}),et=_(""),Ae=_(!1),Le=_(!1),Ft=[{label:"Public",value:1},{label:"Private",value:0}],St=Y({get(){return Ft.find(t=>t.value===b.value.as_web_view)},set(t){b.value.as_web_view=t?t.value:null}}),$t=Y({get(){return b.value.form_name||F.query.form_name||""},set(t){b.value.form_name=t}}),b=_({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${Te.value.value||ie.value.business_unit||F.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:F.query.id?1:0,as_web_view:0,mail_id:""});Se(()=>F.query.form_name,t=>{t&&(b.value.form_name=t,b.value.form_short_name=t)},{immediate:!0});const tt=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(t=>t.toLowerCase().trim()),qt=["Approver","Approved on","Approved By"].map(t=>t.toLowerCase().trim());function It(t){return t.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}Y(()=>b.value),_(""),_(!1),Se(Te,t=>{t&&t.value&&(b.value.business_unit=t.value)},{immediate:!0});function el(t){if(H==null||H==="new")return!1;const e=W(t).roles;if(t===0)return e.length===0;const s=W(t-1).roles;return s.length>0&&s[0]!==null&&s[0]!==""&&e.length===0}Se(()=>b.value.form_name,t=>{b.value.form_name=t.trim()}),Se(()=>b.value.form_short_name,t=>{b.value.form_short_name=t.trim()}),Se(()=>b.value.series,t=>{b.value.series=t.trim()});const lt=_(null),Tt=(t,e,s,o,n,r)=>{lt.value={blockIndex:e,sectionIndex:s,rowIndex:o,columnIndex:n,fieldIndex:r}},ke=(t,e,s,o,n,r)=>{if(!lt.value)return;const{blockIndex:d,sectionIndex:u,rowIndex:v,columnIndex:c,fieldIndex:p}=lt.value,k=h[d].sections[u].rows[v].columns[c].fields,M=h[e].sections[s].rows[o].columns[n].fields;if(d===e&&u===s&&v===o&&c===n&&p===r)return;const w=k.splice(p,1)[0];k===M&&p<r&&r--,M.splice(r,0,w),lt.value=null},Ee=_(""),tl=t=>rt(this,null,function*(){const e=[["module","in",["User Forms"]],["istable","=",1]];t!=null&&t.trim()&&e.push(["name","=",`${t}`]);const s={fields:JSON.stringify(["name"]),filters:JSON.stringify(e),limit_page_length:"None",doctype:me.doctypesList};try{return(yield te.get(le.GetDoctypeData,{params:s})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),st=_(null),At=t=>rt(this,null,function*(){if(Ee.value="",st.value=null,t.tableName){let e=t.tableName.trim();if(e.length>64){Ee.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(e)){Ee.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield tl(e);st.value=o.find(n=>n.name.toLowerCase()===e.toLowerCase()),st.value&&(Ee.value="Table already exists"),t.tableName=e}t.label&&(t.fieldname=It(t.label))});function ll(){const t=b.value.is_linked_form;if(!t){Qe.value=[];return}clearTimeout(Ct),Ct=setTimeout(()=>{const e=[["business_unit","=",`${Te.value.value}`],["name","like",`%${t}%`]],s={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(e),doctype:me.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};te.get(`${le.GetDoctypeData}`,{params:s}).then(o=>{Qe.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function sl(t){b.value.is_linked_form=t,Xe.value=!1}function ol(){setTimeout(()=>{Xe.value=!1},200)}ue({query:"",key:""});function be(t,e,s,o,n){return`${t}-${e}-${s}-${o}-${n}`}ue({});const Be=ue({}),ut=ue({});function al(t){ut[t]=!0}function il(t,e,s,o,n,r){const d=be(e,s,o,n,r),u=[["istable","=",0]];t!=null&&t.trim()&&u.push(["name","like",`%${t}%`]);const v={fields:JSON.stringify(["name"]),filters:JSON.stringify(u),limit_page_length:"none",doctype:me.doctypesList};te.get(le.GetDoctypeData,{params:v}).then(c=>{Be[d]=c.message.data||[]}).catch(c=>{console.error("Error fetching doctype list:",c),Be[d]=[]})}function nl(t,e,s,o,n,r){h[t].sections[e].rows[s].columns[o].fields[n].options=r;const d=be(t,e,s,o,n);Be[d]=[],ut[d]=!1}const rl=Y(()=>h!=null&&h.length?z.value===1?[0]:Array.from({length:z.value},(t,e)=>e).filter(t=>t<z.value):[]),ge=_(null),Ce=_(null),dl=(t,e,s,o,n)=>{ge.value={blockIndex:t,sectionIndex:e,rowIndex:s,columnIndex:o,fieldIndex:n}},cl=()=>{ge.value=null},ul=(t,e,s,o,n)=>ge.value&&ge.value.blockIndex===t&&ge.value.sectionIndex===e&&ge.value.rowIndex===s&&ge.value.columnIndex===o&&ge.value.fieldIndex===n,pl=(t,e,s,o)=>{Ce.value={blockIndex:t,sectionIndex:e,rowIndex:s,columnIndex:o}},fl=()=>{Ce.value=null},ml=(t,e,s,o)=>Ce.value&&Ce.value.blockIndex===t&&Ce.value.sectionIndex===e&&Ce.value.rowIndex===s&&Ce.value.columnIndex===o,Lt=_([{form_json:""}]),De=_("");Kt(()=>{Ot(),De.value=F.query.Clone,H.value=F.query.id||"new",De.value==="1"&&(b.value.series=""),H.value!=null&&H.value!=null&&H.value!="new"&&(Mt(),ht()),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?ct.value=!0:ct.value=!1;let t=localStorage.getItem("Bu");if(b.value.business_unit=t,F.query.preId==="PreDefine"){const e=localStorage.getItem("form_json");if(e){Lt.value[0].form_json=e;const s=Lt.value[0],o=JSON.parse(s.form_json),n=Yt(o.fields);re.value=o.child_table_fields,n.forEach(r=>{h.push(r)})}}});const Fe=_(null),ee=ue({}),Et=_(null),vl=t=>{Fe.value=t},hl=()=>{Fe.value=null},bl=t=>{t.preventDefault()},gl=(t,e)=>{const s=t.target.closest("tr");if(!s)return;const o=Array.from(s.parentNode.children).indexOf(s);if(o!==Fe.value){const n=e[Fe.value];e.splice(Fe.value,1),e.splice(o,0,n),Fe.value=o}},yl=_([]),pt=t=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(t.fieldtype)&&t.options){const e=t.options.split(`
`).map(n=>n.trim()).filter(n=>n),s=[],o=new Set;return e.forEach(n=>{const r=n.toLowerCase();o.has(r)||(o.add(r),s.push(n))}),`
`+s.join(`
`)}else if(["Link","Table"].includes(t.fieldtype)&&t.options)return t.options.trim();return t.options},_l=(t,e)=>{const s=h[t].sections[e];s.childTables||(s.childTables=[]);const o=s.childTables.length;s.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[ne({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},Ie.fieldtype==="Select"&&Ie.options?{options:Ie.options?`
${Ie.options}`:`
`}:{})],newTable:!0})},wl=(t,e,s)=>{const o=h[t].sections[e].childTables[s];o.columns||(o.columns=[]),o.columns.push(ne({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},kl=(t,e,s)=>{h[t].sections[e].childTables.splice(s,1)},Cl=(t,e,s,o)=>{h[t].sections[e].childTables[s].columns.splice(o,1)};function Dl(t,e,s,o,n,r){var c;const d=`${e}-${s}-${o}`;R[d]||(R[d]={columns:[]});const u={},v=((c=t.label)==null?void 0:c.trim())||"";if(!v)u.label="Field Label is required";else{const p=v.toLowerCase();if(tt.includes(p)&&!qt.includes(p))u.label=`"${v}" is a restricted field label`;else if(v.length>64)u.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(v))u.label="Field Label can only contain letters, numbers, and single spaces between words";else{const k=r.map((M,w)=>{var D;return{label:(D=M.label)==null?void 0:D.trim().toLowerCase(),index:w}}).filter(M=>M.label===p);if(k.length>1){const M=k[0].index;n!==M&&(u.label=`"${v}" is already used in this table`)}}}R[d].columns[n]=u}function ot(t,e,s){var r;R[e]||(R[e]={});const o=[],n=((r=t.label)==null?void 0:r.trim())||"";n||o.push("Label is required"),n.length>64&&o.push("Label cannot exceed 64 characters"),n&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(n)&&o.push("No special characters allowed"),n&&tt.includes(n.toLowerCase().trim())&&o.push("This label is restricted"),n&&re.value[e].map(v=>{var c;return(c=v.label)==null?void 0:c.trim().toLowerCase()}).filter(Boolean).filter(v=>v===n.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),t.fieldtype||o.push("Field type is required"),t.fieldtype==="Select"&&(!t.options||t.options.trim()==="")&&o.push("Options are required"),R[e][s]=o}const Fl=(t,e,s)=>{var d;const o=h[t].sections[e].childTables[s],n={tableName:!1,columns:[]};let r=!1;return(d=o.tableName)!=null&&d.trim()||(n.tableName="Table name is required.",r=!0),o.columns.forEach((u,v)=>{var p,k;const c={};(p=u.label)!=null&&p.trim()||(c.label="Field Label is required",r=!0),(k=u.fieldtype)!=null&&k.trim()||(c.fieldtype="Please select field type",r=!0),n.columns[v]=c}),R[`${t}-${e}-${s}`]=n,r},Sl=(t,e,s)=>{var n,r;const o=(r=(n=h[t])==null?void 0:n.sections)==null?void 0:r[e];o&&!Array.isArray(o[s])&&(o[s]=[])},$l=t=>t?t.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",ql=(t,e,s)=>{if(Fl(t,e,s)){he("Please fix validation errors before creating the table",{transition:"zoom"});return}if(st.value){he("Table already exists",{transition:"zoom"});return}const n=h[t].sections[e].childTables[s],r=h[t].sections[e];n.columns=n.columns.map((u,v)=>ye(ne({},u),{idx:v,options:pt(u)})),n.newTable=!1;const d={form_short_name:n.tableName,fields:n.columns,idx:n.idx,as_a_block:n.as_a_block?n.as_a_block:"false"};te.post(le.childtable,d).then(u=>{var v,c,p;if(u){Sl(t,e,"afterCreated"),r.afterCreated[s]=ne({},n),_e("Table created successfully!");const k=(p=(c=(v=u.message)==null?void 0:v[0])==null?void 0:c[0])==null?void 0:p.child_doc;k&&(h[t].sections[e].childTables[s]=ye(ne(ne({},h[t].sections[e].childTables[s]),k),{newTable:!1}))}}).catch(u=>{console.error("Error creating table:",u)})},Pe=(t,e,s,o=[])=>{var d;ee[e]||(ee[e]=[]),ee[e]=ee[e].filter(u=>u!==s),R[e]||(R[e]=[]),R[e][s]=[];const n=[],r=((d=t.label)==null?void 0:d.trim())||"";if(r?tt.includes(r.toLowerCase())?n.push("This label is restricted"):r.length>64?n.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(r)||n.push("Only letters, numbers, and single spaces allowed"):n.push("Label is required"),o.length){const u=r.toLowerCase(),v=o.map((c,p)=>{var k;return{label:(k=c.label)==null?void 0:k.trim().toLowerCase(),idx:p}}).filter(c=>c.label===u);if(v.length>1){const c=v[0].idx;s!==c?(n.push("Duplicate label not allowed"),t._duplicate=!0):t._duplicate=!1}else t._duplicate=!1}return t.fieldtype||n.push("Field type is required"),t.fieldtype==="Select"&&(!t.options||!t.options.trim())&&n.push("Options are required"),R[e][s]=n,n.length>0&&ee[e].push(s),n.length===0},Tl=(t,e,s)=>{const n=h[t].sections[e].afterCreated.find(u=>u.tableName===s);if(!n)return;const r=n.columns.length,d={fieldname:"",fieldtype:"",idx:r+1,label:"",value:"",isNew:!0,description:""};n.columns.push(d),Pe(d,s,r,n.columns)},Vt=_([]),Al=(t,e,s,o)=>{const r=h[t].sections[e].afterCreated.find(u=>u.tableName===s);if(!r)return;r.columns.splice(o,1),r.columns.forEach((u,v)=>{u.idx=v+1});const d=ee.value[s];d&&(ee.value[s]=d.filter(u=>u!==o).map(u=>u>o?u-1:u))},Ll=(t,e,s)=>{const n=h[t].sections[e].afterCreated.find(r=>r.tableName===s);if(n){if(Q[s]){ee[s]=[];let r=!0;if(n.columns.forEach((v,c)=>{Pe(v,s,c,n.columns)||(r=!1)}),!r){he("Please fix the errors in the highlighted fields before saving!");return}const d=n.columns.map((k,p)=>{var M=k,{isNew:v}=M,c=_t(M,["isNew"]);return ye(ne({},c),{idx:p+1,options:pt(c)})}),u={form_short_name:$l(s),fields:d,as_a_block:n.description};te.post(le.childtable,u).then(v=>{Vt.value=v.data,_e("Fields updated successfully!")}).catch(v=>{console.error("❌ Saving fields failed:",v)})}Q[s]=!Q[s]}},Q=ue({}),El=t=>{re.value[t]||(re.value[t]=[]);const e=re.value[t].length+1;re.value[t].push({fieldname:"",fieldtype:"",idx:e,label:"",value:"",isNew:!0,description:"",options:re.value[t].options?`
${re.value[t].options}`:""})},Vl=(t,e)=>{re.value[t]&&re.value[t].splice(e,1)},Rl=(t,e)=>{if(!t)return;ee.value||(ee.value={}),ee.value[t]||(ee.value[t]=[]);const s=re.value[t];if(s){if(Q[t]){ee.value[t]=[];let o=!0;if(s.forEach((d,u)=>{var c;ot(d,t,u);const v=(c=R[t])==null?void 0:c[u];v&&v.length>0&&(ee.value[t].push(u),o=!1),d.label&&(d.label=d.label.trim())}),!o){he("Please fix the errors before saving");return}const n=s.map((c,v)=>{var p=c,{isNew:d}=p,u=_t(p,["isNew"]);return ye(ne({},u),{idx:v+1,options:pt(u)})}),r={form_short_name:t,fields:n,as_a_block:e};te.post(le.childtable,r).then(d=>{Vt.value=d.data,_e("Fields updated successfully!")}).catch(d=>{console.error("❌ Saving fields failed:",d)})}Q[t]=!Q[t],Et.value=Q[t]?t:null}},Ul=_([{id:1,label:"About Form",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Fields & Workflow",stepno:"Step 2",icon:"bi bi-question-circle"},{id:3,label:"Print Format",stepno:"Step 3",icon:"ri-checkbox-circle-line"}]),ft=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],Ml=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],Ol=Y(()=>[$e,...L.value]),Bl=Y(()=>{const t=b.value.accessible_departments;return t.includes($e)?"All Selected":t.length>1?`${t[0]}.. +${t.length-1} more selected`:t.join(", ")}),Pl=t=>t===$e?b.value.accessible_departments.length===L.value.length:b.value.accessible_departments.includes(t),zl=(t,e)=>{t===$e?e.target.checked?b.value.accessible_departments=[...L.value]:b.value.accessible_departments=[]:(e.target.checked?b.value.accessible_departments.push(t):b.value.accessible_departments=b.value.accessible_departments.filter(s=>s!==t),b.value.accessible_departments.length===L.value.length?b.value.accessible_departments=[...L.value]:b.value.accessible_departments=b.value.accessible_departments.filter(s=>s!==$e))},Nl=t=>{t===$e&&(b.value.accessible_departments=[...L.value])},Hl=t=>{t===$e&&(b.value.accessible_departments=[])},mt=_(!1),ze=Y(()=>{var e;let t=[...Z.value];if(Le.value&&(t=t.filter(s=>s.is_hod===1)),(e=we.value)!=null&&e.trim()){const s=we.value.toLowerCase();t=t.filter(o=>o.role.toLowerCase().includes(s))}return t.sort((s,o)=>s.role.localeCompare(o.role)),t.sort((s,o)=>{const n=$.value.includes(s.role),r=$.value.includes(o.role);return n===r?0:n?1:-1}),t.map(s=>s.role)}),jl=Y(()=>{const t=ze.value;return t.length>0&&t.every(e=>$.value.includes(e))});Se([$,ze],()=>{const t=ze.value;mt.value=t.length>0&&t.every(e=>$.value.includes(e))},{immediate:!0,deep:!0});function Jl(t){const e=t.target.checked,s=Z.value.filter(o=>{var n;return!(Le.value&&o.is_hod!==1||(n=we.value)!=null&&n.trim()&&!o.role.toLowerCase().includes(we.value.toLowerCase()))}).map(o=>o.role);e?$.value=Array.from(new Set([...$.value,...s])):$.value=$.value.filter(o=>!s.includes(o)),mt.value=e}function Yl(){$.value=[],mt.value=!1,Le.value=!1}const pe=_("");function Gl(){const t=h[z.value];if(!t||!t.sections){console.error("Error: Invalid block or sections not found.");return}let e={type:z.value==0?"requestor":"approver",roles:$.value,approval_required:U.value,approver_can_edit:j.value,fields:t.sections.flatMap(wt),idx:z.value};z.value!==0&&(e.view_only_reportee=pe.value==="ViewOnlyReportee"?1:0,e.all_approvals_required=pe.value==="all_approvals_required"?1:0,e.requester_as_a_approver=pe.value==="requester_as_a_approver"?1:0,e.on_rejection=ve.value?ve.value:0);const s=I.findIndex(o=>o.idx===e.idx);s!==-1?I[s]=e:I.push(e),Wl()}function W(t){return I.find(e=>e.idx===t)||{roles:[]}}function Zl(t){const e=W(t),s=e.roles||[];$.value=[...s],ve.value=e.on_rejection,U.value=e.approval_required,j.value=e.approver_can_edit,e.view_only_reportee===1?pe.value="ViewOnlyReportee":e.all_approvals_required===1?pe.value="all_approvals_required":e.requester_as_a_approver===1?pe.value="requester_as_a_approver":pe.value=""}const vt=t=>{Le.value=!1,we.value="",pe.value="",ve.value="",b.value.accessible_departments.length&&Kl(t,b.value.accessible_departments),z.value=t,Zl(t)};function Kl(t,e){let s={index:t,departments:e,property:b.value.business_unit};te.post(le.addDesignationroles,s).then(o=>{o.message&&(Z.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function Wl(){te.post(le.add_roles_WF,{workflow_setup:I,doctype:b.value.form_short_name,business_unit:b.value.business_unit}).then(t=>{console.log(t),z.value==0?_e("Requestor Added"):_e(`Approver-${z.value} Added`)})}function Ql(){y.push({path:ie.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function Xl(){b.value.form_name="",b.value.form_short_name="",b.value.owner_of_the_form="",b.value.business_unit="",b.value.form_category="",b.value.accessible_departments=[]}const xl=t=>{if(it.value){he("Please check all required fields before proceeding.");return}t<C.value?Ut():t>C.value&&Rt()},Rt=()=>{if(it.value){he("Please check all required fields before proceeding.");return}C.value<3&&(C.value+=1,C.value===3&&(yt.value=h))},Ut=()=>{C.value>1&&(C.value-=1)},Il=_([]);function Mt(){const t={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:me.EzyFormDefinitions,doc_id:H.value};te.get(le.GetDoctypeData,{params:t}).then(e=>{var o;let s=e==null?void 0:e.message.data;if(s){s.accessible_departments&&(s.accessible_departments=s.accessible_departments.split(",")),b.value=ye(ne(ne({},b.value),s),{owner_of_the_form:s.owner_of_the_form||b.value.owner_of_the_form||""});const n=JSON.parse((o=e.message.data)==null?void 0:o.form_json);ce.value=n.workflow,Xt.value=n.fields.filter(d=>d.fieldtype==="Table"),Il.value=n.fields.filter(d=>d.fieldtype==="Table"),Ae.value=e.message.data.is_landscape;let r=Yt(JSON.parse(s==null?void 0:s.form_json).fields);re.value=JSON.parse(e.message.data.form_json).child_table_fields,yl.value=[],Qt.value=[],r.forEach((d,u)=>{h.push(d)}),JSON.parse(s==null?void 0:s.form_json).workflow.forEach((d,u)=>{I.push(d)})}}).catch(e=>{console.error("Error fetching  data:",e)})}function es(){const t={};et.value&&(t.print_format=et.value),Ae.value!==void 0&&Ae.value!==null&&(t.is_landscape=Ae.value),te.put(le.resource+me.EzyFormDefinitions+`/${F.query.id}`,t).then(e=>{console.log(e),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),_e("Print Format Added Successfully")}).catch(e=>{console.error("Error fetching  data:",e)})}function Ot(){const t={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${ie.value.business_unit||F.query.business_unit}`,doctype:me.departments};te.get(le.GetDoctypeData,{params:t}).then(e=>{var s;(s=e==null?void 0:e.message.data)!=null&&s.length&&(G.value=e.message.data.map(o=>o.name),L.value=e.message.data.map(o=>o.name))}).catch(e=>{console.error("Error fetching department data:",e)})}_(""),Se(()=>b.value.owner_of_the_form,t=>{t&&ht(t)});function ht(t){t&&typeof t=="string"&&t.trim()!==""&&ts(t)}function ts(t){const e={fields:JSON.stringify(["ezy_departments_items"]),doctype:me.departments,doc_id:t};te.get(le.GetDoctypeData,{params:e}).then(s=>{var o;(o=s==null?void 0:s.message.data)!=null&&o.ezy_departments_items&&(q.value=s.message.data.ezy_departments_items.map(n=>n.category))}).catch(s=>{console.error("Error fetching categories data:",s)})}function bt(t){let e=Os(h);const s=ye(ne({},b.value),{fields:e,doctype:me.EzyFormDefinitions,workflow_setup:I,form_status:t==="save"?"Created":"Draft"});s.accessible_departments=s.accessible_departments.toString(),te.post(le.savedata,s).then(o=>{if(o&&o.message&&o.message.message){let n=localStorage.getItem("preName");if(n){let r={installed:"Yes"};te.put(`${le.resource}${me.preDefinedForm}/${n}`,r).then(d=>{localStorage.removeItem("preName")}).catch(d=>{console.error("Error fetching ezyForms data:",d)})}if(y.push({params:{paramid:o.message.message},query:{id:o.message.message}}),H.value=o.message.message,H&&H!=="new"&&(h.splice(0,h.length),Mt()),I.length<h.length)Bs("Add Workflow");else if(Bt.value===!0){_e("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let r=localStorage.getItem("routepath");t==="save"?y.push({path:r}):t==="Draft"&&y.push({path:r})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const at=_(""),ls=()=>{var s,o;const t=h.length,e={label:t===0?"requestor":`approver-${t}`,parent:`${(s=Te.value)==null?void 0:s.value}-${(o=b.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${Te.value.value}-${b.value.form_short_name}`,childTables:[],afterCreated:{},rows:t===0?[{label:`row_0_0_${t}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${t}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${t}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};h.push(e),Ms(()=>{at.value&&at.value.scrollTo({top:at.value.scrollHeight,behavior:"smooth"})})},Bt=_(!1),Pt=t=>{let e=h[t];e.parent&&V.push(e);let s=[];I.length>t&&I[t].roles&&(s=[...I[t].roles]),h.splice(t,1),I.length>t&&I.splice(t,1),h.forEach((o,n)=>{o.sections.forEach((r,d)=>{r.rows.forEach((u,v)=>{u.columns.forEach((c,p)=>{fe(n,d,v,p)})})})}),s.length&&ss(s,t)};function ss(t,e){const s={role:t,level:e,document_type:b.value.form_name,short_name:b.value.form_short_name,property:b.value.business_unit};te.post(le.deleteAssigneRoles,s).then(o=>{o&&bt()})}const os=(t,e)=>{const s={label:"",parent:`${Te.value.value}-${b.value.form_short_name}`,rows:[{label:`row_0_${e}_${t}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};h[t].sections.splice(e+1,0,s)},as=(t,e)=>{let s=h[t].sections[e];s.parent&&V.push(s),h[t].sections.splice(e,1),h[t].sections.forEach((o,n)=>{o.rows.forEach((r,d)=>{r.columns.forEach((u,v)=>{fe(t,n,d,v)})})})},is=(t,e,s)=>{h[t].sections[e].rows[s].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},ns=(t,e,s,o)=>{const r=h[t].sections[e].rows[s].columns,d=r[o];d.parent&&V.push(d),r.length===1?h[t].sections[e].rows.splice(s,1):r.splice(o,1),h[t].sections.forEach((u,v)=>{u.rows.forEach((c,p)=>{c.columns.forEach((k,M)=>{fe(t,v,p,M)})})})},rs=(t,e,s,o)=>{h[t].sections[e].rows[s].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},ds=(t,e,s,o,n)=>{let r=h[t].sections[e].rows[s].columns[o].fields[n];r.parent&&V.push(r),h[t].sections[e].rows[s].columns[o].fields.splice(n,1)},cs=(t,e,s,o,n)=>{const r=h[t].sections[e].rows[s].columns[o].fields[n],d=ne({},r);d.name=`${r.name} Name the field`,h[t].sections[e].rows[s].columns[o].fields.splice(n+1,0,d)},us=(t,e,s,o,n)=>{const r=Zt(h);h.splice(0,h.length,...r);let d=h[t].sections[e].rows[s].columns[o].fields[n].fieldtype;(d!=="Select"||d!=="radio"||d!=="multiselect")&&(h[t].sections[e].rows[s].columns[o].fields[n].options="")};function ps(t){return tt.includes(t==null?void 0:t.trim().toLowerCase())}function fs(t){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(t)||t.includes('"')||t.includes("'")}function ms(t){return t.flatMap(e=>{var s;return[(s=e.label)==null?void 0:s.trim().toLowerCase(),...e.sections.flatMap(o=>{var n;return[(n=o.label)==null?void 0:n.trim().toLowerCase(),...o.rows.flatMap(r=>r.columns.flatMap(d=>{var u;return[(u=d.label)==null?void 0:u.trim().toLowerCase(),...d.fields.map(v=>{var c;return(c=v.label)==null?void 0:c.trim().toLowerCase()})]}))]})]}).filter(e=>e!==""&&!qt.includes(e))}function fe(t,e,s,o,n){const d=ms(h).filter((c,p,k)=>k.indexOf(c)!==p),u=Zt(h);h.splice(0,h.length,...u);function v(c,p){if(!c){p.errorMsg="";return}ps(c)?p.errorMsg="Entered label is restricted":fs(c)?p.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:c.length>64?p.errorMsg="Label should not exceed 64 characters":p.errorMsg=d.includes(c.trim().toLowerCase())?"Duplicate Label Name":""}n!==void 0&&v(h[t].sections[e].rows[s].columns[o].fields[n].label,h[t].sections[e].rows[s].columns[o].fields[n]),n===void 0&&o!==void 0&&v(h[t].sections[e].rows[s].columns[o].label,h[t].sections[e].rows[s].columns[o]),o===void 0&&n===void 0&&v(h[t].sections[e].label,h[t].sections[e]),h.forEach(c=>{c.sections.forEach(p=>{v(p.label,p),p.rows.forEach(k=>{k.columns.forEach(M=>{v(M.label,M),M.fields.forEach(w=>{v(w.label,w)})})})})})}const gt=Y(()=>{function t(e){return!e||typeof e!="object"?!1:"fieldtype"in e&&e.fieldtype===""||"error"in e&&e.error||"errorMsg"in e&&e.errorMsg||["Select","Table MultiSelect"].includes(e.fieldtype)&&(!e.options||e.options.trim()==="")?!0:Array.isArray(e)?e.some(t):Object.values(e).some(t)}return t(h)}),it=Y(()=>x.value.length>0||N.value.length>0||!b.value.form_category||!b.value.owner_of_the_form||b.value.accessible_departments.length===0),vs=Y(()=>h.some(t=>t.sections.some(e=>e.rows.some(s=>s.columns.some(o=>o.fields.some(n=>n.label&&n.fieldtype))))));function zt(t,e){let s=t.target.value.trim();if(!s){e==="form_name"?x.value="Input cannot be empty or only spaces":e==="form_short_name"&&(N.value="Input cannot be empty or only spaces");return}if(s.length>63){e==="form_name"?x.value="Name cannot exceed 63 characters":e==="form_short_name"&&(N.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(s)){e==="form_short_name"&&(N.value="First character must be a letter");return}else N.value="";if(e==="form_short_name"&&s.length<2){N.value="Short name must have at least 2 letters";return}if(e==="form_short_name"&&/[^a-zA-Z ]/.test(s)){N.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(s)){e==="form_name"?x.value="Special characters are not allowed":e==="form_short_name"&&(N.value="Special characters are not allowed");return}else e==="form_name"?x.value="":e==="form_short_name"&&(N.value="");const o=[[e,"=",`${s}`],["business_unit","=",`${b.value.business_unit}`]],n={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:me.EzyFormDefinitions};te.get(`${le.GetDoctypeData}`,{params:n}).then(r=>{K.value=r.message.data,e==="form_name"?x.value=s&&K.value.some(d=>d.form_name&&d.form_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":e==="form_short_name"&&(N.value=s&&K.value.some(d=>d.form_short_name&&d.form_short_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(r=>{console.error("Error fetching ezyForms data:",r),e==="form_name"?x.value="":e==="form_short_name"&&(N.value="")})}const hs=t=>t===0?"1st row":t===1?"2nd row":t===2?"3rd row":`${t+1}th row`,yt=_([]),bs=()=>{h.length&&(yt.value=h,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function gs(){te.post(le.delete_form_items,{deleted_fields:V.flatMap(wt),doctype:H}).then(t=>{var e;(e=t==null?void 0:t.message)!=null&&e.success&&bt()})}function Nt(t){return rt(this,null,function*(){if(gt.value){he("Please fix the errors before proceeding.");return}Bt.value=!0;let e=V.flatMap(wt);H!=null&&H!=null&&H!="new"&&e.length?gs():bt(t)})}const ys=t=>{const e=typeof t=="string"?t:t.fieldType||t.id;console.log("Field added from library:",e,t);const s=xe.value,o=h[s];if(!o){he("Please create a block first before adding fields");return}const n=ws(e);if(!n)return;o.sections||(o.sections=[]),o.sections.length===0&&o.sections.push({label:"",rows:[[{fields:[]}]]});const u=o.sections[0].rows[0][0];u.fields||(u.fields=[]),u.fields.push(n),console.log("Field added successfully:",n),_e(`${n.label} field added successfully`)},_s=t=>{const e=typeof t=="string"?t:t.fieldType||t.id;console.log("Drag started:",e,t),xt.value=e},ws=t=>{var r,d,u,v;console.log("Creating field from type:",t),console.log("Available field types:",Object.keys(We));const e=We[t];if(!e)return console.error("Field type not found:",t),console.error("Attempted to find:",t,"in",We),he(`Field type "${t}" not found. Please try again.`),null;const s=Date.now(),o=Math.random().toString(36).substring(2,6),n=`${t}_${s}_${o}`;return{id:`field_${s}_${o}`,fieldname:n,label:e.name,fieldtype:e.frappe_fieldtype,options:((r=e.defaultProps)==null?void 0:r.options)||"",reqd:(d=e.defaultProps)!=null&&d.required?1:0,read_only:0,hidden:0,description:e.description||"",default:((u=e.defaultProps)==null?void 0:u.default)||"",placeholder:((v=e.defaultProps)==null?void 0:v.placeholder)||""}};return(t,e)=>(a(),i("div",null,[l("div",Vo,[l("div",Ro,[l("div",Uo,[l("div",Mo,[l("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:e[0]||(e[0]=s=>Ql())},e[37]||(e[37]=[l("button",{class:"btn font-13 ms-3"},[l("i",{class:"bi bi-arrow-left"}),l("span",{class:"ms-2"},"Back")],-1)])),t.$route.query.id||t.$route.query.preId?(a(),i("span",Oo,"("+g(ie.value.formId||E(F).query.form_name)+")",1)):m("",!0)]),l("div",null,[C.value===2&&E(h).length&&!t.$route.query.id?(a(),i("button",{key:0,disabled:gt.value||it.value,style:Es({cursor:gt.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:e[1]||(e[1]=s=>Nt("Draft"))},e[38]||(e[38]=[l("i",{class:"bi bi-bookmark-check-fill"},null,-1),P(" Save As Draft ")]),12,Bo)):m("",!0)])]),l("div",Po,[l("div",zo,[l("div",No,[l("div",Ho,[l("ul",jo,[(a(!0),i(O,null,B(Ul.value,s=>(a(),i("li",{key:s.id,class:A({active:C.value===s.id,completed:C.value>s.id})},[l("div",{class:A(["d-flex gap-3 align-items-center",{"not-allowed":it.value&&C.value+1===s.id}]),onClick:o=>xl(s.id)},[C.value>s.id?(a(),i("i",Yo)):(a(),i("i",{key:1,class:A(s.icon)},null,2)),l("div",Go,[l("span",Zo,g(s.stepno),1),e[39]||(e[39]=l("br",null,null,-1)),l("span",Ko,g(s.label),1)])],10,Jo)],2))),128))])])]),l("div",Wo,[l("div",Qo,[l("div",Xo,[C.value===1?(a(),i("div",xo,[l("div",Io,[l("div",ea,[e[40]||(e[40]=l("div",null,null,-1)),e[41]||(e[41]=l("h1",{class:"font-14 fw-bold m-0"},"About Form",-1)),l("div",null,[!t.$route.query.id&&!t.$route.query.preId?(a(),i("button",{key:0,class:"btn btn-light font-12 mx-2",type:"button",onClick:Xl},"Clear Form")):m("",!0),C.value<3?(a(),Me(Gt,{key:1,class:"btn btn-dark bg-dark text-white fw-bold font-13",name:"Next",onClick:Rt})):m("",!0)])])]),l("div",ta,[l("div",la,[e[55]||(e[55]=l("div",{class:"col-sm-none col-md-4"},null,-1)),l("div",sa,[l("div",oa,[l("div",aa,[l("div",ia,[l("div",na,[E(F).query.preId?(a(),i("span",ra,e[42]||(e[42]=[P("Predefined "),l("i",{class:"bi bi-check2-circle"},null,-1)]))):m("",!0),ae(Ze,{disabled:(ie.value.formId&&ie.value.formId.length>0||E(F).query.form_name)&&De.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Untitled Form",onChange:e[2]||(e[2]=s=>zt(s,"form_name")),modelValue:$t.value,"onUpdate:modelValue":e[3]||(e[3]=s=>$t.value=s)},null,8,["disabled","modelValue"]),x.value?(a(),i("span",da,g(x.value),1)):m("",!0)])]),l("div",ca,[ae(Ze,{disabled:(ie.value.formId&&ie.value.formId.length>0||E(F).query.form_name)&&De.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Untitled Form",onChange:e[4]||(e[4]=s=>zt(s,"form_short_name")),modelValue:b.value.form_short_name,"onUpdate:modelValue":e[5]||(e[5]=s=>b.value.form_short_name=s)},null,8,["disabled","modelValue"]),N.value?(a(),i("span",ua,g(N.value),1)):m("",!0)]),l("div",pa,[ae(Ze,{disabled:ie.value.formId&&ie.value.formId.length>0&&De.value!=="1",labeltext:"Form Naming series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Naming series",modelValue:b.value.series,"onUpdate:modelValue":e[6]||(e[6]=s=>b.value.series=s)},null,8,["disabled","modelValue"]),e[43]||(e[43]=Vs('<small class="text-muted" style="font-size:12px;" data-v-7bf58f9f> Note : Enter <code data-v-7bf58f9f>YY-YY</code>, <code data-v-7bf58f9f>YYYY</code>, or <code data-v-7bf58f9f>ABC</code>. The system will default to the format <code data-v-7bf58f9f> 24-25-0001</code>, <code data-v-7bf58f9f> 2025-0001</code>, or <code data-v-7bf58f9f> ABC-0001</code> respectively. </small>',1))]),l("div",fa,[l("label",null,[e[44]||(e[44]=P("Owner Of The Form ")),b.value.owner_of_the_form?m("",!0):(a(),i("span",ma,"*"))]),ae(E(Ke),{disabled:ie.value.formId&&ie.value.formId.length>0&&De.value!=="1",onOpen:Ot,options:G.value,onChange:ht,modelValue:b.value.owner_of_the_form,"onUpdate:modelValue":e[7]||(e[7]=s=>b.value.owner_of_the_form=s),placeholder:"Select Department",multiple:!1,class:"font-11 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"])]),l("div",va,[l("label",null,[e[45]||(e[45]=P("Form Category ")),b.value.form_category?m("",!0):(a(),i("span",ha,"*"))]),ae(E(Ke),{disabled:ie.value.formId&&ie.value.formId.length>0&&De.value!=="1",options:q.value,modelValue:b.value.form_category,"onUpdate:modelValue":e[8]||(e[8]=s=>b.value.form_category=s),placeholder:"Select Category",multiple:!1,searchable:!0,class:"font-11 multiselect"},null,8,["disabled","options","modelValue"])]),l("div",ba,[l("label",null,[e[46]||(e[46]=P("Accessible to Department ")),b.value.accessible_departments.length?m("",!0):(a(),i("span",ga,"*"))]),ae(E(Ke),{modelValue:b.value.accessible_departments,"onUpdate:modelValue":e[10]||(e[10]=s=>b.value.accessible_departments=s),options:Ol.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Department",class:"font-11",onSelect:Nl,onRemove:Hl,openDirection:"bottom"},{option:kt(({option:s})=>[l("div",ya,[l("input",{type:"checkbox",checked:Pl(s),class:"custom-checkbox",onChange:o=>zl(s,o),onClick:e[9]||(e[9]=de(()=>{},["stop"]))},null,40,_a),l("span",null,g(s),1)])]),selection:kt(({values:s,isOpen:o})=>[s.length?S((a(),i("span",{key:0,class:"multiselect__single font-10"},g(Bl.value),513)),[[Ue,!o]]):m("",!0)]),_:1},8,["modelValue","options"])]),l("div",wa,[e[47]||(e[47]=l("label",null,"Form Type",-1)),ae(E(Ke),{options:Ft,modelValue:St.value,"onUpdate:modelValue":e[11]||(e[11]=s=>St.value=s),placeholder:"Select Form Type",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:s=>s.value,class:"font-11 multiselect",openDirection:"top"},null,8,["modelValue","reduce"]),e[48]||(e[48]=l("small",{class:"text-muted font-12 ms-2"},"Note: Public form is accessible by anyone through QR code.",-1))]),l("div",ka,[e[49]||(e[49]=l("label",null,[P("Has Workflow "),l("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(E(Ke),{options:["Yes","No"],modelValue:b.value.has_workflow,"onUpdate:modelValue":e[12]||(e[12]=s=>b.value.has_workflow=s),placeholder:"Select",multiple:!1,class:"font-11 multiselect",searchable:!0},null,8,["modelValue"])]),b.value.as_web_view===1?(a(),i("div",Ca,[e[50]||(e[50]=l("label",null,[P("Form Submit Response "),l("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(Ze,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit Response",modelValue:b.value.public_form_response,"onUpdate:modelValue":e[13]||(e[13]=s=>b.value.public_form_response=s)},null,8,["modelValue"])])):m("",!0),b.value.as_web_view===1?(a(),i("div",Da,[e[51]||(e[51]=l("label",null,[P("Submit Notification Email "),l("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(Ze,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit mail",modelValue:b.value.mail_id,"onUpdate:modelValue":e[14]||(e[14]=s=>b.value.mail_id=s)},null,8,["modelValue"]),e[52]||(e[52]=l("small",{class:"text-muted font-12 ms-2"},"Note : If multiple Emails, separate with commas (,).",-1))])):m("",!0),E(F).query.preId?(a(),i("div",Fa,[l("div",Sa,[S(l("input",{class:"form-check-input linketoCheck p-1",disabled:b.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":e[15]||(e[15]=s=>b.value.is_linked=s),"true-value":1,"false-value":0},null,8,$a),[[Ve,b.value.is_linked]]),e[53]||(e[53]=l("label",{class:"form-check-label font-12 mx-2 mb-0 ps-1",for:"is_linked"}," Link ",-1))])])):m("",!0),b.value.is_linked?(a(),i("div",qa,[e[54]||(e[54]=l("label",{for:"standardFormInput"},"Form",-1)),S(l("input",{type:"text",class:"form-control standardFormInput",id:"standardFormInput",disabled:b.value.is_predefined_doctype==1,"onUpdate:modelValue":e[16]||(e[16]=s=>b.value.is_linked_form=s),placeholder:"Type to search Form Name...",onInput:ll,onFocus:e[17]||(e[17]=s=>Xe.value=!0),onBlur:ol},null,40,Ta),[[J,b.value.is_linked_form]]),Xe.value&&Qe.value.length?(a(),i("ul",Aa,[(a(!0),i(O,null,B(Qe.value,(s,o)=>(a(),i("li",{class:"list-group-item formlistitem",key:o,onMousedown:de(n=>sl(s.name),["prevent"])},g(s.name),41,La))),128))])):m("",!0)])):m("",!0)])])]),e[56]||(e[56]=l("div",{class:"col-sm-none col-md-4"},null,-1))])])])):m("",!0),C.value===2?(a(),i("div",Ea,[l("div",Va,[l("div",Ra,[l("button",{onClick:e[18]||(e[18]=s=>Ut()),class:"btn btn-sm btn-light"},e[57]||(e[57]=[l("i",{class:"bi bi-chevron-left"},null,-1),P(" Back ")]))]),l("div",Ua,[(a(!0),i(O,null,B(E(h),(s,o)=>(a(),i("button",{key:o,class:A(["zoho-tab",{active:xe.value===o}]),onClick:n=>xe.value=o},[e[58]||(e[58]=l("i",{class:"bi bi-file-earmark-text me-1"},null,-1)),P(" "+g(o===0?"Requestor Block":`Approver Block ${o}`)+" ",1),E(h).length>1?(a(),i("i",{key:0,class:"bi bi-x-lg ms-2",onClick:de(n=>Pt(o),["stop"])},null,8,Oa)):m("",!0)],10,Ma))),128))]),l("div",Ba,[l("button",{class:"btn btn-sm btn-primary me-2",onClick:ls},e[59]||(e[59]=[l("i",{class:"bi bi-plus-lg me-1"},null,-1),P("Add Block ")])),vs.value?(a(),i("button",{key:0,class:"btn btn-sm btn-light me-2",onClick:bs},e[60]||(e[60]=[l("i",{class:"bi bi-eye me-1"},null,-1),P("Preview ")]))):m("",!0),E(h).length?(a(),i("button",{key:1,class:"btn btn-sm btn-dark",onClick:e[19]||(e[19]=s=>Nt("save"))},g(E(H)!=="new"?"Update Form":"Create Form"),1)):m("",!0)])]),l("div",Pa,[l("aside",{class:A(["zoho-field-library",{collapsed:!qe.value}])},[l("div",{class:"library-header",onClick:e[20]||(e[20]=s=>qe.value=!qe.value)},[l("div",za,[l("h6",Na,[e[61]||(e[61]=l("i",{class:"bi bi-grid-3x3-gap me-2"},null,-1)),P(" "+g(qe.value?"Field Types":"Fields"),1)]),l("button",Ha,[l("i",{class:A(qe.value?"bi bi-chevron-left":"bi bi-chevron-right")},null,2)])])]),qe.value?(a(),i("div",ja,[ae(Eo,{collapsible:!0,onFieldAdd:ys,onFieldDragstart:_s})])):m("",!0)],2),l("div",Ja,[l("div",{class:"canvas-inner",ref_key:"mainBlockRef",ref:at},[(a(!0),i(O,null,B(E(h),(s,o)=>S((a(),i("div",{class:"block-level",key:o},[l("div",Ya,[l("div",Ga,[l("div",Za,[l("h6",Ka,g(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),l("div",Wa,[o!==0&&W(o).view_only_reportee||W(o).all_approvals_required||W(o).requester_as_a_approver?(a(),i("div",Qa,[l("span",Xa,g(W(o).view_only_reportee===1?"Reporting Manager only":"")+" "+g(W(o).all_approvals_required===1?"All of the selected approvers":"")+" "+g(W(o).requester_as_a_approver===1?"Approval by Requestor":""),1),l("span",null,[e[62]||(e[62]=l("span",{class:"ms-1"}," on rejection escalating to ",-1)),l("span",xa,g(W(o).on_rejection?`Level ${W(o).on_rejection}`:"Requestor"),1)]),l("span",Ia,g(W(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):m("",!0)])]),l("div",ei,[E(H)&&E(I).length?(a(),i("div",ti,[W(o)?(a(),i("label",li,[l("span",si,g(W(o).roles.length>0?o===0?"Requestor: ":"Approver: ":""),1),l("span",oi,g(W(o).roles.slice(0,2).join(", ")),1),W(o).roles.length>2?(a(),i("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>vt(o),class:"more-count"}," +"+g(W(o).roles.length-2)+" more ",9,ai)):m("",!0)])):m("",!0)])):m("",!0),el(o)&&E(H)!=null&&E(H)!=null&&E(H)!="new"&&W(o).roles.length===0?(a(),i("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>vt(o)},[e[63]||(e[63]=l("img",{src:Ps,alt:"Add",class:"me-1"},null,-1)),P(" "+g(o===0?"Add Requestors":"Add Approvers"),1)],8,ii)):m("",!0),E(H)!=null&&E(H)!=null&&E(H)!="new"&&W(o).roles.length>0?(a(),i("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>vt(o)},e[64]||(e[64]=[l("i",{class:"bi bi-pencil font-14"},null,-1)]),8,ni)):m("",!0),l("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:n=>Pt(o)},e[65]||(e[65]=[l("i",{class:"bi bi-trash me-1"},null,-1),P(" Delete Block ")]),8,ri)])])]),l("div",di,[(a(!0),i(O,null,B(s.sections,(n,r)=>(a(),i("div",{key:"section-"+r,class:"dynamicSection mt-0 section"},[l("section",ci,[l("div",ui,[S(l("input",{"onUpdate:modelValue":d=>n.label=d,type:"text",class:A(["border-less-input","font-14",{"italic-style":!n.label},{"fw-medium":n.label}]),onChange:d=>fe(o,r),onInput:d=>fe(o,r),placeholder:"Untitled section"},null,42,pi),[[J,n.label]]),n.errorMsg?(a(),i("small",fi,g(n.errorMsg),1)):m("",!0)]),l("div",mi,[l("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:d=>as(o,r)},e[66]||(e[66]=[l("i",{class:"bi bi-trash me-1"},null,-1),P(" Delete Section ")]),8,vi)])]),l("div",hi,[(a(!0),i(O,null,B(n.rows,(d,u)=>(a(),i("section",{class:"row dynamicRow row-container",key:"row-"+u},[l("div",bi,[l("label",gi,g(hs(u)),1),l("div",null,[d.columns.length<3?(a(),i("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:v=>is(o,r,u)},e[67]||(e[67]=[l("i",{class:"bi bi-plus font-14"},null,-1),P(" Add Column ")]),8,yi)):m("",!0)])]),l("div",_i,[l("div",wi,[(a(!0),i(O,null,B(d.columns,(v,c)=>(a(),i("div",{key:"column-"+c,onMouseenter:p=>pl(o,r,u,c),onMouseleave:fl,class:"col p-0 dynamicColumn position-relative column-container"},[l("div",Ci,[l("div",Di,[S(l("input",{"onUpdate:modelValue":p=>v.label=p,type:"text",class:A(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!v.label},{"fw-medium":v.label}]),onChange:p=>fe(o,r,u,c),onInput:p=>fe(o,r,u,c),placeholder:"Column Name"},null,42,Fi),[[J,v.label]]),v.errorMsg?(a(),i("small",Si,g(v.errorMsg),1)):m("",!0)]),S(l("div",$i,[l("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:p=>ns(o,r,u,c)},e[68]||(e[68]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,qi)],512),[[Ue,ml(o,r,u,c)]])]),v.fields.length===0?(a(),i("div",{key:0,class:"empty-drop-zone",onDragover:e[21]||(e[21]=de(()=>{},["prevent"])),onDrop:p=>ke(p,o,r,u,c,t.fieldIndex)},null,40,Ti)):m("",!0),(a(!0),i(O,null,B(v.fields,(p,k)=>{var M;return a(),i("div",{key:"field-"+k,onMouseenter:w=>dl(o,r,u,c,k),onMouseleave:cl,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:w=>Tt(w,o,r,u,c,k),onDragover:e[25]||(e[25]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,r,u,c,k)},[l("div",{class:"drop-zone",onDragover:e[22]||(e[22]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,r,u,c,k)},null,40,Li),p.fieldtype!=="Table"?(a(),i("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:w=>Tt(w,o,r,u,c,k),onDragover:e[23]||(e[23]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,r,u,c,k)},[l("div",Vi,[l("div",Ri,[S(l("input",{"onUpdate:modelValue":w=>p.label=w,placeholder:"Name the field",class:A(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!p.label},{"fw-medium":p.label}]),onChange:w=>fe(o,r,u,c,k),onInput:w=>fe(o,r,u,c,k)},null,42,Ui),[[J,p.label]]),p.errorMsg?(a(),i("small",Mi,g(p.errorMsg),1)):m("",!0)]),S(l("div",Oi,[l("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:w=>cs(o,r,u,c,k)},e[69]||(e[69]=[l("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,Bi),l("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:w=>{ds(o,r,u,c,k),fe(o,r,u,c)}},e[70]||(e[70]=[l("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,Pi)],512),[[Ue,ul(o,r,u,c,k)]])]),S(l("select",{"onUpdate:modelValue":w=>p.fieldtype=w,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:w=>us(o,r,u,c,k)},[e[71]||(e[71]=l("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(Ml,w=>l("option",{key:w,value:w.type},g(w.label),9,Ni)),64))],40,zi),[[Re,p.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(p.fieldtype)?(a(),i("div",Hi,[e[72]||(e[72]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":w=>p.options=w,class:"form-control shadow-none mb-1 font-12"},null,8,ji),[[J,p.options]]),!p.options||p.options.trim()===""?(a(),i("small",Ji," Options are required for this field type. ")):m("",!0)])):m("",!0),p.fieldtype==="Link"?(a(),i("div",Yi,[l("label",{class:"font-11 fw-light",for:"link-search-"+be(o,r,u,c,k)}," Search Doctype: ",8,Gi),S(l("input",{id:"link-search-"+be(o,r,u,c,k),type:"text","onUpdate:modelValue":w=>E(h)[o].sections[r].rows[u].columns[c].fields[k].options=w,onInput:w=>il(E(h)[o].sections[r].rows[u].columns[c].fields[k].options,o,r,u,c,k),onFocus:w=>al(be(o,r,u,c,k)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,Zi),[[J,E(h)[o].sections[r].rows[u].columns[c].fields[k].options]]),(M=Be[be(o,r,u,c,k)])!=null&&M.length&&ut[be(o,r,u,c,k)]?(a(),i("ul",Ki,[(a(!0),i(O,null,B(Be[be(o,r,u,c,k)],(w,D)=>(a(),i("li",{key:D,onClick:T=>nl(o,r,u,c,k,w.name),class:"list-group-item list-group-item-action"},g(w.name),9,Wi))),128))])):m("",!0)])):m("",!0),l("div",Qi,[l("div",Xi,[l("div",xi,[S(l("input",{class:"font-12","onUpdate:modelValue":w=>p.reqd=w,"true-value":1,id:"mandatory-"+o+"-"+r+"-"+u+"-"+c+"-"+k,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,Ii),[[Ve,p.reqd]])]),l("div",null,[l("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+r+"-"+u+"-"+c+"-"+k},"Mandatory",8,en)])]),l("div",null,[l("button",{class:"btn btn-sm font-12",onClick:w=>p.showDescription=!p.showDescription},g(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,tn)])]),p.showDescription?S((a(),i("textarea",{key:2,"onUpdate:modelValue":w=>p.description=w,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,ln)),[[J,p.description]]):m("",!0),p.error?(a(),i("small",sn,g(p.error),1)):m("",!0)],40,Ei)):m("",!0),l("div",{class:"drop-zone",onDragover:e[24]||(e[24]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,r,u,c,k)},null,40,on),l("div",an,[l("div",null,[l("div",null,[l("div",nn,[p.fieldtype==="Table"?(a(),i("div",rn,[(a(!0),i(O,null,B(re.value,(w,D)=>(a(),i("div",{key:D,class:"childTable"},[D===p.fieldname||D===p.options?(a(),i("h5",dn,g(D.replace(/_/g," ")),1)):m("",!0),Q[D]&&D===Et.value?(a(),i("div",cn,[l("div",un,[p.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":T=>p.description=T,class:"form-control font-12",placeholder:"Enter field description"},null,8,pn)),[[J,p.description]]):m("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:T=>p.showDescription=!p.showDescription},g(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,fn)])])):m("",!0),D===p.options||D===p.fieldname?(a(),i("table",mn,[e[76]||(e[76]=l("thead",null,[l("tr",null,[l("th",null,"#"),l("th",null,"Label"),l("th",null,"Field Type")])],-1)),l("tbody",{onDragover:de(bl,["prevent"]),onDrop:T=>gl(T,w)},[(a(!0),i(O,null,B(w,(T,se)=>{var Ne,He,je,Je,Ye,Ge,oe;return a(),i("tr",{key:se,draggable:Q[D],onDragstart:X=>vl(se),onDragend:hl,class:A({dragging:Fe.value===se})},[l("td",null,g(se+1),1),Q[D]?(a(),i("td",bn,[S(l("input",{"onUpdate:modelValue":X=>T.label=X,onInput:X=>ot(T,D,se),placeholder:"Field Label",class:A(["form-control",{"border-1 border-danger":(He=(Ne=R[D])==null?void 0:Ne[se])==null?void 0:He.length}])},null,42,gn),[[J,T.label]]),(Je=(je=R[D])==null?void 0:je[se])!=null&&Je.length?(a(),i("div",yn,[(a(!0),i(O,null,B(R[D][se],(X,ks)=>(a(),i("div",{key:ks},g(X),1))),128))])):m("",!0)])):(a(),i("td",_n,g(T.label),1)),Q[D]?(a(),i("td",wn,[l("div",kn,[S(l("select",{"onUpdate:modelValue":X=>T.fieldtype=X,onChange:X=>ot(T,D,se),class:A(["form-select form-select-sm",{"border-1 border-danger":(Ge=(Ye=R[D])==null?void 0:Ye[se])==null?void 0:Ge.length}])},[e[73]||(e[73]=l("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(ft,X=>l("option",{key:X.type,value:X.type},g(X.label),9,Dn)),64))],42,Cn),[[Re,T.fieldtype]]),l("div",Fn,[l("div",Sn,[l("div",$n,[S(l("input",{class:"font-12 form-control-sm","onUpdate:modelValue":X=>T.description=X,placeholder:"description",type:"text"},null,8,qn),[[J,T.description]])])]),l("button",{class:"btn btn-light btn-sm",onClick:X=>Vl(D,se)},e[74]||(e[74]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,Tn)])]),["Select"].includes(T.fieldtype)?(a(),i("div",An,[e[75]||(e[75]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":X=>T.options=X,onInput:X=>ot(T,D,se),class:"form-control shadow-none mb-1 font-12"},null,40,Ln),[[J,T.options]]),!T.options||T.options.trim()===""?(a(),i("small",En," Options are required for this field type. ")):m("",!0)])):m("",!0),(oe=ee[D])!=null&&oe.includes(se)?(a(),i("span",Vn,"Type required**")):m("",!0)])):(a(),i("td",Rn,g(T.fieldtype),1))],42,hn)}),128))],40,vn)])):m("",!0),p.fieldtype==="Table"&&(p.label===D||p.fieldname===D)?(a(),i("div",Un,[l("button",{class:"btn btn-light btn-sm mx-2",onClick:T=>Rl(D,p.description)},g(Q[D]?"Save":"Edit"),9,Mn),Q[D]?(a(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:T=>El(D)}," Add More Field ",8,On)):m("",!0)])):m("",!0)]))),128))])):m("",!0)])])])])],40,Ai)}),128)),l("div",{class:"drop-zone-bottom",onDragover:e[26]||(e[26]=de(()=>{},["prevent"])),onDrop:p=>ke(p,o,r,u,c,v.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,Bn),l("div",{class:"drop-zone",onDragover:e[27]||(e[27]=de(()=>{},["prevent"])),onDrop:p=>ke(p,o,r,u,c,t.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,Pn),l("div",zn,[l("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:p=>rs(o,r,u,c)},e[77]||(e[77]=[l("i",{class:"bi bi-plus fs-5"},null,-1),l("span",null,"Add Field",-1)]),8,Nn)])],40,ki))),128))])])]))),128)),l("div",null,[(a(!0),i(O,null,B(n.afterCreated,(d,u)=>(a(),i("div",{key:u,class:"childTable dynamicColumn m-0 p-2"},[l("h5",Hn,g(d.tableName),1),Q[d.tableName]?(a(),i("div",jn,[l("div",Jn,[d.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":v=>d.description=v,class:"form-control font-12",placeholder:"Enter field description"},null,8,Yn)),[[J,d.description]]):m("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:v=>d.showDescription=!d.showDescription},g(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,Gn)])])):m("",!0),l("table",Zn,[e[83]||(e[83]=l("thead",null,[l("tr",null,[l("th",null,"#"),l("th",null,"Label"),l("th",null,"Field Type")])],-1)),l("tbody",null,[(a(!0),i(O,null,B(d.columns,(v,c)=>{var p,k,M,w;return a(),i("tr",{key:c},[l("td",null,g(c+1),1),Q[d.tableName]?(a(),i("td",Kn,[S(l("input",{"onUpdate:modelValue":D=>v.label=D,placeholder:"Field Label",class:A(["form-control",{"border-1 border-danger":(p=ee[d.tableName])==null?void 0:p.includes(c)}]),onBlur:D=>{var T;v.label=(T=v.label)==null?void 0:T.trim(),Pe(v,d.tableName,c,d.columns)}},null,42,Wn),[[J,v.label]]),(k=R[d.tableName])!=null&&k[c]?(a(),i("div",Qn,[(a(!0),i(O,null,B(R[d.tableName][c],(D,T)=>(a(),i("span",{key:T},[P(g(D)+" ",1),e[78]||(e[78]=l("br",null,null,-1))]))),128))])):m("",!0)])):(a(),i("td",Xn,g(v.label),1)),Q[d.tableName]?(a(),i("td",xn,[l("div",In,[S(l("select",{"onUpdate:modelValue":D=>v.fieldtype=D,class:A(["form-select form-select-sm",{"border-1 border-danger":(M=ee[d.tableName])==null?void 0:M.includes(c)}]),onChange:D=>Pe(v,d.tableName,c,d.columns)},[e[79]||(e[79]=l("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(ft,D=>l("option",{key:D.type,value:D.type},g(D.label),9,tr)),64))],42,er),[[Re,v.fieldtype]]),l("button",{class:"btn btn-light btn-sm",onClick:D=>Al(o,r,d.tableName,c)},e[80]||(e[80]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,lr)]),v.fieldtype==="Select"?(a(),i("div",sr,[e[81]||(e[81]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":D=>v.options=D,class:"form-control shadow-none mb-1 font-12",onInput:D=>Pe(v,d.tableName,c,d.columns)},null,40,or),[[J,v.options]])])):m("",!0),(w=R[d.tableName])!=null&&w[c]?(a(),i("div",ar,[(a(!0),i(O,null,B(R[d.tableName][c],(D,T)=>(a(),i("span",{key:T},[P(g(D),1),e[82]||(e[82]=l("br",null,null,-1))]))),128))])):m("",!0)])):(a(),i("td",ir,g(v.fieldtype),1))])}),128))])]),l("div",nr,[l("button",{class:"btn btn-light btn-sm mx-2",onClick:v=>Ll(o,r,d.tableName)},g(Q[d.tableName]?"Save":"Edit"),9,rr),Q[d.tableName]?(a(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:v=>Tl(o,r,d.tableName)}," Add More Field ",8,dr)):m("",!0)])]))),128))])]),l("div",null,[l("div",null,[o==0?(a(),i("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:d=>_l(o,r)}," Add New Table ",8,cr)):m("",!0),(a(!0),i(O,null,B(n.childTables,(d,u)=>{var v;return a(),i("div",{key:`table-${o}-${r}-${u}`,class:"child-table"},[d.newTable?(a(),i("div",ur,[l("div",pr,[l("div",null,[l("span",{class:A(d.tableName?"d-none":"text-danger")},"*",2),S(l("input",{"onUpdate:modelValue":c=>d.tableName=c,placeholder:"Table Name",onBlur:c=>At(d),class:A(["border-less-input font-14 p-0 inputHeight",{"italic-style":!d.tableName,"fw-medium":d.tableName}])},null,42,fr),[[J,d.tableName]]),(v=R[`${o}-${r}-${u}`])!=null&&v.tableName?(a(),i("div",mr,g(R[`${o}-${r}-${u}`].tableName),1)):m("",!0),Ee.value?(a(),i("div",vr,g(Ee.value),1)):m("",!0),l("div",hr,[l("div",br,[d.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":c=>d.as_a_block=c,class:"form-control font-12",placeholder:"Enter field description"},null,8,gr)),[[J,d.as_a_block]]):m("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:c=>d.showDescription=!d.showDescription},g(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,yr)])])]),l("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:c=>kl(o,r,u)},e[84]||(e[84]=[l("i",{class:"bi bi-trash"},null,-1),P(" Remove Table ")]),8,_r)]),(a(!0),i(O,null,B(d.columns,(c,p)=>{var k,M,w,D,T,se,Ne,He,je,Je,Ye,Ge;return a(),i("div",{key:p,class:"dynamicField"},[l("div",wr,[l("div",kr,[l("div",null,[l("span",{class:A(c.label?"d-none":"text-danger")},"*",2),S(l("input",{"onUpdate:modelValue":oe=>c.label=oe,placeholder:"Name the field",onBlur:()=>{At(c),Dl(c,o,r,u,p,d.columns)},class:A(["border-less-input font-14 p-0 inputHeight",{"italic-style":!c.label,"fw-medium":c.label,"is-invalid":(w=(M=(k=R[`${o}-${r}-${u}`])==null?void 0:k.columns)==null?void 0:M[p])==null?void 0:w.label}])},null,42,Cr),[[J,c.label]]),(se=(T=(D=R[`${o}-${r}-${u}`])==null?void 0:D.columns)==null?void 0:T[p])!=null&&se.label?(a(),i("div",Dr,g(R[`${o}-${r}-${u}`].columns[p].label),1)):m("",!0)]),l("div",Fr,[l("div",Sr,[c.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":oe=>c.description=oe,class:"form-control font-12",placeholder:"Enter field description"},null,8,$r)),[[J,c.description]]):m("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:oe=>c.showDescription=!c.showDescription},g(c.showDescription?"Hide Description":c.description?"Edit Description":"Add Description"),9,qr)]),l("button",{class:"btn btn-sm trash-btn py-0",onClick:oe=>Cl(o,r,u,p)},e[85]||(e[85]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,Tr)])]),S(l("select",{"onUpdate:modelValue":oe=>c.fieldtype=oe,class:A(["form-select font-13 mb-1",{"is-invalid":(je=(He=(Ne=R[`${o}-${r}-${u}`])==null?void 0:Ne.columns)==null?void 0:He[p])==null?void 0:je.fieldtype}])},[e[86]||(e[86]=l("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(ft,oe=>l("option",{key:oe.type,value:oe.type},g(oe.label),9,Lr)),64))],10,Ar),[[Re,c.fieldtype]]),["Select"].includes(c.fieldtype)?(a(),i("div",Er,[e[87]||(e[87]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":oe=>c.options=oe,class:"form-control shadow-none mb-1 font-12"},null,8,Vr),[[J,c.options]]),!c.options||c.options.trim()===""?(a(),i("small",Rr," Options are required for this field type. ")):m("",!0)])):m("",!0),(Ge=(Ye=(Je=R[`${o}-${r}-${u}`])==null?void 0:Je.columns)==null?void 0:Ye[p])!=null&&Ge.fieldtype?(a(),i("div",Ur,g(R[`${o}-${r}-${u}`].columns[p].fieldtype),1)):m("",!0)])])}),128)),l("button",{class:"btn btn-light btn-sm addField mx-1",onClick:c=>wl(o,r,u)},e[88]||(e[88]=[l("i",{class:"bi bi-plus"},null,-1),P(" Add Field ")]),8,Mr),l("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:c=>ql(o,r,u)}," Create Table ",8,Or),e[89]||(e[89]=l("hr",null,null,-1))])):m("",!0)])}),128))])]),l("div",Br,[l("button",{class:"btn btn-light border font-12",onClick:d=>os(o,r)},e[90]||(e[90]=[l("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),P(" Add Section ")]),8,Pr)])]))),128)),o===0?(a(),i("div",zr)):m("",!0)])])),[[Ue,o===xe.value]])),128))],512)]),Dt.value?(a(),i("aside",Nr,[l("div",Hr,[e[92]||(e[92]=l("h6",{class:"mb-0"},"Field Properties",-1)),l("button",{class:"btn btn-sm btn-link p-0",onClick:e[28]||(e[28]=s=>Dt.value=null)},e[91]||(e[91]=[l("i",{class:"bi bi-x-lg"},null,-1)]))]),e[93]||(e[93]=l("div",{class:"properties-content"},[l("p",{class:"text-muted small"},"Select a field to edit its properties")],-1))])):m("",!0)])])):m("",!0),C.value===3?(a(),i("div",jr,[e[94]||(e[94]=l("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[l("div",null,[l("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),l("div")],-1)),ae(Rs,{blockArr:yt.value},null,8,["blockArr"])])):m("",!0)])])])])])])]),l("div",Jr,[l("div",Yr,[l("div",Gr,[e[98]||(e[98]=l("div",{class:"modal-header"},[l("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),l("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),l("div",Zr,[e[96]||(e[96]=l("label",{for:""},"Form Name",-1)),S(l("input",{"onUpdate:modelValue":e[29]||(e[29]=s=>et.value=s),multiple:!1,placeholder:E(F).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,Kr),[[J,et.value]]),l("div",Wr,[l("div",Qr,[S(l("input",{class:"font-12","onUpdate:modelValue":e[30]||(e[30]=s=>Ae.value=s),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[Ve,Ae.value]])]),e[95]||(e[95]=l("div",null,[l("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),l("div",{class:"modal-footer"},[e[97]||(e[97]=l("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),l("button",{type:"button",class:"btn btn-dark",onClick:es},"Add Print Format")])])])]),l("div",Xr,[l("div",xr,[l("span",Ir,g(z.value==0?"Add designation for Requestors":`Approval Settings For
          Level-${z.value}`),1),e[99]||(e[99]=l("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),l("div",ed,[l("div",td,[l("div",ld,[z.value!==0?(a(),i("div",sd,[z.value!==0?(a(),i("div",od,[e[101]||(e[101]=l("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),S(l("select",{"onUpdate:modelValue":e[31]||(e[31]=s=>pe.value=s),class:"form-select shadow-none font-12"},e[100]||(e[100]=[l("option",{value:""},"Any one of the selected approvers",-1),l("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),l("option",{value:"all_approvals_required"},"All of the selected approvers",-1),l("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[Re,pe.value]])])):m("",!0)])):m("",!0)])]),l("div",ad,[l("div",id,[l("span",nd," Select "+g(z.value===0?"Requestors":"Approvers"),1),l("span",rd,g($.value.length)+" Selected ",1)]),Z.value.length?(a(),i("div",dd,[l("div",cd,[l("div",ud,[l("input",{type:"checkbox",id:"selectAll",checked:jl.value,onChange:Jl,class:"form-check-input me-2 designationCheckBox"},null,40,pd),l("label",fd," Select all designation ("+g(ze.value.length)+") ",1)]),z.value!==0?(a(),i("div",md,[S(l("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":e[32]||(e[32]=s=>Le.value=s),class:"form-check-input me-2 designationCheckBox"},null,512),[[Ve,Le.value]]),e[102]||(e[102]=l("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):m("",!0),l("div",null,[$.value.length?(a(),i("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:Yl},e[103]||(e[103]=[l("i",{class:"bi bi-x"},null,-1),P(" Clear all ")]))):m("",!0)])]),Z.value.length?(a(),Me(E(Us),{key:0,multiple:!0,modelValue:$.value,"onUpdate:modelValue":e[33]||(e[33]=s=>$.value=s),options:ze.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):m("",!0)],512)):(a(),i("div",vd,e[104]||(e[104]=[l("div",{class:"d-flex justify-content-center"},[l("span",null,"No Designations Found")],-1)])))]),z.value!==0?(a(),i("div",hd,[e[105]||(e[105]=l("div",null,[l("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),S(l("select",{"onUpdate:modelValue":e[34]||(e[34]=s=>ve.value=s),class:"form-select shadow-none font-12 mt-1 me-2"},[(a(!0),i(O,null,B(rl.value,s=>(a(),i("option",{key:s,value:s},g(s===0?"Requestor":"Approver Level "+s),9,bd))),128))],512),[[Re,ve.value,void 0,{number:!0}]])])):m("",!0),z.value!==0?(a(),i("div",gd,[l("div",yd,[l("div",_d,[S(l("input",{"onUpdate:modelValue":e[35]||(e[35]=s=>U.value=s),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Ve,U.value]]),e[106]||(e[106]=l("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),ct.value===!0?(a(),i("div",wd,[S(l("input",{"onUpdate:modelValue":e[36]||(e[36]=s=>j.value=s),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Ve,j.value]]),e[107]||(e[107]=l("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):m("",!0)])])):m("",!0)]),l("div",kd,[l("div",Cd,[l("div",null,[ae(Gt,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:Gl,name:z.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},$d=Oe(Dd,[["__scopeId","data-v-7bf58f9f"]]);export{$d as default};
