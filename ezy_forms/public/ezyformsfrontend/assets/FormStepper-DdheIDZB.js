var pl=Object.defineProperty,ml=Object.defineProperties;var fl=Object.getOwnPropertyDescriptors;var et=Object.getOwnPropertySymbols;var Tt=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable;var Lt=(T,k,V)=>k in T?pl(T,k,{enumerable:!0,configurable:!0,writable:!0,value:V}):T[k]=V,x=(T,k)=>{for(var V in k||(k={}))Tt.call(k,V)&&Lt(T,V,k[V]);if(et)for(var V of et(k))Ut.call(k,V)&&Lt(T,V,k[V]);return T},ve=(T,k)=>ml(T,fl(k));var pt=(T,k)=>{var V={};for(var F in T)Tt.call(T,F)&&k.indexOf(F)<0&&(V[F]=T[F]);if(T!=null&&et)for(var F of et(T))k.indexOf(F)<0&&Ut.call(T,F)&&(V[F]=T[F]);return V};var tt=(T,k,V)=>new Promise((F,$e)=>{var ne=G=>{try{v(V.next(G))}catch(ie){$e(ie)}},Ne=G=>{try{v(V.throw(G))}catch(ie){$e(ie)}},v=G=>G.done?F(G.value):Promise.resolve(G.value).then(ne,Ne);v((V=V.apply(T,k)).next())});import{_ as vl,u as _l,M as hl,r as y,e as ee,x as te,E as gl,w as _e,f as bl,a6 as Ot,K as oe,y as H,z as P,o as u,c,d as s,t as h,L as S,l as _,a7 as yl,m as U,F as E,h as L,n as j,Z as Mt,S as Rt,b as I,O as Be,B as wl,R as ze,Q as Bt,X as ae,i as C,v as mt,N as Se,j as O,Y as kl,k as Fe,a8 as Cl,a9 as Dl,U as he,H as ge,aa as ft,a2 as Sl,ab as zt,ac as Fl,D as $l}from"./index-DcfVEAvB.js";const Al="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",Vl={class:""},ql={class:""},El={class:"d-flex justify-content-between align-items-center CancelNdSave"},Ll={class:"d-flex align-items-center"},Tl={key:0,class:"font-16"},Ul=["disabled"],Ol={class:"form-container p-0 container-fluid mt-1"},Ml={class:"row"},Rl={class:"col-lg-2 col-md-2 col-sm-12"},Bl={class:"steps-sticky-div"},zl={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},Nl=["onClick"],Hl={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},Pl={class:"step-text"},jl={class:"font-11"},Jl={class:"font-14"},Zl={class:"col-lg-10 col-md-10 col-sm-12 formbackground-color"},Yl={class:""},Gl={class:"form-content stepsDiv"},Wl={key:0},Kl={class:""},Ql={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},Xl={class:"container-fluid aboutFields p-0"},xl={class:"row"},Il={class:"col-sm-12 col-md-12 mt-lg-3 p-lg-4"},eo={class:"container-fluid"},to={class:"row g-3"},so={class:"col-md-6"},lo={class:"position-relative"},oo={key:0,class:"font-12 position-absolute PredefinedLabel"},ao={key:1,class:"text-danger ErrorMsg ms-2"},no={class:"col-md-6"},io={key:0,class:"text-danger ErrorMsg ms-2"},ro={class:"col-md-6"},uo={class:"col-md-6"},co={key:0,class:"text-danger"},po={class:"col-md-6"},mo={key:0,class:"text-danger"},fo={class:"col-md-6"},vo={key:0,class:"text-danger"},_o={class:"custom-option"},ho=["checked","onChange"],go={class:"col-md-6"},bo={class:"col-md-6"},yo={key:0,class:"col-md-6"},wo={key:1,class:"col-md-6"},ko={key:2,class:"col-md-6"},Co={class:"form-check d-flex align-items-center p-0 pe-3"},Do=["disabled"],So={key:3,class:"col-md-6"},Fo=["disabled"],$o={key:0,class:"list-group position-absolute w-100 z-3 formslist"},Ao=["onMousedown"],Vo={key:1},qo={class:""},Eo={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},Lo={class:"d-flex gap-2 align-items-center"},To={class:"requestandAppHeader"},Uo={class:"d-flex justify-content-between align-items-center"},Oo={class:""},Mo={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},Ro={class:"text-center ms-2 mt-1"},Bo={key:0,class:"font-12 d-flex align-items-center"},zo={class:"font-12 approver_type_div"},No={class:"font-12 fw-bold"},Ho={class:"font-12 text-danger ms-1"},Po={class:"d-flex align-items-center"},jo={key:0,class:"role-container"},Jo={key:0,class:"role-text d-flex align-items-center"},Zo={class:"role-label fw-bold"},Yo={class:"role-names"},Go=["onClick"],Wo=["onClick"],Ko=["onClick"],Qo=["onClick"],Xo={class:"pt-0 section_block"},xo={class:"d-flex justify-content-between align-items-center"},Io={class:"d-flex flex-column"},ea=["onUpdate:modelValue","onChange","onInput"],ta={key:0,class:"text-danger ps-3 font-10"},sa={class:"d-flex align-items-center"},la=["onClick"],oa={class:"container-fluid"},aa={class:"d-flex justify-content-between align-items-center"},na={class:"rownames m-0"},ia=["onClick"],ra={class:"col"},ua={class:"row"},ca=["onMouseenter"],da={class:"column_name d-flex align-items-center justify-content-between"},pa={class:"d-flex flex-column ps-2"},ma=["onUpdate:modelValue","onChange","onInput"],fa={key:0,class:"text-danger ps-2 font-10"},va={class:"position-absolute top-0 end-0"},_a=["onClick"],ha=["onDrop"],ga=["onMouseenter","onDragstart","onDrop"],ba=["onDrop"],ya=["onDragstart","onDrop"],wa={class:"d-flex justify-content-between"},ka={class:"flex-column d-flex"},Ca=["onUpdate:modelValue","onChange","onInput"],Da={key:0,class:"text-danger font-10"},Sa={class:"FieldcopyRemove"},Fa=["onClick"],$a=["onClick"],Aa=["onUpdate:modelValue","onChange"],Va=["value"],qa={key:0},Ea=["onUpdate:modelValue"],La={key:0,class:"text-danger font-10"},Ta={key:1},Ua=["for"],Oa=["id","onUpdate:modelValue","onInput","onFocus"],Ma={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},Ra=["onClick"],Ba={class:"d-flex align-items-center justify-content-between"},za={class:"d-flex align-items-center gap-2"},Na={class:"d-flex align-items-center"},Ha=["onUpdate:modelValue","id"],Pa=["for"],ja=["onClick"],Ja=["onUpdate:modelValue"],Za={key:3,class:"text-danger font-10"},Ya=["onDrop"],Ga={class:"childtableShow"},Wa={class:"mt-2"},Ka={key:0,class:"childTableContainer"},Qa={key:0,class:"font-13"},Xa={key:1,class:"d-flex align-items-center gap-2"},xa={class:"d-flex align-items-center"},Ia=["onUpdate:modelValue"],en=["onClick"],tn={key:2,class:"table table-bordered rounded-table"},sn=["onDrop"],ln=["draggable","onDragstart"],on={key:0},an=["onUpdate:modelValue","onInput"],nn={key:0,class:"text-danger font-11"},rn={key:1},un={key:2},cn={class:"d-flex gap-1"},dn=["onUpdate:modelValue","onChange"],pn=["value"],mn={class:"d-flex"},fn={class:"d-flex align-items-center gap-2"},vn={class:"d-flex align-items-center"},_n=["onUpdate:modelValue"],hn=["onClick"],gn={key:0},bn=["onUpdate:modelValue","onInput"],yn={key:0,class:"text-danger font-10"},wn={key:1,class:"font-11 text-danger"},kn={key:3},Cn={key:3,class:"mb-2 mt-3"},Dn=["onClick"],Sn=["onClick"],Fn=["onDrop"],$n=["onDrop"],An={class:"d-flex justify-content-center align-items-center my-2"},Vn=["onClick"],qn={class:"font-13"},En={key:0,class:"d-flex align-items-center gap-2"},Ln={class:"d-flex align-items-center"},Tn=["onUpdate:modelValue"],Un=["onClick"],On={class:"table table-bordered rounded-table"},Mn={key:0},Rn=["onUpdate:modelValue","onBlur"],Bn={key:0,class:"text-danger font-11 mt-1"},zn={key:1},Nn={key:2},Hn={class:"d-flex gap-1 align-items-center"},Pn=["onUpdate:modelValue","onChange"],jn=["value"],Jn=["onClick"],Zn={key:0,class:"mt-1"},Yn=["onUpdate:modelValue","onInput"],Gn={key:1,class:"text-danger font-11 mt-1"},Wn={key:3},Kn={class:"mb-2"},Qn=["onClick"],Xn=["onClick"],xn=["onClick"],In={key:0},ei={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},ti=["onUpdate:modelValue","onBlur"],si={key:0,class:"text-danger font-12"},li={key:1,class:"text-danger font-12"},oi={class:"d-flex align-items-center gap-2"},ai={class:"d-flex align-items-center"},ni=["onUpdate:modelValue"],ii=["onClick"],ri=["onClick"],ui={class:"px-1 field-border"},ci={class:"d-flex justify-content-between"},di=["onUpdate:modelValue","onBlur"],pi={key:0,class:"text-danger font-12"},mi={class:"d-flex align-items-center"},fi={class:"d-flex my-1"},vi=["onUpdate:modelValue"],_i=["onClick"],hi=["onClick"],gi=["onUpdate:modelValue"],bi=["value"],yi={key:0},wi=["onUpdate:modelValue"],ki={key:0,class:"text-danger font-10"},Ci={key:1,class:"text-danger font-12"},Di=["onClick"],Si=["onClick"],Fi={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},$i=["onClick"],Ai={key:0,class:"m-2"},Vi={key:2},qi={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},Ei={class:"modal-dialog modal-dialog-centered"},Li={class:"modal-content"},Ti={class:"modal-body"},Ui=["placeholder"],Oi={class:"d-flex align-items-center gap-2"},Mi={class:"d-flex align-items-center py-2"},Ri={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},Bi={class:"offcanvas-header add_designationHeader"},zi={id:"offcanvasRightLabel",class:"font-14 fw-bold"},Ni={class:"offcanvas-body add_desig_offCanvas_body p-0"},Hi={class:""},Pi={class:""},ji={key:0,class:"p-3 approval-border-bottom"},Ji={key:0,class:""},Zi={class:"px-3 listofdesignations"},Yi={class:"my-1 d-flex justify-content-between"},Gi={class:"font-12 fw-bold"},Wi={class:"italic-style text-secondary font-12"},Ki={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},Qi={class:"d-flex align-items-center justify-content-between gap-1"},Xi={class:"form-check ps-1 d-flex align-items-center m-0"},xi=["checked"],Ii={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},er={key:0,class:"form-check d-flex align-items-center m-0"},tr={key:1},sr={key:0,class:"p-3"},lr=["value"],or={key:1},ar={class:""},nr={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},ir={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},rr={class:"offcanvas-footer"},ur={class:"text-end p-3"},be="Select All",cr={__name:"FormStepper",setup(T){const k=_l(),V=hl(),F=y(1),$e=y([]);y([]);const ne=y([]),Ne=y([]);ee([]);let v=ee([]),G=ee([]);const ie=y([]),J=y([]),st=y([]),re=y(""),X=y(""),M=y("");let W=ee([]);const Ae=y("");y(!1),y(!1),y(!1);const ye=y(""),He=y(""),Pe=y(""),Nt=y([]),Ht=y([]),$=ee({}),K=y([]),lt=y(!1),je=y([]),Je=y(!1);let vt=null;const Pt=y("");let q=y("");const we=te(()=>gl);y(!1);const Ze=ee([]),Q=y({routepath:k.query.routepath,business_unit:k.query.business_unit,formId:k.query.id}),Ye=y(""),ke=y(!1),Ce=y(!1),_t=[{label:"Public",value:1},{label:"Private",value:0}],ht=te({get(){return _t.find(t=>t.value===f.value.as_web_view)},set(t){f.value.as_web_view=t?t.value:null}}),gt=te({get(){return f.value.form_name||k.query.form_name||""},set(t){f.value.form_name=t}}),f=y({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${we.value.value||Q.value.business_unit||k.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:k.query.id?1:0,as_web_view:0,mail_id:""});_e(()=>k.query.form_name,t=>{t&&(f.value.form_name=t,f.value.form_short_name=t)},{immediate:!0});const Ge=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(t=>t.toLowerCase().trim()),bt=["Approver","Approved on","Approved By"].map(t=>t.toLowerCase().trim());function jt(t){return t.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}const Jt=te(()=>f.value);y(""),y(!1),_e(we,t=>{t&&t.value&&(f.value.business_unit=t.value)},{immediate:!0});function Zt(t){if(q==null||q==="new")return!1;const e=R(t).roles;if(t===0)return e.length===0;const l=R(t-1).roles;return l.length>0&&l[0]!==null&&l[0]!==""&&e.length===0}_e(()=>f.value.form_name,t=>{f.value.form_name=t.trim()}),_e(()=>f.value.form_short_name,t=>{f.value.form_short_name=t.trim()}),_e(()=>f.value.series,t=>{f.value.series=t.trim()});const We=y(null),yt=(t,e,l,o,n,a)=>{We.value={blockIndex:e,sectionIndex:l,rowIndex:o,columnIndex:n,fieldIndex:a}},de=(t,e,l,o,n,a)=>{if(!We.value)return;const{blockIndex:i,sectionIndex:d,rowIndex:m,columnIndex:r,fieldIndex:p}=We.value,b=v[i].sections[d].rows[m].columns[r].fields,A=v[e].sections[l].rows[o].columns[n].fields;if(i===e&&d===l&&m===o&&r===n&&p===a)return;const g=b.splice(p,1)[0];b===A&&p<a&&a--,A.splice(a,0,g),We.value=null},De=y(""),Yt=t=>tt(this,null,function*(){const e=[["module","in",["User Forms"]],["istable","=",1]];t!=null&&t.trim()&&e.push(["name","=",`${t}`]);const l={fields:JSON.stringify(["name"]),filters:JSON.stringify(e),limit_page_length:"None",doctype:oe.doctypesList};try{return(yield H.get(P.GetDoctypeData,{params:l})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),Ke=y(null),wt=t=>tt(this,null,function*(){if(De.value="",Ke.value=null,t.tableName){let e=t.tableName.trim();if(e.length>64){De.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(e)){De.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield Yt(e);Ke.value=o.find(n=>n.name.toLowerCase()===e.toLowerCase()),Ke.value&&(De.value="Table already exists"),t.tableName=e}t.label&&(t.fieldname=jt(t.label))});function Gt(){const t=f.value.is_linked_form;if(!t){je.value=[];return}clearTimeout(vt),vt=setTimeout(()=>{const e=[["business_unit","=",`${we.value.value}`],["name","like",`%${t}%`]],l={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(e),doctype:oe.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};H.get(`${P.GetDoctypeData}`,{params:l}).then(o=>{je.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function Wt(t){f.value.is_linked_form=t,Je.value=!1}function Kt(){setTimeout(()=>{Je.value=!1},200)}ee({query:"",key:""});function ue(t,e,l,o,n){return`${t}-${e}-${l}-${o}-${n}`}ee({});const Ve=ee({}),ot=ee({});function Qt(t){ot[t]=!0}function Xt(t,e,l,o,n,a){const i=ue(e,l,o,n,a),d=[["istable","=",0]];t!=null&&t.trim()&&d.push(["name","like",`%${t}%`]);const m={fields:JSON.stringify(["name"]),filters:JSON.stringify(d),limit_page_length:"none",doctype:oe.doctypesList};H.get(P.GetDoctypeData,{params:m}).then(r=>{Ve[i]=r.message.data||[]}).catch(r=>{console.error("Error fetching doctype list:",r),Ve[i]=[]})}function xt(t,e,l,o,n,a){v[t].sections[e].rows[l].columns[o].fields[n].options=a;const i=ue(t,e,l,o,n);Ve[i]=[],ot[i]=!1}const It=te(()=>v!=null&&v.length?M.value===1?[0]:Array.from({length:M.value},(t,e)=>e).filter(t=>t<M.value):[]),ce=y(null),pe=y(null),es=(t,e,l,o,n)=>{ce.value={blockIndex:t,sectionIndex:e,rowIndex:l,columnIndex:o,fieldIndex:n}},ts=()=>{ce.value=null},ss=(t,e,l,o,n)=>ce.value&&ce.value.blockIndex===t&&ce.value.sectionIndex===e&&ce.value.rowIndex===l&&ce.value.columnIndex===o&&ce.value.fieldIndex===n,ls=(t,e,l,o)=>{pe.value={blockIndex:t,sectionIndex:e,rowIndex:l,columnIndex:o}},os=()=>{pe.value=null},as=(t,e,l,o)=>pe.value&&pe.value.blockIndex===t&&pe.value.sectionIndex===e&&pe.value.rowIndex===l&&pe.value.columnIndex===o,kt=y([{form_json:""}]),me=y("");bl(()=>{At(),me.value=k.query.Clone,q.value=k.query.id||"new",me.value==="1"&&(f.value.series=""),q.value!=null&&q.value!=null&&q.value!="new"&&($t(),ut()),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?lt.value=!0:lt.value=!1;let t=localStorage.getItem("Bu");if(f.value.business_unit=t,k.query.preId==="PreDefine"){const e=localStorage.getItem("form_json");if(e){kt.value[0].form_json=e;const l=kt.value[0],o=JSON.parse(l.form_json),n=Ot(o.fields);K.value=o.child_table_fields,n.forEach(a=>{v.push(a)})}}});const fe=y(null),N=ee({}),Ct=y(null),ns=t=>{fe.value=t},is=()=>{fe.value=null},rs=t=>{t.preventDefault()},us=(t,e)=>{const l=t.target.closest("tr");if(!l)return;const o=Array.from(l.parentNode.children).indexOf(l);if(o!==fe.value){const n=e[fe.value];e.splice(fe.value,1),e.splice(o,0,n),fe.value=o}},cs=y([]),at=t=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(t.fieldtype)&&t.options){const e=t.options.split(`
`).map(n=>n.trim()).filter(n=>n),l=[],o=new Set;return e.forEach(n=>{const a=n.toLowerCase();o.has(a)||(o.add(a),l.push(n))}),`
`+l.join(`
`)}else if(["Link","Table"].includes(t.fieldtype)&&t.options)return t.options.trim();return t.options},ds=(t,e)=>{const l=v[t].sections[e];l.childTables||(l.childTables=[]);const o=l.childTables.length;l.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[x({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},Ze.fieldtype==="Select"&&Ze.options?{options:Ze.options?`
${Ze.options}`:`
`}:{})],newTable:!0})},ps=(t,e,l)=>{const o=v[t].sections[e].childTables[l];o.columns||(o.columns=[]),o.columns.push(x({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},ms=(t,e,l)=>{v[t].sections[e].childTables.splice(l,1)},fs=(t,e,l,o)=>{v[t].sections[e].childTables[l].columns.splice(o,1)};function vs(t,e,l,o,n,a){var r;const i=`${e}-${l}-${o}`;$[i]||($[i]={columns:[]});const d={},m=((r=t.label)==null?void 0:r.trim())||"";if(!m)d.label="Field Label is required";else{const p=m.toLowerCase();if(Ge.includes(p)&&!bt.includes(p))d.label=`"${m}" is a restricted field label`;else if(m.length>64)d.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(m))d.label="Field Label can only contain letters, numbers, and single spaces between words";else{const b=a.map((A,g)=>{var w;return{label:(w=A.label)==null?void 0:w.trim().toLowerCase(),index:g}}).filter(A=>A.label===p);if(b.length>1){const A=b[0].index;n!==A&&(d.label=`"${m}" is already used in this table`)}}}$[i].columns[n]=d}function Qe(t,e,l){var a;$[e]||($[e]={});const o=[],n=((a=t.label)==null?void 0:a.trim())||"";n||o.push("Label is required"),n.length>64&&o.push("Label cannot exceed 64 characters"),n&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(n)&&o.push("No special characters allowed"),n&&Ge.includes(n.toLowerCase().trim())&&o.push("This label is restricted"),n&&K.value[e].map(m=>{var r;return(r=m.label)==null?void 0:r.trim().toLowerCase()}).filter(Boolean).filter(m=>m===n.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),t.fieldtype||o.push("Field type is required"),t.fieldtype==="Select"&&(!t.options||t.options.trim()==="")&&o.push("Options are required"),$[e][l]=o}const _s=(t,e,l)=>{var i;const o=v[t].sections[e].childTables[l],n={tableName:!1,columns:[]};let a=!1;return(i=o.tableName)!=null&&i.trim()||(n.tableName="Table name is required.",a=!0),o.columns.forEach((d,m)=>{var p,b;const r={};(p=d.label)!=null&&p.trim()||(r.label="Field Label is required",a=!0),(b=d.fieldtype)!=null&&b.trim()||(r.fieldtype="Please select field type",a=!0),n.columns[m]=r}),$[`${t}-${e}-${l}`]=n,a},hs=(t,e,l)=>{var n,a;const o=(a=(n=v[t])==null?void 0:n.sections)==null?void 0:a[e];o&&!Array.isArray(o[l])&&(o[l]=[])},gs=t=>t?t.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",bs=(t,e,l)=>{if(_s(t,e,l)){he("Please fix validation errors before creating the table",{transition:"zoom"});return}if(Ke.value){he("Table already exists",{transition:"zoom"});return}const n=v[t].sections[e].childTables[l],a=v[t].sections[e];n.columns=n.columns.map((d,m)=>ve(x({},d),{idx:m,options:at(d)})),n.newTable=!1;const i={form_short_name:n.tableName,fields:n.columns,idx:n.idx,as_a_block:n.as_a_block?n.as_a_block:"false"};H.post(P.childtable,i).then(d=>{var m,r,p;if(d){hs(t,e,"afterCreated"),a.afterCreated[l]=x({},n),ge("Table created successfully!");const b=(p=(r=(m=d.message)==null?void 0:m[0])==null?void 0:r[0])==null?void 0:p.child_doc;b&&(v[t].sections[e].childTables[l]=ve(x(x({},v[t].sections[e].childTables[l]),b),{newTable:!1}))}}).catch(d=>{console.error("Error creating table:",d)})},qe=(t,e,l,o=[])=>{var i;N[e]||(N[e]=[]),N[e]=N[e].filter(d=>d!==l),$[e]||($[e]=[]),$[e][l]=[];const n=[],a=((i=t.label)==null?void 0:i.trim())||"";if(a?Ge.includes(a.toLowerCase())?n.push("This label is restricted"):a.length>64?n.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(a)||n.push("Only letters, numbers, and single spaces allowed"):n.push("Label is required"),o.length){const d=a.toLowerCase(),m=o.map((r,p)=>{var b;return{label:(b=r.label)==null?void 0:b.trim().toLowerCase(),idx:p}}).filter(r=>r.label===d);if(m.length>1){const r=m[0].idx;l!==r?(n.push("Duplicate label not allowed"),t._duplicate=!0):t._duplicate=!1}else t._duplicate=!1}return t.fieldtype||n.push("Field type is required"),t.fieldtype==="Select"&&(!t.options||!t.options.trim())&&n.push("Options are required"),$[e][l]=n,n.length>0&&N[e].push(l),n.length===0},ys=(t,e,l)=>{const n=v[t].sections[e].afterCreated.find(d=>d.tableName===l);if(!n)return;const a=n.columns.length,i={fieldname:"",fieldtype:"",idx:a+1,label:"",value:"",isNew:!0,description:""};n.columns.push(i),qe(i,l,a,n.columns)},Dt=y([]),ws=(t,e,l,o)=>{const a=v[t].sections[e].afterCreated.find(d=>d.tableName===l);if(!a)return;a.columns.splice(o,1),a.columns.forEach((d,m)=>{d.idx=m+1});const i=N.value[l];i&&(N.value[l]=i.filter(d=>d!==o).map(d=>d>o?d-1:d))},ks=(t,e,l)=>{const n=v[t].sections[e].afterCreated.find(a=>a.tableName===l);if(n){if(B[l]){N[l]=[];let a=!0;if(n.columns.forEach((m,r)=>{qe(m,l,r,n.columns)||(a=!1)}),!a){he("Please fix the errors in the highlighted fields before saving!");return}const i=n.columns.map((b,p)=>{var A=b,{isNew:m}=A,r=pt(A,["isNew"]);return ve(x({},r),{idx:p+1,options:at(r)})}),d={form_short_name:gs(l),fields:i,as_a_block:n.description};H.post(P.childtable,d).then(m=>{Dt.value=m.data,ge("Fields updated successfully!")}).catch(m=>{console.error("❌ Saving fields failed:",m)})}B[l]=!B[l]}},B=ee({}),Cs=t=>{K.value[t]||(K.value[t]=[]);const e=K.value[t].length+1;K.value[t].push({fieldname:"",fieldtype:"",idx:e,label:"",value:"",isNew:!0,description:"",options:K.value[t].options?`
${K.value[t].options}`:""})},Ds=(t,e)=>{K.value[t]&&K.value[t].splice(e,1)},Ss=(t,e)=>{if(!t)return;N.value||(N.value={}),N.value[t]||(N.value[t]=[]);const l=K.value[t];if(l){if(B[t]){N.value[t]=[];let o=!0;if(l.forEach((i,d)=>{var r;Qe(i,t,d);const m=(r=$[t])==null?void 0:r[d];m&&m.length>0&&(N.value[t].push(d),o=!1),i.label&&(i.label=i.label.trim())}),!o){he("Please fix the errors before saving");return}const n=l.map((r,m)=>{var p=r,{isNew:i}=p,d=pt(p,["isNew"]);return ve(x({},d),{idx:m+1,options:at(d)})}),a={form_short_name:t,fields:n,as_a_block:e};H.post(P.childtable,a).then(i=>{Dt.value=i.data,ge("Fields updated successfully!")}).catch(i=>{console.error("❌ Saving fields failed:",i)})}B[t]=!B[t],Ct.value=B[t]?t:null}},Fs=y([{id:1,label:"About Form",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Fields & Workflow",stepno:"Step 2",icon:"bi bi-question-circle"},{id:3,label:"Print Format",stepno:"Step 3",icon:"ri-checkbox-circle-line"}]),nt=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],$s=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],As=te(()=>[be,...ne.value]),Vs=te(()=>{const t=f.value.accessible_departments;return t.includes(be)?"All Selected":t.length>1?`${t[0]}.. +${t.length-1} more selected`:t.join(", ")}),qs=t=>t===be?f.value.accessible_departments.length===ne.value.length:f.value.accessible_departments.includes(t),Es=(t,e)=>{t===be?e.target.checked?f.value.accessible_departments=[...ne.value]:f.value.accessible_departments=[]:(e.target.checked?f.value.accessible_departments.push(t):f.value.accessible_departments=f.value.accessible_departments.filter(l=>l!==t),f.value.accessible_departments.length===ne.value.length?f.value.accessible_departments=[...ne.value]:f.value.accessible_departments=f.value.accessible_departments.filter(l=>l!==be))},Ls=t=>{t===be&&(f.value.accessible_departments=[...ne.value])},Ts=t=>{t===be&&(f.value.accessible_departments=[])},it=y(!1),Ee=te(()=>{var e;let t=[...ie.value];if(Ce.value&&(t=t.filter(l=>l.is_hod===1)),(e=Ae.value)!=null&&e.trim()){const l=Ae.value.toLowerCase();t=t.filter(o=>o.role.toLowerCase().includes(l))}return t.sort((l,o)=>l.role.localeCompare(o.role)),t.sort((l,o)=>{const n=J.value.includes(l.role),a=J.value.includes(o.role);return n===a?0:n?1:-1}),t.map(l=>l.role)}),Us=te(()=>{const t=Ee.value;return t.length>0&&t.every(e=>J.value.includes(e))});_e([J,Ee],()=>{const t=Ee.value;it.value=t.length>0&&t.every(e=>J.value.includes(e))},{immediate:!0,deep:!0});function Os(t){const e=t.target.checked,l=ie.value.filter(o=>{var n;return!(Ce.value&&o.is_hod!==1||(n=Ae.value)!=null&&n.trim()&&!o.role.toLowerCase().includes(Ae.value.toLowerCase()))}).map(o=>o.role);e?J.value=Array.from(new Set([...J.value,...l])):J.value=J.value.filter(o=>!l.includes(o)),it.value=e}function Ms(){J.value=[],it.value=!1,Ce.value=!1}const se=y("");function Rs(){const t=v[M.value];if(!t||!t.sections){console.error("Error: Invalid block or sections not found.");return}let e={type:M.value==0?"requestor":"approver",roles:J.value,approval_required:He.value,approver_can_edit:Pe.value,fields:t.sections.flatMap(ft),idx:M.value};M.value!==0&&(e.view_only_reportee=se.value==="ViewOnlyReportee"?1:0,e.all_approvals_required=se.value==="all_approvals_required"?1:0,e.requester_as_a_approver=se.value==="requester_as_a_approver"?1:0,e.on_rejection=ye.value?ye.value:0);const l=W.findIndex(o=>o.idx===e.idx);l!==-1?W[l]=e:W.push(e),Ns()}function R(t){return W.find(e=>e.idx===t)||{roles:[]}}function Bs(t){const e=R(t),l=e.roles||[];J.value=[...l],ye.value=e.on_rejection,He.value=e.approval_required,Pe.value=e.approver_can_edit,e.view_only_reportee===1?se.value="ViewOnlyReportee":e.all_approvals_required===1?se.value="all_approvals_required":e.requester_as_a_approver===1?se.value="requester_as_a_approver":se.value=""}const rt=t=>{Ce.value=!1,Ae.value="",se.value="",ye.value="",f.value.accessible_departments.length&&zs(t,f.value.accessible_departments),M.value=t,Bs(t)};function zs(t,e){let l={index:t,departments:e,property:f.value.business_unit};H.post(P.addDesignationroles,l).then(o=>{o.message&&(ie.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function Ns(){H.post(P.add_roles_WF,{workflow_setup:W,doctype:f.value.form_short_name,business_unit:f.value.business_unit}).then(t=>{console.log(t),M.value==0?ge("Requestor Added"):ge(`Approver-${M.value} Added`)})}function Hs(){V.push({path:Q.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function Ps(){f.value.form_name="",f.value.form_short_name="",f.value.owner_of_the_form="",f.value.business_unit="",f.value.form_category="",f.value.accessible_departments=[]}const js=t=>{if(xe.value){he("Please check all required fields before proceeding.");return}t<F.value?Ft():t>F.value&&St()},St=()=>{if(xe.value){he("Please check all required fields before proceeding.");return}F.value<3&&(F.value+=1,F.value===3&&(Ie.value=v))},Ft=()=>{F.value>1&&(F.value-=1)},Js=y([]);function $t(){const t={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:oe.EzyFormDefinitions,doc_id:q.value};H.get(P.GetDoctypeData,{params:t}).then(e=>{var o;let l=e==null?void 0:e.message.data;if(l){l.accessible_departments&&(l.accessible_departments=l.accessible_departments.split(",")),f.value=ve(x(x({},f.value),l),{owner_of_the_form:l.owner_of_the_form||f.value.owner_of_the_form||""});const n=JSON.parse((o=e.message.data)==null?void 0:o.form_json);Nt.value=n.workflow,Pt.value=n.fields.filter(i=>i.fieldtype==="Table"),Js.value=n.fields.filter(i=>i.fieldtype==="Table"),ke.value=e.message.data.is_landscape;let a=Ot(JSON.parse(l==null?void 0:l.form_json).fields);K.value=JSON.parse(e.message.data.form_json).child_table_fields,cs.value=[],Ht.value=[],a.forEach((i,d)=>{v.push(i)}),JSON.parse(l==null?void 0:l.form_json).workflow.forEach((i,d)=>{W.push(i)})}}).catch(e=>{console.error("Error fetching  data:",e)})}function Zs(){const t={};Ye.value&&(t.print_format=Ye.value),ke.value!==void 0&&ke.value!==null&&(t.is_landscape=ke.value),H.put(P.resource+oe.EzyFormDefinitions+`/${k.query.id}`,t).then(e=>{console.log(e),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),ge("Print Format Added Successfully")}).catch(e=>{console.error("Error fetching  data:",e)})}function At(){const t={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${Q.value.business_unit||k.query.business_unit}`,doctype:oe.departments};H.get(P.GetDoctypeData,{params:t}).then(e=>{var l;(l=e==null?void 0:e.message.data)!=null&&l.length&&(Ne.value=e.message.data.map(o=>o.name),ne.value=e.message.data.map(o=>o.name))}).catch(e=>{console.error("Error fetching department data:",e)})}y(""),_e(()=>f.value.owner_of_the_form,t=>{t&&ut(t)});function ut(t){t&&typeof t=="string"&&t.trim()!==""&&Ys(t)}function Ys(t){const e={fields:JSON.stringify(["ezy_departments_items"]),doctype:oe.departments,doc_id:t};H.get(P.GetDoctypeData,{params:e}).then(l=>{var o;(o=l==null?void 0:l.message.data)!=null&&o.ezy_departments_items&&($e.value=l.message.data.ezy_departments_items.map(n=>n.category))}).catch(l=>{console.error("Error fetching categories data:",l)})}function ct(t){let e=Fl(v);const l=ve(x({},f.value),{fields:e,doctype:oe.EzyFormDefinitions,workflow_setup:W,form_status:t==="save"?"Created":"Draft"});l.accessible_departments=l.accessible_departments.toString(),H.post(P.savedata,l).then(o=>{if(o&&o.message&&o.message.message){let n=localStorage.getItem("preName");if(n){let a={installed:"Yes"};H.put(`${P.resource}${oe.preDefinedForm}/${n}`,a).then(i=>{localStorage.removeItem("preName")}).catch(i=>{console.error("Error fetching ezyForms data:",i)})}if(V.push({params:{paramid:o.message.message},query:{id:o.message.message}}),q.value=o.message.message,q&&q!=="new"&&(v.splice(0,v.length),$t()),W.length<v.length)$l("Add Workflow");else if(Vt.value===!0){ge("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let a=localStorage.getItem("routepath");t==="save"?V.push({path:a}):t==="Draft"&&V.push({path:a})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const Xe=y(""),Gs=()=>{var l,o;const t=v.length,e={label:t===0?"requestor":`approver-${t}`,parent:`${(l=we.value)==null?void 0:l.value}-${(o=f.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${we.value.value}-${f.value.form_short_name}`,childTables:[],afterCreated:{},rows:t===0?[{label:`row_0_0_${t}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${t}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${t}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};v.push(e),Sl(()=>{Xe.value&&Xe.value.scrollTo({top:Xe.value.scrollHeight,behavior:"smooth"})})},Vt=y(!1),Ws=t=>{let e=v[t];e.parent&&G.push(e);let l=[];W.length>t&&W[t].roles&&(l=[...W[t].roles]),v.splice(t,1),W.length>t&&W.splice(t,1),v.forEach((o,n)=>{o.sections.forEach((a,i)=>{a.rows.forEach((d,m)=>{d.columns.forEach((r,p)=>{le(n,i,m,p)})})})}),l.length&&Ks(l,t)};function Ks(t,e){const l={role:t,level:e,document_type:f.value.form_name,short_name:f.value.form_short_name,property:f.value.business_unit};H.post(P.deleteAssigneRoles,l).then(o=>{o&&ct()})}const Qs=(t,e)=>{const l={label:"",parent:`${we.value.value}-${f.value.form_short_name}`,rows:[{label:`row_0_${e}_${t}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};v[t].sections.splice(e+1,0,l)},Xs=(t,e)=>{let l=v[t].sections[e];l.parent&&G.push(l),v[t].sections.splice(e,1),v[t].sections.forEach((o,n)=>{o.rows.forEach((a,i)=>{a.columns.forEach((d,m)=>{le(t,n,i,m)})})})},xs=(t,e,l)=>{v[t].sections[e].rows[l].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},Is=(t,e,l,o)=>{const a=v[t].sections[e].rows[l].columns,i=a[o];i.parent&&G.push(i),a.length===1?v[t].sections[e].rows.splice(l,1):a.splice(o,1),v[t].sections.forEach((d,m)=>{d.rows.forEach((r,p)=>{r.columns.forEach((b,A)=>{le(t,m,p,A)})})})},el=(t,e,l,o)=>{v[t].sections[e].rows[l].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},tl=(t,e,l,o,n)=>{let a=v[t].sections[e].rows[l].columns[o].fields[n];a.parent&&G.push(a),v[t].sections[e].rows[l].columns[o].fields.splice(n,1)},sl=(t,e,l,o,n)=>{const a=v[t].sections[e].rows[l].columns[o].fields[n],i=x({},a);i.name=`${a.name} Name the field`,v[t].sections[e].rows[l].columns[o].fields.splice(n+1,0,i)},ll=(t,e,l,o,n)=>{const a=zt(v);v.splice(0,v.length,...a);let i=v[t].sections[e].rows[l].columns[o].fields[n].fieldtype;(i!=="Select"||i!=="radio"||i!=="multiselect")&&(v[t].sections[e].rows[l].columns[o].fields[n].options="")};function ol(t){return Ge.includes(t==null?void 0:t.trim().toLowerCase())}function al(t){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(t)||t.includes('"')||t.includes("'")}function nl(t){return t.flatMap(e=>{var l;return[(l=e.label)==null?void 0:l.trim().toLowerCase(),...e.sections.flatMap(o=>{var n;return[(n=o.label)==null?void 0:n.trim().toLowerCase(),...o.rows.flatMap(a=>a.columns.flatMap(i=>{var d;return[(d=i.label)==null?void 0:d.trim().toLowerCase(),...i.fields.map(m=>{var r;return(r=m.label)==null?void 0:r.trim().toLowerCase()})]}))]})]}).filter(e=>e!==""&&!bt.includes(e))}function le(t,e,l,o,n){const i=nl(v).filter((r,p,b)=>b.indexOf(r)!==p),d=zt(v);v.splice(0,v.length,...d);function m(r,p){if(!r){p.errorMsg="";return}ol(r)?p.errorMsg="Entered label is restricted":al(r)?p.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:r.length>64?p.errorMsg="Label should not exceed 64 characters":p.errorMsg=i.includes(r.trim().toLowerCase())?"Duplicate Label Name":""}n!==void 0&&m(v[t].sections[e].rows[l].columns[o].fields[n].label,v[t].sections[e].rows[l].columns[o].fields[n]),n===void 0&&o!==void 0&&m(v[t].sections[e].rows[l].columns[o].label,v[t].sections[e].rows[l].columns[o]),o===void 0&&n===void 0&&m(v[t].sections[e].label,v[t].sections[e]),v.forEach(r=>{r.sections.forEach(p=>{m(p.label,p),p.rows.forEach(b=>{b.columns.forEach(A=>{m(A.label,A),A.fields.forEach(g=>{m(g.label,g)})})})})})}const dt=te(()=>{function t(e){return!e||typeof e!="object"?!1:"fieldtype"in e&&e.fieldtype===""||"error"in e&&e.error||"errorMsg"in e&&e.errorMsg||["Select","Table MultiSelect"].includes(e.fieldtype)&&(!e.options||e.options.trim()==="")?!0:Array.isArray(e)?e.some(t):Object.values(e).some(t)}return t(v)}),xe=te(()=>re.value.length>0||X.value.length>0||!f.value.form_category||!f.value.owner_of_the_form||f.value.accessible_departments.length===0),il=te(()=>v.some(t=>t.sections.some(e=>e.rows.some(l=>l.columns.some(o=>o.fields.some(n=>n.label&&n.fieldtype))))));function qt(t,e){let l=t.target.value.trim();if(!l){e==="form_name"?re.value="Input cannot be empty or only spaces":e==="form_short_name"&&(X.value="Input cannot be empty or only spaces");return}if(l.length>63){e==="form_name"?re.value="Name cannot exceed 63 characters":e==="form_short_name"&&(X.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(l)){e==="form_short_name"&&(X.value="First character must be a letter");return}else X.value="";if(e==="form_short_name"&&l.length<2){X.value="Short name must have at least 2 letters";return}if(e==="form_short_name"&&/[^a-zA-Z ]/.test(l)){X.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(l)){e==="form_name"?re.value="Special characters are not allowed":e==="form_short_name"&&(X.value="Special characters are not allowed");return}else e==="form_name"?re.value="":e==="form_short_name"&&(X.value="");const o=[[e,"=",`${l}`],["business_unit","=",`${f.value.business_unit}`]],n={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:oe.EzyFormDefinitions};H.get(`${P.GetDoctypeData}`,{params:n}).then(a=>{st.value=a.message.data,e==="form_name"?re.value=l&&st.value.some(i=>i.form_name&&i.form_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":e==="form_short_name"&&(X.value=l&&st.value.some(i=>i.form_short_name&&i.form_short_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(a=>{console.error("Error fetching ezyForms data:",a),e==="form_name"?re.value="":e==="form_short_name"&&(X.value="")})}const rl=t=>t===0?"1st row":t===1?"2nd row":t===2?"3rd row":`${t+1}th row`,Ie=y([]),ul=()=>{v.length&&(Ie.value=v,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function cl(){H.post(P.delete_form_items,{deleted_fields:G.flatMap(ft),doctype:q}).then(t=>{var e;(e=t==null?void 0:t.message)!=null&&e.success&&ct()})}function Et(t){return tt(this,null,function*(){if(dt.value){he("Please fix the errors before proceeding.");return}Vt.value=!0;let e=G.flatMap(ft);q!=null&&q!=null&&q!="new"&&e.length?cl():ct(t)})}return(t,e)=>(u(),c("div",null,[s("div",Vl,[s("div",ql,[s("div",El,[s("div",Ll,[s("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:e[0]||(e[0]=l=>Hs())},e[35]||(e[35]=[s("button",{class:"btn font-13 ms-3"},[s("i",{class:"bi bi-arrow-left"}),s("span",{class:"ms-2"},"Back")],-1)])),t.$route.query.id||t.$route.query.preId?(u(),c("span",Tl,"("+h(Q.value.formId||S(k).query.form_name)+")",1)):_("",!0)]),s("div",null,[F.value===2&&S(v).length&&!t.$route.query.id?(u(),c("button",{key:0,disabled:dt.value||xe.value,style:yl({cursor:dt.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:e[1]||(e[1]=l=>Et("Draft"))},e[36]||(e[36]=[s("i",{class:"bi bi-bookmark-check-fill"},null,-1),U(" Save As Draft ")]),12,Ul)):_("",!0)])]),s("div",Ol,[s("div",Ml,[s("div",Rl,[s("div",Bl,[s("ul",zl,[(u(!0),c(E,null,L(Fs.value,l=>(u(),c("li",{key:l.id,class:j({active:F.value===l.id,completed:F.value>l.id})},[s("div",{class:j(["d-flex gap-3 align-items-center",{"not-allowed":xe.value&&F.value+1===l.id}]),onClick:o=>js(l.id)},[F.value>l.id?(u(),c("i",Hl)):(u(),c("i",{key:1,class:j(l.icon)},null,2)),s("div",Pl,[s("span",jl,h(l.stepno),1),e[37]||(e[37]=s("br",null,null,-1)),s("span",Jl,h(l.label),1)])],10,Nl)],2))),128))])])]),s("div",Zl,[s("div",Yl,[s("div",Gl,[F.value===1?(u(),c("div",Wl,[s("div",Kl,[s("div",Ql,[e[38]||(e[38]=s("div",null,null,-1)),e[39]||(e[39]=s("h1",{class:"font-14 fw-bold m-0"},"About Form",-1)),s("div",null,[!t.$route.query.id&&!t.$route.query.preId?(u(),c("button",{key:0,class:"btn btn-light font-12 mx-2",type:"button",onClick:Ps},"Clear Form")):_("",!0),F.value<3?(u(),Mt(Rt,{key:1,class:"btn btn-dark bg-dark text-white fw-bold font-13",name:"Next",onClick:St})):_("",!0)])])]),s("div",Xl,[s("div",xl,[e[53]||(e[53]=s("div",{class:"col-sm-none col-md-4"},null,-1)),s("div",Il,[s("div",eo,[s("div",to,[s("div",so,[s("div",lo,[S(k).query.preId?(u(),c("span",oo,e[40]||(e[40]=[U("Predefined "),s("i",{class:"bi bi-check2-circle"},null,-1)]))):_("",!0),I(Be,{disabled:(Q.value.formId&&Q.value.formId.length>0||S(k).query.form_name)&&me.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Untitled Form",onChange:e[2]||(e[2]=l=>qt(l,"form_name")),modelValue:gt.value,"onUpdate:modelValue":e[3]||(e[3]=l=>gt.value=l)},null,8,["disabled","modelValue"]),re.value?(u(),c("span",ao,h(re.value),1)):_("",!0)])]),s("div",no,[I(Be,{disabled:(Q.value.formId&&Q.value.formId.length>0||S(k).query.form_name)&&me.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Untitled Form",onChange:e[4]||(e[4]=l=>qt(l,"form_short_name")),modelValue:f.value.form_short_name,"onUpdate:modelValue":e[5]||(e[5]=l=>f.value.form_short_name=l)},null,8,["disabled","modelValue"]),X.value?(u(),c("span",io,h(X.value),1)):_("",!0)]),s("div",ro,[I(Be,{disabled:Q.value.formId&&Q.value.formId.length>0&&me.value!=="1",labeltext:"Form Naming series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Naming series",modelValue:f.value.series,"onUpdate:modelValue":e[6]||(e[6]=l=>f.value.series=l)},null,8,["disabled","modelValue"]),e[41]||(e[41]=wl('<small class="text-muted" style="font-size:12px;" data-v-c6823106> Note : Enter <code data-v-c6823106>YY-YY</code>, <code data-v-c6823106>YYYY</code>, or <code data-v-c6823106>ABC</code>. The system will default to the format <code data-v-c6823106> 24-25-0001</code>, <code data-v-c6823106> 2025-0001</code>, or <code data-v-c6823106> ABC-0001</code> respectively. </small>',1))]),s("div",uo,[s("label",null,[e[42]||(e[42]=U("Owner Of The Form ")),f.value.owner_of_the_form?_("",!0):(u(),c("span",co,"*"))]),I(S(ze),{disabled:Q.value.formId&&Q.value.formId.length>0&&me.value!=="1",onOpen:At,options:Ne.value,onChange:ut,modelValue:f.value.owner_of_the_form,"onUpdate:modelValue":e[7]||(e[7]=l=>f.value.owner_of_the_form=l),placeholder:"Select Department",multiple:!1,class:"font-11 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"])]),s("div",po,[s("label",null,[e[43]||(e[43]=U("Form Category ")),f.value.form_category?_("",!0):(u(),c("span",mo,"*"))]),I(S(ze),{disabled:Q.value.formId&&Q.value.formId.length>0&&me.value!=="1",options:$e.value,modelValue:f.value.form_category,"onUpdate:modelValue":e[8]||(e[8]=l=>f.value.form_category=l),placeholder:"Select Category",multiple:!1,searchable:!0,class:"font-11 multiselect"},null,8,["disabled","options","modelValue"])]),s("div",fo,[s("label",null,[e[44]||(e[44]=U("Accessible to Department ")),f.value.accessible_departments.length?_("",!0):(u(),c("span",vo,"*"))]),I(S(ze),{modelValue:f.value.accessible_departments,"onUpdate:modelValue":e[10]||(e[10]=l=>f.value.accessible_departments=l),options:As.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Department",class:"font-11",onSelect:Ls,onRemove:Ts,openDirection:"bottom"},{option:Bt(({option:l})=>[s("div",_o,[s("input",{type:"checkbox",checked:qs(l),class:"custom-checkbox",onChange:o=>Es(l,o),onClick:e[9]||(e[9]=ae(()=>{},["stop"]))},null,40,ho),s("span",null,h(l),1)])]),selection:Bt(({values:l,isOpen:o})=>[l.length?C((u(),c("span",{key:0,class:"multiselect__single font-10"},h(Vs.value),513)),[[mt,!o]]):_("",!0)]),_:1},8,["modelValue","options"])]),s("div",go,[e[45]||(e[45]=s("label",null,"Form Type",-1)),I(S(ze),{options:_t,modelValue:ht.value,"onUpdate:modelValue":e[11]||(e[11]=l=>ht.value=l),placeholder:"Select Form Type",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:l=>l.value,class:"font-11 multiselect",openDirection:"top"},null,8,["modelValue","reduce"]),e[46]||(e[46]=s("small",{class:"text-muted font-12 ms-2"},"Note: Public form is accessible by anyone through QR code.",-1))]),s("div",bo,[e[47]||(e[47]=s("label",null,[U("Has Workflow "),s("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),I(S(ze),{options:["Yes","No"],modelValue:f.value.has_workflow,"onUpdate:modelValue":e[12]||(e[12]=l=>f.value.has_workflow=l),placeholder:"Select",multiple:!1,class:"font-11 multiselect",searchable:!0},null,8,["modelValue"])]),f.value.as_web_view===1?(u(),c("div",yo,[e[48]||(e[48]=s("label",null,[U("Form Submit Response "),s("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),I(Be,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit Response",modelValue:f.value.public_form_response,"onUpdate:modelValue":e[13]||(e[13]=l=>f.value.public_form_response=l)},null,8,["modelValue"])])):_("",!0),f.value.as_web_view===1?(u(),c("div",wo,[e[49]||(e[49]=s("label",null,[U("Submit Notification Email "),s("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),I(Be,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit mail",modelValue:f.value.mail_id,"onUpdate:modelValue":e[14]||(e[14]=l=>f.value.mail_id=l)},null,8,["modelValue"]),e[50]||(e[50]=s("small",{class:"text-muted font-12 ms-2"},"Note : If multiple Emails, separate with commas (,).",-1))])):_("",!0),S(k).query.preId?(u(),c("div",ko,[s("div",Co,[C(s("input",{class:"form-check-input linketoCheck p-1",disabled:f.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":e[15]||(e[15]=l=>f.value.is_linked=l),"true-value":1,"false-value":0},null,8,Do),[[Se,f.value.is_linked]]),e[51]||(e[51]=s("label",{class:"form-check-label font-12 mx-2 mb-0 ps-1",for:"is_linked"}," Link ",-1))])])):_("",!0),f.value.is_linked?(u(),c("div",So,[e[52]||(e[52]=s("label",{for:"standardFormInput"},"Form",-1)),C(s("input",{type:"text",class:"form-control standardFormInput",id:"standardFormInput",disabled:f.value.is_predefined_doctype==1,"onUpdate:modelValue":e[16]||(e[16]=l=>f.value.is_linked_form=l),placeholder:"Type to search Form Name...",onInput:Gt,onFocus:e[17]||(e[17]=l=>Je.value=!0),onBlur:Kt},null,40,Fo),[[O,f.value.is_linked_form]]),Je.value&&je.value.length?(u(),c("ul",$o,[(u(!0),c(E,null,L(je.value,(l,o)=>(u(),c("li",{class:"list-group-item formlistitem",key:o,onMousedown:ae(n=>Wt(l.name),["prevent"])},h(l.name),41,Ao))),128))])):_("",!0)])):_("",!0)])])]),e[54]||(e[54]=s("div",{class:"col-sm-none col-md-4"},null,-1))])])])):_("",!0),F.value===2?(u(),c("div",Vo,[s("div",qo,[s("div",Eo,[s("h1",{onClick:e[18]||(e[18]=l=>Ft()),class:"font-11 m-0"},e[55]||(e[55]=[s("i",{class:"bi bi-chevron-left"},null,-1),s("span",{class:"ms-2"},"Back To About Form",-1)])),s("div",Lo,[s("div",null,[il.value?(u(),c("button",{key:0,class:"btn btn-light previewBtn d-flex align-items-center font-13",type:"button",onClick:ul},e[56]||(e[56]=[s("i",{class:"bi bi-eye me-1 ms-1 mb-0"},null,-1),U("Preview ")]))):_("",!0)]),S(v).length?(u(),c("button",{key:0,class:"btn btn-dark font-10 Withborder border",type:"button",onClick:e[19]||(e[19]=l=>Et("save"))},h(S(q)!=="new"?"Update Form":"Create Form"),1)):_("",!0)])]),I(kl,{blockArr:Ie.value,formDescriptions:Jt.value,childHeaders:K.value},null,8,["blockArr","formDescriptions","childHeaders"]),s("div",{class:"main-block",ref_key:"mainBlockRef",ref:Xe},[(u(!0),c(E,null,L(S(v),(l,o)=>(u(),c("div",{class:"block-level",key:o},[s("div",To,[s("div",Uo,[s("div",Oo,[s("h6",Mo,h(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),s("div",Ro,[o!==0&&R(o).view_only_reportee||R(o).all_approvals_required||R(o).requester_as_a_approver?(u(),c("div",Bo,[s("span",zo,h(R(o).view_only_reportee===1?"Reporting Manager only":"")+" "+h(R(o).all_approvals_required===1?"All of the selected approvers":"")+" "+h(R(o).requester_as_a_approver===1?"Approval by Requestor":""),1),s("span",null,[e[57]||(e[57]=s("span",{class:"ms-1"}," on rejection escalating to ",-1)),s("span",No,h(R(o).on_rejection?`Level ${R(o).on_rejection}`:"Requestor"),1)]),s("span",Ho,h(R(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):_("",!0)])]),s("div",Po,[S(q)&&S(W).length?(u(),c("div",jo,[R(o)?(u(),c("label",Jo,[s("span",Zo,h(R(o).roles.length>0?o===0?"Requestor: ":"Approver: ":""),1),s("span",Yo,h(R(o).roles.slice(0,2).join(", ")),1),R(o).roles.length>2?(u(),c("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>rt(o),class:"more-count"}," +"+h(R(o).roles.length-2)+" more ",9,Go)):_("",!0)])):_("",!0)])):_("",!0),Zt(o)&&S(q)!=null&&S(q)!=null&&S(q)!="new"&&R(o).roles.length===0?(u(),c("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>rt(o)},[e[58]||(e[58]=s("img",{src:Al,alt:"Add",class:"me-1"},null,-1)),U(" "+h(o===0?"Add Requestors":"Add Approvers"),1)],8,Wo)):_("",!0),S(q)!=null&&S(q)!=null&&S(q)!="new"&&R(o).roles.length>0?(u(),c("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>rt(o)},e[59]||(e[59]=[s("i",{class:"bi bi-pencil font-14"},null,-1)]),8,Ko)):_("",!0),s("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:n=>Ws(o)},e[60]||(e[60]=[s("i",{class:"bi bi-trash me-1"},null,-1),U(" Delete Block ")]),8,Qo)])])]),s("div",Xo,[(u(!0),c(E,null,L(l.sections,(n,a)=>(u(),c("div",{key:"section-"+a,class:"dynamicSection mt-0 section"},[s("section",xo,[s("div",Io,[C(s("input",{"onUpdate:modelValue":i=>n.label=i,type:"text",class:j(["border-less-input","font-14",{"italic-style":!n.label},{"fw-medium":n.label}]),onChange:i=>le(o,a),onInput:i=>le(o,a),placeholder:"Untitled section"},null,42,ea),[[O,n.label]]),n.errorMsg?(u(),c("small",ta,h(n.errorMsg),1)):_("",!0)]),s("div",sa,[s("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:i=>Xs(o,a)},e[61]||(e[61]=[s("i",{class:"bi bi-trash me-1"},null,-1),U(" Delete Section ")]),8,la)])]),s("div",oa,[(u(!0),c(E,null,L(n.rows,(i,d)=>(u(),c("section",{class:"row dynamicRow row-container",key:"row-"+d},[s("div",aa,[s("label",na,h(rl(d)),1),s("div",null,[i.columns.length<3?(u(),c("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:m=>xs(o,a,d)},e[62]||(e[62]=[s("i",{class:"bi bi-plus font-14"},null,-1),U(" Add Column ")]),8,ia)):_("",!0)])]),s("div",ra,[s("div",ua,[(u(!0),c(E,null,L(i.columns,(m,r)=>(u(),c("div",{key:"column-"+r,onMouseenter:p=>ls(o,a,d,r),onMouseleave:os,class:"col p-0 dynamicColumn position-relative column-container"},[s("div",da,[s("div",pa,[C(s("input",{"onUpdate:modelValue":p=>m.label=p,type:"text",class:j(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!m.label},{"fw-medium":m.label}]),onChange:p=>le(o,a,d,r),onInput:p=>le(o,a,d,r),placeholder:"Column Name"},null,42,ma),[[O,m.label]]),m.errorMsg?(u(),c("small",fa,h(m.errorMsg),1)):_("",!0)]),C(s("div",va,[s("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:p=>Is(o,a,d,r)},e[63]||(e[63]=[s("i",{class:"bi bi-x-lg"},null,-1)]),8,_a)],512),[[mt,as(o,a,d,r)]])]),m.fields.length===0?(u(),c("div",{key:0,class:"empty-drop-zone",onDragover:e[20]||(e[20]=ae(()=>{},["prevent"])),onDrop:p=>de(p,o,a,d,r,t.fieldIndex)},null,40,ha)):_("",!0),(u(!0),c(E,null,L(m.fields,(p,b)=>{var A;return u(),c("div",{key:"field-"+b,onMouseenter:g=>es(o,a,d,r,b),onMouseleave:ts,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:g=>yt(g,o,a,d,r,b),onDragover:e[24]||(e[24]=ae(()=>{},["prevent"])),onDrop:g=>de(g,o,a,d,r,b)},[s("div",{class:"drop-zone",onDragover:e[21]||(e[21]=ae(()=>{},["prevent"])),onDrop:g=>de(g,o,a,d,r,b)},null,40,ba),p.fieldtype!=="Table"?(u(),c("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:g=>yt(g,o,a,d,r,b),onDragover:e[22]||(e[22]=ae(()=>{},["prevent"])),onDrop:g=>de(g,o,a,d,r,b)},[s("div",wa,[s("div",ka,[C(s("input",{"onUpdate:modelValue":g=>p.label=g,placeholder:"Name the field",class:j(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!p.label},{"fw-medium":p.label}]),onChange:g=>le(o,a,d,r,b),onInput:g=>le(o,a,d,r,b)},null,42,Ca),[[O,p.label]]),p.errorMsg?(u(),c("small",Da,h(p.errorMsg),1)):_("",!0)]),C(s("div",Sa,[s("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:g=>sl(o,a,d,r,b)},e[64]||(e[64]=[s("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,Fa),s("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:g=>{tl(o,a,d,r,b),le(o,a,d,r)}},e[65]||(e[65]=[s("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,$a)],512),[[mt,ss(o,a,d,r,b)]])]),C(s("select",{"onUpdate:modelValue":g=>p.fieldtype=g,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:g=>ll(o,a,d,r,b)},[e[66]||(e[66]=s("option",{value:""},"Select Type",-1)),(u(),c(E,null,L($s,g=>s("option",{key:g,value:g.type},h(g.label),9,Va)),64))],40,Aa),[[Fe,p.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(p.fieldtype)?(u(),c("div",qa,[e[67]||(e[67]=s("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),C(s("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":g=>p.options=g,class:"form-control shadow-none mb-1 font-12"},null,8,Ea),[[O,p.options]]),!p.options||p.options.trim()===""?(u(),c("small",La," Options are required for this field type. ")):_("",!0)])):_("",!0),p.fieldtype==="Link"?(u(),c("div",Ta,[s("label",{class:"font-11 fw-light",for:"link-search-"+ue(o,a,d,r,b)}," Search Doctype: ",8,Ua),C(s("input",{id:"link-search-"+ue(o,a,d,r,b),type:"text","onUpdate:modelValue":g=>S(v)[o].sections[a].rows[d].columns[r].fields[b].options=g,onInput:g=>Xt(S(v)[o].sections[a].rows[d].columns[r].fields[b].options,o,a,d,r,b),onFocus:g=>Qt(ue(o,a,d,r,b)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,Oa),[[O,S(v)[o].sections[a].rows[d].columns[r].fields[b].options]]),(A=Ve[ue(o,a,d,r,b)])!=null&&A.length&&ot[ue(o,a,d,r,b)]?(u(),c("ul",Ma,[(u(!0),c(E,null,L(Ve[ue(o,a,d,r,b)],(g,w)=>(u(),c("li",{key:w,onClick:D=>xt(o,a,d,r,b,g.name),class:"list-group-item list-group-item-action"},h(g.name),9,Ra))),128))])):_("",!0)])):_("",!0),s("div",Ba,[s("div",za,[s("div",Na,[C(s("input",{class:"font-12","onUpdate:modelValue":g=>p.reqd=g,"true-value":1,id:"mandatory-"+o+"-"+a+"-"+d+"-"+r+"-"+b,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,Ha),[[Se,p.reqd]])]),s("div",null,[s("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+a+"-"+d+"-"+r+"-"+b},"Mandatory",8,Pa)])]),s("div",null,[s("button",{class:"btn btn-sm font-12",onClick:g=>p.showDescription=!p.showDescription},h(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,ja)])]),p.showDescription?C((u(),c("textarea",{key:2,"onUpdate:modelValue":g=>p.description=g,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,Ja)),[[O,p.description]]):_("",!0),p.error?(u(),c("small",Za,h(p.error),1)):_("",!0)],40,ya)):_("",!0),s("div",{class:"drop-zone",onDragover:e[23]||(e[23]=ae(()=>{},["prevent"])),onDrop:g=>de(g,o,a,d,r,b)},null,40,Ya),s("div",Ga,[s("div",null,[s("div",null,[s("div",Wa,[p.fieldtype==="Table"?(u(),c("div",Ka,[(u(!0),c(E,null,L(K.value,(g,w)=>(u(),c("div",{key:w,class:"childTable"},[w===p.fieldname||w===p.options?(u(),c("h5",Qa,h(w.replace(/_/g," ")),1)):_("",!0),B[w]&&w===Ct.value?(u(),c("div",Xa,[s("div",xa,[p.showDescription?C((u(),c("input",{key:0,"onUpdate:modelValue":D=>p.description=D,class:"form-control font-12",placeholder:"Enter field description"},null,8,Ia)),[[O,p.description]]):_("",!0),s("button",{class:"btn btn-sm text-nowrap font-12",onClick:D=>p.showDescription=!p.showDescription},h(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,en)])])):_("",!0),w===p.options||w===p.fieldname?(u(),c("table",tn,[e[71]||(e[71]=s("thead",null,[s("tr",null,[s("th",null,"#"),s("th",null,"Label"),s("th",null,"Field Type")])],-1)),s("tbody",{onDragover:ae(rs,["prevent"]),onDrop:D=>us(D,g)},[(u(!0),c(E,null,L(g,(D,Z)=>{var Le,Te,Ue,Oe,Me,Re,Y;return u(),c("tr",{key:Z,draggable:B[w],onDragstart:z=>ns(Z),onDragend:is,class:j({dragging:fe.value===Z})},[s("td",null,h(Z+1),1),B[w]?(u(),c("td",on,[C(s("input",{"onUpdate:modelValue":z=>D.label=z,onInput:z=>Qe(D,w,Z),placeholder:"Field Label",class:j(["form-control",{"border-1 border-danger":(Te=(Le=$[w])==null?void 0:Le[Z])==null?void 0:Te.length}])},null,42,an),[[O,D.label]]),(Oe=(Ue=$[w])==null?void 0:Ue[Z])!=null&&Oe.length?(u(),c("div",nn,[(u(!0),c(E,null,L($[w][Z],(z,dl)=>(u(),c("div",{key:dl},h(z),1))),128))])):_("",!0)])):(u(),c("td",rn,h(D.label),1)),B[w]?(u(),c("td",un,[s("div",cn,[C(s("select",{"onUpdate:modelValue":z=>D.fieldtype=z,onChange:z=>Qe(D,w,Z),class:j(["form-select form-select-sm",{"border-1 border-danger":(Re=(Me=$[w])==null?void 0:Me[Z])==null?void 0:Re.length}])},[e[68]||(e[68]=s("option",{value:""},"Select Type",-1)),(u(),c(E,null,L(nt,z=>s("option",{key:z.type,value:z.type},h(z.label),9,pn)),64))],42,dn),[[Fe,D.fieldtype]]),s("div",mn,[s("div",fn,[s("div",vn,[C(s("input",{class:"font-12 form-control-sm","onUpdate:modelValue":z=>D.description=z,placeholder:"description",type:"text"},null,8,_n),[[O,D.description]])])]),s("button",{class:"btn btn-light btn-sm",onClick:z=>Ds(w,Z)},e[69]||(e[69]=[s("i",{class:"bi bi-x-lg"},null,-1)]),8,hn)])]),["Select"].includes(D.fieldtype)?(u(),c("div",gn,[e[70]||(e[70]=s("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),C(s("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":z=>D.options=z,onInput:z=>Qe(D,w,Z),class:"form-control shadow-none mb-1 font-12"},null,40,bn),[[O,D.options]]),!D.options||D.options.trim()===""?(u(),c("small",yn," Options are required for this field type. ")):_("",!0)])):_("",!0),(Y=N[w])!=null&&Y.includes(Z)?(u(),c("span",wn,"Type required**")):_("",!0)])):(u(),c("td",kn,h(D.fieldtype),1))],42,ln)}),128))],40,sn)])):_("",!0),p.fieldtype==="Table"&&(p.label===w||p.fieldname===w)?(u(),c("div",Cn,[s("button",{class:"btn btn-light btn-sm mx-2",onClick:D=>Ss(w,p.description)},h(B[w]?"Save":"Edit"),9,Dn),B[w]?(u(),c("button",{key:0,class:"btn btn-light btn-sm",onClick:D=>Cs(w)}," Add More Field ",8,Sn)):_("",!0)])):_("",!0)]))),128))])):_("",!0)])])])])],40,ga)}),128)),s("div",{class:"drop-zone-bottom",onDragover:e[25]||(e[25]=ae(()=>{},["prevent"])),onDrop:p=>de(p,o,a,d,r,m.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,Fn),s("div",{class:"drop-zone",onDragover:e[26]||(e[26]=ae(()=>{},["prevent"])),onDrop:p=>de(p,o,a,d,r,t.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,$n),s("div",An,[s("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:p=>el(o,a,d,r)},e[72]||(e[72]=[s("i",{class:"bi bi-plus fs-5"},null,-1),s("span",null,"Add Field",-1)]),8,Vn)])],40,ca))),128))])])]))),128)),s("div",null,[(u(!0),c(E,null,L(n.afterCreated,(i,d)=>(u(),c("div",{key:d,class:"childTable dynamicColumn m-0 p-2"},[s("h5",qn,h(i.tableName),1),B[i.tableName]?(u(),c("div",En,[s("div",Ln,[i.showDescription?C((u(),c("input",{key:0,"onUpdate:modelValue":m=>i.description=m,class:"form-control font-12",placeholder:"Enter field description"},null,8,Tn)),[[O,i.description]]):_("",!0),s("button",{class:"btn btn-sm text-nowrap font-12",onClick:m=>i.showDescription=!i.showDescription},h(i.showDescription?"Hide Description":i.description?"Edit Description":"Add Description"),9,Un)])])):_("",!0),s("table",On,[e[78]||(e[78]=s("thead",null,[s("tr",null,[s("th",null,"#"),s("th",null,"Label"),s("th",null,"Field Type")])],-1)),s("tbody",null,[(u(!0),c(E,null,L(i.columns,(m,r)=>{var p,b,A,g;return u(),c("tr",{key:r},[s("td",null,h(r+1),1),B[i.tableName]?(u(),c("td",Mn,[C(s("input",{"onUpdate:modelValue":w=>m.label=w,placeholder:"Field Label",class:j(["form-control",{"border-1 border-danger":(p=N[i.tableName])==null?void 0:p.includes(r)}]),onBlur:w=>{var D;m.label=(D=m.label)==null?void 0:D.trim(),qe(m,i.tableName,r,i.columns)}},null,42,Rn),[[O,m.label]]),(b=$[i.tableName])!=null&&b[r]?(u(),c("div",Bn,[(u(!0),c(E,null,L($[i.tableName][r],(w,D)=>(u(),c("span",{key:D},[U(h(w)+" ",1),e[73]||(e[73]=s("br",null,null,-1))]))),128))])):_("",!0)])):(u(),c("td",zn,h(m.label),1)),B[i.tableName]?(u(),c("td",Nn,[s("div",Hn,[C(s("select",{"onUpdate:modelValue":w=>m.fieldtype=w,class:j(["form-select form-select-sm",{"border-1 border-danger":(A=N[i.tableName])==null?void 0:A.includes(r)}]),onChange:w=>qe(m,i.tableName,r,i.columns)},[e[74]||(e[74]=s("option",{value:""},"Select Type",-1)),(u(),c(E,null,L(nt,w=>s("option",{key:w.type,value:w.type},h(w.label),9,jn)),64))],42,Pn),[[Fe,m.fieldtype]]),s("button",{class:"btn btn-light btn-sm",onClick:w=>ws(o,a,i.tableName,r)},e[75]||(e[75]=[s("i",{class:"bi bi-x-lg"},null,-1)]),8,Jn)]),m.fieldtype==="Select"?(u(),c("div",Zn,[e[76]||(e[76]=s("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),C(s("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":w=>m.options=w,class:"form-control shadow-none mb-1 font-12",onInput:w=>qe(m,i.tableName,r,i.columns)},null,40,Yn),[[O,m.options]])])):_("",!0),(g=$[i.tableName])!=null&&g[r]?(u(),c("div",Gn,[(u(!0),c(E,null,L($[i.tableName][r],(w,D)=>(u(),c("span",{key:D},[U(h(w),1),e[77]||(e[77]=s("br",null,null,-1))]))),128))])):_("",!0)])):(u(),c("td",Wn,h(m.fieldtype),1))])}),128))])]),s("div",Kn,[s("button",{class:"btn btn-light btn-sm mx-2",onClick:m=>ks(o,a,i.tableName)},h(B[i.tableName]?"Save":"Edit"),9,Qn),B[i.tableName]?(u(),c("button",{key:0,class:"btn btn-light btn-sm",onClick:m=>ys(o,a,i.tableName)}," Add More Field ",8,Xn)):_("",!0)])]))),128))])]),s("div",null,[s("div",null,[o==0?(u(),c("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:i=>ds(o,a)}," Add New Table ",8,xn)):_("",!0),(u(!0),c(E,null,L(n.childTables,(i,d)=>{var m;return u(),c("div",{key:`table-${o}-${a}-${d}`,class:"child-table"},[i.newTable?(u(),c("div",In,[s("div",ei,[s("div",null,[s("span",{class:j(i.tableName?"d-none":"text-danger")},"*",2),C(s("input",{"onUpdate:modelValue":r=>i.tableName=r,placeholder:"Table Name",onBlur:r=>wt(i),class:j(["border-less-input font-14 p-0 inputHeight",{"italic-style":!i.tableName,"fw-medium":i.tableName}])},null,42,ti),[[O,i.tableName]]),(m=$[`${o}-${a}-${d}`])!=null&&m.tableName?(u(),c("div",si,h($[`${o}-${a}-${d}`].tableName),1)):_("",!0),De.value?(u(),c("div",li,h(De.value),1)):_("",!0),s("div",oi,[s("div",ai,[i.showDescription?C((u(),c("input",{key:0,"onUpdate:modelValue":r=>i.as_a_block=r,class:"form-control font-12",placeholder:"Enter field description"},null,8,ni)),[[O,i.as_a_block]]):_("",!0),s("button",{class:"btn btn-sm text-nowrap font-12",onClick:r=>i.showDescription=!i.showDescription},h(i.showDescription?"Hide Description":i.description?"Edit Description":"Add Description"),9,ii)])])]),s("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:r=>ms(o,a,d)},e[79]||(e[79]=[s("i",{class:"bi bi-trash"},null,-1),U(" Remove Table ")]),8,ri)]),(u(!0),c(E,null,L(i.columns,(r,p)=>{var b,A,g,w,D,Z,Le,Te,Ue,Oe,Me,Re;return u(),c("div",{key:p,class:"dynamicField"},[s("div",ui,[s("div",ci,[s("div",null,[s("span",{class:j(r.label?"d-none":"text-danger")},"*",2),C(s("input",{"onUpdate:modelValue":Y=>r.label=Y,placeholder:"Name the field",onBlur:()=>{wt(r),vs(r,o,a,d,p,i.columns)},class:j(["border-less-input font-14 p-0 inputHeight",{"italic-style":!r.label,"fw-medium":r.label,"is-invalid":(g=(A=(b=$[`${o}-${a}-${d}`])==null?void 0:b.columns)==null?void 0:A[p])==null?void 0:g.label}])},null,42,di),[[O,r.label]]),(Z=(D=(w=$[`${o}-${a}-${d}`])==null?void 0:w.columns)==null?void 0:D[p])!=null&&Z.label?(u(),c("div",pi,h($[`${o}-${a}-${d}`].columns[p].label),1)):_("",!0)]),s("div",mi,[s("div",fi,[r.showDescription?C((u(),c("input",{key:0,"onUpdate:modelValue":Y=>r.description=Y,class:"form-control font-12",placeholder:"Enter field description"},null,8,vi)),[[O,r.description]]):_("",!0),s("button",{class:"btn btn-sm text-nowrap font-12",onClick:Y=>r.showDescription=!r.showDescription},h(r.showDescription?"Hide Description":r.description?"Edit Description":"Add Description"),9,_i)]),s("button",{class:"btn btn-sm trash-btn py-0",onClick:Y=>fs(o,a,d,p)},e[80]||(e[80]=[s("i",{class:"bi bi-x-lg"},null,-1)]),8,hi)])]),C(s("select",{"onUpdate:modelValue":Y=>r.fieldtype=Y,class:j(["form-select font-13 mb-1",{"is-invalid":(Ue=(Te=(Le=$[`${o}-${a}-${d}`])==null?void 0:Le.columns)==null?void 0:Te[p])==null?void 0:Ue.fieldtype}])},[e[81]||(e[81]=s("option",{value:""},"Select Type",-1)),(u(),c(E,null,L(nt,Y=>s("option",{key:Y.type,value:Y.type},h(Y.label),9,bi)),64))],10,gi),[[Fe,r.fieldtype]]),["Select"].includes(r.fieldtype)?(u(),c("div",yi,[e[82]||(e[82]=s("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),C(s("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":Y=>r.options=Y,class:"form-control shadow-none mb-1 font-12"},null,8,wi),[[O,r.options]]),!r.options||r.options.trim()===""?(u(),c("small",ki," Options are required for this field type. ")):_("",!0)])):_("",!0),(Re=(Me=(Oe=$[`${o}-${a}-${d}`])==null?void 0:Oe.columns)==null?void 0:Me[p])!=null&&Re.fieldtype?(u(),c("div",Ci,h($[`${o}-${a}-${d}`].columns[p].fieldtype),1)):_("",!0)])])}),128)),s("button",{class:"btn btn-light btn-sm addField mx-1",onClick:r=>ps(o,a,d)},e[83]||(e[83]=[s("i",{class:"bi bi-plus"},null,-1),U(" Add Field ")]),8,Di),s("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:r=>bs(o,a,d)}," Create Table ",8,Si),e[84]||(e[84]=s("hr",null,null,-1))])):_("",!0)])}),128))])]),s("div",Fi,[s("button",{class:"btn btn-light border font-12",onClick:i=>Qs(o,a)},e[85]||(e[85]=[s("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),U(" Add Section ")]),8,$i)])]))),128)),o===0?(u(),c("div",Ai)):_("",!0)])]))),128)),s("div",{class:j(["d-flex justify-content-center align-items-center add-block-btn-div py-4  ",{"background-color-white":S(v).length}])},[s("button",{class:"btn btn-light border d-flex align-items-center font-12",onClick:Gs},[e[86]||(e[86]=s("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1)),U(" "+h(S(v).length===0?"Add Requestor Block":"Add Approval Block"),1)])],2)],512)])])):_("",!0),F.value===3?(u(),c("div",Vi,[e[87]||(e[87]=s("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[s("div",null,[s("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),s("div")],-1)),I(Cl,{blockArr:Ie.value},null,8,["blockArr"])])):_("",!0)])])])])])])]),s("div",qi,[s("div",Ei,[s("div",Li,[e[91]||(e[91]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Ti,[e[89]||(e[89]=s("label",{for:""},"Form Name",-1)),C(s("input",{"onUpdate:modelValue":e[27]||(e[27]=l=>Ye.value=l),multiple:!1,placeholder:S(k).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,Ui),[[O,Ye.value]]),s("div",Oi,[s("div",Mi,[C(s("input",{class:"font-12","onUpdate:modelValue":e[28]||(e[28]=l=>ke.value=l),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[Se,ke.value]])]),e[88]||(e[88]=s("div",null,[s("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),s("div",{class:"modal-footer"},[e[90]||(e[90]=s("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),s("button",{type:"button",class:"btn btn-dark",onClick:Zs},"Add Print Format")])])])]),s("div",Ri,[s("div",Bi,[s("span",zi,h(M.value==0?"Add designation for Requestors":`Approval Settings For
          Level-${M.value}`),1),e[92]||(e[92]=s("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),s("div",Ni,[s("div",Hi,[s("div",Pi,[M.value!==0?(u(),c("div",ji,[M.value!==0?(u(),c("div",Ji,[e[94]||(e[94]=s("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),C(s("select",{"onUpdate:modelValue":e[29]||(e[29]=l=>se.value=l),class:"form-select shadow-none font-12"},e[93]||(e[93]=[s("option",{value:""},"Any one of the selected approvers",-1),s("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),s("option",{value:"all_approvals_required"},"All of the selected approvers",-1),s("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[Fe,se.value]])])):_("",!0)])):_("",!0)])]),s("div",Zi,[s("div",Yi,[s("span",Gi," Select "+h(M.value===0?"Requestors":"Approvers"),1),s("span",Wi,h(J.value.length)+" Selected ",1)]),ie.value.length?(u(),c("div",Ki,[s("div",Qi,[s("div",Xi,[s("input",{type:"checkbox",id:"selectAll",checked:Us.value,onChange:Os,class:"form-check-input me-2 designationCheckBox"},null,40,xi),s("label",Ii," Select all designation ("+h(Ee.value.length)+") ",1)]),M.value!==0?(u(),c("div",er,[C(s("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":e[30]||(e[30]=l=>Ce.value=l),class:"form-check-input me-2 designationCheckBox"},null,512),[[Se,Ce.value]]),e[95]||(e[95]=s("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):_("",!0),s("div",null,[J.value.length?(u(),c("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:Ms},e[96]||(e[96]=[s("i",{class:"bi bi-x"},null,-1),U(" Clear all ")]))):_("",!0)])]),ie.value.length?(u(),Mt(S(Dl),{key:0,multiple:!0,modelValue:J.value,"onUpdate:modelValue":e[31]||(e[31]=l=>J.value=l),options:Ee.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):_("",!0)],512)):(u(),c("div",tr,e[97]||(e[97]=[s("div",{class:"d-flex justify-content-center"},[s("span",null,"No Designations Found")],-1)])))]),M.value!==0?(u(),c("div",sr,[e[98]||(e[98]=s("div",null,[s("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),C(s("select",{"onUpdate:modelValue":e[32]||(e[32]=l=>ye.value=l),class:"form-select shadow-none font-12 mt-1 me-2"},[(u(!0),c(E,null,L(It.value,l=>(u(),c("option",{key:l,value:l},h(l===0?"Requestor":"Approver Level "+l),9,lr))),128))],512),[[Fe,ye.value,void 0,{number:!0}]])])):_("",!0),M.value!==0?(u(),c("div",or,[s("div",ar,[s("div",nr,[C(s("input",{"onUpdate:modelValue":e[33]||(e[33]=l=>He.value=l),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Se,He.value]]),e[99]||(e[99]=s("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),lt.value===!0?(u(),c("div",ir,[C(s("input",{"onUpdate:modelValue":e[34]||(e[34]=l=>Pe.value=l),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Se,Pe.value]]),e[100]||(e[100]=s("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):_("",!0)])])):_("",!0)]),s("div",rr,[s("div",ur,[s("div",null,[I(Rt,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:Rs,name:M.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},mr=vl(cr,[["__scopeId","data-v-c6823106"]]);export{mr as default};
