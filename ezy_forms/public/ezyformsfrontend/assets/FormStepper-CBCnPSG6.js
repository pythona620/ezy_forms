var ks=Object.defineProperty,Cs=Object.defineProperties;var Ds=Object.getOwnPropertyDescriptors;var at=Object.getOwnPropertySymbols;var Ht=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable;var Nt=(f,F,y)=>F in f?ks(f,F,{enumerable:!0,configurable:!0,writable:!0,value:y}):f[F]=y,ne=(f,F)=>{for(var y in F||(F={}))Ht.call(F,y)&&Nt(f,y,F[y]);if(at)for(var y of at(F))jt.call(F,y)&&Nt(f,y,F[y]);return f},ye=(f,F)=>Cs(f,Ds(F));var bt=(f,F)=>{var y={};for(var C in f)Ht.call(f,C)&&F.indexOf(C)<0&&(y[C]=f[C]);if(f!=null&&at)for(var C of at(f))F.indexOf(C)<0&&jt.call(f,C)&&(y[C]=f[C]);return y};var it=(f,F,y)=>new Promise((C,q)=>{var A=V=>{try{h(y.next(V))}catch(Z){q(Z)}},G=V=>{try{h(y.throw(V))}catch(Z){q(Z)}},h=V=>V.done?C(V.value):Promise.resolve(V.value).then(A,G);h((y=y.apply(f,F)).next())});import{_ as Ue,r as _,x as Y,o as a,c as i,d as t,n as L,t as b,l as m,W as nt,X as de,b as ae,Q as _t,i as S,F as O,h as B,Z as Re,v as Ve,T as Fs,m as z,g as Ss,f as Zt,a6 as $s,u as qs,M as Ts,e as ue,E as Ls,w as Se,a7 as Jt,K as me,y as te,z as le,L as E,a8 as As,S as Yt,O as Ye,B as Es,R as Ge,N as Ae,j as J,k as Ee,a9 as Vs,aa as Rs,U as he,H as _e,ab as yt,ac as Gt,ad as Us,D as Ms}from"./index-DlVunteb.js";const Os="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",Bs=["draggable","aria-label","onKeydown"],Ps={class:"field-card-icon"},zs={class:"field-card-content"},Ns={class:"field-card-title"},Hs={class:"field-card-description"},js={key:0,class:"field-card-drag-preview"},Js={__name:"FieldCard",props:{field:{type:Object,required:!0},disabled:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["dragstart","dragend","click","add"],setup(f,{emit:F}){const y=f,C=F,q=_(!1),A=_(!1),G=Y(()=>({"field-card--dragging":q.value,"field-card--disabled":y.disabled,"field-card--compact":y.compact,"field-card--hovered":A.value})),h=$=>{if(y.disabled)return;q.value=!0,$.dataTransfer.effectAllowed="copy",$.dataTransfer.setData("application/json",JSON.stringify({fieldType:y.field.id,fieldData:y.field}));const K=$.currentTarget.cloneNode(!0);K.style.opacity="0.8",K.style.transform="rotate(-2deg)",document.body.appendChild(K),$.dataTransfer.setDragImage(K,75,20),setTimeout(()=>{document.body.removeChild(K)},0),C("dragstart",{fieldType:y.field.id,fieldData:y.field,event:$})},V=$=>{q.value=!1,C("dragend",$)},Z=()=>{y.disabled||(C("click",y.field),C("add",y.field))};return($,K)=>(a(),i("div",{class:L(["field-card",G.value]),draggable:!f.disabled,onDragstart:h,onDragend:V,onClick:Z,role:"button",tabindex:"0","aria-label":`Add ${f.field.name} field`,onKeydown:[nt(Z,["enter"]),nt(de(Z,["prevent"]),["space"])]},[t("div",Ps,[t("i",{class:L(f.field.icon)},null,2)]),t("div",zs,[t("h4",Ns,b(f.field.name),1),t("p",Hs,b(f.field.description),1)]),K[0]||(K[0]=t("div",{class:"field-card-actions"},[t("i",{class:"bi bi-plus-circle"})],-1)),q.value?(a(),i("div",js,[t("i",{class:L(f.field.icon)},null,2),t("span",null,b(f.field.name),1)])):m("",!0)],42,Bs))}},Kt=Ue(Js,[["__scopeId","data-v-871ee6f1"]]),Ys=["aria-expanded","aria-controls","onKeydown"],Gs={class:"field-category-title"},Zs={class:"field-category-name"},Ks={class:"field-category-count"},Ws=["id"],Qs={key:0,class:"field-category-description"},Xs={class:"field-category-fields"},xs={key:1,class:"field-category-empty"},Is={__name:"FieldCategory",props:{category:{type:Object,required:!0},fields:{type:Array,default:()=>[]},initiallyCollapsed:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["field-dragstart","field-dragend","field-click","field-add","toggle"],setup(f,{emit:F}){const y=f,C=F,q=_(y.initiallyCollapsed||y.category.collapsed||!1),A=()=>{q.value=!q.value,C("toggle",{categoryId:y.category.id,isCollapsed:q.value})},G=$=>{C("field-dragstart",ye(ne({},$),{categoryId:y.category.id}))},h=$=>{C("field-dragend",$)},V=$=>{C("field-click",{field:$,categoryId:y.category.id})},Z=$=>{C("field-add",{field:$,categoryId:y.category.id})};return($,K)=>(a(),i("div",{class:L(["field-category",{"field-category--collapsed":q.value}])},[t("div",{class:"field-category-header",onClick:A,role:"button",tabindex:"0","aria-expanded":!q.value,"aria-controls":`category-${f.category.id}`,onKeydown:[nt(A,["enter"]),nt(de(A,["prevent"]),["space"])]},[t("div",Gs,[t("i",{class:L([f.category.icon,"field-category-icon"])},null,2),t("h3",Zs,b(f.category.name),1),t("span",Ks,"("+b(f.fields.length)+")",1)]),t("i",{class:L(["bi bi-chevron-down field-category-chevron",{"field-category-chevron--collapsed":q.value}])},null,2)],40,Ys),ae(Fs,{name:"category-expand"},{default:_t(()=>[S(t("div",{id:`category-${f.category.id}`,class:"field-category-content"},[f.category.description?(a(),i("p",Qs,b(f.category.description),1)):m("",!0),t("div",Xs,[(a(!0),i(O,null,B(f.fields,x=>(a(),Re(Kt,{key:x.id,field:x,compact:f.compact,onDragstart:G,onDragend:h,onClick:V,onAdd:Z},null,8,["field","compact"]))),128))]),f.fields.length===0?(a(),i("div",xs,K[0]||(K[0]=[t("i",{class:"bi bi-inbox"},null,-1),t("p",null,"No fields in this category",-1)]))):m("",!0)],8,Ws),[[Ve,!q.value]])]),_:1})],2))}},eo=Ue(Is,[["__scopeId","data-v-8c30728f"]]),to=["for"],lo={key:0,class:"text-input-required"},so={class:"text-input-container"},oo={key:0,class:"text-input-icon text-input-icon--left"},ao=["id","type","value","placeholder","disabled","readonly","required","maxlength","minlength","aria-describedby","aria-invalid"],io={key:1,class:"text-input-icon text-input-icon--right"},no=["aria-label"],ro={key:1,class:"text-input-hint"},co=["id"],uo=["id"],po={__name:"TextInput",props:{modelValue:{type:[String,Number],default:""},label:{type:String,default:""},type:{type:String,default:"text",validator:f=>["text","email","password","url","tel","number","search"].includes(f)},placeholder:{type:String,default:""},helpText:{type:String,default:""},errorMessage:{type:String,default:""},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},iconLeft:{type:String,default:""},iconRight:{type:String,default:""},size:{type:String,default:"md",validator:f=>["sm","md","lg"].includes(f)},maxLength:{type:Number,default:null},minLength:{type:Number,default:null}},emits:["update:modelValue","blur","focus","clear"],setup(f,{emit:F}){const y=f,C=F,q=Y(()=>`text-input-${Math.random().toString(36).substr(2,9)}`),A=_(!1),G=Y(()=>!!y.errorMessage),h=Y(()=>[`text-input-wrapper--${y.size}`,{"text-input-wrapper--disabled":y.disabled,"text-input-wrapper--readonly":y.readonly,"text-input-wrapper--error":G.value,"text-input-wrapper--focused":A.value}]),V=Y(()=>[`text-input--${y.size}`,{"text-input--with-icon-left":y.iconLeft,"text-input--with-icon-right":y.iconRight||y.clearable,"text-input--error":G.value}]),Z=N=>{C("update:modelValue",N.target.value)},$=N=>{A.value=!1,C("blur",N)},K=N=>{A.value=!0,C("focus",N)},x=()=>{C("update:modelValue",""),C("clear")};return(N,P)=>(a(),i("div",{class:L(["text-input-wrapper",h.value])},[f.label?(a(),i("label",{key:0,for:q.value,class:"text-input-label"},[z(b(f.label)+" ",1),f.required?(a(),i("span",lo,"*")):m("",!0)],8,to)):m("",!0),t("div",so,[f.iconLeft?(a(),i("span",oo,[t("i",{class:L(f.iconLeft)},null,2)])):m("",!0),t("input",{id:q.value,type:f.type,value:f.modelValue,placeholder:f.placeholder,disabled:f.disabled,readonly:f.readonly,required:f.required,maxlength:f.maxLength,minlength:f.minLength,class:L([V.value,"text-input"]),onInput:Z,onBlur:$,onFocus:K,"aria-describedby":f.helpText?`${q.value}-help`:void 0,"aria-invalid":G.value},null,42,ao),f.iconRight||f.clearable?(a(),i("span",io,[f.clearable&&f.modelValue&&!f.disabled?(a(),i("i",{key:0,class:"bi bi-x-circle text-input-clear",onClick:x,role:"button",tabindex:"0","aria-label":`Clear ${f.label||"input"}`},null,8,no)):f.iconRight?(a(),i("i",{key:1,class:L(f.iconRight)},null,2)):m("",!0)])):m("",!0)]),f.helpText||f.errorMessage?(a(),i("div",ro,[!G.value&&f.helpText?(a(),i("p",{key:0,id:`${q.value}-help`,class:"text-input-help"},b(f.helpText),9,co)):m("",!0),G.value&&f.errorMessage?(a(),i("p",{key:1,id:`${q.value}-error`,class:"text-input-error"},[P[0]||(P[0]=t("i",{class:"bi bi-exclamation-circle"},null,-1)),z(" "+b(f.errorMessage),1)],8,uo)):m("",!0)])):m("",!0)],2))}},fo=Ue(po,[["__scopeId","data-v-5d216934"]]),mo=["type","disabled","aria-label"],vo={__name:"IconButton",props:{type:{type:String,default:"button"},icon:{type:String,required:!0},variant:{type:String,default:"ghost",validator:f=>["solid","outline","ghost"].includes(f)},size:{type:String,default:"md",validator:f=>["sm","md","lg"].includes(f)},color:{type:String,default:"default",validator:f=>["default","primary","success","warning","error"].includes(f)},disabled:{type:Boolean,default:!1},ariaLabel:{type:String,required:!0},tooltip:{type:String,default:""}},emits:["click"],setup(f,{emit:F}){const y=f,C=F,q=Y(()=>[`icon-button--${y.variant}`,`icon-button--${y.size}`,`icon-button--${y.color}`,{"icon-button--disabled":y.disabled}]),A=G=>{y.disabled||C("click",G)};return(G,h)=>{const V=Ss("tooltip");return S((a(),i("button",{type:f.type,disabled:f.disabled,class:L([q.value,"icon-button"]),"aria-label":f.ariaLabel,onClick:A},[t("i",{class:L(f.icon)},null,2)],10,mo)),[[V,f.tooltip]])}}},ho=Ue(vo,[["__scopeId","data-v-b3b47a56"]]),go=[{id:"basic",name:"Basic Fields",icon:"bi bi-input-cursor-text",collapsed:!1,description:"Essential form fields for text and numbers"},{id:"choice",name:"Choice Fields",icon:"bi bi-ui-checks",collapsed:!1,description:"Fields for selections and options"},{id:"datetime",name:"Date & Time",icon:"bi bi-calendar3",collapsed:!1,description:"Date, time, and datetime pickers"},{id:"file",name:"File & Media",icon:"bi bi-file-earmark-arrow-up",collapsed:!1,description:"Upload files, images, and signatures"},{id:"layout",name:"Layout Elements",icon:"bi bi-layout-text-sidebar",collapsed:!1,description:"Structure and organize your form"},{id:"advanced",name:"Advanced Fields",icon:"bi bi-gear",collapsed:!0,description:"Special purpose and computed fields"}],wt={text:{id:"text",category:"basic",name:"Text Input",icon:"bi bi-input-cursor-text",description:"Single line text input",frappe_fieldtype:"Data",defaultProps:{label:"Text Field",placeholder:"Enter text...",required:!1,maxLength:255,width:"100%"},validation:{supportedRules:["required","minLength","maxLength","pattern"]}},textarea:{id:"textarea",category:"basic",name:"Textarea",icon:"bi bi-textarea-t",description:"Multi-line text input",frappe_fieldtype:"Text",defaultProps:{label:"Text Area",placeholder:"Enter text...",rows:4,required:!1,maxLength:5e3,width:"100%"},validation:{supportedRules:["required","minLength","maxLength"]}},number:{id:"number",category:"basic",name:"Number",icon:"bi bi-hash",description:"Numeric input field",frappe_fieldtype:"Int",defaultProps:{label:"Number Field",placeholder:"0",required:!1,min:null,max:null,step:1,width:"100%"},validation:{supportedRules:["required","min","max"]}},email:{id:"email",category:"basic",name:"Email",icon:"bi bi-envelope",description:"Email address input",frappe_fieldtype:"Data",defaultProps:{label:"Email Address",placeholder:"email@example.com",required:!1,width:"100%"},validation:{supportedRules:["required","email"]}},phone:{id:"phone",category:"basic",name:"Phone",icon:"bi bi-telephone",description:"Phone number input",frappe_fieldtype:"Data",defaultProps:{label:"Phone Number",placeholder:"+1 (555) 000-0000",required:!1,width:"100%"},validation:{supportedRules:["required","phone"]}},url:{id:"url",category:"basic",name:"URL",icon:"bi bi-link-45deg",description:"Website URL input",frappe_fieldtype:"Data",defaultProps:{label:"Website URL",placeholder:"https://example.com",required:!1,width:"100%"},validation:{supportedRules:["required","url"]}},select:{id:"select",category:"choice",name:"Select Dropdown",icon:"bi bi-chevron-down",description:"Single selection dropdown",frappe_fieldtype:"Select",defaultProps:{label:"Select Field",placeholder:"Choose an option...",required:!1,options:["Option 1","Option 2","Option 3"],width:"100%"},validation:{supportedRules:["required"]}},multiselect:{id:"multiselect",category:"choice",name:"Multi Select",icon:"bi bi-ui-checks-grid",description:"Multiple selection dropdown",frappe_fieldtype:"MultiSelect",defaultProps:{label:"Multi Select Field",placeholder:"Choose options...",required:!1,options:["Option 1","Option 2","Option 3"],width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},radio:{id:"radio",category:"choice",name:"Radio Buttons",icon:"bi bi-record-circle",description:"Single choice radio buttons",frappe_fieldtype:"Select",defaultProps:{label:"Radio Field",required:!1,options:["Option 1","Option 2","Option 3"],layout:"vertical",width:"100%"},validation:{supportedRules:["required"]}},checkbox:{id:"checkbox",category:"choice",name:"Checkboxes",icon:"bi bi-check-square",description:"Multiple choice checkboxes",frappe_fieldtype:"MultiSelect",defaultProps:{label:"Checkbox Field",required:!1,options:["Option 1","Option 2","Option 3"],layout:"vertical",width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},toggle:{id:"toggle",category:"choice",name:"Toggle Switch",icon:"bi bi-toggle-on",description:"On/off switch",frappe_fieldtype:"Check",defaultProps:{label:"Toggle Field",required:!1,default:!1,width:"100%"},validation:{supportedRules:["required"]}},date:{id:"date",category:"datetime",name:"Date Picker",icon:"bi bi-calendar-date",description:"Date selection",frappe_fieldtype:"Date",defaultProps:{label:"Date Field",placeholder:"Select date...",required:!1,format:"YYYY-MM-DD",width:"100%"},validation:{supportedRules:["required","minDate","maxDate"]}},time:{id:"time",category:"datetime",name:"Time Picker",icon:"bi bi-clock",description:"Time selection",frappe_fieldtype:"Time",defaultProps:{label:"Time Field",placeholder:"Select time...",required:!1,format:"HH:mm:ss",width:"100%"},validation:{supportedRules:["required"]}},datetime:{id:"datetime",category:"datetime",name:"DateTime Picker",icon:"bi bi-calendar3",description:"Date and time selection",frappe_fieldtype:"Datetime",defaultProps:{label:"DateTime Field",placeholder:"Select date and time...",required:!1,format:"YYYY-MM-DD HH:mm:ss",width:"100%"},validation:{supportedRules:["required","minDate","maxDate"]}},fileupload:{id:"fileupload",category:"file",name:"File Upload",icon:"bi bi-file-earmark-arrow-up",description:"Upload files",frappe_fieldtype:"Attach",defaultProps:{label:"File Upload",required:!1,acceptedTypes:["pdf","doc","docx","xls","xlsx","txt"],maxSize:10485760,multiple:!1,width:"100%"},validation:{supportedRules:["required","fileType","fileSize"]}},imageupload:{id:"imageupload",category:"file",name:"Image Upload",icon:"bi bi-image",description:"Upload images",frappe_fieldtype:"Attach Image",defaultProps:{label:"Image Upload",required:!1,acceptedTypes:["jpg","jpeg","png","gif"],maxSize:5242880,multiple:!1,width:"100%"},validation:{supportedRules:["required","fileType","fileSize","imageDimensions"]}},signature:{id:"signature",category:"file",name:"Signature Pad",icon:"bi bi-pen",description:"Digital signature capture",frappe_fieldtype:"Signature",defaultProps:{label:"Signature",required:!1,width:"100%",height:200},validation:{supportedRules:["required"]}},sectionbreak:{id:"sectionbreak",category:"layout",name:"Section Break",icon:"bi bi-layout-split",description:"Divide form into sections",frappe_fieldtype:"Section Break",defaultProps:{label:"Section Break",collapsible:!1,collapsed:!1,width:"100%"},validation:{supportedRules:[]}},columnbreak:{id:"columnbreak",category:"layout",name:"Column Break",icon:"bi bi-layout-three-columns",description:"Create columns",frappe_fieldtype:"Column Break",defaultProps:{width:"50%"},validation:{supportedRules:[]}},heading:{id:"heading",category:"layout",name:"Heading",icon:"bi bi-type-h1",description:"Add heading text",frappe_fieldtype:"HTML",defaultProps:{label:"Heading Text",level:2,text:"Heading",width:"100%"},validation:{supportedRules:[]}},paragraph:{id:"paragraph",category:"layout",name:"Paragraph",icon:"bi bi-paragraph",description:"Add description text",frappe_fieldtype:"HTML",defaultProps:{label:"Paragraph Text",text:"Your text here...",width:"100%"},validation:{supportedRules:[]}},divider:{id:"divider",category:"layout",name:"Divider",icon:"bi bi-dash-lg",description:"Horizontal divider line",frappe_fieldtype:"HTML",defaultProps:{width:"100%"},validation:{supportedRules:[]}},table:{id:"table",category:"advanced",name:"Table/Grid",icon:"bi bi-table",description:"Child table for multiple rows",frappe_fieldtype:"Table",defaultProps:{label:"Table Field",required:!1,columns:[],width:"100%"},validation:{supportedRules:["required","minRows","maxRows"]}},link:{id:"link",category:"advanced",name:"Link Field",icon:"bi bi-box-arrow-up-right",description:"Link to another DocType",frappe_fieldtype:"Link",defaultProps:{label:"Link Field",placeholder:"Select...",required:!1,doctype:"",width:"100%"},validation:{supportedRules:["required"]}},dynamiclist:{id:"dynamiclist",category:"advanced",name:"Dynamic List",icon:"bi bi-list-ul",description:"Repeatable list of items",frappe_fieldtype:"Dynamic Link",defaultProps:{label:"Dynamic List",required:!1,minItems:1,maxItems:null,width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},formula:{id:"formula",category:"advanced",name:"Formula Field",icon:"bi bi-calculator",description:"Calculated field",frappe_fieldtype:"Data",defaultProps:{label:"Formula Field",formula:"",readonly:!0,width:"100%"},validation:{supportedRules:[]}},qrcode:{id:"qrcode",category:"advanced",name:"QR Code",icon:"bi bi-qr-code",description:"Generate QR code",frappe_fieldtype:"Barcode",defaultProps:{label:"QR Code Field",data:"",size:200,width:"100%"},validation:{supportedRules:[]}}};function bo(f){return Object.values(wt).filter(F=>F.category===f)}function yo(f){const F=f.toLowerCase();return Object.values(wt).filter(y=>y.name.toLowerCase().includes(F)||y.description.toLowerCase().includes(F))}const _o={class:"field-library-header"},wo={class:"field-library-content"},ko={class:"field-library-search"},Co={key:0,class:"field-library-results"},Do={key:0},Fo={key:1,class:"field-library-no-results"},So={key:1,class:"field-library-search-results"},$o={key:2,class:"field-library-categories"},qo={key:0,class:"field-library-collapsed-indicator"},To={__name:"FieldLibraryPanel",props:{collapsible:{type:Boolean,default:!0},initiallyCollapsed:{type:Boolean,default:!1},compactMode:{type:Boolean,default:!1},hiddenCategories:{type:Array,default:()=>[]},hiddenFields:{type:Array,default:()=>[]}},emits:["field-dragstart","field-dragend","field-click","field-add","collapse","expand"],setup(f,{emit:F}){const y=f,C=F,q=_(""),A=_(y.initiallyCollapsed),G=_({}),h=Y(()=>go.filter(U=>!y.hiddenCategories.includes(U.id))),V=Y(()=>q.value?yo(q.value).filter(j=>!y.hiddenFields.includes(j.id)):[]);function Z(U){return bo(U).filter(ce=>!y.hiddenFields.includes(ce.id))}function $(){A.value=!A.value,C(A.value?"collapse":"expand")}function K(U){}function x(U){C("field-dragstart",U)}function N(U){C("field-dragend",U)}function P(U){C("field-click",U)}function I(U){C("field-add",U)}function we(U){G.value[U.categoryId]=U.isCollapsed}function ve(U){if((U.ctrlKey||U.metaKey)&&U.key==="k"){U.preventDefault();const j=document.querySelector(".field-library-search input");j&&j.focus()}}return Zt(()=>{document.addEventListener("keydown",ve)}),$s(()=>{document.removeEventListener("keydown",ve)}),(U,j)=>(a(),i("div",{class:L(["field-library-panel",{"field-library-panel--collapsed":A.value}])},[t("div",_o,[j[1]||(j[1]=t("div",{class:"field-library-title"},[t("i",{class:"bi bi-grid-3x3-gap"}),t("h2",null,"Add Fields")],-1)),f.collapsible?(a(),Re(ho,{key:0,icon:A.value?"bi bi-chevron-right":"bi bi-chevron-left",variant:"ghost",size:"sm","aria-label":"Toggle field library",onClick:$},null,8,["icon"])):m("",!0)]),S(t("div",wo,[t("div",ko,[ae(fo,{modelValue:q.value,"onUpdate:modelValue":[j[0]||(j[0]=ce=>q.value=ce),K],type:"search",placeholder:"Search fields...","icon-left":"bi bi-search",clearable:!0,size:"sm"},null,8,["modelValue"])]),q.value?(a(),i("div",Co,[V.value.length>0?(a(),i("p",Do,b(V.value.length)+" field"+b(V.value.length!==1?"s":"")+" found ",1)):(a(),i("p",Fo,[j[2]||(j[2]=t("i",{class:"bi bi-search"},null,-1)),z(' No fields found matching "'+b(q.value)+'" ',1)]))])):m("",!0),q.value&&V.value.length>0?(a(),i("div",So,[(a(!0),i(O,null,B(V.value,ce=>(a(),Re(Kt,{key:ce.id,field:ce,compact:f.compactMode,onDragstart:x,onDragend:N,onClick:P,onAdd:I},null,8,["field","compact"]))),128))])):(a(),i("div",$o,[(a(!0),i(O,null,B(h.value,ce=>(a(),Re(eo,{key:ce.id,category:ce,fields:Z(ce.id),compact:f.compactMode,onFieldDragstart:x,onFieldDragend:N,onFieldClick:P,onFieldAdd:I,onToggle:we},null,8,["category","fields","compact"]))),128))])),j[3]||(j[3]=t("div",{class:"field-library-help"},[t("i",{class:"bi bi-info-circle"}),t("p",null,"Drag fields to the canvas or click to add")],-1))],512),[[Ve,!A.value]]),A.value?(a(),i("div",qo,j[4]||(j[4]=[t("i",{class:"bi bi-grid-3x3-gap"},null,-1),t("span",null,"Fields",-1)]))):m("",!0)],2))}},Lo=Ue(To,[["__scopeId","data-v-12f238c7"]]),Ao={class:""},Eo={class:""},Vo={class:"d-flex justify-content-between align-items-center CancelNdSave"},Ro={class:"d-flex align-items-center"},Uo={key:0,class:"font-16"},Mo=["disabled"],Oo={class:"form-container p-0 container-fluid mt-1"},Bo={class:"row"},Po={class:"col-lg-2 col-md-2 col-sm-12"},zo={class:"steps-sticky-div"},No={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},Ho=["onClick"],jo={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},Jo={class:"step-text"},Yo={class:"font-11"},Go={class:"font-14"},Zo={class:"col-lg-10 col-md-10 col-sm-12 formbackground-color"},Ko={class:""},Wo={class:"form-content stepsDiv"},Qo={key:0},Xo={class:""},xo={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},Io={class:"container-fluid aboutFields p-0"},ea={class:"row"},ta={class:"col-sm-12 col-md-12 mt-lg-3 p-lg-4"},la={class:"container-fluid"},sa={class:"row g-3"},oa={class:"col-md-6"},aa={class:"position-relative"},ia={key:0,class:"font-12 position-absolute PredefinedLabel"},na={key:1,class:"text-danger ErrorMsg ms-2"},ra={class:"col-md-6"},da={key:0,class:"text-danger ErrorMsg ms-2"},ca={class:"col-md-6"},ua={class:"col-md-6"},pa={key:0,class:"text-danger"},fa={class:"col-md-6"},ma={key:0,class:"text-danger"},va={class:"col-md-6"},ha={key:0,class:"text-danger"},ga={class:"custom-option"},ba=["checked","onChange"],ya={class:"col-md-6"},_a={class:"col-md-6"},wa={key:0,class:"col-md-6"},ka={key:1,class:"col-md-6"},Ca={key:2,class:"col-md-6"},Da={class:"form-check d-flex align-items-center p-0 pe-3"},Fa=["disabled"],Sa={key:3,class:"col-md-6"},$a=["disabled"],qa={key:0,class:"list-group position-absolute w-100 z-3 formslist"},Ta=["onMousedown"],La={key:1,class:"zoho-form-builder"},Aa={class:"zoho-toolbar"},Ea={class:"toolbar-left"},Va={class:"zoho-tabs"},Ra=["onClick"],Ua=["onClick"],Ma={class:"toolbar-right"},Oa={class:"zoho-builder-container"},Ba={class:"zoho-field-library"},Pa={class:"library-header"},za={key:0,class:"library-content"},Na={class:"zoho-form-canvas"},Ha={class:"requestandAppHeader"},ja={class:"d-flex justify-content-between align-items-center"},Ja={class:""},Ya={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},Ga={class:"text-center ms-2 mt-1"},Za={key:0,class:"font-12 d-flex align-items-center"},Ka={class:"font-12 approver_type_div"},Wa={class:"font-12 fw-bold"},Qa={class:"font-12 text-danger ms-1"},Xa={class:"d-flex align-items-center"},xa={key:0,class:"role-container"},Ia={key:0,class:"role-text d-flex align-items-center"},ei={class:"role-label fw-bold"},ti={class:"role-names"},li=["onClick"],si=["onClick"],oi=["onClick"],ai=["onClick"],ii={class:"pt-0 section_block"},ni={class:"d-flex justify-content-between align-items-center"},ri={class:"d-flex flex-column"},di=["onUpdate:modelValue","onChange","onInput"],ci={key:0,class:"text-danger ps-3 font-10"},ui={class:"d-flex align-items-center"},pi=["onClick"],fi={class:"container-fluid"},mi={class:"d-flex justify-content-between align-items-center"},vi={class:"rownames m-0"},hi=["onClick"],gi={class:"col"},bi={class:"row"},yi=["onMouseenter"],_i={class:"column_name d-flex align-items-center justify-content-between"},wi={class:"d-flex flex-column ps-2"},ki=["onUpdate:modelValue","onChange","onInput"],Ci={key:0,class:"text-danger ps-2 font-10"},Di={class:"position-absolute top-0 end-0"},Fi=["onClick"],Si=["onDrop"],$i=["onMouseenter","onDragstart","onDrop"],qi=["onDrop"],Ti=["onDragstart","onDrop"],Li={class:"d-flex justify-content-between"},Ai={class:"flex-column d-flex"},Ei=["onUpdate:modelValue","onChange","onInput"],Vi={key:0,class:"text-danger font-10"},Ri={class:"FieldcopyRemove"},Ui=["onClick"],Mi=["onClick"],Oi=["onUpdate:modelValue","onChange"],Bi=["value"],Pi={key:0},zi=["onUpdate:modelValue"],Ni={key:0,class:"text-danger font-10"},Hi={key:1},ji=["for"],Ji=["id","onUpdate:modelValue","onInput","onFocus"],Yi={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},Gi=["onClick"],Zi={class:"d-flex align-items-center justify-content-between"},Ki={class:"d-flex align-items-center gap-2"},Wi={class:"d-flex align-items-center"},Qi=["onUpdate:modelValue","id"],Xi=["for"],xi=["onClick"],Ii=["onUpdate:modelValue"],en={key:3,class:"text-danger font-10"},tn=["onDrop"],ln={class:"childtableShow"},sn={class:"mt-2"},on={key:0,class:"childTableContainer"},an={key:0,class:"font-13"},nn={key:1,class:"d-flex align-items-center gap-2"},rn={class:"d-flex align-items-center"},dn=["onUpdate:modelValue"],cn=["onClick"],un={key:2,class:"table table-bordered rounded-table"},pn=["onDrop"],fn=["draggable","onDragstart"],mn={key:0},vn=["onUpdate:modelValue","onInput"],hn={key:0,class:"text-danger font-11"},gn={key:1},bn={key:2},yn={class:"d-flex gap-1"},_n=["onUpdate:modelValue","onChange"],wn=["value"],kn={class:"d-flex"},Cn={class:"d-flex align-items-center gap-2"},Dn={class:"d-flex align-items-center"},Fn=["onUpdate:modelValue"],Sn=["onClick"],$n={key:0},qn=["onUpdate:modelValue","onInput"],Tn={key:0,class:"text-danger font-10"},Ln={key:1,class:"font-11 text-danger"},An={key:3},En={key:3,class:"mb-2 mt-3"},Vn=["onClick"],Rn=["onClick"],Un=["onDrop"],Mn=["onDrop"],On={class:"d-flex justify-content-center align-items-center my-2"},Bn=["onClick"],Pn={class:"font-13"},zn={key:0,class:"d-flex align-items-center gap-2"},Nn={class:"d-flex align-items-center"},Hn=["onUpdate:modelValue"],jn=["onClick"],Jn={class:"table table-bordered rounded-table"},Yn={key:0},Gn=["onUpdate:modelValue","onBlur"],Zn={key:0,class:"text-danger font-11 mt-1"},Kn={key:1},Wn={key:2},Qn={class:"d-flex gap-1 align-items-center"},Xn=["onUpdate:modelValue","onChange"],xn=["value"],In=["onClick"],er={key:0,class:"mt-1"},tr=["onUpdate:modelValue","onInput"],lr={key:1,class:"text-danger font-11 mt-1"},sr={key:3},or={class:"mb-2"},ar=["onClick"],ir=["onClick"],nr=["onClick"],rr={key:0},dr={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},cr=["onUpdate:modelValue","onBlur"],ur={key:0,class:"text-danger font-12"},pr={key:1,class:"text-danger font-12"},fr={class:"d-flex align-items-center gap-2"},mr={class:"d-flex align-items-center"},vr=["onUpdate:modelValue"],hr=["onClick"],gr=["onClick"],br={class:"px-1 field-border"},yr={class:"d-flex justify-content-between"},_r=["onUpdate:modelValue","onBlur"],wr={key:0,class:"text-danger font-12"},kr={class:"d-flex align-items-center"},Cr={class:"d-flex my-1"},Dr=["onUpdate:modelValue"],Fr=["onClick"],Sr=["onClick"],$r=["onUpdate:modelValue"],qr=["value"],Tr={key:0},Lr=["onUpdate:modelValue"],Ar={key:0,class:"text-danger font-10"},Er={key:1,class:"text-danger font-12"},Vr=["onClick"],Rr=["onClick"],Ur={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},Mr=["onClick"],Or={key:0,class:"m-2"},Br={key:0,class:"zoho-properties-panel"},Pr={class:"properties-header"},zr={key:2},Nr={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},Hr={class:"modal-dialog modal-dialog-centered"},jr={class:"modal-content"},Jr={class:"modal-body"},Yr=["placeholder"],Gr={class:"d-flex align-items-center gap-2"},Zr={class:"d-flex align-items-center py-2"},Kr={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},Wr={class:"offcanvas-header add_designationHeader"},Qr={id:"offcanvasRightLabel",class:"font-14 fw-bold"},Xr={class:"offcanvas-body add_desig_offCanvas_body p-0"},xr={class:""},Ir={class:""},ed={key:0,class:"p-3 approval-border-bottom"},td={key:0,class:""},ld={class:"px-3 listofdesignations"},sd={class:"my-1 d-flex justify-content-between"},od={class:"font-12 fw-bold"},ad={class:"italic-style text-secondary font-12"},id={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},nd={class:"d-flex align-items-center justify-content-between gap-1"},rd={class:"form-check ps-1 d-flex align-items-center m-0"},dd=["checked"],cd={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},ud={key:0,class:"form-check d-flex align-items-center m-0"},pd={key:1},fd={key:0,class:"p-3"},md=["value"],vd={key:1},hd={class:""},gd={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},bd={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},yd={class:"offcanvas-footer"},_d={class:"text-end p-3"},$e="Select All",wd={__name:"FormStepper",setup(f){const F=qs(),y=Ts(),C=_(1),q=_([]);_([]);const A=_([]),G=_([]);ue([]);let h=ue([]),V=ue([]);const Z=_([]),$=_([]),K=_([]),x=_(""),N=_(""),P=_("");let I=ue([]);const we=_("");_(!1),_(!1),_(!1);const ve=_(""),U=_(""),j=_(""),ce=_([]),Wt=_([]),R=ue({}),re=_([]),rt=_(!1),Ze=_([]),Ke=_(!1);let kt=null;const Qt=_("");let H=_("");const Xt=_(null),Ct=_(null),We=_(!0),Qe=_(0),Xe=Y(()=>Ls);_(!1);const xe=ue([]),ie=_({routepath:F.query.routepath,business_unit:F.query.business_unit,formId:F.query.id}),Ie=_(""),qe=_(!1),Te=_(!1),Dt=[{label:"Public",value:1},{label:"Private",value:0}],Ft=Y({get(){return Dt.find(l=>l.value===g.value.as_web_view)},set(l){g.value.as_web_view=l?l.value:null}}),St=Y({get(){return g.value.form_name||F.query.form_name||""},set(l){g.value.form_name=l}}),g=_({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${Xe.value.value||ie.value.business_unit||F.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:F.query.id?1:0,as_web_view:0,mail_id:""});Se(()=>F.query.form_name,l=>{l&&(g.value.form_name=l,g.value.form_short_name=l)},{immediate:!0});const et=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(l=>l.toLowerCase().trim()),$t=["Approver","Approved on","Approved By"].map(l=>l.toLowerCase().trim());function xt(l){return l.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}Y(()=>g.value),_(""),_(!1),Se(Xe,l=>{l&&l.value&&(g.value.business_unit=l.value)},{immediate:!0});function It(l){if(H==null||H==="new")return!1;const e=W(l).roles;if(l===0)return e.length===0;const s=W(l-1).roles;return s.length>0&&s[0]!==null&&s[0]!==""&&e.length===0}Se(()=>g.value.form_name,l=>{g.value.form_name=l.trim()}),Se(()=>g.value.form_short_name,l=>{g.value.form_short_name=l.trim()}),Se(()=>g.value.series,l=>{g.value.series=l.trim()});const tt=_(null),qt=(l,e,s,o,r,n)=>{tt.value={blockIndex:e,sectionIndex:s,rowIndex:o,columnIndex:r,fieldIndex:n}},ke=(l,e,s,o,r,n)=>{if(!tt.value)return;const{blockIndex:d,sectionIndex:u,rowIndex:v,columnIndex:c,fieldIndex:p}=tt.value,k=h[d].sections[u].rows[v].columns[c].fields,M=h[e].sections[s].rows[o].columns[r].fields;if(d===e&&u===s&&v===o&&c===r&&p===n)return;const w=k.splice(p,1)[0];k===M&&p<n&&n--,M.splice(n,0,w),tt.value=null},Le=_(""),el=l=>it(this,null,function*(){const e=[["module","in",["User Forms"]],["istable","=",1]];l!=null&&l.trim()&&e.push(["name","=",`${l}`]);const s={fields:JSON.stringify(["name"]),filters:JSON.stringify(e),limit_page_length:"None",doctype:me.doctypesList};try{return(yield te.get(le.GetDoctypeData,{params:s})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),lt=_(null),Tt=l=>it(this,null,function*(){if(Le.value="",lt.value=null,l.tableName){let e=l.tableName.trim();if(e.length>64){Le.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(e)){Le.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield el(e);lt.value=o.find(r=>r.name.toLowerCase()===e.toLowerCase()),lt.value&&(Le.value="Table already exists"),l.tableName=e}l.label&&(l.fieldname=xt(l.label))});function tl(){const l=g.value.is_linked_form;if(!l){Ze.value=[];return}clearTimeout(kt),kt=setTimeout(()=>{const e=[["business_unit","=",`${Xe.value.value}`],["name","like",`%${l}%`]],s={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(e),doctype:me.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};te.get(`${le.GetDoctypeData}`,{params:s}).then(o=>{Ze.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function ll(l){g.value.is_linked_form=l,Ke.value=!1}function sl(){setTimeout(()=>{Ke.value=!1},200)}ue({query:"",key:""});function ge(l,e,s,o,r){return`${l}-${e}-${s}-${o}-${r}`}ue({});const Me=ue({}),dt=ue({});function ol(l){dt[l]=!0}function al(l,e,s,o,r,n){const d=ge(e,s,o,r,n),u=[["istable","=",0]];l!=null&&l.trim()&&u.push(["name","like",`%${l}%`]);const v={fields:JSON.stringify(["name"]),filters:JSON.stringify(u),limit_page_length:"none",doctype:me.doctypesList};te.get(le.GetDoctypeData,{params:v}).then(c=>{Me[d]=c.message.data||[]}).catch(c=>{console.error("Error fetching doctype list:",c),Me[d]=[]})}function il(l,e,s,o,r,n){h[l].sections[e].rows[s].columns[o].fields[r].options=n;const d=ge(l,e,s,o,r);Me[d]=[],dt[d]=!1}const nl=Y(()=>h!=null&&h.length?P.value===1?[0]:Array.from({length:P.value},(l,e)=>e).filter(l=>l<P.value):[]),be=_(null),Ce=_(null),rl=(l,e,s,o,r)=>{be.value={blockIndex:l,sectionIndex:e,rowIndex:s,columnIndex:o,fieldIndex:r}},dl=()=>{be.value=null},cl=(l,e,s,o,r)=>be.value&&be.value.blockIndex===l&&be.value.sectionIndex===e&&be.value.rowIndex===s&&be.value.columnIndex===o&&be.value.fieldIndex===r,ul=(l,e,s,o)=>{Ce.value={blockIndex:l,sectionIndex:e,rowIndex:s,columnIndex:o}},pl=()=>{Ce.value=null},fl=(l,e,s,o)=>Ce.value&&Ce.value.blockIndex===l&&Ce.value.sectionIndex===e&&Ce.value.rowIndex===s&&Ce.value.columnIndex===o,Lt=_([{form_json:""}]),De=_("");Zt(()=>{Mt(),De.value=F.query.Clone,H.value=F.query.id||"new",De.value==="1"&&(g.value.series=""),H.value!=null&&H.value!=null&&H.value!="new"&&(Ut(),mt()),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?rt.value=!0:rt.value=!1;let l=localStorage.getItem("Bu");if(g.value.business_unit=l,F.query.preId==="PreDefine"){const e=localStorage.getItem("form_json");if(e){Lt.value[0].form_json=e;const s=Lt.value[0],o=JSON.parse(s.form_json),r=Jt(o.fields);re.value=o.child_table_fields,r.forEach(n=>{h.push(n)})}}});const Fe=_(null),ee=ue({}),At=_(null),ml=l=>{Fe.value=l},vl=()=>{Fe.value=null},hl=l=>{l.preventDefault()},gl=(l,e)=>{const s=l.target.closest("tr");if(!s)return;const o=Array.from(s.parentNode.children).indexOf(s);if(o!==Fe.value){const r=e[Fe.value];e.splice(Fe.value,1),e.splice(o,0,r),Fe.value=o}},bl=_([]),ct=l=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(l.fieldtype)&&l.options){const e=l.options.split(`
`).map(r=>r.trim()).filter(r=>r),s=[],o=new Set;return e.forEach(r=>{const n=r.toLowerCase();o.has(n)||(o.add(n),s.push(r))}),`
`+s.join(`
`)}else if(["Link","Table"].includes(l.fieldtype)&&l.options)return l.options.trim();return l.options},yl=(l,e)=>{const s=h[l].sections[e];s.childTables||(s.childTables=[]);const o=s.childTables.length;s.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[ne({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},xe.fieldtype==="Select"&&xe.options?{options:xe.options?`
${xe.options}`:`
`}:{})],newTable:!0})},_l=(l,e,s)=>{const o=h[l].sections[e].childTables[s];o.columns||(o.columns=[]),o.columns.push(ne({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},wl=(l,e,s)=>{h[l].sections[e].childTables.splice(s,1)},kl=(l,e,s,o)=>{h[l].sections[e].childTables[s].columns.splice(o,1)};function Cl(l,e,s,o,r,n){var c;const d=`${e}-${s}-${o}`;R[d]||(R[d]={columns:[]});const u={},v=((c=l.label)==null?void 0:c.trim())||"";if(!v)u.label="Field Label is required";else{const p=v.toLowerCase();if(et.includes(p)&&!$t.includes(p))u.label=`"${v}" is a restricted field label`;else if(v.length>64)u.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(v))u.label="Field Label can only contain letters, numbers, and single spaces between words";else{const k=n.map((M,w)=>{var D;return{label:(D=M.label)==null?void 0:D.trim().toLowerCase(),index:w}}).filter(M=>M.label===p);if(k.length>1){const M=k[0].index;r!==M&&(u.label=`"${v}" is already used in this table`)}}}R[d].columns[r]=u}function st(l,e,s){var n;R[e]||(R[e]={});const o=[],r=((n=l.label)==null?void 0:n.trim())||"";r||o.push("Label is required"),r.length>64&&o.push("Label cannot exceed 64 characters"),r&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(r)&&o.push("No special characters allowed"),r&&et.includes(r.toLowerCase().trim())&&o.push("This label is restricted"),r&&re.value[e].map(v=>{var c;return(c=v.label)==null?void 0:c.trim().toLowerCase()}).filter(Boolean).filter(v=>v===r.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),l.fieldtype||o.push("Field type is required"),l.fieldtype==="Select"&&(!l.options||l.options.trim()==="")&&o.push("Options are required"),R[e][s]=o}const Dl=(l,e,s)=>{var d;const o=h[l].sections[e].childTables[s],r={tableName:!1,columns:[]};let n=!1;return(d=o.tableName)!=null&&d.trim()||(r.tableName="Table name is required.",n=!0),o.columns.forEach((u,v)=>{var p,k;const c={};(p=u.label)!=null&&p.trim()||(c.label="Field Label is required",n=!0),(k=u.fieldtype)!=null&&k.trim()||(c.fieldtype="Please select field type",n=!0),r.columns[v]=c}),R[`${l}-${e}-${s}`]=r,n},Fl=(l,e,s)=>{var r,n;const o=(n=(r=h[l])==null?void 0:r.sections)==null?void 0:n[e];o&&!Array.isArray(o[s])&&(o[s]=[])},Sl=l=>l?l.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",$l=(l,e,s)=>{if(Dl(l,e,s)){he("Please fix validation errors before creating the table",{transition:"zoom"});return}if(lt.value){he("Table already exists",{transition:"zoom"});return}const r=h[l].sections[e].childTables[s],n=h[l].sections[e];r.columns=r.columns.map((u,v)=>ye(ne({},u),{idx:v,options:ct(u)})),r.newTable=!1;const d={form_short_name:r.tableName,fields:r.columns,idx:r.idx,as_a_block:r.as_a_block?r.as_a_block:"false"};te.post(le.childtable,d).then(u=>{var v,c,p;if(u){Fl(l,e,"afterCreated"),n.afterCreated[s]=ne({},r),_e("Table created successfully!");const k=(p=(c=(v=u.message)==null?void 0:v[0])==null?void 0:c[0])==null?void 0:p.child_doc;k&&(h[l].sections[e].childTables[s]=ye(ne(ne({},h[l].sections[e].childTables[s]),k),{newTable:!1}))}}).catch(u=>{console.error("Error creating table:",u)})},Oe=(l,e,s,o=[])=>{var d;ee[e]||(ee[e]=[]),ee[e]=ee[e].filter(u=>u!==s),R[e]||(R[e]=[]),R[e][s]=[];const r=[],n=((d=l.label)==null?void 0:d.trim())||"";if(n?et.includes(n.toLowerCase())?r.push("This label is restricted"):n.length>64?r.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(n)||r.push("Only letters, numbers, and single spaces allowed"):r.push("Label is required"),o.length){const u=n.toLowerCase(),v=o.map((c,p)=>{var k;return{label:(k=c.label)==null?void 0:k.trim().toLowerCase(),idx:p}}).filter(c=>c.label===u);if(v.length>1){const c=v[0].idx;s!==c?(r.push("Duplicate label not allowed"),l._duplicate=!0):l._duplicate=!1}else l._duplicate=!1}return l.fieldtype||r.push("Field type is required"),l.fieldtype==="Select"&&(!l.options||!l.options.trim())&&r.push("Options are required"),R[e][s]=r,r.length>0&&ee[e].push(s),r.length===0},ql=(l,e,s)=>{const r=h[l].sections[e].afterCreated.find(u=>u.tableName===s);if(!r)return;const n=r.columns.length,d={fieldname:"",fieldtype:"",idx:n+1,label:"",value:"",isNew:!0,description:""};r.columns.push(d),Oe(d,s,n,r.columns)},Et=_([]),Tl=(l,e,s,o)=>{const n=h[l].sections[e].afterCreated.find(u=>u.tableName===s);if(!n)return;n.columns.splice(o,1),n.columns.forEach((u,v)=>{u.idx=v+1});const d=ee.value[s];d&&(ee.value[s]=d.filter(u=>u!==o).map(u=>u>o?u-1:u))},Ll=(l,e,s)=>{const r=h[l].sections[e].afterCreated.find(n=>n.tableName===s);if(r){if(Q[s]){ee[s]=[];let n=!0;if(r.columns.forEach((v,c)=>{Oe(v,s,c,r.columns)||(n=!1)}),!n){he("Please fix the errors in the highlighted fields before saving!");return}const d=r.columns.map((k,p)=>{var M=k,{isNew:v}=M,c=bt(M,["isNew"]);return ye(ne({},c),{idx:p+1,options:ct(c)})}),u={form_short_name:Sl(s),fields:d,as_a_block:r.description};te.post(le.childtable,u).then(v=>{Et.value=v.data,_e("Fields updated successfully!")}).catch(v=>{console.error("❌ Saving fields failed:",v)})}Q[s]=!Q[s]}},Q=ue({}),Al=l=>{re.value[l]||(re.value[l]=[]);const e=re.value[l].length+1;re.value[l].push({fieldname:"",fieldtype:"",idx:e,label:"",value:"",isNew:!0,description:"",options:re.value[l].options?`
${re.value[l].options}`:""})},El=(l,e)=>{re.value[l]&&re.value[l].splice(e,1)},Vl=(l,e)=>{if(!l)return;ee.value||(ee.value={}),ee.value[l]||(ee.value[l]=[]);const s=re.value[l];if(s){if(Q[l]){ee.value[l]=[];let o=!0;if(s.forEach((d,u)=>{var c;st(d,l,u);const v=(c=R[l])==null?void 0:c[u];v&&v.length>0&&(ee.value[l].push(u),o=!1),d.label&&(d.label=d.label.trim())}),!o){he("Please fix the errors before saving");return}const r=s.map((c,v)=>{var p=c,{isNew:d}=p,u=bt(p,["isNew"]);return ye(ne({},u),{idx:v+1,options:ct(u)})}),n={form_short_name:l,fields:r,as_a_block:e};te.post(le.childtable,n).then(d=>{Et.value=d.data,_e("Fields updated successfully!")}).catch(d=>{console.error("❌ Saving fields failed:",d)})}Q[l]=!Q[l],At.value=Q[l]?l:null}},Rl=_([{id:1,label:"About Form",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Fields & Workflow",stepno:"Step 2",icon:"bi bi-question-circle"},{id:3,label:"Print Format",stepno:"Step 3",icon:"ri-checkbox-circle-line"}]),ut=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],Ul=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],Ml=Y(()=>[$e,...A.value]),Ol=Y(()=>{const l=g.value.accessible_departments;return l.includes($e)?"All Selected":l.length>1?`${l[0]}.. +${l.length-1} more selected`:l.join(", ")}),Bl=l=>l===$e?g.value.accessible_departments.length===A.value.length:g.value.accessible_departments.includes(l),Pl=(l,e)=>{l===$e?e.target.checked?g.value.accessible_departments=[...A.value]:g.value.accessible_departments=[]:(e.target.checked?g.value.accessible_departments.push(l):g.value.accessible_departments=g.value.accessible_departments.filter(s=>s!==l),g.value.accessible_departments.length===A.value.length?g.value.accessible_departments=[...A.value]:g.value.accessible_departments=g.value.accessible_departments.filter(s=>s!==$e))},zl=l=>{l===$e&&(g.value.accessible_departments=[...A.value])},Nl=l=>{l===$e&&(g.value.accessible_departments=[])},pt=_(!1),Be=Y(()=>{var e;let l=[...Z.value];if(Te.value&&(l=l.filter(s=>s.is_hod===1)),(e=we.value)!=null&&e.trim()){const s=we.value.toLowerCase();l=l.filter(o=>o.role.toLowerCase().includes(s))}return l.sort((s,o)=>s.role.localeCompare(o.role)),l.sort((s,o)=>{const r=$.value.includes(s.role),n=$.value.includes(o.role);return r===n?0:r?1:-1}),l.map(s=>s.role)}),Hl=Y(()=>{const l=Be.value;return l.length>0&&l.every(e=>$.value.includes(e))});Se([$,Be],()=>{const l=Be.value;pt.value=l.length>0&&l.every(e=>$.value.includes(e))},{immediate:!0,deep:!0});function jl(l){const e=l.target.checked,s=Z.value.filter(o=>{var r;return!(Te.value&&o.is_hod!==1||(r=we.value)!=null&&r.trim()&&!o.role.toLowerCase().includes(we.value.toLowerCase()))}).map(o=>o.role);e?$.value=Array.from(new Set([...$.value,...s])):$.value=$.value.filter(o=>!s.includes(o)),pt.value=e}function Jl(){$.value=[],pt.value=!1,Te.value=!1}const pe=_("");function Yl(){const l=h[P.value];if(!l||!l.sections){console.error("Error: Invalid block or sections not found.");return}let e={type:P.value==0?"requestor":"approver",roles:$.value,approval_required:U.value,approver_can_edit:j.value,fields:l.sections.flatMap(yt),idx:P.value};P.value!==0&&(e.view_only_reportee=pe.value==="ViewOnlyReportee"?1:0,e.all_approvals_required=pe.value==="all_approvals_required"?1:0,e.requester_as_a_approver=pe.value==="requester_as_a_approver"?1:0,e.on_rejection=ve.value?ve.value:0);const s=I.findIndex(o=>o.idx===e.idx);s!==-1?I[s]=e:I.push(e),Kl()}function W(l){return I.find(e=>e.idx===l)||{roles:[]}}function Gl(l){const e=W(l),s=e.roles||[];$.value=[...s],ve.value=e.on_rejection,U.value=e.approval_required,j.value=e.approver_can_edit,e.view_only_reportee===1?pe.value="ViewOnlyReportee":e.all_approvals_required===1?pe.value="all_approvals_required":e.requester_as_a_approver===1?pe.value="requester_as_a_approver":pe.value=""}const ft=l=>{Te.value=!1,we.value="",pe.value="",ve.value="",g.value.accessible_departments.length&&Zl(l,g.value.accessible_departments),P.value=l,Gl(l)};function Zl(l,e){let s={index:l,departments:e,property:g.value.business_unit};te.post(le.addDesignationroles,s).then(o=>{o.message&&(Z.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function Kl(){te.post(le.add_roles_WF,{workflow_setup:I,doctype:g.value.form_short_name,business_unit:g.value.business_unit}).then(l=>{console.log(l),P.value==0?_e("Requestor Added"):_e(`Approver-${P.value} Added`)})}function Wl(){y.push({path:ie.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function Ql(){g.value.form_name="",g.value.form_short_name="",g.value.owner_of_the_form="",g.value.business_unit="",g.value.form_category="",g.value.accessible_departments=[]}const Xl=l=>{if(ot.value){he("Please check all required fields before proceeding.");return}l<C.value?Rt():l>C.value&&Vt()},Vt=()=>{if(ot.value){he("Please check all required fields before proceeding.");return}C.value<3&&(C.value+=1,C.value===3&&(gt.value=h))},Rt=()=>{C.value>1&&(C.value-=1)},xl=_([]);function Ut(){const l={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:me.EzyFormDefinitions,doc_id:H.value};te.get(le.GetDoctypeData,{params:l}).then(e=>{var o;let s=e==null?void 0:e.message.data;if(s){s.accessible_departments&&(s.accessible_departments=s.accessible_departments.split(",")),g.value=ye(ne(ne({},g.value),s),{owner_of_the_form:s.owner_of_the_form||g.value.owner_of_the_form||""});const r=JSON.parse((o=e.message.data)==null?void 0:o.form_json);ce.value=r.workflow,Qt.value=r.fields.filter(d=>d.fieldtype==="Table"),xl.value=r.fields.filter(d=>d.fieldtype==="Table"),qe.value=e.message.data.is_landscape;let n=Jt(JSON.parse(s==null?void 0:s.form_json).fields);re.value=JSON.parse(e.message.data.form_json).child_table_fields,bl.value=[],Wt.value=[],n.forEach((d,u)=>{h.push(d)}),JSON.parse(s==null?void 0:s.form_json).workflow.forEach((d,u)=>{I.push(d)})}}).catch(e=>{console.error("Error fetching  data:",e)})}function Il(){const l={};Ie.value&&(l.print_format=Ie.value),qe.value!==void 0&&qe.value!==null&&(l.is_landscape=qe.value),te.put(le.resource+me.EzyFormDefinitions+`/${F.query.id}`,l).then(e=>{console.log(e),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),_e("Print Format Added Successfully")}).catch(e=>{console.error("Error fetching  data:",e)})}function Mt(){const l={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${ie.value.business_unit||F.query.business_unit}`,doctype:me.departments};te.get(le.GetDoctypeData,{params:l}).then(e=>{var s;(s=e==null?void 0:e.message.data)!=null&&s.length&&(G.value=e.message.data.map(o=>o.name),A.value=e.message.data.map(o=>o.name))}).catch(e=>{console.error("Error fetching department data:",e)})}_(""),Se(()=>g.value.owner_of_the_form,l=>{l&&mt(l)});function mt(l){l&&typeof l=="string"&&l.trim()!==""&&es(l)}function es(l){const e={fields:JSON.stringify(["ezy_departments_items"]),doctype:me.departments,doc_id:l};te.get(le.GetDoctypeData,{params:e}).then(s=>{var o;(o=s==null?void 0:s.message.data)!=null&&o.ezy_departments_items&&(q.value=s.message.data.ezy_departments_items.map(r=>r.category))}).catch(s=>{console.error("Error fetching categories data:",s)})}function vt(l){let e=Us(h);const s=ye(ne({},g.value),{fields:e,doctype:me.EzyFormDefinitions,workflow_setup:I,form_status:l==="save"?"Created":"Draft"});s.accessible_departments=s.accessible_departments.toString(),te.post(le.savedata,s).then(o=>{if(o&&o.message&&o.message.message){let r=localStorage.getItem("preName");if(r){let n={installed:"Yes"};te.put(`${le.resource}${me.preDefinedForm}/${r}`,n).then(d=>{localStorage.removeItem("preName")}).catch(d=>{console.error("Error fetching ezyForms data:",d)})}if(y.push({params:{paramid:o.message.message},query:{id:o.message.message}}),H.value=o.message.message,H&&H!=="new"&&(h.splice(0,h.length),Ut()),I.length<h.length)Ms("Add Workflow");else if(Ot.value===!0){_e("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let n=localStorage.getItem("routepath");l==="save"?y.push({path:n}):l==="Draft"&&y.push({path:n})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const ts=_(""),Ot=_(!1),Bt=l=>{let e=h[l];e.parent&&V.push(e);let s=[];I.length>l&&I[l].roles&&(s=[...I[l].roles]),h.splice(l,1),I.length>l&&I.splice(l,1),h.forEach((o,r)=>{o.sections.forEach((n,d)=>{n.rows.forEach((u,v)=>{u.columns.forEach((c,p)=>{fe(r,d,v,p)})})})}),s.length&&ls(s,l)};function ls(l,e){const s={role:l,level:e,document_type:g.value.form_name,short_name:g.value.form_short_name,property:g.value.business_unit};te.post(le.deleteAssigneRoles,s).then(o=>{o&&vt()})}const ss=(l,e)=>{const s={label:"",parent:`${Xe.value.value}-${g.value.form_short_name}`,rows:[{label:`row_0_${e}_${l}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};h[l].sections.splice(e+1,0,s)},os=(l,e)=>{let s=h[l].sections[e];s.parent&&V.push(s),h[l].sections.splice(e,1),h[l].sections.forEach((o,r)=>{o.rows.forEach((n,d)=>{n.columns.forEach((u,v)=>{fe(l,r,d,v)})})})},as=(l,e,s)=>{h[l].sections[e].rows[s].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},is=(l,e,s,o)=>{const n=h[l].sections[e].rows[s].columns,d=n[o];d.parent&&V.push(d),n.length===1?h[l].sections[e].rows.splice(s,1):n.splice(o,1),h[l].sections.forEach((u,v)=>{u.rows.forEach((c,p)=>{c.columns.forEach((k,M)=>{fe(l,v,p,M)})})})},ns=(l,e,s,o)=>{h[l].sections[e].rows[s].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},rs=(l,e,s,o,r)=>{let n=h[l].sections[e].rows[s].columns[o].fields[r];n.parent&&V.push(n),h[l].sections[e].rows[s].columns[o].fields.splice(r,1)},ds=(l,e,s,o,r)=>{const n=h[l].sections[e].rows[s].columns[o].fields[r],d=ne({},n);d.name=`${n.name} Name the field`,h[l].sections[e].rows[s].columns[o].fields.splice(r+1,0,d)},cs=(l,e,s,o,r)=>{const n=Gt(h);h.splice(0,h.length,...n);let d=h[l].sections[e].rows[s].columns[o].fields[r].fieldtype;(d!=="Select"||d!=="radio"||d!=="multiselect")&&(h[l].sections[e].rows[s].columns[o].fields[r].options="")};function us(l){return et.includes(l==null?void 0:l.trim().toLowerCase())}function ps(l){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(l)||l.includes('"')||l.includes("'")}function fs(l){return l.flatMap(e=>{var s;return[(s=e.label)==null?void 0:s.trim().toLowerCase(),...e.sections.flatMap(o=>{var r;return[(r=o.label)==null?void 0:r.trim().toLowerCase(),...o.rows.flatMap(n=>n.columns.flatMap(d=>{var u;return[(u=d.label)==null?void 0:u.trim().toLowerCase(),...d.fields.map(v=>{var c;return(c=v.label)==null?void 0:c.trim().toLowerCase()})]}))]})]}).filter(e=>e!==""&&!$t.includes(e))}function fe(l,e,s,o,r){const d=fs(h).filter((c,p,k)=>k.indexOf(c)!==p),u=Gt(h);h.splice(0,h.length,...u);function v(c,p){if(!c){p.errorMsg="";return}us(c)?p.errorMsg="Entered label is restricted":ps(c)?p.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:c.length>64?p.errorMsg="Label should not exceed 64 characters":p.errorMsg=d.includes(c.trim().toLowerCase())?"Duplicate Label Name":""}r!==void 0&&v(h[l].sections[e].rows[s].columns[o].fields[r].label,h[l].sections[e].rows[s].columns[o].fields[r]),r===void 0&&o!==void 0&&v(h[l].sections[e].rows[s].columns[o].label,h[l].sections[e].rows[s].columns[o]),o===void 0&&r===void 0&&v(h[l].sections[e].label,h[l].sections[e]),h.forEach(c=>{c.sections.forEach(p=>{v(p.label,p),p.rows.forEach(k=>{k.columns.forEach(M=>{v(M.label,M),M.fields.forEach(w=>{v(w.label,w)})})})})})}const ht=Y(()=>{function l(e){return!e||typeof e!="object"?!1:"fieldtype"in e&&e.fieldtype===""||"error"in e&&e.error||"errorMsg"in e&&e.errorMsg||["Select","Table MultiSelect"].includes(e.fieldtype)&&(!e.options||e.options.trim()==="")?!0:Array.isArray(e)?e.some(l):Object.values(e).some(l)}return l(h)}),ot=Y(()=>x.value.length>0||N.value.length>0||!g.value.form_category||!g.value.owner_of_the_form||g.value.accessible_departments.length===0),ms=Y(()=>h.some(l=>l.sections.some(e=>e.rows.some(s=>s.columns.some(o=>o.fields.some(r=>r.label&&r.fieldtype))))));function Pt(l,e){let s=l.target.value.trim();if(!s){e==="form_name"?x.value="Input cannot be empty or only spaces":e==="form_short_name"&&(N.value="Input cannot be empty or only spaces");return}if(s.length>63){e==="form_name"?x.value="Name cannot exceed 63 characters":e==="form_short_name"&&(N.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(s)){e==="form_short_name"&&(N.value="First character must be a letter");return}else N.value="";if(e==="form_short_name"&&s.length<2){N.value="Short name must have at least 2 letters";return}if(e==="form_short_name"&&/[^a-zA-Z ]/.test(s)){N.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(s)){e==="form_name"?x.value="Special characters are not allowed":e==="form_short_name"&&(N.value="Special characters are not allowed");return}else e==="form_name"?x.value="":e==="form_short_name"&&(N.value="");const o=[[e,"=",`${s}`],["business_unit","=",`${g.value.business_unit}`]],r={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:me.EzyFormDefinitions};te.get(`${le.GetDoctypeData}`,{params:r}).then(n=>{K.value=n.message.data,e==="form_name"?x.value=s&&K.value.some(d=>d.form_name&&d.form_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":e==="form_short_name"&&(N.value=s&&K.value.some(d=>d.form_short_name&&d.form_short_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(n=>{console.error("Error fetching ezyForms data:",n),e==="form_name"?x.value="":e==="form_short_name"&&(N.value="")})}const vs=l=>l===0?"1st row":l===1?"2nd row":l===2?"3rd row":`${l+1}th row`,gt=_([]),hs=()=>{h.length&&(gt.value=h,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function gs(){te.post(le.delete_form_items,{deleted_fields:V.flatMap(yt),doctype:H}).then(l=>{var e;(e=l==null?void 0:l.message)!=null&&e.success&&vt()})}function zt(l){return it(this,null,function*(){if(ht.value){he("Please fix the errors before proceeding.");return}Ot.value=!0;let e=V.flatMap(yt);H!=null&&H!=null&&H!="new"&&e.length?gs():vt(l)})}const bs=l=>{console.log("Field added from library:",l);const e=Qe.value,s=h[e];if(!s){he("Please create a block first before adding fields");return}const o=_s(l);if(!o)return;s.sections||(s.sections=[]),s.sections.length===0&&s.sections.push({label:"",rows:[[{fields:[]}]]});const d=s.sections[0].rows[0][0];d.fields||(d.fields=[]),d.fields.push(o),console.log("Field added successfully:",o),_e(`${o.label} field added successfully`)},ys=l=>{console.log("Drag started:",l),Xt.value=l},_s=l=>{var n,d,u,v;const e=wt[l];if(!e)return console.error("Field type not found:",l),he("Field type not found"),null;const s=Date.now(),o=Math.random().toString(36).substring(2,6),r=`${l}_${s}_${o}`;return{id:`field_${s}_${o}`,fieldname:r,label:e.name,fieldtype:e.frappe_fieldtype,options:((n=e.defaultProps)==null?void 0:n.options)||"",reqd:(d=e.defaultProps)!=null&&d.required?1:0,read_only:0,hidden:0,description:e.description||"",default:((u=e.defaultProps)==null?void 0:u.default)||"",placeholder:((v=e.defaultProps)==null?void 0:v.placeholder)||""}};return(l,e)=>(a(),i("div",null,[t("div",Ao,[t("div",Eo,[t("div",Vo,[t("div",Ro,[t("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:e[0]||(e[0]=s=>Wl())},e[37]||(e[37]=[t("button",{class:"btn font-13 ms-3"},[t("i",{class:"bi bi-arrow-left"}),t("span",{class:"ms-2"},"Back")],-1)])),l.$route.query.id||l.$route.query.preId?(a(),i("span",Uo,"("+b(ie.value.formId||E(F).query.form_name)+")",1)):m("",!0)]),t("div",null,[C.value===2&&E(h).length&&!l.$route.query.id?(a(),i("button",{key:0,disabled:ht.value||ot.value,style:As({cursor:ht.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:e[1]||(e[1]=s=>zt("Draft"))},e[38]||(e[38]=[t("i",{class:"bi bi-bookmark-check-fill"},null,-1),z(" Save As Draft ")]),12,Mo)):m("",!0)])]),t("div",Oo,[t("div",Bo,[t("div",Po,[t("div",zo,[t("ul",No,[(a(!0),i(O,null,B(Rl.value,s=>(a(),i("li",{key:s.id,class:L({active:C.value===s.id,completed:C.value>s.id})},[t("div",{class:L(["d-flex gap-3 align-items-center",{"not-allowed":ot.value&&C.value+1===s.id}]),onClick:o=>Xl(s.id)},[C.value>s.id?(a(),i("i",jo)):(a(),i("i",{key:1,class:L(s.icon)},null,2)),t("div",Jo,[t("span",Yo,b(s.stepno),1),e[39]||(e[39]=t("br",null,null,-1)),t("span",Go,b(s.label),1)])],10,Ho)],2))),128))])])]),t("div",Zo,[t("div",Ko,[t("div",Wo,[C.value===1?(a(),i("div",Qo,[t("div",Xo,[t("div",xo,[e[40]||(e[40]=t("div",null,null,-1)),e[41]||(e[41]=t("h1",{class:"font-14 fw-bold m-0"},"About Form",-1)),t("div",null,[!l.$route.query.id&&!l.$route.query.preId?(a(),i("button",{key:0,class:"btn btn-light font-12 mx-2",type:"button",onClick:Ql},"Clear Form")):m("",!0),C.value<3?(a(),Re(Yt,{key:1,class:"btn btn-dark bg-dark text-white fw-bold font-13",name:"Next",onClick:Vt})):m("",!0)])])]),t("div",Io,[t("div",ea,[e[55]||(e[55]=t("div",{class:"col-sm-none col-md-4"},null,-1)),t("div",ta,[t("div",la,[t("div",sa,[t("div",oa,[t("div",aa,[E(F).query.preId?(a(),i("span",ia,e[42]||(e[42]=[z("Predefined "),t("i",{class:"bi bi-check2-circle"},null,-1)]))):m("",!0),ae(Ye,{disabled:(ie.value.formId&&ie.value.formId.length>0||E(F).query.form_name)&&De.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Untitled Form",onChange:e[2]||(e[2]=s=>Pt(s,"form_name")),modelValue:St.value,"onUpdate:modelValue":e[3]||(e[3]=s=>St.value=s)},null,8,["disabled","modelValue"]),x.value?(a(),i("span",na,b(x.value),1)):m("",!0)])]),t("div",ra,[ae(Ye,{disabled:(ie.value.formId&&ie.value.formId.length>0||E(F).query.form_name)&&De.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Untitled Form",onChange:e[4]||(e[4]=s=>Pt(s,"form_short_name")),modelValue:g.value.form_short_name,"onUpdate:modelValue":e[5]||(e[5]=s=>g.value.form_short_name=s)},null,8,["disabled","modelValue"]),N.value?(a(),i("span",da,b(N.value),1)):m("",!0)]),t("div",ca,[ae(Ye,{disabled:ie.value.formId&&ie.value.formId.length>0&&De.value!=="1",labeltext:"Form Naming series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Naming series",modelValue:g.value.series,"onUpdate:modelValue":e[6]||(e[6]=s=>g.value.series=s)},null,8,["disabled","modelValue"]),e[43]||(e[43]=Es('<small class="text-muted" style="font-size:12px;" data-v-0c5dd444> Note : Enter <code data-v-0c5dd444>YY-YY</code>, <code data-v-0c5dd444>YYYY</code>, or <code data-v-0c5dd444>ABC</code>. The system will default to the format <code data-v-0c5dd444> 24-25-0001</code>, <code data-v-0c5dd444> 2025-0001</code>, or <code data-v-0c5dd444> ABC-0001</code> respectively. </small>',1))]),t("div",ua,[t("label",null,[e[44]||(e[44]=z("Owner Of The Form ")),g.value.owner_of_the_form?m("",!0):(a(),i("span",pa,"*"))]),ae(E(Ge),{disabled:ie.value.formId&&ie.value.formId.length>0&&De.value!=="1",onOpen:Mt,options:G.value,onChange:mt,modelValue:g.value.owner_of_the_form,"onUpdate:modelValue":e[7]||(e[7]=s=>g.value.owner_of_the_form=s),placeholder:"Select Department",multiple:!1,class:"font-11 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"])]),t("div",fa,[t("label",null,[e[45]||(e[45]=z("Form Category ")),g.value.form_category?m("",!0):(a(),i("span",ma,"*"))]),ae(E(Ge),{disabled:ie.value.formId&&ie.value.formId.length>0&&De.value!=="1",options:q.value,modelValue:g.value.form_category,"onUpdate:modelValue":e[8]||(e[8]=s=>g.value.form_category=s),placeholder:"Select Category",multiple:!1,searchable:!0,class:"font-11 multiselect"},null,8,["disabled","options","modelValue"])]),t("div",va,[t("label",null,[e[46]||(e[46]=z("Accessible to Department ")),g.value.accessible_departments.length?m("",!0):(a(),i("span",ha,"*"))]),ae(E(Ge),{modelValue:g.value.accessible_departments,"onUpdate:modelValue":e[10]||(e[10]=s=>g.value.accessible_departments=s),options:Ml.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Department",class:"font-11",onSelect:zl,onRemove:Nl,openDirection:"bottom"},{option:_t(({option:s})=>[t("div",ga,[t("input",{type:"checkbox",checked:Bl(s),class:"custom-checkbox",onChange:o=>Pl(s,o),onClick:e[9]||(e[9]=de(()=>{},["stop"]))},null,40,ba),t("span",null,b(s),1)])]),selection:_t(({values:s,isOpen:o})=>[s.length?S((a(),i("span",{key:0,class:"multiselect__single font-10"},b(Ol.value),513)),[[Ve,!o]]):m("",!0)]),_:1},8,["modelValue","options"])]),t("div",ya,[e[47]||(e[47]=t("label",null,"Form Type",-1)),ae(E(Ge),{options:Dt,modelValue:Ft.value,"onUpdate:modelValue":e[11]||(e[11]=s=>Ft.value=s),placeholder:"Select Form Type",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:s=>s.value,class:"font-11 multiselect",openDirection:"top"},null,8,["modelValue","reduce"]),e[48]||(e[48]=t("small",{class:"text-muted font-12 ms-2"},"Note: Public form is accessible by anyone through QR code.",-1))]),t("div",_a,[e[49]||(e[49]=t("label",null,[z("Has Workflow "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(E(Ge),{options:["Yes","No"],modelValue:g.value.has_workflow,"onUpdate:modelValue":e[12]||(e[12]=s=>g.value.has_workflow=s),placeholder:"Select",multiple:!1,class:"font-11 multiselect",searchable:!0},null,8,["modelValue"])]),g.value.as_web_view===1?(a(),i("div",wa,[e[50]||(e[50]=t("label",null,[z("Form Submit Response "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(Ye,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit Response",modelValue:g.value.public_form_response,"onUpdate:modelValue":e[13]||(e[13]=s=>g.value.public_form_response=s)},null,8,["modelValue"])])):m("",!0),g.value.as_web_view===1?(a(),i("div",ka,[e[51]||(e[51]=t("label",null,[z("Submit Notification Email "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(Ye,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit mail",modelValue:g.value.mail_id,"onUpdate:modelValue":e[14]||(e[14]=s=>g.value.mail_id=s)},null,8,["modelValue"]),e[52]||(e[52]=t("small",{class:"text-muted font-12 ms-2"},"Note : If multiple Emails, separate with commas (,).",-1))])):m("",!0),E(F).query.preId?(a(),i("div",Ca,[t("div",Da,[S(t("input",{class:"form-check-input linketoCheck p-1",disabled:g.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":e[15]||(e[15]=s=>g.value.is_linked=s),"true-value":1,"false-value":0},null,8,Fa),[[Ae,g.value.is_linked]]),e[53]||(e[53]=t("label",{class:"form-check-label font-12 mx-2 mb-0 ps-1",for:"is_linked"}," Link ",-1))])])):m("",!0),g.value.is_linked?(a(),i("div",Sa,[e[54]||(e[54]=t("label",{for:"standardFormInput"},"Form",-1)),S(t("input",{type:"text",class:"form-control standardFormInput",id:"standardFormInput",disabled:g.value.is_predefined_doctype==1,"onUpdate:modelValue":e[16]||(e[16]=s=>g.value.is_linked_form=s),placeholder:"Type to search Form Name...",onInput:tl,onFocus:e[17]||(e[17]=s=>Ke.value=!0),onBlur:sl},null,40,$a),[[J,g.value.is_linked_form]]),Ke.value&&Ze.value.length?(a(),i("ul",qa,[(a(!0),i(O,null,B(Ze.value,(s,o)=>(a(),i("li",{class:"list-group-item formlistitem",key:o,onMousedown:de(r=>ll(s.name),["prevent"])},b(s.name),41,Ta))),128))])):m("",!0)])):m("",!0)])])]),e[56]||(e[56]=t("div",{class:"col-sm-none col-md-4"},null,-1))])])])):m("",!0),C.value===2?(a(),i("div",La,[t("div",Aa,[t("div",Ea,[t("button",{onClick:e[18]||(e[18]=s=>Rt()),class:"btn btn-sm btn-light"},e[57]||(e[57]=[t("i",{class:"bi bi-chevron-left"},null,-1),z(" Back ")]))]),t("div",Va,[(a(!0),i(O,null,B(E(h),(s,o)=>(a(),i("button",{key:o,class:L(["zoho-tab",{active:Qe.value===o}]),onClick:r=>Qe.value=o},[e[58]||(e[58]=t("i",{class:"bi bi-file-earmark-text me-1"},null,-1)),z(" "+b(o===0?"Requestor Block":`Approver Block ${o}`)+" ",1),E(h).length>1?(a(),i("i",{key:0,class:"bi bi-x-lg ms-2",onClick:de(r=>Bt(o),["stop"])},null,8,Ua)):m("",!0)],10,Ra))),128))]),t("div",Ma,[ms.value?(a(),i("button",{key:0,class:"btn btn-sm btn-light me-2",onClick:hs},e[59]||(e[59]=[t("i",{class:"bi bi-eye me-1"},null,-1),z("Preview ")]))):m("",!0),E(h).length?(a(),i("button",{key:1,class:"btn btn-sm btn-dark",onClick:e[19]||(e[19]=s=>zt("save"))},b(E(H)!=="new"?"Update Form":"Create Form"),1)):m("",!0)])]),t("div",Oa,[t("aside",Ba,[t("div",Pa,[e[60]||(e[60]=t("h6",{class:"mb-0"},"Field Types",-1)),t("button",{class:"btn btn-sm btn-link p-0",onClick:e[20]||(e[20]=s=>We.value=!We.value)},[t("i",{class:L(We.value?"bi bi-chevron-left":"bi bi-chevron-right")},null,2)])]),We.value?(a(),i("div",za,[ae(Lo,{collapsible:!1,onFieldAdd:bs,onFieldDragstart:ys})])):m("",!0)]),t("div",Na,[t("div",{class:"canvas-inner",ref_key:"mainBlockRef",ref:ts},[(a(!0),i(O,null,B(E(h),(s,o)=>S((a(),i("div",{class:"block-level",key:o},[t("div",Ha,[t("div",ja,[t("div",Ja,[t("h6",Ya,b(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),t("div",Ga,[o!==0&&W(o).view_only_reportee||W(o).all_approvals_required||W(o).requester_as_a_approver?(a(),i("div",Za,[t("span",Ka,b(W(o).view_only_reportee===1?"Reporting Manager only":"")+" "+b(W(o).all_approvals_required===1?"All of the selected approvers":"")+" "+b(W(o).requester_as_a_approver===1?"Approval by Requestor":""),1),t("span",null,[e[61]||(e[61]=t("span",{class:"ms-1"}," on rejection escalating to ",-1)),t("span",Wa,b(W(o).on_rejection?`Level ${W(o).on_rejection}`:"Requestor"),1)]),t("span",Qa,b(W(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):m("",!0)])]),t("div",Xa,[E(H)&&E(I).length?(a(),i("div",xa,[W(o)?(a(),i("label",Ia,[t("span",ei,b(W(o).roles.length>0?o===0?"Requestor: ":"Approver: ":""),1),t("span",ti,b(W(o).roles.slice(0,2).join(", ")),1),W(o).roles.length>2?(a(),i("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:r=>ft(o),class:"more-count"}," +"+b(W(o).roles.length-2)+" more ",9,li)):m("",!0)])):m("",!0)])):m("",!0),It(o)&&E(H)!=null&&E(H)!=null&&E(H)!="new"&&W(o).roles.length===0?(a(),i("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:r=>ft(o)},[e[62]||(e[62]=t("img",{src:Os,alt:"Add",class:"me-1"},null,-1)),z(" "+b(o===0?"Add Requestors":"Add Approvers"),1)],8,si)):m("",!0),E(H)!=null&&E(H)!=null&&E(H)!="new"&&W(o).roles.length>0?(a(),i("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:r=>ft(o)},e[63]||(e[63]=[t("i",{class:"bi bi-pencil font-14"},null,-1)]),8,oi)):m("",!0),t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:r=>Bt(o)},e[64]||(e[64]=[t("i",{class:"bi bi-trash me-1"},null,-1),z(" Delete Block ")]),8,ai)])])]),t("div",ii,[(a(!0),i(O,null,B(s.sections,(r,n)=>(a(),i("div",{key:"section-"+n,class:"dynamicSection mt-0 section"},[t("section",ni,[t("div",ri,[S(t("input",{"onUpdate:modelValue":d=>r.label=d,type:"text",class:L(["border-less-input","font-14",{"italic-style":!r.label},{"fw-medium":r.label}]),onChange:d=>fe(o,n),onInput:d=>fe(o,n),placeholder:"Untitled section"},null,42,di),[[J,r.label]]),r.errorMsg?(a(),i("small",ci,b(r.errorMsg),1)):m("",!0)]),t("div",ui,[t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:d=>os(o,n)},e[65]||(e[65]=[t("i",{class:"bi bi-trash me-1"},null,-1),z(" Delete Section ")]),8,pi)])]),t("div",fi,[(a(!0),i(O,null,B(r.rows,(d,u)=>(a(),i("section",{class:"row dynamicRow row-container",key:"row-"+u},[t("div",mi,[t("label",vi,b(vs(u)),1),t("div",null,[d.columns.length<3?(a(),i("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:v=>as(o,n,u)},e[66]||(e[66]=[t("i",{class:"bi bi-plus font-14"},null,-1),z(" Add Column ")]),8,hi)):m("",!0)])]),t("div",gi,[t("div",bi,[(a(!0),i(O,null,B(d.columns,(v,c)=>(a(),i("div",{key:"column-"+c,onMouseenter:p=>ul(o,n,u,c),onMouseleave:pl,class:"col p-0 dynamicColumn position-relative column-container"},[t("div",_i,[t("div",wi,[S(t("input",{"onUpdate:modelValue":p=>v.label=p,type:"text",class:L(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!v.label},{"fw-medium":v.label}]),onChange:p=>fe(o,n,u,c),onInput:p=>fe(o,n,u,c),placeholder:"Column Name"},null,42,ki),[[J,v.label]]),v.errorMsg?(a(),i("small",Ci,b(v.errorMsg),1)):m("",!0)]),S(t("div",Di,[t("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:p=>is(o,n,u,c)},e[67]||(e[67]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Fi)],512),[[Ve,fl(o,n,u,c)]])]),v.fields.length===0?(a(),i("div",{key:0,class:"empty-drop-zone",onDragover:e[21]||(e[21]=de(()=>{},["prevent"])),onDrop:p=>ke(p,o,n,u,c,l.fieldIndex)},null,40,Si)):m("",!0),(a(!0),i(O,null,B(v.fields,(p,k)=>{var M;return a(),i("div",{key:"field-"+k,onMouseenter:w=>rl(o,n,u,c,k),onMouseleave:dl,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:w=>qt(w,o,n,u,c,k),onDragover:e[25]||(e[25]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},[t("div",{class:"drop-zone",onDragover:e[22]||(e[22]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},null,40,qi),p.fieldtype!=="Table"?(a(),i("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:w=>qt(w,o,n,u,c,k),onDragover:e[23]||(e[23]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},[t("div",Li,[t("div",Ai,[S(t("input",{"onUpdate:modelValue":w=>p.label=w,placeholder:"Name the field",class:L(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!p.label},{"fw-medium":p.label}]),onChange:w=>fe(o,n,u,c,k),onInput:w=>fe(o,n,u,c,k)},null,42,Ei),[[J,p.label]]),p.errorMsg?(a(),i("small",Vi,b(p.errorMsg),1)):m("",!0)]),S(t("div",Ri,[t("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:w=>ds(o,n,u,c,k)},e[68]||(e[68]=[t("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,Ui),t("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:w=>{rs(o,n,u,c,k),fe(o,n,u,c)}},e[69]||(e[69]=[t("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,Mi)],512),[[Ve,cl(o,n,u,c,k)]])]),S(t("select",{"onUpdate:modelValue":w=>p.fieldtype=w,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:w=>cs(o,n,u,c,k)},[e[70]||(e[70]=t("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(Ul,w=>t("option",{key:w,value:w.type},b(w.label),9,Bi)),64))],40,Oi),[[Ee,p.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(p.fieldtype)?(a(),i("div",Pi,[e[71]||(e[71]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":w=>p.options=w,class:"form-control shadow-none mb-1 font-12"},null,8,zi),[[J,p.options]]),!p.options||p.options.trim()===""?(a(),i("small",Ni," Options are required for this field type. ")):m("",!0)])):m("",!0),p.fieldtype==="Link"?(a(),i("div",Hi,[t("label",{class:"font-11 fw-light",for:"link-search-"+ge(o,n,u,c,k)}," Search Doctype: ",8,ji),S(t("input",{id:"link-search-"+ge(o,n,u,c,k),type:"text","onUpdate:modelValue":w=>E(h)[o].sections[n].rows[u].columns[c].fields[k].options=w,onInput:w=>al(E(h)[o].sections[n].rows[u].columns[c].fields[k].options,o,n,u,c,k),onFocus:w=>ol(ge(o,n,u,c,k)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,Ji),[[J,E(h)[o].sections[n].rows[u].columns[c].fields[k].options]]),(M=Me[ge(o,n,u,c,k)])!=null&&M.length&&dt[ge(o,n,u,c,k)]?(a(),i("ul",Yi,[(a(!0),i(O,null,B(Me[ge(o,n,u,c,k)],(w,D)=>(a(),i("li",{key:D,onClick:T=>il(o,n,u,c,k,w.name),class:"list-group-item list-group-item-action"},b(w.name),9,Gi))),128))])):m("",!0)])):m("",!0),t("div",Zi,[t("div",Ki,[t("div",Wi,[S(t("input",{class:"font-12","onUpdate:modelValue":w=>p.reqd=w,"true-value":1,id:"mandatory-"+o+"-"+n+"-"+u+"-"+c+"-"+k,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,Qi),[[Ae,p.reqd]])]),t("div",null,[t("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+n+"-"+u+"-"+c+"-"+k},"Mandatory",8,Xi)])]),t("div",null,[t("button",{class:"btn btn-sm font-12",onClick:w=>p.showDescription=!p.showDescription},b(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,xi)])]),p.showDescription?S((a(),i("textarea",{key:2,"onUpdate:modelValue":w=>p.description=w,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,Ii)),[[J,p.description]]):m("",!0),p.error?(a(),i("small",en,b(p.error),1)):m("",!0)],40,Ti)):m("",!0),t("div",{class:"drop-zone",onDragover:e[24]||(e[24]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},null,40,tn),t("div",ln,[t("div",null,[t("div",null,[t("div",sn,[p.fieldtype==="Table"?(a(),i("div",on,[(a(!0),i(O,null,B(re.value,(w,D)=>(a(),i("div",{key:D,class:"childTable"},[D===p.fieldname||D===p.options?(a(),i("h5",an,b(D.replace(/_/g," ")),1)):m("",!0),Q[D]&&D===At.value?(a(),i("div",nn,[t("div",rn,[p.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":T=>p.description=T,class:"form-control font-12",placeholder:"Enter field description"},null,8,dn)),[[J,p.description]]):m("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:T=>p.showDescription=!p.showDescription},b(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,cn)])])):m("",!0),D===p.options||D===p.fieldname?(a(),i("table",un,[e[75]||(e[75]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Label"),t("th",null,"Field Type")])],-1)),t("tbody",{onDragover:de(hl,["prevent"]),onDrop:T=>gl(T,w)},[(a(!0),i(O,null,B(w,(T,se)=>{var Pe,ze,Ne,He,je,Je,oe;return a(),i("tr",{key:se,draggable:Q[D],onDragstart:X=>ml(se),onDragend:vl,class:L({dragging:Fe.value===se})},[t("td",null,b(se+1),1),Q[D]?(a(),i("td",mn,[S(t("input",{"onUpdate:modelValue":X=>T.label=X,onInput:X=>st(T,D,se),placeholder:"Field Label",class:L(["form-control",{"border-1 border-danger":(ze=(Pe=R[D])==null?void 0:Pe[se])==null?void 0:ze.length}])},null,42,vn),[[J,T.label]]),(He=(Ne=R[D])==null?void 0:Ne[se])!=null&&He.length?(a(),i("div",hn,[(a(!0),i(O,null,B(R[D][se],(X,ws)=>(a(),i("div",{key:ws},b(X),1))),128))])):m("",!0)])):(a(),i("td",gn,b(T.label),1)),Q[D]?(a(),i("td",bn,[t("div",yn,[S(t("select",{"onUpdate:modelValue":X=>T.fieldtype=X,onChange:X=>st(T,D,se),class:L(["form-select form-select-sm",{"border-1 border-danger":(Je=(je=R[D])==null?void 0:je[se])==null?void 0:Je.length}])},[e[72]||(e[72]=t("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(ut,X=>t("option",{key:X.type,value:X.type},b(X.label),9,wn)),64))],42,_n),[[Ee,T.fieldtype]]),t("div",kn,[t("div",Cn,[t("div",Dn,[S(t("input",{class:"font-12 form-control-sm","onUpdate:modelValue":X=>T.description=X,placeholder:"description",type:"text"},null,8,Fn),[[J,T.description]])])]),t("button",{class:"btn btn-light btn-sm",onClick:X=>El(D,se)},e[73]||(e[73]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Sn)])]),["Select"].includes(T.fieldtype)?(a(),i("div",$n,[e[74]||(e[74]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":X=>T.options=X,onInput:X=>st(T,D,se),class:"form-control shadow-none mb-1 font-12"},null,40,qn),[[J,T.options]]),!T.options||T.options.trim()===""?(a(),i("small",Tn," Options are required for this field type. ")):m("",!0)])):m("",!0),(oe=ee[D])!=null&&oe.includes(se)?(a(),i("span",Ln,"Type required**")):m("",!0)])):(a(),i("td",An,b(T.fieldtype),1))],42,fn)}),128))],40,pn)])):m("",!0),p.fieldtype==="Table"&&(p.label===D||p.fieldname===D)?(a(),i("div",En,[t("button",{class:"btn btn-light btn-sm mx-2",onClick:T=>Vl(D,p.description)},b(Q[D]?"Save":"Edit"),9,Vn),Q[D]?(a(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:T=>Al(D)}," Add More Field ",8,Rn)):m("",!0)])):m("",!0)]))),128))])):m("",!0)])])])])],40,$i)}),128)),t("div",{class:"drop-zone-bottom",onDragover:e[26]||(e[26]=de(()=>{},["prevent"])),onDrop:p=>ke(p,o,n,u,c,v.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,Un),t("div",{class:"drop-zone",onDragover:e[27]||(e[27]=de(()=>{},["prevent"])),onDrop:p=>ke(p,o,n,u,c,l.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,Mn),t("div",On,[t("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:p=>ns(o,n,u,c)},e[76]||(e[76]=[t("i",{class:"bi bi-plus fs-5"},null,-1),t("span",null,"Add Field",-1)]),8,Bn)])],40,yi))),128))])])]))),128)),t("div",null,[(a(!0),i(O,null,B(r.afterCreated,(d,u)=>(a(),i("div",{key:u,class:"childTable dynamicColumn m-0 p-2"},[t("h5",Pn,b(d.tableName),1),Q[d.tableName]?(a(),i("div",zn,[t("div",Nn,[d.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":v=>d.description=v,class:"form-control font-12",placeholder:"Enter field description"},null,8,Hn)),[[J,d.description]]):m("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:v=>d.showDescription=!d.showDescription},b(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,jn)])])):m("",!0),t("table",Jn,[e[82]||(e[82]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Label"),t("th",null,"Field Type")])],-1)),t("tbody",null,[(a(!0),i(O,null,B(d.columns,(v,c)=>{var p,k,M,w;return a(),i("tr",{key:c},[t("td",null,b(c+1),1),Q[d.tableName]?(a(),i("td",Yn,[S(t("input",{"onUpdate:modelValue":D=>v.label=D,placeholder:"Field Label",class:L(["form-control",{"border-1 border-danger":(p=ee[d.tableName])==null?void 0:p.includes(c)}]),onBlur:D=>{var T;v.label=(T=v.label)==null?void 0:T.trim(),Oe(v,d.tableName,c,d.columns)}},null,42,Gn),[[J,v.label]]),(k=R[d.tableName])!=null&&k[c]?(a(),i("div",Zn,[(a(!0),i(O,null,B(R[d.tableName][c],(D,T)=>(a(),i("span",{key:T},[z(b(D)+" ",1),e[77]||(e[77]=t("br",null,null,-1))]))),128))])):m("",!0)])):(a(),i("td",Kn,b(v.label),1)),Q[d.tableName]?(a(),i("td",Wn,[t("div",Qn,[S(t("select",{"onUpdate:modelValue":D=>v.fieldtype=D,class:L(["form-select form-select-sm",{"border-1 border-danger":(M=ee[d.tableName])==null?void 0:M.includes(c)}]),onChange:D=>Oe(v,d.tableName,c,d.columns)},[e[78]||(e[78]=t("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(ut,D=>t("option",{key:D.type,value:D.type},b(D.label),9,xn)),64))],42,Xn),[[Ee,v.fieldtype]]),t("button",{class:"btn btn-light btn-sm",onClick:D=>Tl(o,n,d.tableName,c)},e[79]||(e[79]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,In)]),v.fieldtype==="Select"?(a(),i("div",er,[e[80]||(e[80]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":D=>v.options=D,class:"form-control shadow-none mb-1 font-12",onInput:D=>Oe(v,d.tableName,c,d.columns)},null,40,tr),[[J,v.options]])])):m("",!0),(w=R[d.tableName])!=null&&w[c]?(a(),i("div",lr,[(a(!0),i(O,null,B(R[d.tableName][c],(D,T)=>(a(),i("span",{key:T},[z(b(D),1),e[81]||(e[81]=t("br",null,null,-1))]))),128))])):m("",!0)])):(a(),i("td",sr,b(v.fieldtype),1))])}),128))])]),t("div",or,[t("button",{class:"btn btn-light btn-sm mx-2",onClick:v=>Ll(o,n,d.tableName)},b(Q[d.tableName]?"Save":"Edit"),9,ar),Q[d.tableName]?(a(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:v=>ql(o,n,d.tableName)}," Add More Field ",8,ir)):m("",!0)])]))),128))])]),t("div",null,[t("div",null,[o==0?(a(),i("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:d=>yl(o,n)}," Add New Table ",8,nr)):m("",!0),(a(!0),i(O,null,B(r.childTables,(d,u)=>{var v;return a(),i("div",{key:`table-${o}-${n}-${u}`,class:"child-table"},[d.newTable?(a(),i("div",rr,[t("div",dr,[t("div",null,[t("span",{class:L(d.tableName?"d-none":"text-danger")},"*",2),S(t("input",{"onUpdate:modelValue":c=>d.tableName=c,placeholder:"Table Name",onBlur:c=>Tt(d),class:L(["border-less-input font-14 p-0 inputHeight",{"italic-style":!d.tableName,"fw-medium":d.tableName}])},null,42,cr),[[J,d.tableName]]),(v=R[`${o}-${n}-${u}`])!=null&&v.tableName?(a(),i("div",ur,b(R[`${o}-${n}-${u}`].tableName),1)):m("",!0),Le.value?(a(),i("div",pr,b(Le.value),1)):m("",!0),t("div",fr,[t("div",mr,[d.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":c=>d.as_a_block=c,class:"form-control font-12",placeholder:"Enter field description"},null,8,vr)),[[J,d.as_a_block]]):m("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:c=>d.showDescription=!d.showDescription},b(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,hr)])])]),t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:c=>wl(o,n,u)},e[83]||(e[83]=[t("i",{class:"bi bi-trash"},null,-1),z(" Remove Table ")]),8,gr)]),(a(!0),i(O,null,B(d.columns,(c,p)=>{var k,M,w,D,T,se,Pe,ze,Ne,He,je,Je;return a(),i("div",{key:p,class:"dynamicField"},[t("div",br,[t("div",yr,[t("div",null,[t("span",{class:L(c.label?"d-none":"text-danger")},"*",2),S(t("input",{"onUpdate:modelValue":oe=>c.label=oe,placeholder:"Name the field",onBlur:()=>{Tt(c),Cl(c,o,n,u,p,d.columns)},class:L(["border-less-input font-14 p-0 inputHeight",{"italic-style":!c.label,"fw-medium":c.label,"is-invalid":(w=(M=(k=R[`${o}-${n}-${u}`])==null?void 0:k.columns)==null?void 0:M[p])==null?void 0:w.label}])},null,42,_r),[[J,c.label]]),(se=(T=(D=R[`${o}-${n}-${u}`])==null?void 0:D.columns)==null?void 0:T[p])!=null&&se.label?(a(),i("div",wr,b(R[`${o}-${n}-${u}`].columns[p].label),1)):m("",!0)]),t("div",kr,[t("div",Cr,[c.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":oe=>c.description=oe,class:"form-control font-12",placeholder:"Enter field description"},null,8,Dr)),[[J,c.description]]):m("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:oe=>c.showDescription=!c.showDescription},b(c.showDescription?"Hide Description":c.description?"Edit Description":"Add Description"),9,Fr)]),t("button",{class:"btn btn-sm trash-btn py-0",onClick:oe=>kl(o,n,u,p)},e[84]||(e[84]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Sr)])]),S(t("select",{"onUpdate:modelValue":oe=>c.fieldtype=oe,class:L(["form-select font-13 mb-1",{"is-invalid":(Ne=(ze=(Pe=R[`${o}-${n}-${u}`])==null?void 0:Pe.columns)==null?void 0:ze[p])==null?void 0:Ne.fieldtype}])},[e[85]||(e[85]=t("option",{value:""},"Select Type",-1)),(a(),i(O,null,B(ut,oe=>t("option",{key:oe.type,value:oe.type},b(oe.label),9,qr)),64))],10,$r),[[Ee,c.fieldtype]]),["Select"].includes(c.fieldtype)?(a(),i("div",Tr,[e[86]||(e[86]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":oe=>c.options=oe,class:"form-control shadow-none mb-1 font-12"},null,8,Lr),[[J,c.options]]),!c.options||c.options.trim()===""?(a(),i("small",Ar," Options are required for this field type. ")):m("",!0)])):m("",!0),(Je=(je=(He=R[`${o}-${n}-${u}`])==null?void 0:He.columns)==null?void 0:je[p])!=null&&Je.fieldtype?(a(),i("div",Er,b(R[`${o}-${n}-${u}`].columns[p].fieldtype),1)):m("",!0)])])}),128)),t("button",{class:"btn btn-light btn-sm addField mx-1",onClick:c=>_l(o,n,u)},e[87]||(e[87]=[t("i",{class:"bi bi-plus"},null,-1),z(" Add Field ")]),8,Vr),t("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:c=>$l(o,n,u)}," Create Table ",8,Rr),e[88]||(e[88]=t("hr",null,null,-1))])):m("",!0)])}),128))])]),t("div",Ur,[t("button",{class:"btn btn-light border font-12",onClick:d=>ss(o,n)},e[89]||(e[89]=[t("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),z(" Add Section ")]),8,Mr)])]))),128)),o===0?(a(),i("div",Or)):m("",!0)])])),[[Ve,o===Qe.value]])),128))],512)]),Ct.value?(a(),i("aside",Br,[t("div",Pr,[e[91]||(e[91]=t("h6",{class:"mb-0"},"Field Properties",-1)),t("button",{class:"btn btn-sm btn-link p-0",onClick:e[28]||(e[28]=s=>Ct.value=null)},e[90]||(e[90]=[t("i",{class:"bi bi-x-lg"},null,-1)]))]),e[92]||(e[92]=t("div",{class:"properties-content"},[t("p",{class:"text-muted small"},"Select a field to edit its properties")],-1))])):m("",!0)])])):m("",!0),C.value===3?(a(),i("div",zr,[e[93]||(e[93]=t("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[t("div",null,[t("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),t("div")],-1)),ae(Vs,{blockArr:gt.value},null,8,["blockArr"])])):m("",!0)])])])])])])]),t("div",Nr,[t("div",Hr,[t("div",jr,[e[97]||(e[97]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Jr,[e[95]||(e[95]=t("label",{for:""},"Form Name",-1)),S(t("input",{"onUpdate:modelValue":e[29]||(e[29]=s=>Ie.value=s),multiple:!1,placeholder:E(F).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,Yr),[[J,Ie.value]]),t("div",Gr,[t("div",Zr,[S(t("input",{class:"font-12","onUpdate:modelValue":e[30]||(e[30]=s=>qe.value=s),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[Ae,qe.value]])]),e[94]||(e[94]=t("div",null,[t("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),t("div",{class:"modal-footer"},[e[96]||(e[96]=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),t("button",{type:"button",class:"btn btn-dark",onClick:Il},"Add Print Format")])])])]),t("div",Kr,[t("div",Wr,[t("span",Qr,b(P.value==0?"Add designation for Requestors":`Approval Settings For
          Level-${P.value}`),1),e[98]||(e[98]=t("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),t("div",Xr,[t("div",xr,[t("div",Ir,[P.value!==0?(a(),i("div",ed,[P.value!==0?(a(),i("div",td,[e[100]||(e[100]=t("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),S(t("select",{"onUpdate:modelValue":e[31]||(e[31]=s=>pe.value=s),class:"form-select shadow-none font-12"},e[99]||(e[99]=[t("option",{value:""},"Any one of the selected approvers",-1),t("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),t("option",{value:"all_approvals_required"},"All of the selected approvers",-1),t("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[Ee,pe.value]])])):m("",!0)])):m("",!0)])]),t("div",ld,[t("div",sd,[t("span",od," Select "+b(P.value===0?"Requestors":"Approvers"),1),t("span",ad,b($.value.length)+" Selected ",1)]),Z.value.length?(a(),i("div",id,[t("div",nd,[t("div",rd,[t("input",{type:"checkbox",id:"selectAll",checked:Hl.value,onChange:jl,class:"form-check-input me-2 designationCheckBox"},null,40,dd),t("label",cd," Select all designation ("+b(Be.value.length)+") ",1)]),P.value!==0?(a(),i("div",ud,[S(t("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":e[32]||(e[32]=s=>Te.value=s),class:"form-check-input me-2 designationCheckBox"},null,512),[[Ae,Te.value]]),e[101]||(e[101]=t("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):m("",!0),t("div",null,[$.value.length?(a(),i("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:Jl},e[102]||(e[102]=[t("i",{class:"bi bi-x"},null,-1),z(" Clear all ")]))):m("",!0)])]),Z.value.length?(a(),Re(E(Rs),{key:0,multiple:!0,modelValue:$.value,"onUpdate:modelValue":e[33]||(e[33]=s=>$.value=s),options:Be.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):m("",!0)],512)):(a(),i("div",pd,e[103]||(e[103]=[t("div",{class:"d-flex justify-content-center"},[t("span",null,"No Designations Found")],-1)])))]),P.value!==0?(a(),i("div",fd,[e[104]||(e[104]=t("div",null,[t("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),S(t("select",{"onUpdate:modelValue":e[34]||(e[34]=s=>ve.value=s),class:"form-select shadow-none font-12 mt-1 me-2"},[(a(!0),i(O,null,B(nl.value,s=>(a(),i("option",{key:s,value:s},b(s===0?"Requestor":"Approver Level "+s),9,md))),128))],512),[[Ee,ve.value,void 0,{number:!0}]])])):m("",!0),P.value!==0?(a(),i("div",vd,[t("div",hd,[t("div",gd,[S(t("input",{"onUpdate:modelValue":e[35]||(e[35]=s=>U.value=s),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Ae,U.value]]),e[105]||(e[105]=t("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),rt.value===!0?(a(),i("div",bd,[S(t("input",{"onUpdate:modelValue":e[36]||(e[36]=s=>j.value=s),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Ae,j.value]]),e[106]||(e[106]=t("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):m("",!0)])])):m("",!0)]),t("div",yd,[t("div",_d,[t("div",null,[ae(Yt,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:Yl,name:P.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},Dd=Ue(wd,[["__scopeId","data-v-0c5dd444"]]);export{Dd as default};
