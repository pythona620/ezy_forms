var ie=Object.defineProperty,de=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var O=(v,m,u)=>m in v?ie(v,m,{enumerable:!0,configurable:!0,writable:!0,value:u}):v[m]=u,w=(v,m)=>{for(var u in m||(m={}))me.call(m,u)&&O(v,u,m[u]);if(A)for(var u of A(m))ue.call(m,u)&&O(v,u,m[u]);return v},N=(v,m)=>de(v,re(m));import{_ as pe,e as ce,d as r,w as U,H as _e,o as i,c as d,b as t,a as _,F as f,t as g,h as D,B as j,z as R,A as J,v as T,y as q,j as $,G as ve,P as be,E as ye,l as V,m as x,p as C,k as I}from"./index-DUC1w12e.js";const fe={class:"d-flex justify-content-between align-items-center py-2"},ge={class:"d-flex gap-2 align-items-center"},Ce={class:"modal fade",id:"createDepartments",tabindex:"-1","aria-labelledby":"createDepartmentsLabel","aria-hidden":"true"},he={class:"modal-dialog modal-lg"},ke={class:"modal-content"},De={class:"modal-body"},Ve={class:"mb-3"},xe={key:0,class:"text-danger font-12"},ze={class:"mb-3"},we={key:0,class:"text-danger font-12"},Ee={class:"d-flex align-items-center gap-2"},Ne={class:"w-100"},Ue={key:0},$e={class:"table mt-3 global-table"},Le={key:0},Se={key:1},Pe=["onChange"],Fe={class:"text-center"},Be=["onClick"],Ae=["onClick"],Oe=["onClick"],je={class:"modal-footer"},Re=["disabled"],Je={class:"mt-2"},Te={class:"modal fade",id:"viewCategory","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"viewCategoryLabel","aria-hidden":"true"},qe={class:"modal-dialog"},Ie={class:"modal-content"},He={class:"modal-body"},Me={class:"mb-3"},Ge={key:0,class:"text-danger font-12"},Ke={class:"mb-3"},Qe={key:0,class:"text-danger font-12"},We={class:"d-flex w-100 gap-3"},Xe={key:0,class:"table mt-3 global-table"},Ye={key:0},Ze={key:1},et=["onChange"],tt={class:"text-center"},at=["onClick"],nt=["onClick"],st=["onClick"],lt={class:"modal-footer"},ot=["disabled"],it={__name:"DepartmentComp",setup(v){const m=ce(()=>ye.value),u=r(0),E=r([]);r(["yes","no"]),r([]);const b=r(""),y=r(null),p=r("");r([]);const h=r({ezy_departments_items:[]}),L=r([]),H=r([{name:"View Categories",icon:"fa-solid fa-eye"}]),c=r({department_code:"",department_name:""}),S=r([]),k=r({limitPageLength:"None",limit_start:0}),M=a=>{k.value.limitPageLength=a,k.value.limit_start=0,fetchTable()},G=([a,e])=>{k.value.limitPageLength=a,k.value.limit_start=e,fetchTable()},P=r([{th:"Name",td_key:"name"},{th:"Department Code",td_key:"department_code"},{th:"Department Name",td_key:"department_name"},{th:"Business Unit",td_key:"business_unit"}]),K=r({department_code:{type:"input"},department_name:{type:"input"},form_category:{type:"select",options:["Software","Hardware"]}}),s=r({department_code:"",department_name:"",business_unit:"",ezy_departments_items:[]});U(()=>s.value.department_code,a=>{const e=a.trim().toLowerCase();S.value.filter(n=>n!==null).map(n=>n.trim().toLowerCase()).includes(e)?c.value.department_code="Department code already exists.":c.value.department_code=""}),U(()=>s.value.department_name,a=>{const e=a.trim().toLowerCase();L.value.filter(n=>n!==null).map(n=>n.trim().toLowerCase()).includes(e)?c.value.department_name="Department name already exists.":c.value.department_name=""}),_e({applieddepartment_name:!1,applieddepartment_code:!1,department_name:"",department_code:""}),U(m,a=>{s.value.business_unit=a,a.length&&z()},{immediate:!0});function Q(a,e){e.name==="View Categories"&&(a?(s.value=w({},a),V.get(`${x.resource}${C.departments}/${a.name}`).then(n=>{n.data&&(h.value=n.data)}).catch(n=>{console.error("Error fetching categories data:",n)}),new bootstrap.Modal(document.getElementById("viewCategory"),{}).show()):(console.warn("No form fields provided."),formCreation(a)))}function W(){b.value&&(s.value.ezy_departments_items.push({category:b.value,parentfield:"ezy_departments_items"}),b.value="")}function X(){b.value&&(h.value.ezy_departments_items.push({category:b.value,parentfield:"ezy_departments_items"}),b.value="")}function Y(a,e){y.value=a,p.value=e}function F(a){p.value.trim()&&(s.value.ezy_departments_items[a].category=p.value,y.value=null,p.value="")}function Z(a){s.value.ezy_departments_items.splice(a,1)}function ee(a,e){y.value=a,p.value=e}function B(a){p.value.trim()&&(h.value.ezy_departments_items[a].category=p.value,y.value=null,p.value="")}function te(a){h.value.ezy_departments_items.splice(a,1)}function ae(a){const e=[];P.value.forEach(l=>{const n=l.td_key;a[n]&&e.push([n,"like",`%${a[n]}%`])}),e.length?z(e):z()}function ne(){const a=[["business_unit","like",`%${s.value.business_unit}%`]],e={fields:JSON.stringify(["department_name","department_code"]),filters:JSON.stringify(a),limit_page_length:"None",limit_start:k.value.limit_start,order_by:"`tabEzy Departments`.`creation` desc"};V.get(x.resource+C.departments,{params:e}).then(l=>{l.data&&(L.value=[...new Set(l.data.map(n=>n.department_name))],S.value=[...new Set(l.data.map(n=>n.department_code))])}).catch(l=>{console.error("Error fetching department data:",l)})}function z(a){const e=[["business_unit","like",`%${s.value.business_unit}%`]];a&&e.push(...a);const l={fields:JSON.stringify(["*"]),filters:JSON.stringify(e),limit_page_length:k.value.limitPageLength,limit_start:k.value.limit_start,order_by:"`tabEzy Departments`.`creation` desc"},n={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(e)};V.get(`${x.resource}${C.departments}`,{params:n}).then(o=>{u.value=o.data[0].total_count}).catch(o=>{console.error("Error fetching ezyForms data:",o)}),V.get(x.resource+C.departments,{params:l}).then(o=>{o.data&&(E.value=o.data)}).catch(o=>{console.error("Error fetching department data:",o)})}function se(){s.value={department_code:"",department_name:"",ezy_departments_items:[]},s.value.business_unit=m.value}function le(){const a=N(w({},s.value),{doctype:C.departments});console.log(a,"------------------"),V.post(x.resource+C.departments,a).then(e=>{e.data&&(I.success("Department Created",{autoClose:500,transition:"zoom"}),z(),s.value={department_code:"",department_name:"",ezy_departments_items:[]})})}function oe(){s.value.ezy_departments_items=h.value.ezy_departments_items;const a=N(w({},s.value),{doctype:C.departments});V.put(`${x.resource}${C.departments}/${s.value.name}`,a).then(e=>{e.data&&(I.success("Department Updated",{autoClose:500,transition:"zoom"}),z(),s.value={department_code:"",department_name:"",business_unit:"",ezy_departments_items:[]})}).catch(e=>{var l;console.error("Error updating department:",((l=e.response)==null?void 0:l.data)||e)})}return(a,e)=>(i(),d("div",null,[t("div",fe,[e[17]||(e[17]=t("div",null,[t("h1",{class:"m-0 font-13"}," Departments ")],-1)),t("div",ge,[t("div",{class:"d-flex align-items-center"},[t("button",{type:"button",class:"btn btn-dark buttoncomp CreateDepartments d-flex align-items-center",onClick:ne,"data-bs-toggle":"modal","data-bs-target":"#createDepartments"}," Create Department ")]),t("div",Ce,[t("div",he,[t("div",ke,[t("div",De,[t("div",Ve,[e[10]||(e[10]=t("label",{class:"font-13 ps-1",for:"DepartmentCode"},"Department Code",-1)),_(f,{tag:"input",type:"text",name:"DepartmentCode",id:"DepartmentCode",placeholder:"Enter department code",modelValue:s.value.department_code,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.department_code=l)},null,8,["modelValue"]),c.value.department_code?(i(),d("span",xe,g(c.value.department_code),1)):D("",!0)]),t("div",ze,[e[11]||(e[11]=t("label",{class:"font-13 ps-1",for:"Requedepartment_namested"},"Department name",-1)),_(f,{tag:"input",type:"text",name:"department_name",id:"department_name",placeholder:"Enter department name",modelValue:s.value.department_name,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.department_name=l)},null,8,["modelValue"]),c.value.department_name?(i(),d("span",we,g(c.value.department_name),1)):D("",!0)]),e[14]||(e[14]=t("label",{class:"font-13 ps-1",for:"business_unit"},"Business Unit",-1)),_(f,{tag:"input",type:"text",disabled:!!s.value.business_unit,placeholder:"",class:"mb-3",name:"business_unit",id:"business_unit",modelValue:s.value.business_unit,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.business_unit=l)},null,8,["disabled","modelValue"]),t("div",Ee,[t("div",Ne,[e[12]||(e[12]=t("label",{class:"font-13 ps-1",for:"ezy_departments_items"},"ADD Department Categories ",-1)),_(f,{class:"mb-3",tag:"input",type:"text",name:"ezy_departments_items",id:"ezy_departments_items",placeholder:"Enter category",modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=l=>b.value=l)},null,8,["modelValue"])]),_(j,{class:"buttoncomp mt-2",name:"Add",onClick:W})]),s.value.ezy_departments_items?(i(),d("div",Ue,[t("table",$e,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Category Name"),t("th",{class:"text-center"},"Actions")])],-1)),t("tbody",null,[(i(!0),d(R,null,J(s.value.ezy_departments_items,(l,n)=>(i(),d("tr",{key:n},[t("td",null,g(n+1),1),y.value!==n?(i(),d("td",Le,g(l.category),1)):(i(),d("td",Se,[T(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=o=>p.value=o),onChange:o=>F(n),placeholder:"Edit Category"},null,40,Pe),[[q,p.value]])])),t("td",Fe,[y.value!==n?(i(),d("i",{key:0,class:"bi bi-pencil",onClick:o=>Y(n,l.category)},null,8,Be)):(i(),d("i",{key:1,class:"bi bi-check font-20",onClick:o=>F(n)},null,8,Ae)),t("i",{class:"bi bi-trash ms-2",onClick:o=>Z(n)},null,8,Oe)])]))),128))])])])):D("",!0)]),t("div",je,[t("button",{type:"button",class:"cancelfilter border-1 text-nowrap font-10 d-flex justify-content-center align-items-center",onClick:se,"data-bs-dismiss":"modal"},e[15]||(e[15]=[t("span",{class:"font-16 me-1"},[t("i",{class:"bi bi-x"})],-1),$("Cancel ")])),t("button",{type:"button",class:"applyfilter btn btn-dark text-nowrap font-10 d-flex justify-content-center align-items-center","data-bs-dismiss":"modal",disabled:!s.value.department_code||!s.value.department_name||!s.value.business_unit,onClick:le},e[16]||(e[16]=[t("span",{class:"font-16 me-1"},[t("i",{class:"bi bi-check2"})],-1),$(" Create Department")]),8,Re)])])])])])]),t("div",Je,[_(ve,{tHeaders:P.value,tData:E.value,onActionClicked:Q,isAction:"true",actions:H.value,actionType:"dropdown",isCheckbox:"true",isFiltersoption:"true","field-mapping":K.value,onUpdateFilters:ae},null,8,["tHeaders","tData","actions","field-mapping"]),_(be,{currentRecords:E.value.length,totalRecords:u.value,onUpdateValue:M,onLimitStart:G},null,8,["currentRecords","totalRecords"])]),t("div",Te,[t("div",qe,[t("div",Ie,[e[23]||(e[23]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"viewCategoryLabel"},"Department Data"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",He,[t("div",null,[t("div",Me,[e[18]||(e[18]=t("label",{class:"font-13 ps-1",for:"DepartmentCode"},"Department Code",-1)),_(f,{tag:"input",type:"text",name:"DepartmentCode",id:"DepartmentCode",placeholder:"Enter department code",modelValue:s.value.department_code,"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.department_code=l)},null,8,["modelValue"]),c.value.department_code?(i(),d("span",Ge,g(c.value.department_code),1)):D("",!0)]),t("div",Ke,[e[19]||(e[19]=t("label",{class:"font-13 ps-1",for:"Requedepartment_namested"},"Department name",-1)),_(f,{tag:"input",type:"text",name:"department_name",id:"department_name",placeholder:"Enter department name",modelValue:s.value.department_name,"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.department_name=l)},null,8,["modelValue"]),c.value.department_name?(i(),d("span",Qe,g(c.value.department_name),1)):D("",!0)]),e[20]||(e[20]=t("label",{class:"font-13 ps-1",for:"business_unit"},"Business Unit",-1)),_(f,{tag:"input",type:"text",disabled:!!s.value.business_unit,placeholder:"",class:"mb-3",name:"business_unit",id:"business_unit",modelValue:s.value.business_unit,"onUpdate:modelValue":e[7]||(e[7]=l=>s.value.business_unit=l)},null,8,["disabled","modelValue"])]),t("div",We,[_(f,{class:"w-100",tag:"input",type:"text",name:"ezy_departments_items",id:"ezy_departments_items",placeholder:"Enter category",modelValue:b.value,"onUpdate:modelValue":e[8]||(e[8]=l=>b.value=l)},null,8,["modelValue"]),_(j,{class:"buttoncomp",name:"Add",onClick:X})]),h.value.ezy_departments_items?(i(),d("table",Xe,[e[21]||(e[21]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Category Name"),t("th",{class:"text-center"},"Actions")])],-1)),t("tbody",null,[(i(!0),d(R,null,J(h.value.ezy_departments_items,(l,n)=>(i(),d("tr",{key:n},[t("td",null,g(n+1),1),y.value!==n?(i(),d("td",Ye,g(l.category),1)):(i(),d("td",Ze,[T(t("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=o=>p.value=o),onChange:o=>B(n),placeholder:"Edit Category"},null,40,et),[[q,p.value]])])),t("td",tt,[y.value!==n?(i(),d("i",{key:0,class:"bi bi-pencil",onClick:o=>ee(n,l.category)},null,8,at)):(i(),d("i",{key:1,class:"bi bi-check font-20",onClick:o=>B(n)},null,8,nt)),t("i",{class:"bi bi-trash ms-2",onClick:o=>te(n)},null,8,st)])]))),128))])])):D("",!0)]),t("div",lt,[t("button",{type:"button",class:"applyfilter btn btn-dark text-nowrap font-10 d-flex justify-content-center align-items-center","data-bs-dismiss":"modal",disabled:!s.value.department_code||!s.value.department_name||!s.value.business_unit,onClick:oe},e[22]||(e[22]=[t("span",{class:"font-16 me-1"},[t("i",{class:"bi bi-check2"})],-1),$(" Save Department")]),8,ot)])])])])]))}},mt=pe(it,[["__scopeId","data-v-d0861524"]]);export{mt as default};
