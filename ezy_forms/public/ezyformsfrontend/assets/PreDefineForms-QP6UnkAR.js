import{_ as O,d as s,u as A,e as y,I as M,f as z,w as B,O as J,o as U,c as V,b as o,a as k,G as q,i as F,Q as R,E as G,k as c,l as d,n as p,j as Q,m as K}from"./index-BHd6CXej.js";const W={class:"mt-2"},X={class:"modal fade",id:"pdfView",tabindex:"-1","aria-labelledby":"pdfViewLabel","aria-hidden":"true"},Y={class:"modal-dialog modal-xl"},Z={class:"modal-content"},ee={class:"d-block modal-header bg-dark text-white py-2"},te={class:"d-flex align-items-center justify-content-between"},oe={class:""},se={class:"modal-body"},ne=["innerHTML"],ae={__name:"PreDefineForms",setup(ie){const w=s(0),x=s(""),_=s({}),r=s([]),b=A(),m=y(()=>G.value);M([]),z(()=>{});const u=s({limit_start:0,limitPageLength:20,form_name:"",form_short_name:"",accessible_departments:"[]",business_unit:"",form_category:"",owner_of_the_form:"",search:""}),P=s("");B(m,t=>{u.value.business_unit=t,t.length&&(P.value=t,r.value=[],g())},{immediate:!0});const h=s([{th:"Form name",td_key:"form_name"},{th:"Installed",td_key:"installed"}]),S=J(),C=s(null),E=s([{name:"Set up Form",icon:"fa-solid fa-edit"}]),$=s([]);function D(t,e){e.name==="Set up Form"&&(S.push({name:"FormStepper",query:{routepath:b.path,preId:"PreDefine",business_unit:m.value,form_name:t.form_name,preName:t.name}}),localStorage.setItem("form_json",t.form_json),localStorage.setItem("preName",t.name),localStorage.setItem("routepath",b.path))}function N(t,e,a){const n=t.enable=="1"||t.enable===1,i=n?"Disable":"Enable";confirm(`Are you sure you want to ${i} ${t.name} Form?`)&&(t.enable=n?0:1,c.put(`${d.resource}${p.EzyFormDefinitions}/${t.name}`,t).then(l=>{Q.success(`Form ${i}d successfully`,{autoClose:700}),window.location.reload()}).catch(l=>{console.error("Error updating toggle:",l)}))}function T(){const t={form_short_name:_.value.form_short_name,name:null,business_unit:m.value};c.post(d.download_pdf_form,t).then(e=>{let a=K+e.message;a=a.replace("/api","");const n=document.createElement("a");n.href=a,n.download=e.message.split("/").pop(),n.click()}).catch(e=>{console.error("Error fetching data:",e)})}const v=s(null);function I(t){clearTimeout(v.value),v.value=setTimeout(()=>{const e=[];h.value.forEach(a=>{const n=a.td_key;t[n]&&e.push([n,"like",`%${t[n]}%`])}),g(e.length?e:void 0)},500)}const j=s([]);s([]);const H=s([]);function g(t){const e=[];t&&e.push(...t);const a={fields:JSON.stringify(["*"]),filters:JSON.stringify(e),limit_page_length:5,limit_start:u.value.limit_start},n={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(e)};c.get(`${d.resource}${p.preDefinedForm}`,{params:n}).then(i=>{w.value=i.data[0].total_count}).catch(i=>{console.error("Error fetching ezyForms data:",i)}),c.get(`${d.resource}${p.preDefinedForm}`,{params:a}).then(i=>{const l=i.data;u.value.limit_start===0?(r.value=l,j.value=[...new Set(l.map(f=>f.form_category))],H.value=[...new Set(l.map(f=>f.owner_of_the_form))]):r.value=r.value.concat(l)}).catch(i=>{console.error("Error fetching ezyForms data:",i)})}const L=y(()=>({form_name:{type:"input"},form_short_name:{type:"input"},form_category:{type:"input"},owner_of_the_form:{type:"input"}}));return(t,e)=>(U(),V("div",null,[e[5]||(e[5]=o("div",{class:"d-flex formsticky align-items-center justify-content-between py-2"},[o("div",null,[o("h1",{class:"m-0 font-13"},"Pre Defined Forms ")])],-1)),o("div",W,[k(q,{tHeaders:h.value,tData:r.value,isAction:"true",actionType:"dropdown",enableDisable:"true",onActionClicked:D,onToggleClick:N,isFiltersoption:"true","field-mapping":L.value,actions:E.value,onUpdateFilters:I,isCheckbox:"true"},null,8,["tHeaders","tData","field-mapping","actions"])]),o("div",X,[o("div",Y,[o("div",Z,[o("div",ee,[o("div",te,[e[3]||(e[3]=o("div",null,[o("h5",{class:"m-0 text-white font-13",id:"exampleModalLabel"}," PDF format ")],-1)),o("div",oe,[o("button",{button:"button",class:"btn btn-dark text-white font-13",onClick:T},e[1]||(e[1]=[F("Download Pdf"),o("span",{class:"ms-2"},[o("i",{class:"bi bi-download"})],-1)])),o("button",{type:"button",class:"btn btn-dark text-white font-13",onClick:e[0]||(e[0]=(...a)=>t.closemodal&&t.closemodal(...a)),"data-bs-dismiss":"modal"},e[2]||(e[2]=[F("Close "),o("i",{class:"bi bi-x"},null,-1)]))])])]),o("div",se,[o("div",{innerHTML:x.value},null,8,ne)]),e[4]||(e[4]=o("div",{class:"modal-footer"},null,-1))])])]),k(R,{blockArr:C.value,formDescriptions:_.value,childHeaders:$.value},null,8,["blockArr","formDescriptions","childHeaders"])]))}},re=O(ae,[["__scopeId","data-v-8769f38d"]]);export{re as default};
