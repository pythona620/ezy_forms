import{_ as G,r as s,e as H,E as Q,w as E,I as K,f as p,g as b,h as v,o as f,c as T,d as t,b as g,G as Y,P as W,F as L,N as X,q as Z,l as C,t as N,m as P}from"./index-DxID15hf.js";import{Q as ee}from"./vue-quill.snow-CWmYDCJk.js";const te={class:"mt-2"},ae={class:"modal fade",id:"EmailTemplateModal","data-bs-backdrop":"static",tabindex:"-1","aria-labelledby":"EmailTemplateLabel","aria-hidden":"true"},le={class:"modal-dialog modal-lg modal-dialog-centered"},se={class:"modal-content"},oe={class:"modal-body"},ne={class:"modal-footer"},ie=["disabled"],de={class:"modal fade",id:"EmployeeToggleModal",tabindex:"-1","aria-hidden":"true"},me={class:"modal-dialog modal-dialog-centered"},re={class:"modal-content"},ue={class:"modal-body"},ce={class:"fw-bold"},pe={class:"fw-semibold"},be={class:"modal-footer"},ve={__name:"EmailTemplate",setup(fe){const k=s(0),V=s([]),r=s([]);s({ezy_departments_items:[]});const U=s([]),n=s({}),d=s(""),u=s(!1);function B(){u.value=!0,n.value={},d.value=""}function I(){const a={__newname:n.value.name,subject:n.value.subject,response:d.value};p.post(b.resource+v.emailTemplate,a).then(e=>{e.data&&(bootstrap.Modal.getInstance(document.getElementById("EmailTemplateModal")).hide(),P.success("Email Template Create successfully",{autoClose:700}),u.value=!1,m())})}function F(){const a={response:d.value,name:n.value.name,subject:n.value.subject};p.put(`${b.resource}${v.emailTemplate}/${w.value.name}`,a).then(e=>{e.data&&(P.success("Email Template Updated successfully",{autoClose:700}),m(),bootstrap.Modal.getInstance(document.getElementById("EmailTemplateModal")).hide())}).catch(e=>{console.error("Error updating toggle:",e)})}const w=s(""),y=s(0);function h(){n.value={},d.value="",u.value=!1,y.value++}function O(a){n.value.name=a.name||"",n.value.subject=a.subject||"",d.value=a.response||"",w.value=a,y.value=Date.now(),new bootstrap.Modal(document.getElementById("EmailTemplateModal")).show()}const j=s({}),x=s("");function R(a){j.value=a;const e=a.enable===0;x.value=e?"Enable":"Disable",new bootstrap.Modal(document.getElementById("EmployeeToggleModal")).show()}const $=H(()=>Q.value),i=s({limitPageLength:20,limit_start:0,filters:[]}),c=s({department_code:"",department_name:""}),S=s([{th:"Name",td_key:"name"},{th:"Subject",td_key:"subject"}]),A=s({}),_=s({department_code:"",department_name:"",business_unit:"",ezy_departments_items:[]});E(()=>_.value.department_code,a=>{const e=a.trim().toLowerCase();V.value.filter(o=>o!==null).map(o=>o.trim().toLowerCase()).includes(e)?c.value.department_code="Department code already exists.":c.value.department_code=""}),E(()=>_.value.department_name,a=>{const e=a.trim().toLowerCase();U.value.filter(o=>o!==null).map(o=>o.trim().toLowerCase()).includes(e)?c.value.department_name="Department name already exists.":c.value.department_name=""}),K({applieddepartment_name:!1,applieddepartment_code:!1,department_name:"",department_code:""}),E($,a=>{_.value.business_unit=a,a.length&&m()},{immediate:!0});const M=s(null);function z(a){clearTimeout(M.value),M.value=setTimeout(()=>{i.value.filters=[],S.value.forEach(e=>{const l=e.td_key;a[l]&&i.value.filters.push([l,"like",`%${a[l]}%`])}),i.value.filters.length?m(i.value.filters):m()},500)}const J=a=>{i.value.limitPageLength=a,i.value.limit_start=0,m()},q=([a,e])=>{i.value.limitPageLength=a,i.value.limit_start=e,m()};function m(a){a&&i.value.filters.push(...a);const e={fields:JSON.stringify(["*"]),filters:JSON.stringify(i.value.filters),limit_page_length:i.value.limitPageLength,limit_start:i.value.limit_start,order_by:"`tabEmail Template`.`creation` desc"},l={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(i.value.filters)};p.get(`${b.resource}${v.emailTemplate}`,{params:l}).then(o=>{k.value=o.data[0].total_count}).catch(o=>{console.error("Error fetching ezyForms data:",o)}),p.get(b.resource+v.emailTemplate,{params:e}).then(o=>{if(o.data){const D=o.data;i.value.limit_start===0?r.value=D:r.value=r.value.concat(D)}}).catch(o=>{console.error("Error fetching department data:",o)})}return(a,e)=>(f(),T("div",null,[t("div",{class:"d-flex justify-content-between align-items-center py-2"},[e[4]||(e[4]=t("div",null,[t("h1",{class:"mt-3 font-13"}," Email Template ")],-1)),t("div",{class:"d-flex gap-2 align-items-center"},[t("div",{class:"d-flex align-items-center"},[t("button",{type:"button",class:"btn btn-dark CreateDepartments","data-bs-toggle":"modal","data-bs-target":"#EmailTemplateModal",onClick:B}," Create Email Template ")])])]),t("div",te,[g(Y,{tHeaders:S.value,tData:r.value,enableDisable:"true",isAction:"true",viewType:"viewPdf",isFiltersoption:"true",onCellClick:O,"field-mapping":A.value,onUpdateFilters:z,onToggleClick:R},null,8,["tHeaders","tData","field-mapping"]),g(W,{currentRecords:r.value.length,totalRecords:k.value,onUpdateValue:J,onLimitStart:q},null,8,["currentRecords","totalRecords"])]),t("div",ae,[t("div",le,[t("div",se,[t("div",{class:"modal-header"},[e[5]||(e[5]=t("h5",{class:"modal-title",id:"EmailTemplateLabel"},"Email Template",-1)),t("button",{onClick:h,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]),t("div",oe,[e[6]||(e[6]=t("label",{for:"password",class:"font-13"},"Name",-1)),e[7]||(e[7]=t("br",null,null,-1)),g(L,{tag:"input",type:"text",name:"name",id:"name",placeholder:"Enter Name",class:"mb-4",modelValue:n.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>n.value.name=l),modelModifiers:{trim:!0}},null,8,["modelValue"]),e[8]||(e[8]=t("label",{for:"password",class:"font-13"},"Subject",-1)),e[9]||(e[9]=t("br",null,null,-1)),g(L,{tag:"input",type:"text",name:"Subject",id:"Subject",placeholder:"Enter Subject",class:"mb-4",modelValue:n.value.subject,"onUpdate:modelValue":e[1]||(e[1]=l=>n.value.subject=l),modelModifiers:{trim:!0}},null,8,["modelValue"]),e[10]||(e[10]=t("label",{for:"password",class:"font-13"},"Template",-1)),e[11]||(e[11]=t("br",null,null,-1)),(f(),X(Z(ee),{content:d.value,"onUpdate:content":e[2]||(e[2]=l=>d.value=l),key:y.value,contentType:"html",theme:"snow",style:{height:"300px"}},null,8,["content"]))]),t("div",ne,[t("button",{onClick:h,type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," Close "),u.value?(f(),T("button",{key:0,disabled:!n.value.name||!n.value.subject||!d.value,type:"button",class:"btn btn-dark",onClick:I}," Submit ",8,ie)):(f(),T("button",{key:1,type:"button",class:"btn btn-dark",onClick:F}," Update "))])])])]),t("div",de,[t("div",me,[t("div",re,[e[16]||(e[16]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Confirm Acknowledgement Status"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ue,[e[12]||(e[12]=C(" Are you sure you want to ")),t("span",ce,N(x.value),1),e[13]||(e[13]=C(' "')),t("span",pe,N(j.value.name),1),e[14]||(e[14]=C('"? '))]),t("div",be,[e[15]||(e[15]=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-dark","data-bs-dismiss":"modal",onClick:e[3]||(e[3]=(...l)=>a.confirmEmployeeToggle&&a.confirmEmployeeToggle(...l))},"Yes, Proceed")])])])])]))}},_e=G(ve,[["__scopeId","data-v-8146713c"]]);export{_e as default};
