import{_ as O,d as s,u as I,e as g,q as M,f as q,w as z,s as B,o as J,c as U,b as o,a as y,G as V,j as k,F as R,E as G,l as c,m as d,p,k as K,n as Q}from"./index-B4_9ZtV1.js";const W={class:"mt-2"},X={class:"modal fade",id:"pdfView",tabindex:"-1","aria-labelledby":"pdfViewLabel","aria-hidden":"true"},Y={class:"modal-dialog modal-xl"},Z={class:"modal-content"},ee={class:"d-block modal-header bg-dark text-white py-2"},te={class:"d-flex align-items-center justify-content-between"},oe={class:""},se={class:"modal-body"},ne=["innerHTML"],ae={__name:"PreDefineForms",setup(ie){const F=s(0),w=s(""),_=s({}),l=s([]),x=I(),u=g(()=>G.value);M([]),q(()=>{});const m=s({limit_start:0,limitPageLength:20,form_name:"",form_short_name:"",accessible_departments:"[]",business_unit:"",form_category:"",owner_of_the_form:"",search:""}),P=s("");z(u,t=>{m.value.business_unit=t,t.length&&(P.value=t,l.value=[],v())},{immediate:!0});const b=s([{th:"Form name",td_key:"form_name"},{th:"Short Name",td_key:"form_short_name"},{th:"Status",td_key:"form_status"}]),S=B(),C=s(null),D=s([{name:"Set up Form",icon:"fa-solid fa-eye"}]),E=s([]);function $(t,e){e.name==="Set up Form"&&(S.push({name:"FormStepper",query:{routepath:x.path,preId:"PreDefine",business_unit:u.value,form_name:t.form_name}}),localStorage.setItem("form_json",t.form_json))}function T(t,e,a){const n=t.enable=="1"||t.enable===1,i=n?"Disable":"Enable";confirm(`Are you sure you want to ${i} ${t.name} Form?`)&&(t.enable=n?0:1,c.put(`${d.resource}${p.EzyFormDefinitions}/${t.name}`,t).then(r=>{K.success(`Form ${i}d successfully`,{autoClose:700}),window.location.reload()}).catch(r=>{console.error("Error updating toggle:",r)}))}function N(){const t={form_short_name:_.value.form_short_name,name:null,business_unit:u.value};c.post(d.download_pdf_form,t).then(e=>{let a=Q+e.message;a=a.replace("/api","");const n=document.createElement("a");n.href=a,n.download=e.message.split("/").pop(),n.click()}).catch(e=>{console.error("Error fetching data:",e)})}const h=s(null);function j(t){clearTimeout(h.value),h.value=setTimeout(()=>{const e=[];b.value.forEach(a=>{const n=a.td_key;t[n]&&e.push([n,"like",`%${t[n]}%`])}),v(e.length?e:void 0)},500)}const H=s([]);s([]);const L=s([]);function v(t){const e=[];t&&e.push(...t);const a={fields:JSON.stringify(["*"]),filters:JSON.stringify(e),limit_page_length:5,limit_start:m.value.limit_start},n={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(e)};c.get(`${d.resource}${p.preDefinedForm}`,{params:n}).then(i=>{F.value=i.data[0].total_count}).catch(i=>{console.error("Error fetching ezyForms data:",i)}),c.get(`${d.resource}${p.preDefinedForm}`,{params:a}).then(i=>{const r=i.data;m.value.limit_start===0?(l.value=r,H.value=[...new Set(r.map(f=>f.form_category))],L.value=[...new Set(r.map(f=>f.owner_of_the_form))]):l.value=l.value.concat(r)}).catch(i=>{console.error("Error fetching ezyForms data:",i)})}const A=g(()=>({form_name:{type:"input"},form_short_name:{type:"input"},form_category:{type:"input"},owner_of_the_form:{type:"input"}}));return(t,e)=>(J(),U("div",null,[e[5]||(e[5]=o("div",{class:"d-flex formsticky align-items-center justify-content-between py-2"},[o("div",null,[o("h1",{class:"m-0 font-13"},"Pre Defined Forms ")])],-1)),o("div",W,[y(V,{tHeaders:b.value,tData:l.value,isAction:"true",actionType:"dropdown",enableDisable:"true",onActionClicked:$,onToggleClick:T,isFiltersoption:"true","field-mapping":A.value,actions:D.value,onUpdateFilters:j,isCheckbox:"true"},null,8,["tHeaders","tData","field-mapping","actions"])]),o("div",X,[o("div",Y,[o("div",Z,[o("div",ee,[o("div",te,[e[3]||(e[3]=o("div",null,[o("h5",{class:"m-0 text-white font-13",id:"exampleModalLabel"}," PDF format ")],-1)),o("div",oe,[o("button",{button:"button",class:"btn btn-dark text-white font-13",onClick:N},e[1]||(e[1]=[k("Download Pdf"),o("span",{class:"ms-2"},[o("i",{class:"bi bi-download"})],-1)])),o("button",{type:"button",class:"btn btn-dark text-white font-13",onClick:e[0]||(e[0]=(...a)=>t.closemodal&&t.closemodal(...a)),"data-bs-dismiss":"modal"},e[2]||(e[2]=[k("Close "),o("i",{class:"bi bi-x"},null,-1)]))])])]),o("div",se,[o("div",{innerHTML:w.value},null,8,ne)]),e[4]||(e[4]=o("div",{class:"modal-footer"},null,-1))])])]),y(R,{blockArr:C.value,formDescriptions:_.value,childHeaders:E.value},null,8,["blockArr","formDescriptions","childHeaders"])]))}},le=O(ae,[["__scopeId","data-v-4c435db9"]]);export{le as default};
