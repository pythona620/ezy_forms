var re=Object.defineProperty,me=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var R=(_,r,u)=>r in _?re(_,r,{enumerable:!0,configurable:!0,writable:!0,value:u}):_[r]=u,q=(_,r)=>{for(var u in r||(r={}))ce.call(r,u)&&R(_,u,r[u]);if(P)for(var u of P(r))pe.call(r,u)&&R(_,u,r[u]);return _},I=(_,r)=>me(_,ue(r));import{p as _e,f as M,q as ve,d as m,e as be,w as fe,l as h,m as k,n as g,o,c as d,b as t,g as D,t as y,h as E,a as v,F as V,s as O,u as A,_ as ge,P as ye,E as Ce,k as j,v as J,x as T}from"./index-B-ZWE6ER.js";import{B as H}from"./ButtonComp-Ciox4MwK.js";const he={class:"d-flex justify-content-between align-items-center"},ke={class:"d-flex gap-2 align-items-center"},De={class:"d-flex align-items-center"},Ee={class:"me-2"},Ve={key:0,class:"process-date font-11 m-0"},we={key:1,class:"process-date font-11 m-0"},ze={type:"button",class:"filterbtn d-flex align-items-center position-relative","data-bs-toggle":"modal","data-bs-target":"#fileterModal"},xe={key:0,class:"badge badge-light colorappiled"},$e={class:"modal fade",id:"fileterModal",tabindex:"-1","aria-labelledby":"fileterModalLabel","aria-hidden":"true"},Fe={class:"modal-dialog modal-lg"},Se={class:"modal-content"},Ne={class:"modal-body"},Ue={class:"row"},Be={class:"col-6"},Le={class:"col-6"},Pe={class:"modal fade",id:"createDepartments",tabindex:"-1","aria-labelledby":"createDepartmentsLabel","aria-hidden":"true"},Re={class:"modal-dialog modal-lg"},qe={class:"modal-content"},Ie={class:"modal-body"},Me={class:"d-flex align-items-center"},Oe={class:"w-100"},Ae={key:0},je={class:"table mt-3 global-table"},Je={key:0},Te={key:1},He=["onChange"],Ge=["onClick"],Ke=["onClick"],Qe=["onClick"],We={class:"mt-2"},Xe={class:"modal fade",id:"viewCategory","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"viewCategoryLabel","aria-hidden":"true"},Ye={class:"modal-dialog"},Ze={class:"modal-content"},et={class:"modal-body"},tt={class:"table mt-3 global-table"},at={key:0},nt={key:1},st=["onChange"],lt=["onClick"],ot=["onClick"],dt=["onClick"],it={class:"modal-footer"},rt={__name:"DepartmentComp",setup(_){const r=M(()=>Ce.value);ve(()=>{oe()});const u=m(0),z=m([]);m(["yes","no"]);const $=m([]),w=m(""),b=m(null),p=m(""),G=m([]),f=m({ezy_departments_items:[]}),K=m([{name:"View Categories",icon:"fa-solid fa-eye"}]),C=m({limitPageLength:"None",limit_start:0}),Q=a=>{C.value.limitPageLength=a,C.value.limit_start=0,fetchTable()},W=([a,e])=>{C.value.limitPageLength=a,C.value.limit_start=e,fetchTable()};function X(a,e){e.name==="View Categories"&&(a?(h.get(`${k.resource}${g.departments}/${a.name}`).then(n=>{n.data&&(f.value=n.data,console.log(G.value))}).catch(n=>{console.error("Error fetching categories data:",n)}),new bootstrap.Modal(document.getElementById("viewCategory"),{}).show()):(console.warn("No form fields provided."),formCreation(a)))}const Y=m([{th:"Department Code",td_key:"department_code"},{th:"Department Name",td_key:"department_name"},{th:"Business Unit",td_key:"business_unit"},{th:"Status",td_key:"docstatus"}]),i=m({department_code:"",department_name:"",business_unit:"",ezy_departments_items:[]}),s=be({applieddepartment_name:!1,applieddepartment_code:!1,department_name:"",department_code:""}),F=M(()=>[{value:s.department_code,applied:s.applieddepartment_code},{value:s.department_name,applied:s.applieddepartment_name}].filter(a=>a.applied&&a.value).length);function Z(){s.value={department_name:"",department_code:""}}function S(a){a==="department_name"?(s.department_name="",s.applieddepartment_name=!1):a==="department_code"&&(s.department_code="",s.applieddepartment_code=!1),B()}fe(r,a=>{i.value.business_unit=a,a.length&&(console.log(a,"new value of business unit"),x())},{immediate:!0});function ee(){w.value&&(i.value.ezy_departments_items.push({category:w.value,parentfield:"ezy_departments_items"}),w.value="")}function te(a,e){b.value=a,p.value=e}function N(a){p.value.trim()&&(i.value.ezy_departments_items[a].category=p.value,b.value=null,p.value="")}function ae(a){i.value.ezy_departments_items.splice(a,1)}function ne(a,e){b.value=a,p.value=e}function U(a){p.value.trim()&&(f.value.ezy_departments_items[a].category=p.value,b.value=null,p.value="")}function se(a){f.value.ezy_departments_items.splice(a,1)}function le(){console.log(f.value,"---------------",f.value.name),h.put(`${k.resource}${g.departments}/${f.value.name}`,f.value).then(a=>{j.success("Changes Saved",{autoClose:500}),bootstrap.Modal.getInstance(document.getElementById("viewCategory")).hide(),console.log("Categories saved successfully:",a.data)}).catch(a=>{console.error("Error saving categories:",a)})}function B(){s.applieddepartment_code=!!s.department_code,s.applieddepartment_name=!!s.department_name,x()}const L=m([]);function x(){const a=[["business_unit","like",`%${i.value.business_unit}%`]];s.department_code&&a.push(["department_code","like",`%${s.department_code}%`]),s.department_name&&a.push(["department_name","like",`%${s.department_name}%`]);const e={fields:JSON.stringify(["*"]),filters:JSON.stringify(a),limit_page_length:C.value.limitPageLength,limit_start:C.value.limit_start,order_by:"`tabEzy Departments`.`creation` desc"},l={fields:JSON.stringify(["count( `tabEzy Departments`.`name`) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(a)};h.get(`${k.resource}${g.departments}`,{params:l}).then(n=>{u.value=n.data[0].total_count}).catch(n=>{console.error("Error fetching ezyForms data:",n)}),h.get(k.resource+g.departments,{params:e}).then(n=>{n.data&&(z.value=n.data,L.value=[...new Set(n.data.map(c=>c.department_name))])}).catch(n=>{console.error("Error fetching department data:",n)})}const oe=()=>{const a={fields:JSON.stringify(["*"])};h.get(k.resource+g.wfSettingEzyForms,{params:a}).then(e=>{var l;(l=e==null?void 0:e.data)!=null&&l.length&&($.value=e.data.map(n=>n.bu_code))}).catch(e=>{console.error("Error fetching ezyForms data:",e)})};function de(){i.value={department_code:"",department_name:"",ezy_departments_items:[]}}function ie(){const a=I(q({},i.value),{doctype:g.departments});console.log(a,"------------------"),h.post(k.resource+g.departments,a).then(e=>{e.data&&(j.success("Department Created",{autoClose:500}),x())})}return(a,e)=>(o(),d("div",null,[t("div",he,[e[26]||(e[26]=t("div",null,[t("h1",{class:"m-0 font-13"}," Departments ")],-1)),t("div",ke,[t("div",De,[t("div",null,[t("div",Ee,[s.department_name&&s.applieddepartment_name?(o(),d("span",Ve,[D(y(s.department_name)+" ",1),s.department_name?(o(),d("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:e[0]||(e[0]=l=>S("department_name"))},e[11]||(e[11]=[t("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):E("",!0)])):E("",!0),s.department_code&&s.applieddepartment_code?(o(),d("span",we,[D(y(s.department_code)+" ",1),s.department_code?(o(),d("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:e[1]||(e[1]=l=>S("department_code"))},e[12]||(e[12]=[t("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):E("",!0)])):E("",!0)])]),t("div",null,[t("button",ze,[e[13]||(e[13]=t("span",null,[t("i",{class:"ri-filter-2-line"})],-1)),F.value!==0?(o(),d("span",xe," ( "+y(F.value)+") ",1)):E("",!0)])])]),t("div",$e,[t("div",Fe,[t("div",Se,[t("div",Ne,[t("div",Ue,[t("div",Be,[e[14]||(e[14]=t("label",{class:"font-13 ps-1",for:"Requested"},"Department Code:",-1)),v(V,{class:"mb-3",tag:"input",type:"search",name:"Requested",id:"Requested",placeholder:"Search",modelValue:s.department_code,"onUpdate:modelValue":e[2]||(e[2]=l=>s.department_code=l)},null,8,["modelValue"])]),t("div",Le,[e[15]||(e[15]=t("label",{class:"font-13 ps-1 fw-medium",for:"dept"},"Requested Dept:",-1)),v(V,{tag:"select",placeholder:"Select Department",class:"mb-3",name:"dept",modelValue:s.department_name,"onUpdate:modelValue":e[3]||(e[3]=l=>s.department_name=l),id:"dept",Required:!1,options:L.value},null,8,["modelValue","options"])])])]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"cancelfilter border-0 text-nowrap font-10",onClick:Z,"data-bs-dismiss":"modal"},e[16]||(e[16]=[t("span",{class:"font-14 me-1"},"x",-1),D("Cancel Filter")])),t("button",{type:"button",class:"applyfilter text-nowrap border-0 btn btn-dark text-white font-10 d-flex justify-content-center align-items-center","data-bs-dismiss":"modal",onClick:B},e[17]||(e[17]=[t("span",{class:"font-16 me-1"},[t("i",{class:"bi bi-check2"})],-1),D(" Apply Filter")]))])])])]),e[25]||(e[25]=t("div",{class:"d-flex align-items-center"},[t("button",{type:"button",class:"btn btn-dark buttoncomp CreateDepartments d-flex align-items-center","data-bs-toggle":"modal","data-bs-target":"#createDepartments"}," Create Departments ")],-1)),t("div",Pe,[t("div",Re,[t("div",qe,[t("div",Ie,[e[20]||(e[20]=t("label",{class:"font-13 ps-1",for:"DepartmentCode"},"Department Code",-1)),v(V,{class:"mb-3",tag:"input",type:"text",name:"DepartmentCode",id:"DepartmentCode",placeholder:"Enter department code",modelValue:i.value.department_code,"onUpdate:modelValue":e[4]||(e[4]=l=>i.value.department_code=l)},null,8,["modelValue"]),e[21]||(e[21]=t("label",{class:"font-13 ps-1",for:"Requedepartment_namested"},"Department name",-1)),v(V,{class:"mb-3",tag:"input",type:"text",name:"department_name",id:"department_name",placeholder:"Enter department name",modelValue:i.value.department_name,"onUpdate:modelValue":e[5]||(e[5]=l=>i.value.department_name=l)},null,8,["modelValue"]),e[22]||(e[22]=t("label",{class:"font-13 ps-1",for:"business_unit"},"Business Unit",-1)),v(V,{tag:"select",placeholder:"",class:"mb-3",name:"business_unit",id:"business_unit",modelValue:i.value.business_unit,"onUpdate:modelValue":e[6]||(e[6]=l=>i.value.business_unit=l),options:$.value},null,8,["modelValue","options"]),t("div",Me,[t("div",Oe,[e[18]||(e[18]=t("label",{class:"font-13 ps-1",for:"ezy_departments_items"},"Ezy Departments Items",-1)),v(V,{class:"mb-3",tag:"input",type:"text",name:"ezy_departments_items",id:"ezy_departments_items",placeholder:"Enter category",modelValue:w.value,"onUpdate:modelValue":e[7]||(e[7]=l=>w.value=l)},null,8,["modelValue"])]),v(H,{class:"buttoncomp mt-2",name:"Add",onClick:ee})]),i.value.ezy_departments_items.length>0?(o(),d("div",Ae,[t("table",je,[e[19]||(e[19]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Category Name"),t("th",null,"Actions")])],-1)),t("tbody",null,[(o(!0),d(O,null,A(i.value.ezy_departments_items,(l,n)=>(o(),d("tr",{key:n},[t("td",null,y(n+1),1),b.value!==n?(o(),d("td",Je,y(l.category),1)):(o(),d("td",Te,[J(t("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=c=>p.value=c),onChange:c=>N(n),placeholder:"Edit Category"},null,40,He),[[T,p.value]])])),t("td",null,[b.value!==n?(o(),d("i",{key:0,class:"bi bi-pencil",onClick:c=>te(n,l.category)},null,8,Ge)):(o(),d("i",{key:1,class:"bi bi-check font-20",onClick:c=>N(n)},null,8,Ke)),t("i",{class:"bi bi-trash ms-2",onClick:c=>ae(n)},null,8,Qe)])]))),128))])])])):E("",!0)]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"cancelfilter border-1 text-nowrap font-10 d-flex justify-content-center align-items-center",onClick:de,"data-bs-dismiss":"modal"},e[23]||(e[23]=[t("span",{class:"font-16 me-1"},[t("i",{class:"bi bi-x"})],-1),D("Cancel ")])),t("button",{type:"button",class:"applyfilter btn btn-dark text-nowrap font-10 d-flex justify-content-center align-items-center","data-bs-dismiss":"modal",onClick:ie},e[24]||(e[24]=[t("span",{class:"font-16 me-1"},[t("i",{class:"bi bi-check2"})],-1),D(" Create Department")]))])])])])])]),t("div",We,[v(ge,{tHeaders:Y.value,tData:z.value,onActionClicked:X,isAction:"true",actions:K.value,actionType:"dropdown",isCheckbox:"true"},null,8,["tHeaders","tData","actions"]),v(ye,{currentRecords:z.value.length,totalRecords:u.value,onUpdateValue:Q,onLimitStart:W},null,8,["currentRecords","totalRecords"])]),t("div",Xe,[t("div",Ye,[t("div",Ze,[e[28]||(e[28]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"viewCategoryLabel"},"Ezy Departments Items"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",et,[t("table",tt,[e[27]||(e[27]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Category Name"),t("th",null,"Actions")])],-1)),t("tbody",null,[(o(!0),d(O,null,A(f.value.ezy_departments_items,(l,n)=>(o(),d("tr",{key:n},[t("td",null,y(n+1),1),b.value!==n?(o(),d("td",at,y(l.category),1)):(o(),d("td",nt,[J(t("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=c=>p.value=c),onChange:c=>U(n),placeholder:"Edit Category"},null,40,st),[[T,p.value]])])),t("td",null,[b.value!==n?(o(),d("i",{key:0,class:"bi bi-pencil",onClick:c=>ne(n,l.category)},null,8,lt)):(o(),d("i",{key:1,class:"bi bi-check font-20",onClick:c=>U(n)},null,8,ot)),t("i",{class:"bi bi-trash ms-2",onClick:c=>se(n)},null,8,dt)])]))),128))])])]),t("div",it,[v(H,{class:"btn btn-dark font-11",name:"Save Categories",onClick:e[10]||(e[10]=l=>le())})])])])])]))}},pt=_e(rt,[["__scopeId","data-v-cb0bd5cf"]]);export{pt as default};
