import{_ as J,r as s,x as K,E as Q,w as g,e as q,K as y,y as _,z as E,o as p,c as T,d as t,b,G as Y,P as Z,O as L,Z as W,L as X,m as w,t as S,H as U,U as P}from"./index-DcfVEAvB.js";import{Q as ee}from"./vue-quill.snow-BBIlSAzj.js";const te={class:"mt-2"},ae={class:"modal fade",id:"EmailTemplateModal","data-bs-backdrop":"static",tabindex:"-1","aria-labelledby":"EmailTemplateLabel","aria-hidden":"true"},le={class:"modal-dialog modal-lg modal-dialog-centered"},se={class:"modal-content"},oe={class:"modal-body"},ne={class:"modal-footer"},ie=["disabled"],de={class:"modal fade",id:"EmployeeToggleModal",tabindex:"-1","aria-hidden":"true"},me={class:"modal-dialog modal-dialog-centered"},ue={class:"modal-content"},re={class:"modal-body"},ce={class:"fw-bold"},pe={class:"fw-semibold"},be={class:"modal-footer"},ve={__name:"EmailTemplate",setup(fe){const C=s(0),V=s([]),u=s([]);s({ezy_departments_items:[]});const B=s([]),o=s({}),d=s(""),r=s(!1);function N(){r.value=!0,o.value={},d.value=""}function I(){const a={__newname:o.value.name,subject:o.value.subject,response:d.value,doctype:y.emailTemplate};_.post(E.DataUpdate,a).then(e=>{e.message.success==!0?(bootstrap.Modal.getInstance(document.getElementById("EmailTemplateModal")).hide(),U("Email Template Create successfully"),r.value=!1,m()):P(response.message.message)})}function F(){const a={response:d.value,name:o.value.name,subject:o.value.subject,doctype:y.emailTemplate};_.put(`${E.DataUpdate}/${k.value.name}`,a).then(e=>{e.message.success==!0?(U("Email Template Updated successfully"),m(),bootstrap.Modal.getInstance(document.getElementById("EmailTemplateModal")).hide()):P(e.message.message)}).catch(e=>{console.error("Error updating toggle:",e)})}const k=s(""),v=s(0);function h(){o.value={},d.value="",r.value=!1,v.value++}function R(a){o.value.name=a.name||"",o.value.subject=a.subject||"",d.value=a.response||"",k.value=a,v.value=Date.now(),new bootstrap.Modal(document.getElementById("EmailTemplateModal")).show()}const j=s({}),x=s("");function O(a){j.value=a;const e=a.enable===0;x.value=e?"Enable":"Disable",new bootstrap.Modal(document.getElementById("EmployeeToggleModal")).show()}const z=K(()=>Q.value),n=s({limitPageLength:20,limit_start:0,filters:[]}),c=s({department_code:"",department_name:""}),D=s([{th:"Name",td_key:"name"},{th:"Subject",td_key:"subject"}]),A=s({}),f=s({department_code:"",department_name:"",business_unit:"",ezy_departments_items:[]});g(()=>f.value.department_code,a=>{const e=a.trim().toLowerCase();V.value.filter(i=>i!==null).map(i=>i.trim().toLowerCase()).includes(e)?c.value.department_code="Department code already exists.":c.value.department_code=""}),g(()=>f.value.department_name,a=>{const e=a.trim().toLowerCase();B.value.filter(i=>i!==null).map(i=>i.trim().toLowerCase()).includes(e)?c.value.department_name="Department name already exists.":c.value.department_name=""}),q({applieddepartment_name:!1,applieddepartment_code:!1,department_name:"",department_code:""}),g(z,a=>{f.value.business_unit=a,a.length&&m()},{immediate:!0});const M=s(null);function G(a){clearTimeout(M.value),M.value=setTimeout(()=>{n.value.filters=[],D.value.forEach(e=>{const l=e.td_key;a[l]&&n.value.filters.push([l,"like",`%${a[l]}%`])}),n.value.filters.length?m(n.value.filters):m()},500)}const H=a=>{n.value.limitPageLength=a,n.value.limit_start=0,m()},$=([a,e])=>{n.value.limitPageLength=a,n.value.limit_start=e,m()};function m(a){a&&n.value.filters.push(...a);const e={fields:JSON.stringify(["name","subject","response_html","response"]),filters:JSON.stringify(n.value.filters),limit_page_length:n.value.limitPageLength,limit_start:n.value.limit_start,doctype:y.emailTemplate,order_by:"`tabEmail Template`.`creation` desc"};_.get(E.GetDoctypeData,{params:e}).then(l=>{if(l.message){C.value=l.message.total_count;const i=l.message.data;n.value.limit_start===0?u.value=i:u.value=u.value.concat(i)}}).catch(l=>{console.error("Error fetching department data:",l)})}return(a,e)=>(p(),T("div",null,[t("div",{class:"d-flex justify-content-between align-items-center py-2"},[e[4]||(e[4]=t("div",null,[t("h1",{class:"mt-3 font-13"}," Email Template ")],-1)),t("div",{class:"d-flex gap-2 align-items-center"},[t("div",{class:"d-flex align-items-center"},[t("button",{type:"button",class:"btn btn-dark CreateDepartments","data-bs-toggle":"modal","data-bs-target":"#EmailTemplateModal",onClick:N}," Create Email Template ")])])]),t("div",te,[b(Y,{tHeaders:D.value,tData:u.value,enableDisable:"true",isAction:"true",viewType:"viewPdf",isFiltersoption:"true",onCellClick:R,"field-mapping":A.value,onUpdateFilters:G,onToggleClick:O},null,8,["tHeaders","tData","field-mapping"]),b(Z,{currentRecords:u.value.length,totalRecords:C.value,onUpdateValue:H,onLimitStart:$},null,8,["currentRecords","totalRecords"])]),t("div",ae,[t("div",le,[t("div",se,[t("div",{class:"modal-header"},[e[5]||(e[5]=t("h5",{class:"modal-title",id:"EmailTemplateLabel"},"Email Template",-1)),t("button",{onClick:h,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]),t("div",oe,[e[6]||(e[6]=t("label",{for:"password",class:"font-13"},"Name",-1)),e[7]||(e[7]=t("br",null,null,-1)),b(L,{tag:"input",type:"text",name:"name",id:"name",placeholder:"Enter Name",class:"mb-4",modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.name=l),modelModifiers:{trim:!0}},null,8,["modelValue"]),e[8]||(e[8]=t("label",{for:"password",class:"font-13"},"Subject",-1)),e[9]||(e[9]=t("br",null,null,-1)),b(L,{tag:"input",type:"text",name:"Subject",id:"Subject",placeholder:"Enter Subject",class:"mb-4",modelValue:o.value.subject,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.subject=l),modelModifiers:{trim:!0}},null,8,["modelValue"]),e[10]||(e[10]=t("label",{for:"password",class:"font-13"},"Template",-1)),e[11]||(e[11]=t("br",null,null,-1)),(p(),W(X(ee),{content:d.value,"onUpdate:content":e[2]||(e[2]=l=>d.value=l),key:v.value,contentType:"html",theme:"snow",style:{height:"300px"}},null,8,["content"]))]),t("div",ne,[t("button",{onClick:h,type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," Close "),r.value?(p(),T("button",{key:0,disabled:!o.value.name||!o.value.subject||!d.value,type:"button",class:"btn btn-dark",onClick:I}," Submit ",8,ie)):(p(),T("button",{key:1,type:"button",class:"btn btn-dark",onClick:F}," Update "))])])])]),t("div",de,[t("div",me,[t("div",ue,[e[16]||(e[16]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Confirm Acknowledgement Status"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",re,[e[12]||(e[12]=w(" Are you sure you want to ")),t("span",ce,S(x.value),1),e[13]||(e[13]=w(' "')),t("span",pe,S(j.value.name),1),e[14]||(e[14]=w('"? '))]),t("div",be,[e[15]||(e[15]=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-dark","data-bs-dismiss":"modal",onClick:e[3]||(e[3]=(...l)=>a.confirmEmployeeToggle&&a.confirmEmployeeToggle(...l))},"Yes, Proceed")])])])])]))}},_e=J(ve,[["__scopeId","data-v-3dbf7b36"]]);export{_e as default};
