import{_ as O,r as s,u as $,L as A,e as F,E as q,I as J,w as U,f as p,g as _,h as k,o as V,c as z,d as t,b as S,G as R,l as v,t as G,M as Y,p as K}from"./index-DxID15hf.js";const Q={class:"mt-2"},W={class:"modal fade",id:"pdfView",tabindex:"-1","aria-labelledby":"pdfViewLabel","aria-hidden":"true"},X={class:"modal-dialog modal-xl"},Z={class:"modal-content"},ee={class:"d-block modal-header bg-dark text-white py-2"},te={class:"d-flex align-items-center justify-content-between"},oe={class:""},se={class:"modal-body"},ae=["innerHTML"],ne={class:"modal fade",id:"FormSetupModal",tabindex:"-1","aria-hidden":"true"},le={class:"modal-dialog modal-dialog-centered"},ie={class:"modal-content"},re={class:"modal-body"},de={class:"text-center"},me={class:"modal-footer"},ue={__name:"PreDefineForms",setup(ce){const x=s(0),D=s(""),l=s(""),P=s([]);s([]);const C=s([]),b=s({}),r=s([]),u=$(),I=s(""),h=A(),N=s(null),E=s([]),M=s([]),d=F(()=>q.value);J([]);const c=s({limit_start:0,limitPageLength:20,form_name:"",form_short_name:"",accessible_departments:"[]",business_unit:"",form_category:"",owner_of_the_form:"",search:""}),g=s([{th:"Form name",td_key:"form_name"},{th:"Installed",td_key:"installed"}]);U(d,o=>{c.value.business_unit=o,o.length&&(I.value=o,r.value=[],w())},{immediate:!0});function L(o,e,a){l.value=o,a==="edit"&&l.value.installed==="No"&&new bootstrap.Modal(document.getElementById("FormSetupModal"),{}).show(),a==="FormPreview"&&h.push({name:"FormPreviewComp",query:{routepath:u.path,form_short_name:o.form_name,business_unit:d.value}})}function T(){bootstrap.Modal.getInstance(document.getElementById("FormSetupModal")).hide(),h.push({name:"FormStepper",query:{routepath:u.path,preId:"PreDefine",business_unit:d.value,form_name:l.value.form_name,preName:l.value.name}}),localStorage.setItem("form_json",l.value.form_json),localStorage.setItem("preName",l.value.name),localStorage.setItem("routepath",u.path)}function j(){const o={form_short_name:b.value.form_short_name,name:null,business_unit:d.value};p.post(_.download_pdf_form,o).then(e=>{let a=K+e.message;a=a.replace("/api","");const n=document.createElement("a");n.href=a,n.download=e.message.split("/").pop(),n.click()}).catch(e=>{console.error("Error fetching data:",e)})}const y=s(null);function H(o){clearTimeout(y.value),y.value=setTimeout(()=>{const e=[];g.value.forEach(a=>{const n=a.td_key;o[n]&&e.push([n,"like",`%${o[n]}%`])}),w(e.length?e:void 0)},500)}function w(o){const e=[];o&&e.push(...o);const a={fields:JSON.stringify(["form_name","installed","form_json","name"]),filters:JSON.stringify(e),limit_page_length:"None",limit_start:c.value.limit_start,order_by:"`installed` DESC"},n={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(e)};p.get(`${_.resource}${k.preDefinedForm}`,{params:n}).then(i=>{x.value=i.data[0].total_count}).catch(i=>{console.error("Error fetching ezyForms data:",i)}),p.get(`${_.resource}${k.preDefinedForm}`,{params:a}).then(i=>{const m=i.data;c.value.limit_start===0?(r.value=m,P.value=[...new Set(m.map(f=>f.form_category))],C.value=[...new Set(m.map(f=>f.owner_of_the_form))]):r.value=r.value.concat(m)}).catch(i=>{console.error("Error fetching ezyForms data:",i)})}const B=F(()=>({form_name:{type:"input"},installed:{type:"input"}}));return(o,e)=>(V(),z("div",null,[e[10]||(e[10]=t("div",{class:"d-flex formsticky align-items-center justify-content-between py-2"},[t("div",null,[t("h1",{class:"m-0 font-13 py-2"},"Form Template")])],-1)),t("div",Q,[S(R,{tHeaders:g.value,tData:r.value,isAction:"true",view:"edit",onCellClick:L,isFiltersoption:"true","field-mapping":B.value,actions:M.value,onUpdateFilters:H,isCheckbox:"true"},null,8,["tHeaders","tData","field-mapping","actions"])]),t("div",W,[t("div",X,[t("div",Z,[t("div",ee,[t("div",te,[e[4]||(e[4]=t("div",null,[t("h5",{class:"m-0 text-white font-13",id:"exampleModalLabel"}," PDF format ")],-1)),t("div",oe,[t("button",{button:"button",class:"btn btn-dark text-white font-13",onClick:j},e[2]||(e[2]=[v("Download Pdf"),t("span",{class:"ms-2"},[t("i",{class:"bi bi-download"})],-1)])),t("button",{type:"button",class:"btn btn-dark text-white font-13",onClick:e[0]||(e[0]=(...a)=>o.closemodal&&o.closemodal(...a)),"data-bs-dismiss":"modal"},e[3]||(e[3]=[v("Close "),t("i",{class:"bi bi-x"},null,-1)]))])])]),t("div",se,[t("div",{innerHTML:D.value},null,8,ae)]),e[5]||(e[5]=t("div",{class:"modal-footer"},null,-1))])])]),t("div",ne,[t("div",le,[t("div",ie,[e[9]||(e[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Form Setup"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",re,[t("div",de,[e[6]||(e[6]=v(" Are you sure you want to set up the ")),t("strong",null,G(l.value.form_name),1),e[7]||(e[7]=t("br",null,null,-1))])]),t("div",me,[e[8]||(e[8]=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-dark",onClick:e[1]||(e[1]=a=>T())}," Yes, Proceed ")])])])]),S(Y,{blockArr:N.value,formDescriptions:b.value,childHeaders:E.value},null,8,["blockArr","formDescriptions","childHeaders"])]))}},pe=O(ue,[["__scopeId","data-v-db1f17f4"]]);export{pe as default};
