var Sl=Object.defineProperty,ql=Object.defineProperties;var Al=Object.getOwnPropertyDescriptors;var dt=Object.getOwnPropertySymbols;var Ht=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable;var jt=(M,C,A)=>C in M?Sl(M,C,{enumerable:!0,configurable:!0,writable:!0,value:A}):M[C]=A,te=(M,C)=>{for(var A in C||(C={}))Ht.call(C,A)&&jt(M,A,C[A]);if(dt)for(var A of dt(C))Jt.call(C,A)&&jt(M,A,C[A]);return M},ye=(M,C)=>ql(M,Al(C));var wt=(M,C)=>{var A={};for(var F in M)Ht.call(M,F)&&C.indexOf(F)<0&&(A[F]=M[F]);if(M!=null&&dt)for(var F of dt(M))C.indexOf(F)<0&&Jt.call(M,F)&&(A[F]=M[F]);return A};var Ve=(M,C,A)=>new Promise((F,re)=>{var le=G=>{try{v(A.next(G))}catch(ne){re(ne)}},Ce=G=>{try{v(A.throw(G))}catch(ne){re(ne)}},v=G=>G.done?F(G.value):Promise.resolve(G.value).then(le,Ce);v((A=A.apply(M,C)).next())});import{_ as It,r as h,x as se,o as r,c as d,d as s,i as D,j as O,F as L,h as T,t as b,u as Vl,M as El,e as oe,E as Ll,w as we,f as Tl,a6 as Wt,K as ce,y as z,z as H,L as $,l as _,a7 as Ul,m as S,n as N,Z as Zt,S as Gt,b as X,O as We,B as Yt,R as Ee,Q as Kt,X as ie,v as ut,N as Le,k as Te,a8 as Qt,a9 as Ml,U as ae,H as pe,aa as kt,a2 as Ol,ab as Xt,D as xt,ac as Rl}from"./index-Dfr1Ik7C.js";const Bl="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",zl={class:"simple-field-library"},Nl={class:"field-search"},Pl={class:"field-types-grid"},jl=["onDragstart","onClick"],Hl={__name:"SimpleFieldLibrary",props:{fields:{type:Array,required:!0}},emits:["field-add","field-dragstart","field-dragend"],setup(M,{emit:C}){const A=M,F=C,re=h(""),le=h(!1),Ce=se(()=>{if(!re.value)return A.fields;const E=re.value.toLowerCase();return A.fields.filter(I=>I.label.toLowerCase().includes(E))}),v=(E,I)=>{le.value=!0,E.dataTransfer.effectAllowed="copy",E.dataTransfer.setData("text/plain",I.type),F("field-dragstart",I.type)},G=()=>{le.value=!1,F("field-dragend")},ne=E=>{F("field-add",E.type)};return(E,I)=>(r(),d("div",zl,[s("div",Nl,[I[1]||(I[1]=s("i",{class:"bi bi-search"},null,-1)),D(s("input",{"onUpdate:modelValue":I[0]||(I[0]=Y=>re.value=Y),type:"text",placeholder:"Search fields",class:"search-input"},null,512),[[O,re.value]])]),s("div",Pl,[(r(!0),d(L,null,T(Ce.value,Y=>(r(),d("button",{key:Y.type,class:"field-type-btn",draggable:!0,onDragstart:K=>v(K,Y),onDragend:G,onClick:K=>ne(Y)},b(Y.label),41,jl))),128))])]))}},Jl=It(Hl,[["__scopeId","data-v-cb64d6f9"]]),Wl={class:""},Zl={class:""},Gl={class:"d-flex justify-content-between align-items-center CancelNdSave"},Yl={class:"d-flex align-items-center"},Kl={key:0,class:"font-16"},Ql=["disabled"],Xl={class:"form-container p-0 container-fluid mt-3"},xl={class:"row g-4"},Il={class:"col-lg-2 col-md-3 col-sm-12"},eo={class:"steps-sticky-div"},to={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},so=["onClick"],lo={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},oo={class:"step-text"},ao={class:"font-11"},no={class:"font-14"},io={class:"col-lg-10 col-md-9 col-sm-12 formbackground-color"},ro={class:"px-2"},uo={class:"form-content stepsDiv"},co={key:0},po={class:""},fo={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},mo={class:"container-fluid aboutFields p-0"},vo={class:"row"},_o={class:"col-sm-12 col-md-12 mt-lg-3 p-lg-4"},ho={class:"container-fluid"},bo={class:"row g-3"},go={class:"col-md-6"},yo={class:"position-relative"},wo={key:0,class:"font-12 position-absolute PredefinedLabel"},ko={key:1,class:"text-danger ErrorMsg ms-2"},Co={class:"col-md-6"},Do={key:0,class:"text-danger ErrorMsg ms-2"},Fo={class:"col-md-6"},$o={class:"col-md-6"},So={key:0,class:"text-danger"},qo={class:"col-md-6"},Ao={key:0,class:"text-danger"},Vo={class:"col-md-6"},Eo={key:0,class:"text-danger"},Lo={class:"custom-option"},To=["checked","onChange"],Uo={class:"col-md-6"},Mo={class:"col-md-6"},Oo={key:0,class:"col-md-6"},Ro={key:1,class:"col-md-6"},Bo={key:2,class:"col-md-6"},zo={key:3,class:"col-md-6"},No={class:"form-check d-flex align-items-center p-0 pe-3"},Po=["disabled"],jo={key:4,class:"col-md-6"},Ho=["disabled"],Jo={key:0,class:"list-group position-absolute w-100 z-3 formslist"},Wo=["onMousedown"],Zo={key:1,class:"zoho-form-builder mt-4"},Go={class:"zoho-toolbar"},Yo={class:"toolbar-left"},Ko={class:"zoho-tabs"},Qo=["onClick"],Xo=["onClick"],xo={class:"toolbar-right"},Io={class:"zoho-builder-container"},ea={class:"d-flex align-items-center justify-content-between w-100"},ta={class:"mb-0 font-14 fw-bold"},sa={class:"btn btn-sm btn-link p-0 text-dark"},la={key:0,class:"library-content"},oa={class:"zoho-form-canvas"},aa={class:"requestandAppHeader"},na={class:"d-flex justify-content-between align-items-center"},ia={class:""},ra={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},da={class:"text-center ms-2 mt-1"},ua={key:0,class:"font-12 d-flex align-items-center"},ca={class:"font-12 approver_type_div"},pa={class:"font-12 fw-bold"},fa={class:"font-12 text-danger ms-1"},ma={class:"d-flex align-items-center"},va={key:0,class:"role-container"},_a={key:0,class:"role-text d-flex align-items-center"},ha={class:"role-label fw-bold"},ba={class:"role-names"},ga=["onClick"],ya=["onClick"],wa=["onClick"],ka=["onClick"],Ca={class:"pt-0 section_block"},Da={class:"d-flex justify-content-between align-items-center"},Fa={class:"d-flex flex-column"},$a=["onUpdate:modelValue","onChange","onInput"],Sa={key:0,class:"text-danger ps-3 font-10"},qa={class:"d-flex align-items-center"},Aa=["onClick"],Va={class:"container-fluid"},Ea={class:"d-flex justify-content-between align-items-center"},La={class:"rownames m-0"},Ta=["onClick"],Ua={class:"col"},Ma={class:"row"},Oa=["onMouseenter"],Ra={class:"column_name d-flex align-items-center justify-content-between"},Ba={class:"d-flex flex-column ps-2"},za=["onUpdate:modelValue","onChange","onInput"],Na={key:0,class:"text-danger ps-2 font-10"},Pa={class:"position-absolute top-0 end-0"},ja=["onClick"],Ha=["onDrop"],Ja=["onMouseenter","onDragstart","onDrop"],Wa=["onDrop"],Za=["onDragstart","onDrop"],Ga={class:"d-flex justify-content-between"},Ya={class:"flex-column d-flex"},Ka=["onUpdate:modelValue","onChange","onInput"],Qa={key:0,class:"text-danger font-10"},Xa={class:"FieldcopyRemove"},xa=["onClick"],Ia=["onClick"],en=["onUpdate:modelValue","onChange"],tn=["value"],sn={key:0},ln=["onUpdate:modelValue"],on={key:0,class:"text-danger font-10"},an={key:1},nn=["for"],rn=["id","onUpdate:modelValue","onInput","onFocus"],dn={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},un=["onClick"],cn={class:"d-flex align-items-center justify-content-between"},pn={class:"d-flex align-items-center gap-2"},fn={class:"d-flex align-items-center"},mn=["onUpdate:modelValue","id"],vn=["for"],_n=["onClick"],hn=["onUpdate:modelValue"],bn={key:3,class:"text-danger font-10"},gn=["onDrop"],yn={class:"childtableShow"},wn={class:"mt-2"},kn={key:0,class:"childTableContainer"},Cn={key:0,class:"font-13"},Dn={key:1,class:"d-flex align-items-center gap-2"},Fn={class:"d-flex align-items-center"},$n=["onUpdate:modelValue"],Sn=["onClick"],qn={key:2,class:"table table-bordered rounded-table"},An=["onDrop"],Vn=["draggable","onDragstart"],En={key:0},Ln=["onUpdate:modelValue","onInput"],Tn={key:0,class:"text-danger font-11"},Un={key:1},Mn={key:2},On={class:"d-flex gap-1"},Rn=["onUpdate:modelValue","onChange"],Bn=["value"],zn={class:"d-flex"},Nn={class:"d-flex align-items-center gap-2"},Pn={class:"d-flex align-items-center"},jn=["onUpdate:modelValue"],Hn=["onClick"],Jn={key:0},Wn=["onUpdate:modelValue","onInput"],Zn={key:0,class:"text-danger font-10"},Gn={key:1,class:"font-11 text-danger"},Yn={key:3},Kn={key:3,class:"mb-2 mt-3"},Qn=["onClick"],Xn=["onClick"],xn=["onDrop"],In=["onDrop"],ei={class:"d-flex justify-content-center align-items-center my-2"},ti=["onClick"],si={class:"font-13"},li={key:0,class:"d-flex align-items-center gap-2"},oi={class:"d-flex align-items-center"},ai=["onUpdate:modelValue"],ni=["onClick"],ii={class:"table table-bordered rounded-table"},ri={key:0},di=["onUpdate:modelValue","onBlur"],ui={key:0,class:"text-danger font-11 mt-1"},ci={key:1},pi={key:2},fi={class:"d-flex gap-1 align-items-center"},mi=["onUpdate:modelValue","onChange"],vi=["value"],_i=["onClick"],hi={key:0,class:"mt-1"},bi=["onUpdate:modelValue","onInput"],gi={key:1,class:"text-danger font-11 mt-1"},yi={key:3},wi={class:"mb-2"},ki=["onClick"],Ci=["onClick"],Di=["onClick"],Fi={key:0},$i={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},Si=["onUpdate:modelValue","onBlur"],qi={key:0,class:"text-danger font-12"},Ai={key:1,class:"text-danger font-12"},Vi={class:"d-flex align-items-center gap-2"},Ei={class:"d-flex align-items-center"},Li=["onUpdate:modelValue"],Ti=["onClick"],Ui=["onClick"],Mi={class:"px-1 field-border"},Oi={class:"d-flex justify-content-between"},Ri=["onUpdate:modelValue","onBlur"],Bi={key:0,class:"text-danger font-12"},zi={class:"d-flex align-items-center"},Ni={class:"d-flex my-1"},Pi=["onUpdate:modelValue"],ji=["onClick"],Hi=["onClick"],Ji=["onUpdate:modelValue"],Wi=["value"],Zi={key:0},Gi=["onUpdate:modelValue"],Yi={key:0,class:"text-danger font-10"},Ki={key:1,class:"text-danger font-12"},Qi=["onClick"],Xi=["onClick"],xi={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},Ii=["onClick"],er={key:0,class:"m-2"},tr={key:0,class:"zoho-properties-panel"},sr={class:"properties-header"},lr={key:2},or={class:"stepperbackground d-flex align-items-center justify-content-between p-3"},ar={key:3},nr={class:"stepperbackground d-flex align-items-center justify-content-between p-3"},ir={key:4},rr={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},dr={class:"modal-dialog modal-dialog-centered"},ur={class:"modal-content"},cr={class:"modal-body"},pr=["placeholder"],fr={class:"d-flex align-items-center gap-2"},mr={class:"d-flex align-items-center py-2"},vr={class:"modal fade",id:"formViewModal",tabindex:"-1","aria-labelledby":"formViewModalLabel","aria-hidden":"true"},_r={class:"modal-dialog modal-xl modal-dialog-scrollable"},hr={class:"modal-content"},br={class:"modal-body"},gr={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},yr={class:"offcanvas-header add_designationHeader"},wr={id:"offcanvasRightLabel",class:"font-14 fw-bold"},kr={class:"offcanvas-body add_desig_offCanvas_body p-0"},Cr={class:""},Dr={class:""},Fr={key:0,class:"p-3 approval-border-bottom"},$r={key:0,class:""},Sr={class:"px-3 listofdesignations"},qr={class:"my-1 d-flex justify-content-between"},Ar={class:"font-12 fw-bold"},Vr={class:"italic-style text-secondary font-12"},Er={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},Lr={class:"d-flex align-items-center justify-content-between gap-1"},Tr={class:"form-check ps-1 d-flex align-items-center m-0"},Ur=["checked"],Mr={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},Or={key:0,class:"form-check d-flex align-items-center m-0"},Rr={key:1},Br={key:0,class:"p-3"},zr=["value"],Nr={key:1},Pr={class:""},jr={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},Hr={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},Jr={class:"offcanvas-footer"},Wr={class:"text-end p-3"},ke="Select All",Zr={__name:"FormStepper",setup(M){const C=Vl(),A=El(),F=h(1),re=h([]);h([]);const le=h([]),Ce=h([]);oe([]);let v=oe([]),G=oe([]);const ne=h([]),E=h([]),I=h([]),Y=h(""),K=h(""),R=h("");let J=oe([]);const Ue=h("");h(!1),h(!1),h(!1);const De=h(""),Ze=h(""),Ge=h(""),es=h([]),ts=h([]),q=oe({}),ee=h([]),ct=h(!1),Ye=h([]),Ke=h(!1);let Ct=null;const ss=h("");let U=h("");const ve=h(null),Dt=h(null),Fe=h(!0),Qe=h(0),Xe=h([]),Ft=h(null),$e=se(()=>Ll);h(!1);const xe=oe([]),x=h({routepath:C.query.routepath,business_unit:C.query.business_unit,formId:C.query.id}),Ie=h(""),Se=h(!1),qe=h(!1),$t=[{label:"Public",value:1},{label:"Private",value:0}],St=se({get(){return $t.find(t=>t.value===m.value.as_web_view)},set(t){m.value.as_web_view=t?t.value:null}}),qt=se({get(){return m.value.form_name||C.query.form_name||""},set(t){m.value.form_name=t}}),m=h({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${$e.value.value||x.value.business_unit||C.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:C.query.id?1:0,as_web_view:0,mail_id:""});we(()=>C.query.form_name,t=>{t&&(m.value.form_name=t,m.value.form_short_name=t)},{immediate:!0});const et=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(t=>t.toLowerCase().trim()),At=["Approver","Approved on","Approved By"].map(t=>t.toLowerCase().trim());function ls(t){return t.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}se(()=>m.value),h(""),h(!1),we($e,t=>{t&&t.value&&(m.value.business_unit=t.value)},{immediate:!0});function os(t){if(U==null||U==="new")return!1;const e=B(t).roles;if(t===0)return e.length===0;const l=B(t-1).roles;return l.length>0&&l[0]!==null&&l[0]!==""&&e.length===0}we(()=>m.value.form_name,t=>{m.value.form_name=t.trim()}),we(()=>m.value.form_short_name,t=>{m.value.form_short_name=t.trim()}),we(()=>m.value.series,t=>{m.value.series=t.trim()});const Me=h(null),Vt=(t,e,l,o,n,a)=>{Me.value={blockIndex:e,sectionIndex:l,rowIndex:o,columnIndex:n,fieldIndex:a}},_e=(t,e,l,o,n,a)=>{if(t.preventDefault(),t.stopPropagation(),console.log("Field dropped at index:",{targetBlock:e,targetSection:l,targetRow:o,targetColumn:n,insertIndex:a,draggedField:Me.value,draggedFieldType:ve.value}),ve.value){console.log("Dropping from field library:",ve.value);const g=Pt(ve.value);if(!g){console.error("Failed to create field from type:",ve.value);return}const k=v[e];if(!k){ae("Target block not found");return}k.sections||(k.sections=[]),k.sections[l]||(k.sections[l]={label:"",rows:[]}),k.sections[l].rows||(k.sections[l].rows=[]),k.sections[l].rows[o]||(k.sections[l].rows[o]={label:"",columns:[]}),k.sections[l].rows[o].columns||(k.sections[l].rows[o].columns=[]),k.sections[l].rows[o].columns[n]||(k.sections[l].rows[o].columns[n]={label:"",fields:[]}),k.sections[l].rows[o].columns[n].fields.splice(a,0,g),console.log("Field added successfully:",g),pe(`${g.label} field added`),ve.value=null;return}if(!Me.value){console.log("No dragged field found");return}const{blockIndex:i,sectionIndex:c,rowIndex:f,columnIndex:u,fieldIndex:p}=Me.value,w=v[i].sections[c].rows[f].columns[u].fields,V=v[e].sections[l].rows[o].columns[n].fields;if(i===e&&c===l&&f===o&&u===n&&p===a)return;const y=w.splice(p,1)[0];w===V&&p<a&&a--,V.splice(a,0,y),Me.value=null},Ae=h(""),as=t=>Ve(this,null,function*(){const e=[["module","in",["User Forms"]],["istable","=",1]];t!=null&&t.trim()&&e.push(["name","=",`${t}`]);const l={fields:JSON.stringify(["name"]),filters:JSON.stringify(e),limit_page_length:"None",doctype:ce.doctypesList};try{return(yield z.get(H.GetDoctypeData,{params:l})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),tt=h(null),Et=t=>Ve(this,null,function*(){if(Ae.value="",tt.value=null,t.tableName){let e=t.tableName.trim();if(e.length>64){Ae.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(e)){Ae.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield as(e);tt.value=o.find(n=>n.name.toLowerCase()===e.toLowerCase()),tt.value&&(Ae.value="Table already exists"),t.tableName=e}t.label&&(t.fieldname=ls(t.label))});function ns(){const t=m.value.is_linked_form;if(!t){Ye.value=[];return}clearTimeout(Ct),Ct=setTimeout(()=>{const e=[["business_unit","=",`${$e.value.value}`],["name","like",`%${t}%`]],l={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(e),doctype:ce.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};z.get(`${H.GetDoctypeData}`,{params:l}).then(o=>{Ye.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function is(t){m.value.is_linked_form=t,Ke.value=!1}function rs(){setTimeout(()=>{Ke.value=!1},200)}oe({query:"",key:""});function fe(t,e,l,o,n){return`${t}-${e}-${l}-${o}-${n}`}oe({});const Oe=oe({}),pt=oe({});function ds(t){pt[t]=!0}function us(t,e,l,o,n,a){const i=fe(e,l,o,n,a),c=[["istable","=",0]];t!=null&&t.trim()&&c.push(["name","like",`%${t}%`]);const f={fields:JSON.stringify(["name"]),filters:JSON.stringify(c),limit_page_length:"none",doctype:ce.doctypesList};z.get(H.GetDoctypeData,{params:f}).then(u=>{Oe[i]=u.message.data||[]}).catch(u=>{console.error("Error fetching doctype list:",u),Oe[i]=[]})}function cs(t,e,l,o,n,a){v[t].sections[e].rows[l].columns[o].fields[n].options=a;const i=fe(t,e,l,o,n);Oe[i]=[],pt[i]=!1}const ps=se(()=>v!=null&&v.length?R.value===1?[0]:Array.from({length:R.value},(t,e)=>e).filter(t=>t<R.value):[]),me=h(null),he=h(null),fs=(t,e,l,o,n)=>{me.value={blockIndex:t,sectionIndex:e,rowIndex:l,columnIndex:o,fieldIndex:n}},ms=()=>{me.value=null},vs=(t,e,l,o,n)=>me.value&&me.value.blockIndex===t&&me.value.sectionIndex===e&&me.value.rowIndex===l&&me.value.columnIndex===o&&me.value.fieldIndex===n,_s=(t,e,l,o)=>{he.value={blockIndex:t,sectionIndex:e,rowIndex:l,columnIndex:o}},hs=()=>{he.value=null},bs=(t,e,l,o)=>he.value&&he.value.blockIndex===t&&he.value.sectionIndex===e&&he.value.rowIndex===l&&he.value.columnIndex===o,Lt=h([{form_json:""}]),be=h("");Tl(()=>{Ot(),be.value=C.query.Clone,U.value=C.query.id||"new",be.value==="1"&&(m.value.series=""),U.value!=null&&U.value!=null&&U.value!="new"&&(Mt(),ht()),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?ct.value=!0:ct.value=!1;let t=localStorage.getItem("Bu");if(m.value.business_unit=t,C.query.preId==="PreDefine"){const e=localStorage.getItem("form_json");if(e){Lt.value[0].form_json=e;const l=Lt.value[0],o=JSON.parse(l.form_json),n=Wt(o.fields);ee.value=o.child_table_fields,n.forEach(a=>{v.push(a)})}}});const ge=h(null),W=oe({}),Tt=h(null),gs=t=>{ge.value=t},ys=()=>{ge.value=null},ws=t=>{t.preventDefault()},ks=(t,e)=>{const l=t.target.closest("tr");if(!l)return;const o=Array.from(l.parentNode.children).indexOf(l);if(o!==ge.value){const n=e[ge.value];e.splice(ge.value,1),e.splice(o,0,n),ge.value=o}},Cs=h([]),ft=t=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(t.fieldtype)&&t.options){const e=t.options.split(`
`).map(n=>n.trim()).filter(n=>n),l=[],o=new Set;return e.forEach(n=>{const a=n.toLowerCase();o.has(a)||(o.add(a),l.push(n))}),`
`+l.join(`
`)}else if(["Link","Table"].includes(t.fieldtype)&&t.options)return t.options.trim();return t.options},Ds=(t,e)=>{const l=v[t].sections[e];l.childTables||(l.childTables=[]);const o=l.childTables.length;l.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[te({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},xe.fieldtype==="Select"&&xe.options?{options:xe.options?`
${xe.options}`:`
`}:{})],newTable:!0})},Fs=(t,e,l)=>{const o=v[t].sections[e].childTables[l];o.columns||(o.columns=[]),o.columns.push(te({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},$s=(t,e,l)=>{v[t].sections[e].childTables.splice(l,1)},Ss=(t,e,l,o)=>{v[t].sections[e].childTables[l].columns.splice(o,1)};function qs(t,e,l,o,n,a){var u;const i=`${e}-${l}-${o}`;q[i]||(q[i]={columns:[]});const c={},f=((u=t.label)==null?void 0:u.trim())||"";if(!f)c.label="Field Label is required";else{const p=f.toLowerCase();if(et.includes(p)&&!At.includes(p))c.label=`"${f}" is a restricted field label`;else if(f.length>64)c.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(f))c.label="Field Label can only contain letters, numbers, and single spaces between words";else{const w=a.map((V,y)=>{var g;return{label:(g=V.label)==null?void 0:g.trim().toLowerCase(),index:y}}).filter(V=>V.label===p);if(w.length>1){const V=w[0].index;n!==V&&(c.label=`"${f}" is already used in this table`)}}}q[i].columns[n]=c}function st(t,e,l){var a;q[e]||(q[e]={});const o=[],n=((a=t.label)==null?void 0:a.trim())||"";n||o.push("Label is required"),n.length>64&&o.push("Label cannot exceed 64 characters"),n&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(n)&&o.push("No special characters allowed"),n&&et.includes(n.toLowerCase().trim())&&o.push("This label is restricted"),n&&ee.value[e].map(f=>{var u;return(u=f.label)==null?void 0:u.trim().toLowerCase()}).filter(Boolean).filter(f=>f===n.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),t.fieldtype||o.push("Field type is required"),t.fieldtype==="Select"&&(!t.options||t.options.trim()==="")&&o.push("Options are required"),q[e][l]=o}const As=(t,e,l)=>{var i;const o=v[t].sections[e].childTables[l],n={tableName:!1,columns:[]};let a=!1;return(i=o.tableName)!=null&&i.trim()||(n.tableName="Table name is required.",a=!0),o.columns.forEach((c,f)=>{var p,w;const u={};(p=c.label)!=null&&p.trim()||(u.label="Field Label is required",a=!0),(w=c.fieldtype)!=null&&w.trim()||(u.fieldtype="Please select field type",a=!0),n.columns[f]=u}),q[`${t}-${e}-${l}`]=n,a},Vs=(t,e,l)=>{var n,a;const o=(a=(n=v[t])==null?void 0:n.sections)==null?void 0:a[e];o&&!Array.isArray(o[l])&&(o[l]=[])},Es=t=>t?t.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",Ls=(t,e,l)=>{if(As(t,e,l)){ae("Please fix validation errors before creating the table",{transition:"zoom"});return}if(tt.value){ae("Table already exists",{transition:"zoom"});return}const n=v[t].sections[e].childTables[l],a=v[t].sections[e];n.columns=n.columns.map((c,f)=>ye(te({},c),{idx:f,options:ft(c)})),n.newTable=!1;const i={form_short_name:n.tableName,fields:n.columns,idx:n.idx,as_a_block:n.as_a_block?n.as_a_block:"false"};z.post(H.childtable,i).then(c=>{var f,u,p;if(c){Vs(t,e,"afterCreated"),a.afterCreated[l]=te({},n),pe("Table created successfully!");const w=(p=(u=(f=c.message)==null?void 0:f[0])==null?void 0:u[0])==null?void 0:p.child_doc;w&&(v[t].sections[e].childTables[l]=ye(te(te({},v[t].sections[e].childTables[l]),w),{newTable:!1}))}}).catch(c=>{console.error("Error creating table:",c)})},Re=(t,e,l,o=[])=>{var i;W[e]||(W[e]=[]),W[e]=W[e].filter(c=>c!==l),q[e]||(q[e]=[]),q[e][l]=[];const n=[],a=((i=t.label)==null?void 0:i.trim())||"";if(a?et.includes(a.toLowerCase())?n.push("This label is restricted"):a.length>64?n.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(a)||n.push("Only letters, numbers, and single spaces allowed"):n.push("Label is required"),o.length){const c=a.toLowerCase(),f=o.map((u,p)=>{var w;return{label:(w=u.label)==null?void 0:w.trim().toLowerCase(),idx:p}}).filter(u=>u.label===c);if(f.length>1){const u=f[0].idx;l!==u?(n.push("Duplicate label not allowed"),t._duplicate=!0):t._duplicate=!1}else t._duplicate=!1}return t.fieldtype||n.push("Field type is required"),t.fieldtype==="Select"&&(!t.options||!t.options.trim())&&n.push("Options are required"),q[e][l]=n,n.length>0&&W[e].push(l),n.length===0},Ts=(t,e,l)=>{const n=v[t].sections[e].afterCreated.find(c=>c.tableName===l);if(!n)return;const a=n.columns.length,i={fieldname:"",fieldtype:"",idx:a+1,label:"",value:"",isNew:!0,description:""};n.columns.push(i),Re(i,l,a,n.columns)},Ut=h([]),Us=(t,e,l,o)=>{const a=v[t].sections[e].afterCreated.find(c=>c.tableName===l);if(!a)return;a.columns.splice(o,1),a.columns.forEach((c,f)=>{c.idx=f+1});const i=W.value[l];i&&(W.value[l]=i.filter(c=>c!==o).map(c=>c>o?c-1:c))},Ms=(t,e,l)=>{const n=v[t].sections[e].afterCreated.find(a=>a.tableName===l);if(n){if(P[l]){W[l]=[];let a=!0;if(n.columns.forEach((f,u)=>{Re(f,l,u,n.columns)||(a=!1)}),!a){ae("Please fix the errors in the highlighted fields before saving!");return}const i=n.columns.map((w,p)=>{var V=w,{isNew:f}=V,u=wt(V,["isNew"]);return ye(te({},u),{idx:p+1,options:ft(u)})}),c={form_short_name:Es(l),fields:i,as_a_block:n.description};z.post(H.childtable,c).then(f=>{Ut.value=f.data,pe("Fields updated successfully!")}).catch(f=>{console.error("❌ Saving fields failed:",f)})}P[l]=!P[l]}},P=oe({}),Os=t=>{ee.value[t]||(ee.value[t]=[]);const e=ee.value[t].length+1;ee.value[t].push({fieldname:"",fieldtype:"",idx:e,label:"",value:"",isNew:!0,description:"",options:ee.value[t].options?`
${ee.value[t].options}`:""})},Rs=(t,e)=>{ee.value[t]&&ee.value[t].splice(e,1)},Bs=(t,e)=>{if(!t)return;W.value||(W.value={}),W.value[t]||(W.value[t]=[]);const l=ee.value[t];if(l){if(P[t]){W.value[t]=[];let o=!0;if(l.forEach((i,c)=>{var u;st(i,t,c);const f=(u=q[t])==null?void 0:u[c];f&&f.length>0&&(W.value[t].push(c),o=!1),i.label&&(i.label=i.label.trim())}),!o){ae("Please fix the errors before saving");return}const n=l.map((u,f)=>{var p=u,{isNew:i}=p,c=wt(p,["isNew"]);return ye(te({},c),{idx:f+1,options:ft(c)})}),a={form_short_name:t,fields:n,as_a_block:e};z.post(H.childtable,a).then(i=>{Ut.value=i.data,pe("Fields updated successfully!")}).catch(i=>{console.error("❌ Saving fields failed:",i)})}P[t]=!P[t],Tt.value=P[t]?t:null}},zs=h([{id:1,label:"Form Info",stepno:"Step 1",icon:"bi bi-file-text"},{id:2,label:"Requestor Block",stepno:"Step 2",icon:"bi bi-person-plus"},{id:3,label:"Approver Blocks",stepno:"Step 3",icon:"bi bi-people"},{id:4,label:"Print Format",stepno:"Step 4",icon:"ri-checkbox-circle-line"}]),mt=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],lt=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],Ns=se(()=>[ke,...le.value]),Ps=se(()=>{const t=m.value.accessible_departments;return t.includes(ke)?"All Selected":t.length>1?`${t[0]}.. +${t.length-1} more selected`:t.join(", ")}),js=t=>t===ke?m.value.accessible_departments.length===le.value.length:m.value.accessible_departments.includes(t),Hs=(t,e)=>{t===ke?e.target.checked?m.value.accessible_departments=[...le.value]:m.value.accessible_departments=[]:(e.target.checked?m.value.accessible_departments.push(t):m.value.accessible_departments=m.value.accessible_departments.filter(l=>l!==t),m.value.accessible_departments.length===le.value.length?m.value.accessible_departments=[...le.value]:m.value.accessible_departments=m.value.accessible_departments.filter(l=>l!==ke))},Js=t=>{t===ke&&(m.value.accessible_departments=[...le.value])},Ws=t=>{t===ke&&(m.value.accessible_departments=[])},vt=h(!1),Be=se(()=>{var e;let t=[...ne.value];if(qe.value&&(t=t.filter(l=>l.is_hod===1)),(e=Ue.value)!=null&&e.trim()){const l=Ue.value.toLowerCase();t=t.filter(o=>o.role.toLowerCase().includes(l))}return t.sort((l,o)=>l.role.localeCompare(o.role)),t.sort((l,o)=>{const n=E.value.includes(l.role),a=E.value.includes(o.role);return n===a?0:n?1:-1}),t.map(l=>l.role)}),Zs=se(()=>{const t=Be.value;return t.length>0&&t.every(e=>E.value.includes(e))});we([E,Be],()=>{const t=Be.value;vt.value=t.length>0&&t.every(e=>E.value.includes(e))},{immediate:!0,deep:!0});function Gs(t){const e=t.target.checked,l=ne.value.filter(o=>{var n;return!(qe.value&&o.is_hod!==1||(n=Ue.value)!=null&&n.trim()&&!o.role.toLowerCase().includes(Ue.value.toLowerCase()))}).map(o=>o.role);e?E.value=Array.from(new Set([...E.value,...l])):E.value=E.value.filter(o=>!l.includes(o)),vt.value=e}function Ys(){E.value=[],vt.value=!1,qe.value=!1}const de=h("");function Ks(){const t=v[R.value];if(!t||!t.sections){console.error("Error: Invalid block or sections not found.");return}let e={type:R.value==0?"requestor":"approver",roles:E.value,approval_required:Ze.value,approver_can_edit:Ge.value,fields:t.sections.flatMap(kt),idx:R.value};R.value!==0&&(e.view_only_reportee=de.value==="ViewOnlyReportee"?1:0,e.all_approvals_required=de.value==="all_approvals_required"?1:0,e.requester_as_a_approver=de.value==="requester_as_a_approver"?1:0,e.on_rejection=De.value?De.value:0);const l=J.findIndex(o=>o.idx===e.idx);l!==-1?J[l]=e:J.push(e),xs()}function B(t){return J.find(e=>e.idx===t)||{roles:[]}}function Qs(t){const e=B(t),l=e.roles||[];E.value=[...l],De.value=e.on_rejection,Ze.value=e.approval_required,Ge.value=e.approver_can_edit,e.view_only_reportee===1?de.value="ViewOnlyReportee":e.all_approvals_required===1?de.value="all_approvals_required":e.requester_as_a_approver===1?de.value="requester_as_a_approver":de.value=""}const _t=t=>{qe.value=!1,Ue.value="",de.value="",De.value="",m.value.accessible_departments.length&&Xs(t,m.value.accessible_departments),R.value=t,Qs(t)};function Xs(t,e){let l={index:t,departments:e,property:m.value.business_unit};z.post(H.addDesignationroles,l).then(o=>{o.message&&(ne.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function xs(){z.post(H.add_roles_WF,{workflow_setup:J,doctype:m.value.form_short_name,business_unit:m.value.business_unit}).then(t=>{console.log(t),R.value==0?pe("Requestor Added"):pe(`Approver-${R.value} Added`)})}function Is(){A.push({path:x.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function el(){m.value.form_name="",m.value.form_short_name="",m.value.owner_of_the_form="",m.value.business_unit="",m.value.form_category="",m.value.accessible_departments=[]}const tl=t=>{if(it.value){ae("Please check all required fields before proceeding.");return}t<F.value?at():t>F.value&&ot()},ot=()=>{if(it.value){ae("Please check all required fields before proceeding.");return}F.value<4&&(F.value+=1,F.value===4&&(rt.value=v))},at=()=>{F.value>1&&(F.value-=1)},sl=h([]);function Mt(){const t={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:ce.EzyFormDefinitions,doc_id:U.value};z.get(H.GetDoctypeData,{params:t}).then(e=>{var o;let l=e==null?void 0:e.message.data;if(l){l.accessible_departments&&(l.accessible_departments=l.accessible_departments.split(",")),m.value=ye(te(te({},m.value),l),{owner_of_the_form:l.owner_of_the_form||m.value.owner_of_the_form||""});const n=JSON.parse((o=e.message.data)==null?void 0:o.form_json);es.value=n.workflow,ss.value=n.fields.filter(i=>i.fieldtype==="Table"),sl.value=n.fields.filter(i=>i.fieldtype==="Table"),Se.value=e.message.data.is_landscape;let a=Wt(JSON.parse(l==null?void 0:l.form_json).fields);ee.value=JSON.parse(e.message.data.form_json).child_table_fields,Cs.value=[],ts.value=[],a.forEach((i,c)=>{v.push(i)}),JSON.parse(l==null?void 0:l.form_json).workflow.forEach((i,c)=>{J.push(i)})}}).catch(e=>{console.error("Error fetching  data:",e)})}function ll(){const t={};Ie.value&&(t.print_format=Ie.value),Se.value!==void 0&&Se.value!==null&&(t.is_landscape=Se.value),z.put(H.resource+ce.EzyFormDefinitions+`/${C.query.id}`,t).then(e=>{console.log(e),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),pe("Print Format Added Successfully")}).catch(e=>{console.error("Error fetching  data:",e)})}function Ot(){const t={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${x.value.business_unit||C.query.business_unit}`,doctype:ce.departments};z.get(H.GetDoctypeData,{params:t}).then(e=>{var l;(l=e==null?void 0:e.message.data)!=null&&l.length&&(Ce.value=e.message.data.map(o=>o.name),le.value=e.message.data.map(o=>o.name))}).catch(e=>{console.error("Error fetching department data:",e)})}h(""),we(()=>m.value.owner_of_the_form,t=>{t&&ht(t)});function ht(t){t&&typeof t=="string"&&t.trim()!==""&&ol(t)}function ol(t){const e={fields:JSON.stringify(["ezy_departments_items"]),doctype:ce.departments,doc_id:t};z.get(H.GetDoctypeData,{params:e}).then(l=>{var o;(o=l==null?void 0:l.message.data)!=null&&o.ezy_departments_items&&(re.value=l.message.data.ezy_departments_items.map(n=>n.category))}).catch(l=>{console.error("Error fetching categories data:",l)})}function bt(t){let e=Rl(v);const l=ye(te({},m.value),{fields:e,doctype:ce.EzyFormDefinitions,workflow_setup:J,form_status:t==="save"?"Created":"Draft"});l.accessible_departments=l.accessible_departments.toString(),z.post(H.savedata,l).then(o=>{if(o&&o.message&&o.message.message){let n=localStorage.getItem("preName");if(n){let a={installed:"Yes"};z.put(`${H.resource}${ce.preDefinedForm}/${n}`,a).then(i=>{localStorage.removeItem("preName")}).catch(i=>{console.error("Error fetching ezyForms data:",i)})}if(A.push({params:{paramid:o.message.message},query:{id:o.message.message}}),U.value=o.message.message,U&&U!=="new"&&(v.splice(0,v.length),Mt()),J.length<v.length)xt("Add Workflow");else if(Rt.value===!0){pe("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let a=localStorage.getItem("routepath");t==="save"?A.push({path:a}):t==="Draft"&&A.push({path:a})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const nt=h(""),gt=()=>{var l,o;const t=v.length,e={label:t===0?"requestor":`approver-${t}`,parent:`${(l=$e.value)==null?void 0:l.value}-${(o=m.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${$e.value.value}-${m.value.form_short_name}`,childTables:[],afterCreated:{},rows:t===0?[{label:`row_0_0_${t}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${t}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${t}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};v.push(e),Ol(()=>{nt.value&&nt.value.scrollTo({top:nt.value.scrollHeight,behavior:"smooth"})})},Rt=h(!1),Bt=t=>{let e=v[t];e.parent&&G.push(e);let l=[];J.length>t&&J[t].roles&&(l=[...J[t].roles]),v.splice(t,1),J.length>t&&J.splice(t,1),v.forEach((o,n)=>{o.sections.forEach((a,i)=>{a.rows.forEach((c,f)=>{c.columns.forEach((u,p)=>{ue(n,i,f,p)})})})}),l.length&&al(l,t)};function al(t,e){const l={role:t,level:e,document_type:m.value.form_name,short_name:m.value.form_short_name,property:m.value.business_unit};z.post(H.deleteAssigneRoles,l).then(o=>{o&&bt()})}const nl=(t,e)=>{const l={label:"",parent:`${$e.value.value}-${m.value.form_short_name}`,rows:[{label:`row_0_${e}_${t}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};v[t].sections.splice(e+1,0,l)},il=(t,e)=>{let l=v[t].sections[e];l.parent&&G.push(l),v[t].sections.splice(e,1),v[t].sections.forEach((o,n)=>{o.rows.forEach((a,i)=>{a.columns.forEach((c,f)=>{ue(t,n,i,f)})})})},rl=(t,e,l)=>{v[t].sections[e].rows[l].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},dl=(t,e,l,o)=>{const a=v[t].sections[e].rows[l].columns,i=a[o];i.parent&&G.push(i),a.length===1?v[t].sections[e].rows.splice(l,1):a.splice(o,1),v[t].sections.forEach((c,f)=>{c.rows.forEach((u,p)=>{u.columns.forEach((w,V)=>{ue(t,f,p,V)})})})},ul=(t,e,l,o)=>{v[t].sections[e].rows[l].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},cl=(t,e,l,o,n)=>{let a=v[t].sections[e].rows[l].columns[o].fields[n];a.parent&&G.push(a),v[t].sections[e].rows[l].columns[o].fields.splice(n,1)},pl=(t,e,l,o,n)=>{const a=v[t].sections[e].rows[l].columns[o].fields[n],i=te({},a);i.name=`${a.name} Name the field`,v[t].sections[e].rows[l].columns[o].fields.splice(n+1,0,i)},fl=(t,e,l,o,n)=>{const a=Xt(v);v.splice(0,v.length,...a);let i=v[t].sections[e].rows[l].columns[o].fields[n].fieldtype;(i!=="Select"||i!=="radio"||i!=="multiselect")&&(v[t].sections[e].rows[l].columns[o].fields[n].options="")};function ml(t){return et.includes(t==null?void 0:t.trim().toLowerCase())}function vl(t){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(t)||t.includes('"')||t.includes("'")}function _l(t){return t.flatMap(e=>{var l;return[(l=e.label)==null?void 0:l.trim().toLowerCase(),...e.sections.flatMap(o=>{var n;return[(n=o.label)==null?void 0:n.trim().toLowerCase(),...o.rows.flatMap(a=>a.columns.flatMap(i=>{var c;return[(c=i.label)==null?void 0:c.trim().toLowerCase(),...i.fields.map(f=>{var u;return(u=f.label)==null?void 0:u.trim().toLowerCase()})]}))]})]}).filter(e=>e!==""&&!At.includes(e))}function ue(t,e,l,o,n){const i=_l(v).filter((u,p,w)=>w.indexOf(u)!==p),c=Xt(v);v.splice(0,v.length,...c);function f(u,p){if(!u){p.errorMsg="";return}ml(u)?p.errorMsg="Entered label is restricted":vl(u)?p.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:u.length>64?p.errorMsg="Label should not exceed 64 characters":p.errorMsg=i.includes(u.trim().toLowerCase())?"Duplicate Label Name":""}n!==void 0&&f(v[t].sections[e].rows[l].columns[o].fields[n].label,v[t].sections[e].rows[l].columns[o].fields[n]),n===void 0&&o!==void 0&&f(v[t].sections[e].rows[l].columns[o].label,v[t].sections[e].rows[l].columns[o]),o===void 0&&n===void 0&&f(v[t].sections[e].label,v[t].sections[e]),v.forEach(u=>{u.sections.forEach(p=>{f(p.label,p),p.rows.forEach(w=>{w.columns.forEach(V=>{f(V.label,V),V.fields.forEach(y=>{f(y.label,y)})})})})})}const yt=se(()=>{function t(e){return!e||typeof e!="object"?!1:"fieldtype"in e&&e.fieldtype===""||"error"in e&&e.error||"errorMsg"in e&&e.errorMsg||["Select","Table MultiSelect"].includes(e.fieldtype)&&(!e.options||e.options.trim()==="")?!0:Array.isArray(e)?e.some(t):Object.values(e).some(t)}return t(v)}),it=se(()=>Y.value.length>0||K.value.length>0||!m.value.form_category||!m.value.owner_of_the_form||m.value.accessible_departments.length===0),hl=se(()=>v.some(t=>t.sections.some(e=>e.rows.some(l=>l.columns.some(o=>o.fields.some(n=>n.label&&n.fieldtype))))));function zt(t,e){let l=t.target.value.trim();if(!l){e==="form_name"?Y.value="Input cannot be empty or only spaces":e==="form_short_name"&&(K.value="Input cannot be empty or only spaces");return}if(l.length>63){e==="form_name"?Y.value="Name cannot exceed 63 characters":e==="form_short_name"&&(K.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(l)){e==="form_short_name"&&(K.value="First character must be a letter");return}else K.value="";if(e==="form_short_name"&&l.length<2){K.value="Short name must have at least 2 letters";return}if(e==="form_short_name"&&/[^a-zA-Z ]/.test(l)){K.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(l)){e==="form_name"?Y.value="Special characters are not allowed":e==="form_short_name"&&(K.value="Special characters are not allowed");return}else e==="form_name"?Y.value="":e==="form_short_name"&&(K.value="");const o=[[e,"=",`${l}`],["business_unit","=",`${m.value.business_unit}`]],n={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:ce.EzyFormDefinitions};z.get(`${H.GetDoctypeData}`,{params:n}).then(a=>{I.value=a.message.data,e==="form_name"?Y.value=l&&I.value.some(i=>i.form_name&&i.form_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":e==="form_short_name"&&(K.value=l&&I.value.some(i=>i.form_short_name&&i.form_short_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(a=>{console.error("Error fetching ezyForms data:",a),e==="form_name"?Y.value="":e==="form_short_name"&&(K.value="")})}const bl=t=>t===0?"1st row":t===1?"2nd row":t===2?"3rd row":`${t+1}th row`,rt=h([]),gl=()=>{v.length&&(rt.value=v,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function yl(){z.post(H.delete_form_items,{deleted_fields:G.flatMap(kt),doctype:U}).then(t=>{var e;(e=t==null?void 0:t.message)!=null&&e.success&&bt()})}function Nt(t){return Ve(this,null,function*(){if(yt.value){ae("Please fix the errors before proceeding.");return}Rt.value=!0;let e=G.flatMap(kt);U!=null&&U!=null&&U!="new"&&e.length?yl():bt(t)})}const wl=()=>Ve(this,null,function*(){var t;if(!(Xe.value.length>0))try{const e={doctype:"WF Roadmap",fields:JSON.stringify(["name","roadmap_title","document_type","workflow_levels","property","cluster_name"]),filters:JSON.stringify([])},l=yield z.get(H.GetDoctypeData,{params:e});(t=l==null?void 0:l.message)!=null&&t.data&&(Xe.value=l.message.data.map(o=>({roadmap_title:o.name,display_name:`${o.roadmap_title} (${o.document_type})`,document_type:o.document_type,workflow_levels:o.workflow_levels,property:o.property,cluster_name:o.cluster_name})),console.log("Fetched WF Road Maps:",Xe.value))}catch(e){console.error("Error fetching WF Road Maps:",e),ae("Failed to fetch workflow road maps")}}),kl=t=>Ve(this,null,function*(){var e;if(t){console.log("Selected WF Road Map:",t);try{const l=yield z.get(`/api/resource/WF Roadmap/${t.roadmap_title}`);if((e=l==null?void 0:l.data)!=null&&e.data){const o=l.data.data;if(console.log("Full Roadmap Data:",o),o.wf_requestors&&o.wf_requestors.length>0&&(v.length===0&&gt(),xt(`Workflow loaded: ${o.wf_requestors.length} requestor(s), ${o.workflow_levels} approval level(s)`)),o.wf_level_setup&&o.wf_level_setup.length>0){const n=o.wf_level_setup,a=1+o.workflow_levels;for(;v.length<a;)gt();J.length=0,J.push({type:"requestor",roles:[]}),n.forEach((i,c)=>{J.push({type:"approver",level:i.level,roles:[i.role],approval_required:i.mandatory?"1":"0",approver_can_edit:"0",view_only_reportee:i.view_only_reportee||0,all_approvals_required:i.all_approvals_required||0,requester_as_a_approver:i.requester_as_a_approver||0,on_rejection:i.on_rejection||"",fields:[]})}),pe(`Loaded workflow: ${o.workflow_levels} approval level(s) configured`)}}}catch(l){console.error("Error loading WF Road Map details:",l),ae("Failed to load workflow configuration")}}}),Cl=t=>{console.log("Field added from library:",t);const e=Qe.value,l=v[e];if(!l){ae("Please create a block first before adding fields");return}const o=Pt(t);if(!o)return;l.sections||(l.sections=[]),l.sections.length===0&&l.sections.push({label:"",rows:[[{label:"",fields:[]}]]});const i=l.sections[0].rows[0][0];i.fields||(i.fields=[]),i.fields.push(o),console.log("Field added successfully:",o),pe(`${o.label} field added successfully`)},Dl=t=>{console.log("Drag started:",t),ve.value=t},Fl=()=>{console.log("Drag ended")},Pt=t=>{console.log("Creating field from Frappe type:",t);const e=lt.find(a=>a.type===t);if(!e)return console.error("Field type not found:",t),console.error("Available types:",lt.map(a=>a.type)),ae(`Field type "${t}" not found. Please try again.`),null;const l=Date.now(),o=Math.random().toString(36).substring(2,6),n=`field_${l}_${o}`;return{id:`field_${l}_${o}`,fieldname:n,label:e.label,fieldtype:e.type,options:"",reqd:0,read_only:0,hidden:0,description:"",default:"",placeholder:""}};return(t,e)=>(r(),d("div",null,[s("div",Wl,[s("div",Zl,[s("div",Gl,[s("div",Yl,[s("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:e[0]||(e[0]=l=>Is())},e[40]||(e[40]=[s("button",{class:"btn font-13 ms-3"},[s("i",{class:"bi bi-arrow-left"}),s("span",{class:"ms-2"},"Back")],-1)])),t.$route.query.id||t.$route.query.preId?(r(),d("span",Kl,"("+b(x.value.formId||$(C).query.form_name)+")",1)):_("",!0)]),s("div",null,[F.value===2&&$(v).length&&!t.$route.query.id?(r(),d("button",{key:0,disabled:yt.value||it.value,style:Ul({cursor:yt.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:e[1]||(e[1]=l=>Nt("Draft"))},e[41]||(e[41]=[s("i",{class:"bi bi-bookmark-check-fill"},null,-1),S(" Save As Draft ")]),12,Ql)):_("",!0)])]),s("div",Xl,[s("div",xl,[s("div",Il,[s("div",eo,[s("ul",to,[(r(!0),d(L,null,T(zs.value,l=>(r(),d("li",{key:l.id,class:N({active:F.value===l.id,completed:F.value>l.id})},[s("div",{class:N(["d-flex gap-3 align-items-center",{"not-allowed":it.value&&F.value+1===l.id}]),onClick:o=>tl(l.id)},[F.value>l.id?(r(),d("i",lo)):(r(),d("i",{key:1,class:N(l.icon)},null,2)),s("div",oo,[s("span",ao,b(l.stepno),1),e[42]||(e[42]=s("br",null,null,-1)),s("span",no,b(l.label),1)])],10,so)],2))),128))])])]),s("div",io,[s("div",ro,[s("div",uo,[F.value===1?(r(),d("div",co,[s("div",po,[s("div",fo,[e[43]||(e[43]=s("div",null,null,-1)),e[44]||(e[44]=s("h1",{class:"font-14 fw-bold m-0"},"Form Info & Fields",-1)),s("div",null,[!t.$route.query.id&&!t.$route.query.preId?(r(),d("button",{key:0,class:"btn btn-light font-12 mx-2",type:"button",onClick:el},"Clear Form")):_("",!0),F.value<4?(r(),Zt(Gt,{key:1,class:"btn btn-dark bg-dark text-white fw-bold font-13",name:"Next",onClick:ot})):_("",!0)])])]),s("div",mo,[s("div",vo,[e[60]||(e[60]=s("div",{class:"col-sm-none col-md-4"},null,-1)),s("div",_o,[s("div",ho,[s("div",bo,[s("div",go,[s("div",yo,[$(C).query.preId?(r(),d("span",wo,e[45]||(e[45]=[S("Predefined "),s("i",{class:"bi bi-check2-circle"},null,-1)]))):_("",!0),X(We,{disabled:(x.value.formId&&x.value.formId.length>0||$(C).query.form_name)&&be.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Untitled Form",onChange:e[2]||(e[2]=l=>zt(l,"form_name")),modelValue:qt.value,"onUpdate:modelValue":e[3]||(e[3]=l=>qt.value=l)},null,8,["disabled","modelValue"]),Y.value?(r(),d("span",ko,b(Y.value),1)):_("",!0)])]),s("div",Co,[X(We,{disabled:(x.value.formId&&x.value.formId.length>0||$(C).query.form_name)&&be.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Untitled Form",onChange:e[4]||(e[4]=l=>zt(l,"form_short_name")),modelValue:m.value.form_short_name,"onUpdate:modelValue":e[5]||(e[5]=l=>m.value.form_short_name=l)},null,8,["disabled","modelValue"]),K.value?(r(),d("span",Do,b(K.value),1)):_("",!0)]),s("div",Fo,[X(We,{disabled:x.value.formId&&x.value.formId.length>0&&be.value!=="1",labeltext:"Form Naming series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Naming series",modelValue:m.value.series,"onUpdate:modelValue":e[6]||(e[6]=l=>m.value.series=l)},null,8,["disabled","modelValue"]),e[46]||(e[46]=Yt('<small class="text-muted" style="font-size:12px;" data-v-ff005066> Note : Enter <code data-v-ff005066>YY-YY</code>, <code data-v-ff005066>YYYY</code>, or <code data-v-ff005066>ABC</code>. The system will default to the format <code data-v-ff005066> 24-25-0001</code>, <code data-v-ff005066> 2025-0001</code>, or <code data-v-ff005066> ABC-0001</code> respectively. </small>',1))]),s("div",$o,[s("label",null,[e[47]||(e[47]=S("Owner Of The Form ")),m.value.owner_of_the_form?_("",!0):(r(),d("span",So,"*"))]),X($(Ee),{disabled:x.value.formId&&x.value.formId.length>0&&be.value!=="1",onOpen:Ot,options:Ce.value,onChange:ht,modelValue:m.value.owner_of_the_form,"onUpdate:modelValue":e[7]||(e[7]=l=>m.value.owner_of_the_form=l),placeholder:"Select Department",multiple:!1,class:"font-11 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"])]),s("div",qo,[s("label",null,[e[48]||(e[48]=S("Form Category ")),m.value.form_category?_("",!0):(r(),d("span",Ao,"*"))]),X($(Ee),{disabled:x.value.formId&&x.value.formId.length>0&&be.value!=="1",options:re.value,modelValue:m.value.form_category,"onUpdate:modelValue":e[8]||(e[8]=l=>m.value.form_category=l),placeholder:"Select Category",multiple:!1,searchable:!0,class:"font-11 multiselect"},null,8,["disabled","options","modelValue"])]),s("div",Vo,[s("label",null,[e[49]||(e[49]=S("Accessible to Department ")),m.value.accessible_departments.length?_("",!0):(r(),d("span",Eo,"*"))]),X($(Ee),{modelValue:m.value.accessible_departments,"onUpdate:modelValue":e[10]||(e[10]=l=>m.value.accessible_departments=l),options:Ns.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Department",class:"font-11",onSelect:Js,onRemove:Ws,openDirection:"bottom"},{option:Kt(({option:l})=>[s("div",Lo,[s("input",{type:"checkbox",checked:js(l),class:"custom-checkbox",onChange:o=>Hs(l,o),onClick:e[9]||(e[9]=ie(()=>{},["stop"]))},null,40,To),s("span",null,b(l),1)])]),selection:Kt(({values:l,isOpen:o})=>[l.length?D((r(),d("span",{key:0,class:"multiselect__single font-10"},b(Ps.value),513)),[[ut,!o]]):_("",!0)]),_:1},8,["modelValue","options"])]),s("div",Uo,[e[50]||(e[50]=s("label",null,"Form Type",-1)),X($(Ee),{options:$t,modelValue:St.value,"onUpdate:modelValue":e[11]||(e[11]=l=>St.value=l),placeholder:"Select Form Type",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:l=>l.value,class:"font-11 multiselect",openDirection:"top"},null,8,["modelValue","reduce"]),e[51]||(e[51]=s("small",{class:"text-muted font-12 ms-2"},"Note: Public form is accessible by anyone through QR code.",-1))]),s("div",Mo,[e[52]||(e[52]=s("label",null,[S("Has Workflow "),s("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),X($(Ee),{options:["Yes","No"],modelValue:m.value.has_workflow,"onUpdate:modelValue":e[12]||(e[12]=l=>m.value.has_workflow=l),placeholder:"Select",multiple:!1,class:"font-11 multiselect",searchable:!0},null,8,["modelValue"])]),m.value.has_workflow==="Yes"?(r(),d("div",Oo,[e[53]||(e[53]=s("label",null,[S("Use Existing Workflow "),s("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),X($(Ee),{onOpen:wl,options:Xe.value,modelValue:Ft.value,"onUpdate:modelValue":e[13]||(e[13]=l=>Ft.value=l),placeholder:"Select WF Road Map",multiple:!1,class:"font-11 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:kl,openDirection:"bottom"},null,8,["options","modelValue"]),e[54]||(e[54]=s("small",{class:"text-muted font-12 ms-2"},[s("i",{class:"bi bi-info-circle me-1"}),S(" Select to auto-populate requestor and approver configurations ")],-1))])):_("",!0),m.value.as_web_view===1?(r(),d("div",Ro,[e[55]||(e[55]=s("label",null,[S("Form Submit Response "),s("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),X(We,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit Response",modelValue:m.value.public_form_response,"onUpdate:modelValue":e[14]||(e[14]=l=>m.value.public_form_response=l)},null,8,["modelValue"])])):_("",!0),m.value.as_web_view===1?(r(),d("div",Bo,[e[56]||(e[56]=s("label",null,[S("Submit Notification Email "),s("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),X(We,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit mail",modelValue:m.value.mail_id,"onUpdate:modelValue":e[15]||(e[15]=l=>m.value.mail_id=l)},null,8,["modelValue"]),e[57]||(e[57]=s("small",{class:"text-muted font-12 ms-2"},"Note : If multiple Emails, separate with commas (,).",-1))])):_("",!0),$(C).query.preId?(r(),d("div",zo,[s("div",No,[D(s("input",{class:"form-check-input linketoCheck p-1",disabled:m.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":e[16]||(e[16]=l=>m.value.is_linked=l),"true-value":1,"false-value":0},null,8,Po),[[Le,m.value.is_linked]]),e[58]||(e[58]=s("label",{class:"form-check-label font-12 mx-2 mb-0 ps-1",for:"is_linked"}," Link ",-1))])])):_("",!0),m.value.is_linked?(r(),d("div",jo,[e[59]||(e[59]=s("label",{for:"standardFormInput"},"Form",-1)),D(s("input",{type:"text",class:"form-control standardFormInput",id:"standardFormInput",disabled:m.value.is_predefined_doctype==1,"onUpdate:modelValue":e[17]||(e[17]=l=>m.value.is_linked_form=l),placeholder:"Type to search Form Name...",onInput:ns,onFocus:e[18]||(e[18]=l=>Ke.value=!0),onBlur:rs},null,40,Ho),[[O,m.value.is_linked_form]]),Ke.value&&Ye.value.length?(r(),d("ul",Jo,[(r(!0),d(L,null,T(Ye.value,(l,o)=>(r(),d("li",{class:"list-group-item formlistitem",key:o,onMousedown:ie(n=>is(l.name),["prevent"])},b(l.name),41,Wo))),128))])):_("",!0)])):_("",!0)])])]),e[61]||(e[61]=s("div",{class:"col-sm-none col-md-4"},null,-1))])])])):_("",!0),F.value===1?(r(),d("div",Zo,[s("div",Go,[s("div",Yo,[s("button",{onClick:e[19]||(e[19]=l=>at()),class:"btn btn-sm btn-light"},e[62]||(e[62]=[s("i",{class:"bi bi-chevron-left"},null,-1),S(" Back ")]))]),s("div",Ko,[(r(!0),d(L,null,T($(v),(l,o)=>(r(),d("button",{key:o,class:N(["zoho-tab",{active:Qe.value===o}]),onClick:n=>Qe.value=o},[e[63]||(e[63]=s("i",{class:"bi bi-file-earmark-text me-1"},null,-1)),S(" "+b(o===0?"Requestor Block":`Approver Block ${o}`)+" ",1),$(v).length>1?(r(),d("i",{key:0,class:"bi bi-x-lg ms-2",onClick:ie(n=>Bt(o),["stop"])},null,8,Xo)):_("",!0)],10,Qo))),128))]),s("div",xo,[s("button",{class:"btn btn-sm btn-primary me-2",onClick:gt},e[64]||(e[64]=[s("i",{class:"bi bi-plus-lg me-1"},null,-1),S("Add Block ")])),hl.value?(r(),d("button",{key:0,class:"btn btn-sm btn-light me-2",onClick:gl},e[65]||(e[65]=[s("i",{class:"bi bi-eye me-1"},null,-1),S("Preview ")]))):_("",!0),$(v).length?(r(),d("button",{key:1,class:"btn btn-sm btn-dark",onClick:e[20]||(e[20]=l=>Nt("save"))},b($(U)!=="new"?"Update Form":"Create Form"),1)):_("",!0)])]),s("div",Io,[s("aside",{class:N(["zoho-field-library",{collapsed:!Fe.value}])},[s("div",{class:"library-header",onClick:e[21]||(e[21]=l=>Fe.value=!Fe.value)},[s("div",ea,[s("h6",ta,[e[66]||(e[66]=s("i",{class:"bi bi-grid-3x3-gap me-2"},null,-1)),S(" "+b(Fe.value?"Field Types":"Fields"),1)]),s("button",sa,[s("i",{class:N(Fe.value?"bi bi-chevron-left":"bi bi-chevron-right")},null,2)])])]),Fe.value?(r(),d("div",la,[X(Jl,{fields:lt,onFieldAdd:Cl,onFieldDragstart:Dl,onFieldDragend:Fl})])):_("",!0)],2),s("div",oa,[s("div",{class:"canvas-inner",ref_key:"mainBlockRef",ref:nt},[(r(!0),d(L,null,T($(v),(l,o)=>D((r(),d("div",{class:"block-level",key:o},[s("div",aa,[s("div",na,[s("div",ia,[s("h6",ra,b(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),s("div",da,[o!==0&&B(o).view_only_reportee||B(o).all_approvals_required||B(o).requester_as_a_approver?(r(),d("div",ua,[s("span",ca,b(B(o).view_only_reportee===1?"Reporting Manager only":"")+" "+b(B(o).all_approvals_required===1?"All of the selected approvers":"")+" "+b(B(o).requester_as_a_approver===1?"Approval by Requestor":""),1),s("span",null,[e[67]||(e[67]=s("span",{class:"ms-1"}," on rejection escalating to ",-1)),s("span",pa,b(B(o).on_rejection?`Level ${B(o).on_rejection}`:"Requestor"),1)]),s("span",fa,b(B(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):_("",!0)])]),s("div",ma,[$(U)&&$(J).length?(r(),d("div",va,[B(o)?(r(),d("label",_a,[s("span",ha,b(B(o).roles.length>0?o===0?"Requestor: ":"Approver: ":""),1),s("span",ba,b(B(o).roles.slice(0,2).join(", ")),1),B(o).roles.length>2?(r(),d("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>_t(o),class:"more-count"}," +"+b(B(o).roles.length-2)+" more ",9,ga)):_("",!0)])):_("",!0)])):_("",!0),os(o)&&$(U)!=null&&$(U)!=null&&$(U)!="new"&&B(o).roles.length===0?(r(),d("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>_t(o)},[e[68]||(e[68]=s("img",{src:Bl,alt:"Add",class:"me-1"},null,-1)),S(" "+b(o===0?"Add Requestors":"Add Approvers"),1)],8,ya)):_("",!0),$(U)!=null&&$(U)!=null&&$(U)!="new"&&B(o).roles.length>0?(r(),d("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:n=>_t(o)},e[69]||(e[69]=[s("i",{class:"bi bi-pencil font-14"},null,-1)]),8,wa)):_("",!0),s("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:n=>Bt(o)},e[70]||(e[70]=[s("i",{class:"bi bi-trash me-1"},null,-1),S(" Delete Block ")]),8,ka)])])]),s("div",Ca,[(r(!0),d(L,null,T(l.sections,(n,a)=>(r(),d("div",{key:"section-"+a,class:"dynamicSection mt-0 section"},[s("section",Da,[s("div",Fa,[D(s("input",{"onUpdate:modelValue":i=>n.label=i,type:"text",class:N(["border-less-input","font-14",{"italic-style":!n.label},{"fw-medium":n.label}]),onChange:i=>ue(o,a),onInput:i=>ue(o,a),placeholder:"Untitled section"},null,42,$a),[[O,n.label]]),n.errorMsg?(r(),d("small",Sa,b(n.errorMsg),1)):_("",!0)]),s("div",qa,[s("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:i=>il(o,a)},e[71]||(e[71]=[s("i",{class:"bi bi-trash me-1"},null,-1),S(" Delete Section ")]),8,Aa)])]),s("div",Va,[(r(!0),d(L,null,T(n.rows,(i,c)=>(r(),d("section",{class:"row dynamicRow row-container",key:"row-"+c},[s("div",Ea,[s("label",La,b(bl(c)),1),s("div",null,[i.columns.length<3?(r(),d("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:f=>rl(o,a,c)},e[72]||(e[72]=[s("i",{class:"bi bi-plus font-14"},null,-1),S(" Add Column ")]),8,Ta)):_("",!0)])]),s("div",Ua,[s("div",Ma,[(r(!0),d(L,null,T(i.columns,(f,u)=>(r(),d("div",{key:"column-"+u,onMouseenter:p=>_s(o,a,c,u),onMouseleave:hs,class:"col p-0 dynamicColumn position-relative column-container"},[s("div",Ra,[s("div",Ba,[D(s("input",{"onUpdate:modelValue":p=>f.label=p,type:"text",class:N(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!f.label},{"fw-medium":f.label}]),onChange:p=>ue(o,a,c,u),onInput:p=>ue(o,a,c,u),placeholder:"Column Name"},null,42,za),[[O,f.label]]),f.errorMsg?(r(),d("small",Na,b(f.errorMsg),1)):_("",!0)]),D(s("div",Pa,[s("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:p=>dl(o,a,c,u)},e[73]||(e[73]=[s("i",{class:"bi bi-x-lg"},null,-1)]),8,ja)],512),[[ut,bs(o,a,c,u)]])]),f.fields.length===0?(r(),d("div",{key:0,class:"empty-drop-zone",onDragover:e[22]||(e[22]=ie(()=>{},["prevent"])),onDrop:p=>_e(p,o,a,c,u,t.fieldIndex)},null,40,Ha)):_("",!0),(r(!0),d(L,null,T(f.fields,(p,w)=>{var V;return r(),d("div",{key:"field-"+w,onMouseenter:y=>fs(o,a,c,u,w),onMouseleave:ms,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:y=>Vt(y,o,a,c,u,w),onDragover:e[26]||(e[26]=ie(()=>{},["prevent"])),onDrop:y=>_e(y,o,a,c,u,w)},[s("div",{class:"drop-zone",onDragover:e[23]||(e[23]=ie(()=>{},["prevent"])),onDrop:y=>_e(y,o,a,c,u,w)},null,40,Wa),p.fieldtype!=="Table"?(r(),d("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:y=>Vt(y,o,a,c,u,w),onDragover:e[24]||(e[24]=ie(()=>{},["prevent"])),onDrop:y=>_e(y,o,a,c,u,w)},[s("div",Ga,[s("div",Ya,[D(s("input",{"onUpdate:modelValue":y=>p.label=y,placeholder:"Name the field",class:N(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!p.label},{"fw-medium":p.label}]),onChange:y=>ue(o,a,c,u,w),onInput:y=>ue(o,a,c,u,w)},null,42,Ka),[[O,p.label]]),p.errorMsg?(r(),d("small",Qa,b(p.errorMsg),1)):_("",!0)]),D(s("div",Xa,[s("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:y=>pl(o,a,c,u,w)},e[74]||(e[74]=[s("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,xa),s("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:y=>{cl(o,a,c,u,w),ue(o,a,c,u)}},e[75]||(e[75]=[s("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,Ia)],512),[[ut,vs(o,a,c,u,w)]])]),D(s("select",{"onUpdate:modelValue":y=>p.fieldtype=y,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:y=>fl(o,a,c,u,w)},[e[76]||(e[76]=s("option",{value:""},"Select Type",-1)),(r(),d(L,null,T(lt,y=>s("option",{key:y,value:y.type},b(y.label),9,tn)),64))],40,en),[[Te,p.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(p.fieldtype)?(r(),d("div",sn,[e[77]||(e[77]=s("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(s("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":y=>p.options=y,class:"form-control shadow-none mb-1 font-12"},null,8,ln),[[O,p.options]]),!p.options||p.options.trim()===""?(r(),d("small",on," Options are required for this field type. ")):_("",!0)])):_("",!0),p.fieldtype==="Link"?(r(),d("div",an,[s("label",{class:"font-11 fw-light",for:"link-search-"+fe(o,a,c,u,w)}," Search Doctype: ",8,nn),D(s("input",{id:"link-search-"+fe(o,a,c,u,w),type:"text","onUpdate:modelValue":y=>$(v)[o].sections[a].rows[c].columns[u].fields[w].options=y,onInput:y=>us($(v)[o].sections[a].rows[c].columns[u].fields[w].options,o,a,c,u,w),onFocus:y=>ds(fe(o,a,c,u,w)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,rn),[[O,$(v)[o].sections[a].rows[c].columns[u].fields[w].options]]),(V=Oe[fe(o,a,c,u,w)])!=null&&V.length&&pt[fe(o,a,c,u,w)]?(r(),d("ul",dn,[(r(!0),d(L,null,T(Oe[fe(o,a,c,u,w)],(y,g)=>(r(),d("li",{key:g,onClick:k=>cs(o,a,c,u,w,y.name),class:"list-group-item list-group-item-action"},b(y.name),9,un))),128))])):_("",!0)])):_("",!0),s("div",cn,[s("div",pn,[s("div",fn,[D(s("input",{class:"font-12","onUpdate:modelValue":y=>p.reqd=y,"true-value":1,id:"mandatory-"+o+"-"+a+"-"+c+"-"+u+"-"+w,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,mn),[[Le,p.reqd]])]),s("div",null,[s("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+a+"-"+c+"-"+u+"-"+w},"Mandatory",8,vn)])]),s("div",null,[s("button",{class:"btn btn-sm font-12",onClick:y=>p.showDescription=!p.showDescription},b(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,_n)])]),p.showDescription?D((r(),d("textarea",{key:2,"onUpdate:modelValue":y=>p.description=y,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,hn)),[[O,p.description]]):_("",!0),p.error?(r(),d("small",bn,b(p.error),1)):_("",!0)],40,Za)):_("",!0),s("div",{class:"drop-zone",onDragover:e[25]||(e[25]=ie(()=>{},["prevent"])),onDrop:y=>_e(y,o,a,c,u,w)},null,40,gn),s("div",yn,[s("div",null,[s("div",null,[s("div",wn,[p.fieldtype==="Table"?(r(),d("div",kn,[(r(!0),d(L,null,T(ee.value,(y,g)=>(r(),d("div",{key:g,class:"childTable"},[g===p.fieldname||g===p.options?(r(),d("h5",Cn,b(g.replace(/_/g," ")),1)):_("",!0),P[g]&&g===Tt.value?(r(),d("div",Dn,[s("div",Fn,[p.showDescription?D((r(),d("input",{key:0,"onUpdate:modelValue":k=>p.description=k,class:"form-control font-12",placeholder:"Enter field description"},null,8,$n)),[[O,p.description]]):_("",!0),s("button",{class:"btn btn-sm text-nowrap font-12",onClick:k=>p.showDescription=!p.showDescription},b(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,Sn)])])):_("",!0),g===p.options||g===p.fieldname?(r(),d("table",qn,[e[81]||(e[81]=s("thead",null,[s("tr",null,[s("th",null,"#"),s("th",null,"Label"),s("th",null,"Field Type")])],-1)),s("tbody",{onDragover:ie(ws,["prevent"]),onDrop:k=>ks(k,y)},[(r(!0),d(L,null,T(y,(k,Z)=>{var ze,Ne,Pe,je,He,Je,Q;return r(),d("tr",{key:Z,draggable:P[g],onDragstart:j=>gs(Z),onDragend:ys,class:N({dragging:ge.value===Z})},[s("td",null,b(Z+1),1),P[g]?(r(),d("td",En,[D(s("input",{"onUpdate:modelValue":j=>k.label=j,onInput:j=>st(k,g,Z),placeholder:"Field Label",class:N(["form-control",{"border-1 border-danger":(Ne=(ze=q[g])==null?void 0:ze[Z])==null?void 0:Ne.length}])},null,42,Ln),[[O,k.label]]),(je=(Pe=q[g])==null?void 0:Pe[Z])!=null&&je.length?(r(),d("div",Tn,[(r(!0),d(L,null,T(q[g][Z],(j,$l)=>(r(),d("div",{key:$l},b(j),1))),128))])):_("",!0)])):(r(),d("td",Un,b(k.label),1)),P[g]?(r(),d("td",Mn,[s("div",On,[D(s("select",{"onUpdate:modelValue":j=>k.fieldtype=j,onChange:j=>st(k,g,Z),class:N(["form-select form-select-sm",{"border-1 border-danger":(Je=(He=q[g])==null?void 0:He[Z])==null?void 0:Je.length}])},[e[78]||(e[78]=s("option",{value:""},"Select Type",-1)),(r(),d(L,null,T(mt,j=>s("option",{key:j.type,value:j.type},b(j.label),9,Bn)),64))],42,Rn),[[Te,k.fieldtype]]),s("div",zn,[s("div",Nn,[s("div",Pn,[D(s("input",{class:"font-12 form-control-sm","onUpdate:modelValue":j=>k.description=j,placeholder:"description",type:"text"},null,8,jn),[[O,k.description]])])]),s("button",{class:"btn btn-light btn-sm",onClick:j=>Rs(g,Z)},e[79]||(e[79]=[s("i",{class:"bi bi-x-lg"},null,-1)]),8,Hn)])]),["Select"].includes(k.fieldtype)?(r(),d("div",Jn,[e[80]||(e[80]=s("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(s("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":j=>k.options=j,onInput:j=>st(k,g,Z),class:"form-control shadow-none mb-1 font-12"},null,40,Wn),[[O,k.options]]),!k.options||k.options.trim()===""?(r(),d("small",Zn," Options are required for this field type. ")):_("",!0)])):_("",!0),(Q=W[g])!=null&&Q.includes(Z)?(r(),d("span",Gn,"Type required**")):_("",!0)])):(r(),d("td",Yn,b(k.fieldtype),1))],42,Vn)}),128))],40,An)])):_("",!0),p.fieldtype==="Table"&&(p.label===g||p.fieldname===g)?(r(),d("div",Kn,[s("button",{class:"btn btn-light btn-sm mx-2",onClick:k=>Bs(g,p.description)},b(P[g]?"Save":"Edit"),9,Qn),P[g]?(r(),d("button",{key:0,class:"btn btn-light btn-sm",onClick:k=>Os(g)}," Add More Field ",8,Xn)):_("",!0)])):_("",!0)]))),128))])):_("",!0)])])])])],40,Ja)}),128)),s("div",{class:"drop-zone-bottom",onDragover:e[27]||(e[27]=ie(()=>{},["prevent"])),onDrop:p=>_e(p,o,a,c,u,f.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,xn),s("div",{class:"drop-zone",onDragover:e[28]||(e[28]=ie(()=>{},["prevent"])),onDrop:p=>_e(p,o,a,c,u,t.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,In),s("div",ei,[s("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:p=>ul(o,a,c,u)},e[82]||(e[82]=[s("i",{class:"bi bi-plus fs-5"},null,-1),s("span",null,"Add Field",-1)]),8,ti)])],40,Oa))),128))])])]))),128)),s("div",null,[(r(!0),d(L,null,T(n.afterCreated,(i,c)=>(r(),d("div",{key:c,class:"childTable dynamicColumn m-0 p-2"},[s("h5",si,b(i.tableName),1),P[i.tableName]?(r(),d("div",li,[s("div",oi,[i.showDescription?D((r(),d("input",{key:0,"onUpdate:modelValue":f=>i.description=f,class:"form-control font-12",placeholder:"Enter field description"},null,8,ai)),[[O,i.description]]):_("",!0),s("button",{class:"btn btn-sm text-nowrap font-12",onClick:f=>i.showDescription=!i.showDescription},b(i.showDescription?"Hide Description":i.description?"Edit Description":"Add Description"),9,ni)])])):_("",!0),s("table",ii,[e[88]||(e[88]=s("thead",null,[s("tr",null,[s("th",null,"#"),s("th",null,"Label"),s("th",null,"Field Type")])],-1)),s("tbody",null,[(r(!0),d(L,null,T(i.columns,(f,u)=>{var p,w,V,y;return r(),d("tr",{key:u},[s("td",null,b(u+1),1),P[i.tableName]?(r(),d("td",ri,[D(s("input",{"onUpdate:modelValue":g=>f.label=g,placeholder:"Field Label",class:N(["form-control",{"border-1 border-danger":(p=W[i.tableName])==null?void 0:p.includes(u)}]),onBlur:g=>{var k;f.label=(k=f.label)==null?void 0:k.trim(),Re(f,i.tableName,u,i.columns)}},null,42,di),[[O,f.label]]),(w=q[i.tableName])!=null&&w[u]?(r(),d("div",ui,[(r(!0),d(L,null,T(q[i.tableName][u],(g,k)=>(r(),d("span",{key:k},[S(b(g)+" ",1),e[83]||(e[83]=s("br",null,null,-1))]))),128))])):_("",!0)])):(r(),d("td",ci,b(f.label),1)),P[i.tableName]?(r(),d("td",pi,[s("div",fi,[D(s("select",{"onUpdate:modelValue":g=>f.fieldtype=g,class:N(["form-select form-select-sm",{"border-1 border-danger":(V=W[i.tableName])==null?void 0:V.includes(u)}]),onChange:g=>Re(f,i.tableName,u,i.columns)},[e[84]||(e[84]=s("option",{value:""},"Select Type",-1)),(r(),d(L,null,T(mt,g=>s("option",{key:g.type,value:g.type},b(g.label),9,vi)),64))],42,mi),[[Te,f.fieldtype]]),s("button",{class:"btn btn-light btn-sm",onClick:g=>Us(o,a,i.tableName,u)},e[85]||(e[85]=[s("i",{class:"bi bi-x-lg"},null,-1)]),8,_i)]),f.fieldtype==="Select"?(r(),d("div",hi,[e[86]||(e[86]=s("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(s("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":g=>f.options=g,class:"form-control shadow-none mb-1 font-12",onInput:g=>Re(f,i.tableName,u,i.columns)},null,40,bi),[[O,f.options]])])):_("",!0),(y=q[i.tableName])!=null&&y[u]?(r(),d("div",gi,[(r(!0),d(L,null,T(q[i.tableName][u],(g,k)=>(r(),d("span",{key:k},[S(b(g),1),e[87]||(e[87]=s("br",null,null,-1))]))),128))])):_("",!0)])):(r(),d("td",yi,b(f.fieldtype),1))])}),128))])]),s("div",wi,[s("button",{class:"btn btn-light btn-sm mx-2",onClick:f=>Ms(o,a,i.tableName)},b(P[i.tableName]?"Save":"Edit"),9,ki),P[i.tableName]?(r(),d("button",{key:0,class:"btn btn-light btn-sm",onClick:f=>Ts(o,a,i.tableName)}," Add More Field ",8,Ci)):_("",!0)])]))),128))])]),s("div",null,[s("div",null,[o==0?(r(),d("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:i=>Ds(o,a)}," Add New Table ",8,Di)):_("",!0),(r(!0),d(L,null,T(n.childTables,(i,c)=>{var f;return r(),d("div",{key:`table-${o}-${a}-${c}`,class:"child-table"},[i.newTable?(r(),d("div",Fi,[s("div",$i,[s("div",null,[s("span",{class:N(i.tableName?"d-none":"text-danger")},"*",2),D(s("input",{"onUpdate:modelValue":u=>i.tableName=u,placeholder:"Table Name",onBlur:u=>Et(i),class:N(["border-less-input font-14 p-0 inputHeight",{"italic-style":!i.tableName,"fw-medium":i.tableName}])},null,42,Si),[[O,i.tableName]]),(f=q[`${o}-${a}-${c}`])!=null&&f.tableName?(r(),d("div",qi,b(q[`${o}-${a}-${c}`].tableName),1)):_("",!0),Ae.value?(r(),d("div",Ai,b(Ae.value),1)):_("",!0),s("div",Vi,[s("div",Ei,[i.showDescription?D((r(),d("input",{key:0,"onUpdate:modelValue":u=>i.as_a_block=u,class:"form-control font-12",placeholder:"Enter field description"},null,8,Li)),[[O,i.as_a_block]]):_("",!0),s("button",{class:"btn btn-sm text-nowrap font-12",onClick:u=>i.showDescription=!i.showDescription},b(i.showDescription?"Hide Description":i.description?"Edit Description":"Add Description"),9,Ti)])])]),s("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:u=>$s(o,a,c)},e[89]||(e[89]=[s("i",{class:"bi bi-trash"},null,-1),S(" Remove Table ")]),8,Ui)]),(r(!0),d(L,null,T(i.columns,(u,p)=>{var w,V,y,g,k,Z,ze,Ne,Pe,je,He,Je;return r(),d("div",{key:p,class:"dynamicField"},[s("div",Mi,[s("div",Oi,[s("div",null,[s("span",{class:N(u.label?"d-none":"text-danger")},"*",2),D(s("input",{"onUpdate:modelValue":Q=>u.label=Q,placeholder:"Name the field",onBlur:()=>{Et(u),qs(u,o,a,c,p,i.columns)},class:N(["border-less-input font-14 p-0 inputHeight",{"italic-style":!u.label,"fw-medium":u.label,"is-invalid":(y=(V=(w=q[`${o}-${a}-${c}`])==null?void 0:w.columns)==null?void 0:V[p])==null?void 0:y.label}])},null,42,Ri),[[O,u.label]]),(Z=(k=(g=q[`${o}-${a}-${c}`])==null?void 0:g.columns)==null?void 0:k[p])!=null&&Z.label?(r(),d("div",Bi,b(q[`${o}-${a}-${c}`].columns[p].label),1)):_("",!0)]),s("div",zi,[s("div",Ni,[u.showDescription?D((r(),d("input",{key:0,"onUpdate:modelValue":Q=>u.description=Q,class:"form-control font-12",placeholder:"Enter field description"},null,8,Pi)),[[O,u.description]]):_("",!0),s("button",{class:"btn btn-sm text-nowrap font-12",onClick:Q=>u.showDescription=!u.showDescription},b(u.showDescription?"Hide Description":u.description?"Edit Description":"Add Description"),9,ji)]),s("button",{class:"btn btn-sm trash-btn py-0",onClick:Q=>Ss(o,a,c,p)},e[90]||(e[90]=[s("i",{class:"bi bi-x-lg"},null,-1)]),8,Hi)])]),D(s("select",{"onUpdate:modelValue":Q=>u.fieldtype=Q,class:N(["form-select font-13 mb-1",{"is-invalid":(Pe=(Ne=(ze=q[`${o}-${a}-${c}`])==null?void 0:ze.columns)==null?void 0:Ne[p])==null?void 0:Pe.fieldtype}])},[e[91]||(e[91]=s("option",{value:""},"Select Type",-1)),(r(),d(L,null,T(mt,Q=>s("option",{key:Q.type,value:Q.type},b(Q.label),9,Wi)),64))],10,Ji),[[Te,u.fieldtype]]),["Select"].includes(u.fieldtype)?(r(),d("div",Zi,[e[92]||(e[92]=s("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(s("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":Q=>u.options=Q,class:"form-control shadow-none mb-1 font-12"},null,8,Gi),[[O,u.options]]),!u.options||u.options.trim()===""?(r(),d("small",Yi," Options are required for this field type. ")):_("",!0)])):_("",!0),(Je=(He=(je=q[`${o}-${a}-${c}`])==null?void 0:je.columns)==null?void 0:He[p])!=null&&Je.fieldtype?(r(),d("div",Ki,b(q[`${o}-${a}-${c}`].columns[p].fieldtype),1)):_("",!0)])])}),128)),s("button",{class:"btn btn-light btn-sm addField mx-1",onClick:u=>Fs(o,a,c)},e[93]||(e[93]=[s("i",{class:"bi bi-plus"},null,-1),S(" Add Field ")]),8,Qi),s("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:u=>Ls(o,a,c)}," Create Table ",8,Xi),e[94]||(e[94]=s("hr",null,null,-1))])):_("",!0)])}),128))])]),s("div",xi,[s("button",{class:"btn btn-light border font-12",onClick:i=>nl(o,a)},e[95]||(e[95]=[s("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),S(" Add Section ")]),8,Ii)])]))),128)),o===0?(r(),d("div",er)):_("",!0)])])),[[ut,o===Qe.value]])),128))],512)]),Dt.value?(r(),d("aside",tr,[s("div",sr,[e[97]||(e[97]=s("h6",{class:"mb-0"},"Field Properties",-1)),s("button",{class:"btn btn-sm btn-link p-0",onClick:e[29]||(e[29]=l=>Dt.value=null)},e[96]||(e[96]=[s("i",{class:"bi bi-x-lg"},null,-1)]))]),e[98]||(e[98]=s("div",{class:"properties-content"},[s("p",{class:"text-muted small"},"Select a field to edit its properties")],-1))])):_("",!0)])])):_("",!0),F.value===2?(r(),d("div",lr,[s("div",or,[s("button",{onClick:e[30]||(e[30]=l=>at()),class:"btn btn-sm btn-light"},e[99]||(e[99]=[s("i",{class:"bi bi-chevron-left"},null,-1),S(" Back ")])),e[101]||(e[101]=s("h1",{class:"font-14 fw-bold m-0"},"Requestor Block - Predefined Fields",-1)),s("button",{class:"btn btn-sm btn-dark",onClick:ot},e[100]||(e[100]=[S(" Next "),s("i",{class:"bi bi-chevron-right"},null,-1)]))]),e[102]||(e[102]=Yt('<div class="container-fluid mt-4 p-4" data-v-ff005066><div class="alert alert-info" data-v-ff005066><i class="bi bi-info-circle me-2" data-v-ff005066></i><strong data-v-ff005066>System Generated Fields:</strong> These fields are automatically included for all requestors. </div><div class="predefined-fields-container mt-4" data-v-ff005066><div class="row g-3" data-v-ff005066><div class="col-md-6" data-v-ff005066><div class="field-preview-card" data-v-ff005066><label class="form-label fw-bold" data-v-ff005066>Requestor Name</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-ff005066></div></div><div class="col-md-6" data-v-ff005066><div class="field-preview-card" data-v-ff005066><label class="form-label fw-bold" data-v-ff005066>Requestor Email</label><input type="email" class="form-control" value="Auto-populated from user profile" disabled data-v-ff005066></div></div><div class="col-md-6" data-v-ff005066><div class="field-preview-card" data-v-ff005066><label class="form-label fw-bold" data-v-ff005066>Request Date</label><input type="text" class="form-control" value="Auto-populated on submission" disabled data-v-ff005066></div></div><div class="col-md-6" data-v-ff005066><div class="field-preview-card" data-v-ff005066><label class="form-label fw-bold" data-v-ff005066>Department</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-ff005066></div></div></div></div></div>',1))])):_("",!0),F.value===3?(r(),d("div",ar,[s("div",nr,[s("button",{onClick:e[31]||(e[31]=l=>at()),class:"btn btn-sm btn-light"},e[103]||(e[103]=[s("i",{class:"bi bi-chevron-left"},null,-1),S(" Back ")])),e[105]||(e[105]=s("h1",{class:"font-14 fw-bold m-0"},"Approver Blocks - Workflow Setup",-1)),s("button",{class:"btn btn-sm btn-dark",onClick:ot},e[104]||(e[104]=[S(" Next "),s("i",{class:"bi bi-chevron-right"},null,-1)]))]),e[106]||(e[106]=s("div",{class:"container-fluid mt-4 p-4"},[s("div",{class:"alert alert-warning"},[s("i",{class:"bi bi-exclamation-triangle me-2"}),s("strong",null,"Coming Soon:"),S(" Workflow configuration will be moved here. Currently under construction. ")])],-1))])):_("",!0),F.value===4?(r(),d("div",ir,[e[107]||(e[107]=s("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[s("div",null,[s("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),s("div")],-1)),X(Qt,{blockArr:rt.value},null,8,["blockArr"])])):_("",!0)])])])])])])]),s("div",rr,[s("div",dr,[s("div",ur,[e[111]||(e[111]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",cr,[e[109]||(e[109]=s("label",{for:""},"Form Name",-1)),D(s("input",{"onUpdate:modelValue":e[32]||(e[32]=l=>Ie.value=l),multiple:!1,placeholder:$(C).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,pr),[[O,Ie.value]]),s("div",fr,[s("div",mr,[D(s("input",{class:"font-12","onUpdate:modelValue":e[33]||(e[33]=l=>Se.value=l),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[Le,Se.value]])]),e[108]||(e[108]=s("div",null,[s("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),s("div",{class:"modal-footer"},[e[110]||(e[110]=s("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),s("button",{type:"button",class:"btn btn-dark",onClick:ll},"Add Print Format")])])])]),s("div",vr,[s("div",_r,[s("div",hr,[e[112]||(e[112]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"formViewModalLabel"},"Form Preview"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",br,[X(Qt,{blockArr:rt.value},null,8,["blockArr"])]),e[113]||(e[113]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])]),s("div",gr,[s("div",yr,[s("span",wr,b(R.value==0?"Add designation for Requestors":`Approval Settings For
          Level-${R.value}`),1),e[114]||(e[114]=s("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),s("div",kr,[s("div",Cr,[s("div",Dr,[R.value!==0?(r(),d("div",Fr,[R.value!==0?(r(),d("div",$r,[e[116]||(e[116]=s("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),D(s("select",{"onUpdate:modelValue":e[34]||(e[34]=l=>de.value=l),class:"form-select shadow-none font-12"},e[115]||(e[115]=[s("option",{value:""},"Any one of the selected approvers",-1),s("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),s("option",{value:"all_approvals_required"},"All of the selected approvers",-1),s("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[Te,de.value]])])):_("",!0)])):_("",!0)])]),s("div",Sr,[s("div",qr,[s("span",Ar," Select "+b(R.value===0?"Requestors":"Approvers"),1),s("span",Vr,b(E.value.length)+" Selected ",1)]),ne.value.length?(r(),d("div",Er,[s("div",Lr,[s("div",Tr,[s("input",{type:"checkbox",id:"selectAll",checked:Zs.value,onChange:Gs,class:"form-check-input me-2 designationCheckBox"},null,40,Ur),s("label",Mr," Select all designation ("+b(Be.value.length)+") ",1)]),R.value!==0?(r(),d("div",Or,[D(s("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":e[35]||(e[35]=l=>qe.value=l),class:"form-check-input me-2 designationCheckBox"},null,512),[[Le,qe.value]]),e[117]||(e[117]=s("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):_("",!0),s("div",null,[E.value.length?(r(),d("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:Ys},e[118]||(e[118]=[s("i",{class:"bi bi-x"},null,-1),S(" Clear all ")]))):_("",!0)])]),ne.value.length?(r(),Zt($(Ml),{key:0,multiple:!0,modelValue:E.value,"onUpdate:modelValue":e[36]||(e[36]=l=>E.value=l),options:Be.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):_("",!0)],512)):(r(),d("div",Rr,e[119]||(e[119]=[s("div",{class:"d-flex justify-content-center"},[s("span",null,"No Designations Found")],-1)])))]),R.value!==0?(r(),d("div",Br,[e[120]||(e[120]=s("div",null,[s("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),D(s("select",{"onUpdate:modelValue":e[37]||(e[37]=l=>De.value=l),class:"form-select shadow-none font-12 mt-1 me-2"},[(r(!0),d(L,null,T(ps.value,l=>(r(),d("option",{key:l,value:l},b(l===0?"Requestor":"Approver Level "+l),9,zr))),128))],512),[[Te,De.value,void 0,{number:!0}]])])):_("",!0),R.value!==0?(r(),d("div",Nr,[s("div",Pr,[s("div",jr,[D(s("input",{"onUpdate:modelValue":e[38]||(e[38]=l=>Ze.value=l),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Le,Ze.value]]),e[121]||(e[121]=s("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),ct.value===!0?(r(),d("div",Hr,[D(s("input",{"onUpdate:modelValue":e[39]||(e[39]=l=>Ge.value=l),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Le,Ge.value]]),e[122]||(e[122]=s("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):_("",!0)])])):_("",!0)]),s("div",Jr,[s("div",Wr,[s("div",null,[X(Gt,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:Ks,name:R.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},Kr=It(Zr,[["__scopeId","data-v-ff005066"]]);export{Kr as default};
