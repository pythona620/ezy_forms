var oe=Object.defineProperty,le=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var $=(p,i,u)=>i in p?oe(p,i,{enumerable:!0,configurable:!0,writable:!0,value:u}):p[i]=u,L=(p,i)=>{for(var u in i||(i={}))re.call(i,u)&&$(p,u,i[u]);if(N)for(var u of N(i))de.call(i,u)&&$(p,u,i[u]);return p},P=(p,i)=>le(p,ie(i));import{_ as me,x as ue,E as ce,f as pe,r as l,e as ve,w as ye,y as h,z as C,K as g,o as d,c as m,d as t,b as y,O as z,S as U,F as x,h as B,t as E,i as I,j as O,l as _e,m as j,G as ge,P as fe,H as A}from"./index-OFIKcRIU.js";const be={class:"d-flex justify-content-between align-items-center py-2"},he={class:"d-flex gap-2 align-items-center"},Ce={class:"modal fade",id:"createDepartments",tabindex:"-1","aria-labelledby":"createDepartmentsLabel","aria-hidden":"true"},ke={class:"modal-dialog modal-lg"},ze={class:"modal-content"},Ee={class:"modal-body"},we={class:"d-flex align-items-center"},De={class:"w-100"},Ve={key:0},Fe={class:"table mt-3 global-table"},Se={key:0},Ne={key:1},$e=["onChange"],Le=["onClick"],Pe=["onClick"],Ue=["onClick"],xe={class:"mt-2"},Be={class:"modal fade",id:"viewCategory","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"viewCategoryLabel","aria-hidden":"true"},Ie={class:"modal-dialog"},Oe={class:"modal-content"},je={class:"modal-body"},Ae={class:"table mt-3 global-table"},Re={key:0},Te={key:1},Je=["onChange"],Me=["onClick"],qe=["onClick"],He=["onClick"],Ge={class:"modal-footer"},Ke={__name:"Catagories",setup(p){const i=ue(()=>ce.value);pe(()=>{te()});const u=l(0),w=l([]);l(["yes","no"]);const D=l([]),f=l(""),v=l(null),c=l(""),R=l([]),b=l({ezy_departments_items:[]}),T=l([]),J=l([{name:"View Categories",icon:"fa-solid fa-eye"}]),_=l({limitPageLength:"None",limit_start:0}),M=a=>{_.value.limitPageLength=a,_.value.limit_start=0,fetchTable()},q=([a,e])=>{_.value.limitPageLength=a,_.value.limit_start=e,fetchTable()};function H(a,e){e.name==="View Categories"&&(a?(R.value=a,new bootstrap.Modal(document.getElementById("viewCategory"),{}).show()):(console.warn("No form fields provided."),formCreation(a)))}const V=l([{th:"Department Name",td_key:"department"},{th:"Categoies",td_key:"category"},{th:"Forms",td_key:"forms"}]),G=l({department:{type:"input"},category:{type:"input"},form_category:{type:"select",options:["Software","Hardware"]}}),r=l({department_code:"",department_name:"",business_unit:"",ezy_departments_items:[]});ve({applieddepartment_name:!1,applieddepartment_code:!1,department_name:"",department_code:""}),ye(i,a=>{r.value.business_unit=a,a.length&&k()},{immediate:!0});function K(){f.value&&(r.value.ezy_departments_items.push({category:f.value,parentfield:"ezy_departments_items"}),f.value="")}function Q(a,e){v.value=a,c.value=e}function F(a){c.value.trim()&&(r.value.ezy_departments_items[a].category=c.value,v.value=null,c.value="")}function W(a){r.value.ezy_departments_items.splice(a,1)}function X(a,e){v.value=a,c.value=e}function S(a){c.value.trim()&&(b.value.ezy_departments_items[a].category=c.value,v.value=null,c.value="")}function Y(a){b.value.ezy_departments_items.splice(a,1)}function Z(){h.put(`${C.resource}${g.departments}/${b.value.name}`,b.value).then(a=>{A("Changes Saved"),bootstrap.Modal.getInstance(document.getElementById("viewCategory")).hide()}).catch(a=>{console.error("Error saving categories:",a)})}function ee(a){const e=[];V.value.forEach(n=>{const s=n.td_key;a[s]&&e.push(s,"like",`%${a[s]}%`)}),e.length?k(e):k()}function k(a){const e=[];a&&e.push(a);const n={fields:JSON.stringify(["*"]),filters:JSON.stringify(e),limit_page_length:_.value.limitPageLength,limit_start:_.value.limit_start,order_by:"`tabEzy Category`.`creation` desc"},s={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(e)};h.get(`${C.resource}${g.EzyCategories}`,{params:s}).then(o=>{u.value=o.data[0].total_count}).catch(o=>{console.error("Error fetching ezyForms data:",o)}),h.get(C.resource+g.EzyCategories,{params:n}).then(o=>{o.data&&(w.value=o.data,T.value=[...new Set(o.data.map(ne=>ne.department_name))])}).catch(o=>{console.error("Error fetching department data:",o)})}const te=()=>{const a={fields:JSON.stringify(["*"])};h.get(C.resource+g.wfSettingEzyForms,{params:a}).then(e=>{var n;(n=e==null?void 0:e.data)!=null&&n.length&&(D.value=e.data.map(s=>s.bu_code))}).catch(e=>{console.error("Error fetching ezyForms data:",e)})};function ae(){r.value={department_code:"",department_name:"",ezy_departments_items:[]}}function se(){const a=P(L({},r.value),{doctype:g.departments});h.post(C.resource+g.departments,a).then(e=>{e.data&&(A("Department Created"),k())})}return(a,e)=>(d(),m("div",null,[t("div",be,[e[14]||(e[14]=t("div",null,[t("h1",{class:"m-0 font-13"}," Departments ")],-1)),t("div",he,[t("div",Ce,[t("div",ke,[t("div",ze,[t("div",Ee,[e[9]||(e[9]=t("label",{class:"font-13 ps-1",for:"DepartmentCode"},"Department Code",-1)),y(z,{class:"mb-3",tag:"input",type:"text",name:"DepartmentCode",id:"DepartmentCode",placeholder:"Enter department code",modelValue:r.value.department_code,"onUpdate:modelValue":e[0]||(e[0]=n=>r.value.department_code=n)},null,8,["modelValue"]),e[10]||(e[10]=t("label",{class:"font-13 ps-1",for:"Requedepartment_namested"},"Department name",-1)),y(z,{class:"mb-3",tag:"input",type:"text",name:"department_name",id:"department_name",placeholder:"Enter department name",modelValue:r.value.department_name,"onUpdate:modelValue":e[1]||(e[1]=n=>r.value.department_name=n)},null,8,["modelValue"]),e[11]||(e[11]=t("label",{class:"font-13 ps-1",for:"business_unit"},"Business Unit",-1)),y(z,{tag:"select",placeholder:"",class:"mb-3",name:"business_unit",id:"business_unit",modelValue:r.value.business_unit,"onUpdate:modelValue":e[2]||(e[2]=n=>r.value.business_unit=n),options:D.value},null,8,["modelValue","options"]),t("div",we,[t("div",De,[e[7]||(e[7]=t("label",{class:"font-13 ps-1",for:"ezy_departments_items"},"Ezy Departments Items",-1)),y(z,{class:"mb-3",tag:"input",type:"text",name:"ezy_departments_items",id:"ezy_departments_items",placeholder:"Enter category",modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=n=>f.value=n)},null,8,["modelValue"])]),y(U,{class:"buttoncomp mt-2",name:"Add",onClick:K})]),r.value.ezy_departments_items.length>0?(d(),m("div",Ve,[t("table",Fe,[e[8]||(e[8]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Category Name"),t("th",null,"Actions")])],-1)),t("tbody",null,[(d(!0),m(x,null,B(r.value.ezy_departments_items,(n,s)=>(d(),m("tr",{key:s},[t("td",null,E(s+1),1),v.value!==s?(d(),m("td",Se,E(n.category),1)):(d(),m("td",Ne,[I(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=o=>c.value=o),onChange:o=>F(s),placeholder:"Edit Category"},null,40,$e),[[O,c.value]])])),t("td",null,[v.value!==s?(d(),m("i",{key:0,class:"bi bi-pencil",onClick:o=>Q(s,n.category)},null,8,Le)):(d(),m("i",{key:1,class:"bi bi-check font-20",onClick:o=>F(s)},null,8,Pe)),t("i",{class:"bi bi-trash ms-2",onClick:o=>W(s)},null,8,Ue)])]))),128))])])])):_e("",!0)]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"cancelfilter border-1 text-nowrap font-10 d-flex justify-content-center align-items-center",onClick:ae,"data-bs-dismiss":"modal"},e[12]||(e[12]=[t("span",{class:"font-16 me-1"},[t("i",{class:"bi bi-x"})],-1),j("Cancel ")])),t("button",{type:"button",class:"applyfilter btn btn-dark text-nowrap font-10 d-flex justify-content-center align-items-center","data-bs-dismiss":"modal",onClick:se},e[13]||(e[13]=[t("span",{class:"font-16 me-1"},[t("i",{class:"bi bi-check2"})],-1),j(" Create Department")]))])])])])])]),t("div",xe,[y(ge,{tHeaders:V.value,tData:w.value,onActionClicked:H,isAction:"true",actions:J.value,actionType:"dropdown",isCheckbox:"true",isFiltersoption:"true","field-mapping":G.value,onUpdateFilters:ee},null,8,["tHeaders","tData","actions","field-mapping"]),y(fe,{currentRecords:w.value.length,totalRecords:u.value,onUpdateValue:M,onLimitStart:q},null,8,["currentRecords","totalRecords"])]),t("div",Be,[t("div",Ie,[t("div",Oe,[e[16]||(e[16]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"viewCategoryLabel"},"Ezy Departments Items"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",je,[t("table",Ae,[e[15]||(e[15]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Category Name"),t("th",null,"Actions")])],-1)),t("tbody",null,[(d(!0),m(x,null,B(b.value.ezy_departments_items,(n,s)=>(d(),m("tr",{key:s},[t("td",null,E(s+1),1),v.value!==s?(d(),m("td",Re,E(n.category),1)):(d(),m("td",Te,[I(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=o=>c.value=o),onChange:o=>S(s),placeholder:"Edit Category"},null,40,Je),[[O,c.value]])])),t("td",null,[v.value!==s?(d(),m("i",{key:0,class:"bi bi-pencil",onClick:o=>X(s,n.category)},null,8,Me)):(d(),m("i",{key:1,class:"bi bi-check font-20",onClick:o=>S(s)},null,8,qe)),t("i",{class:"bi bi-trash ms-2",onClick:o=>Y(s)},null,8,He)])]))),128))])])]),t("div",Ge,[y(U,{class:"btn btn-dark font-11",name:"Save Categories",onClick:e[6]||(e[6]=n=>Z())})])])])])]))}},Xe=me(Ke,[["__scopeId","data-v-c3307559"]]);export{Xe as default};
