import{_ as B,r as a,u as U,M as V,x as w,E as A,e as O,w as q,K as z,y as k,z as F,o as G,c as J,d as t,b as f,G as Y,P as $,m as v,t as K,Y as Q,J as W}from"./index-DGkXveTt.js";const X={class:"mt-2"},Z={class:"modal fade",id:"pdfView",tabindex:"-1","aria-labelledby":"pdfViewLabel","aria-hidden":"true"},ee={class:"modal-dialog modal-xl"},te={class:"modal-content"},oe={class:"d-block modal-header bg-dark text-white py-2"},ae={class:"d-flex align-items-center justify-content-between"},se={class:""},ne={class:"modal-body"},le=["innerHTML"],ie={class:"modal fade",id:"FormSetupModal",tabindex:"-1","aria-hidden":"true"},re={class:"modal-dialog modal-dialog-centered"},de={class:"modal-content"},me={class:"modal-body"},ue={class:"text-center"},ce={class:"modal-footer"},pe={__name:"PreDefineForms",setup(fe){const _=a(0),P=a(""),i=a(""),x=a([]);a([]);const D=a([]),b=a({}),r=a([]),c=U(),S=a(""),h=V(),C=a(null),I=a([]),L=a([]),d=w(()=>A.value);O([]);const l=a({limit_start:0,limitPageLength:20,form_name:"",form_short_name:"",accessible_departments:"[]",business_unit:"",form_category:"",owner_of_the_form:"",search:""}),g=a([{th:"Form name",td_key:"form_name"},{th:"Installed",td_key:"installed"}]);q(d,o=>{l.value.business_unit=o,o.length&&(S.value=o,r.value=[],m())},{immediate:!0});function E(o,e,s){i.value=o,s==="edit"&&i.value.installed==="No"&&new bootstrap.Modal(document.getElementById("FormSetupModal"),{}).show(),s==="FormPreview"&&h.push({name:"FormPreviewComp",query:{routepath:c.path,form_short_name:o.form_name,business_unit:d.value}})}function M(){bootstrap.Modal.getInstance(document.getElementById("FormSetupModal")).hide(),h.push({name:"FormStepper",query:{routepath:c.path,preId:"PreDefine",business_unit:d.value,form_name:i.value.form_name,preName:i.value.name}}),localStorage.setItem("form_json",i.value.form_json),localStorage.setItem("preName",i.value.name),localStorage.setItem("routepath",c.path)}function N(){const o={form_short_name:b.value.form_short_name,name:null,business_unit:d.value};k.post(F.download_pdf_form,o).then(e=>{let s=W+e.message;s=s.replace("/api","");const n=document.createElement("a");n.href=s,n.download=e.message.split("/").pop(),n.click()}).catch(e=>{console.error("Error fetching data:",e)})}const y=a(null);function T(o){clearTimeout(y.value),y.value=setTimeout(()=>{const e=[];g.value.forEach(s=>{const n=s.td_key;o[n]&&e.push([n,"like",`%${o[n]}%`])}),m(e.length?e:void 0)},500)}const j=o=>{l.value.limitPageLength=o,l.value.limit_start=0,m()},H=([o,e])=>{l.value.limitPageLength=o,l.value.limit_start=e,m()};function m(o){const e=[];o&&e.push(...o);const s={fields:JSON.stringify(["form_name","installed","form_json","name"]),filters:JSON.stringify(e),limit_page_length:"none",limit_start:l.value.limit_start,doctype:z.preDefinedForm,order_by:"`installed` DESC"};k.get(F.GetDoctypeData,{params:s}).then(n=>{const u=n.message.data;_.value=n.message.total_count,l.value.limit_start===0?(r.value=u,x.value=[...new Set(u.map(p=>p.form_category))],D.value=[...new Set(u.map(p=>p.owner_of_the_form))]):r.value=r.value.concat(u)}).catch(n=>{console.error("Error fetching ezyForms data:",n)})}const R=w(()=>({form_name:{type:"input"},installed:{type:"input"}}));return(o,e)=>(G(),J("div",null,[e[10]||(e[10]=t("div",{class:"d-flex formsticky align-items-center justify-content-between py-2"},[t("div",null,[t("h1",{class:"m-0 font-13 py-2"},"Form Template")])],-1)),t("div",X,[f(Y,{tHeaders:g.value,tData:r.value,isAction:"true",view:"edit",onCellClick:E,isFiltersoption:"true","field-mapping":R.value,actions:L.value,onUpdateFilters:T,isCheckbox:"true"},null,8,["tHeaders","tData","field-mapping","actions"]),f($,{currentRecords:r.value.length,totalRecords:_.value,"items-per-page":l.value.limitPageLength,onUpdateValue:j,onLimitStart:H},null,8,["currentRecords","totalRecords","items-per-page"])]),t("div",Z,[t("div",ee,[t("div",te,[t("div",oe,[t("div",ae,[e[4]||(e[4]=t("div",null,[t("h5",{class:"m-0 text-white font-13",id:"exampleModalLabel"}," PDF format ")],-1)),t("div",se,[t("button",{button:"button",class:"btn btn-dark text-white font-13",onClick:N},e[2]||(e[2]=[v("Download Pdf"),t("span",{class:"ms-2"},[t("i",{class:"bi bi-download"})],-1)])),t("button",{type:"button",class:"btn btn-dark text-white font-13",onClick:e[0]||(e[0]=(...s)=>o.closemodal&&o.closemodal(...s)),"data-bs-dismiss":"modal"},e[3]||(e[3]=[v("Close "),t("i",{class:"bi bi-x"},null,-1)]))])])]),t("div",ne,[t("div",{innerHTML:P.value},null,8,le)]),e[5]||(e[5]=t("div",{class:"modal-footer"},null,-1))])])]),t("div",ie,[t("div",re,[t("div",de,[e[9]||(e[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Form Setup"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",me,[t("div",ue,[e[6]||(e[6]=v(" Are you sure you want to set up the ")),t("strong",null,K(i.value.form_name),1),e[7]||(e[7]=t("br",null,null,-1))])]),t("div",ce,[e[8]||(e[8]=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-dark",onClick:e[1]||(e[1]=s=>M())}," Yes, Proceed ")])])])]),f(Q,{blockArr:C.value,formDescriptions:b.value,childHeaders:I.value},null,8,["blockArr","formDescriptions","childHeaders"])]))}},_e=B(pe,[["__scopeId","data-v-ec0888dd"]]);export{_e as default};
