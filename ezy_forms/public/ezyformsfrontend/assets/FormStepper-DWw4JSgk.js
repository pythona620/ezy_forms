var Ps=Object.defineProperty,Hs=Object.defineProperties;var js=Object.getOwnPropertyDescriptors;var gt=Object.getOwnPropertySymbols;var sl=Object.prototype.hasOwnProperty,ol=Object.prototype.propertyIsEnumerable;var ll=(H,U,R)=>U in H?Ps(H,U,{enumerable:!0,configurable:!0,writable:!0,value:R}):H[U]=R,ie=(H,U)=>{for(var R in U||(U={}))sl.call(U,R)&&ll(H,R,U[R]);if(gt)for(var R of gt(U))ol.call(U,R)&&ll(H,R,U[R]);return H},ze=(H,U)=>Hs(H,js(U));var Ut=(H,U)=>{var R={};for(var T in H)sl.call(H,T)&&U.indexOf(T)<0&&(R[T]=H[T]);if(H!=null&&gt)for(var T of gt(H))U.indexOf(T)<0&&ol.call(H,T)&&(R[T]=H[T]);return R};var Qe=(H,U,R)=>new Promise((T,q)=>{var ae=x=>{try{_(R.next(x))}catch(le){q(le)}},ye=x=>{try{_(R.throw(x))}catch(le){q(le)}},_=x=>x.done?T(x.value):Promise.resolve(x.value).then(ae,ye);_((R=R.apply(H,U)).next())});import{_ as Bt,r as w,x as pe,o as a,c as n,d as e,i as k,j as L,F as O,h as N,t as y,m as D,l as f,Z as Et,Q as Mt,n as z,k as we,N as X,L as M,a6 as Ws,U as re,H as me,u as Js,M as Zs,e as ve,E as Gs,w as Ve,f as Ys,a7 as al,K as fe,y as K,z as Q,a8 as Ks,S as nl,b as oe,O as nt,B as il,R as Pe,X as be,v as yt,a9 as rl,aa as dl,ab as Qs,ac as Lt,a2 as ul,ad as cl,D as pl,ae as Xs}from"./index-OFIKcRIU.js";const xs="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",Is={class:"simple-field-library"},eo={class:"field-search"},to={class:"field-types-grid"},lo=["onDragstart","onClick"],so={__name:"SimpleFieldLibrary",props:{fields:{type:Array,required:!0}},emits:["field-add","field-dragstart","field-dragend"],setup(H,{emit:U}){const R=H,T=U,q=w(""),ae=w(!1),ye=pe(()=>{if(!q.value)return R.fields;const P=q.value.toLowerCase();return R.fields.filter(de=>de.label.toLowerCase().includes(P))}),_=(P,de)=>{ae.value=!0,P.dataTransfer.effectAllowed="copy",P.dataTransfer.setData("text/plain",de.type),T("field-dragstart",de.type)},x=()=>{ae.value=!1,T("field-dragend")},le=P=>{T("field-add",P.type)};return(P,de)=>(a(),n("div",Is,[e("div",eo,[de[1]||(de[1]=e("i",{class:"bi bi-search"},null,-1)),k(e("input",{"onUpdate:modelValue":de[0]||(de[0]=I=>q.value=I),type:"text",placeholder:"Search fields",class:"search-input"},null,512),[[L,q.value]])]),e("div",to,[(a(!0),n(O,null,N(ye.value,I=>(a(),n("button",{key:I.type,class:"field-type-btn",draggable:!0,onDragstart:j=>_(j,I),onDragend:x,onClick:j=>le(I)},y(I.label),41,lo))),128))])]))}},oo=Bt(so,[["__scopeId","data-v-cb64d6f9"]]),ao={class:"frappe-form-builder"},no={class:"builder-toolbar"},io={class:"d-flex gap-2 align-items-center flex-wrap"},ro=["disabled"],uo=["disabled"],co={class:"ms-auto"},po={class:"badge bg-secondary"},mo={class:"fields-container"},vo={key:0,class:"empty-state"},fo=["onMouseenter"],bo={class:"field-index-badge"},_o=["title"],ho={class:"field-content"},go={class:"field-editor"},yo={class:"row g-2 mb-2"},ko={class:"col-md-4"},wo=["onUpdate:modelValue","placeholder","onInput"],$o={class:"col-md-3"},Co=["onUpdate:modelValue","onChange"],Fo={key:0,class:"col-md-3"},Do={class:"input-group input-group-sm"},So=["onUpdate:modelValue","readonly"],Vo={class:"col-md-2"},Ao={class:"d-flex gap-2"},qo=["onClick"],To=["onClick"],Uo=["onClick"],Lo={key:0,class:"quick-options mb-2"},Eo={class:"row g-2"},Mo={key:0,class:"col-md-6"},Bo=["onUpdate:modelValue","placeholder"],Ro=["onUpdate:modelValue","placeholder"],Oo={class:"col-md-6"},No={class:"d-flex gap-3 flex-wrap"},zo={class:"form-check"},Po=["onUpdate:modelValue","id"],Ho=["for"],jo={class:"form-check"},Wo=["onUpdate:modelValue","id"],Jo=["for"],Zo={class:"form-check"},Go=["onUpdate:modelValue","id"],Yo=["for"],Ko={class:"form-check"},Qo=["onUpdate:modelValue","id"],Xo=["for"],xo={class:"form-check"},Io=["onUpdate:modelValue","id"],ea=["for"],ta={key:0,class:"form-check"},la=["onUpdate:modelValue","id"],sa=["for"],oa={key:1,class:"mb-2"},aa=["onUpdate:modelValue"],na={key:2,class:"advanced-panel"},ia={class:"nav nav-tabs nav-tabs-sm mb-2"},ra={class:"nav-item"},da=["onClick"],ua={class:"nav-item"},ca=["onClick"],pa={class:"nav-item"},ma=["onClick"],va={class:"nav-item"},fa=["onClick"],ba={key:0,class:"tab-content"},_a={class:"row g-2"},ha={class:"col-md-6"},ga=["onUpdate:modelValue"],ya={class:"col-md-6"},ka=["onUpdate:modelValue"],wa={key:0,class:"col-md-6"},$a=["onUpdate:modelValue"],Ca={key:1,class:"col-md-6"},Fa=["onUpdate:modelValue"],Da={class:"col-md-6"},Sa=["onUpdate:modelValue"],Va={class:"col-md-6"},Aa=["onUpdate:modelValue"],qa={class:"col-md-12"},Ta={class:"form-check"},Ua=["onUpdate:modelValue","id"],La=["for"],Ea={class:"form-check"},Ma=["onUpdate:modelValue","id"],Ba=["for"],Ra={class:"form-check"},Oa=["onUpdate:modelValue","id"],Na=["for"],za={key:1,class:"tab-content"},Pa={class:"row g-2"},Ha={class:"col-md-12"},ja=["onUpdate:modelValue"],Wa={class:"col-md-12"},Ja=["onUpdate:modelValue"],Za={class:"col-md-12"},Ga=["onUpdate:modelValue"],Ya={key:0,class:"col-md-12"},Ka=["onUpdate:modelValue"],Qa={key:2,class:"tab-content"},Xa={class:"row g-2"},xa={class:"col-md-12"},Ia={class:"input-group input-group-sm mb-2"},en=["onUpdate:modelValue"],tn={class:"dropdown-menu dropdown-menu-end"},ln=["onClick"],sn=["onClick"],on=["onClick"],an=["onClick"],nn=["onClick"],rn={class:"col-md-12"},dn=["onUpdate:modelValue"],un={key:0,class:"col-md-6"},cn={class:"form-check"},pn=["onUpdate:modelValue","id"],mn=["for"],vn={key:3,class:"tab-content"},fn={class:"row g-2"},bn={key:0,class:"col-md-6"},_n=["onUpdate:modelValue"],hn={key:1,class:"col-md-6"},gn=["onUpdate:modelValue"],yn={class:"col-md-12"},kn={class:"form-check"},wn=["onUpdate:modelValue","id"],$n=["for"],Cn={class:"form-check"},Fn=["onUpdate:modelValue","id"],Dn=["for"],Sn={__name:"FrappeFormBuilder",props:{formName:{type:String,default:""},existingFields:{type:Array,default:()=>[]},currentBlockIndex:{type:Number,default:0}},emits:["save","update","addFields"],setup(H,{expose:U,emit:R}){const T=R,q=w([]),ae=w(!1),ye=w(null),_=w(1),x=(S="Data")=>({id:`field_${_.value++}`,idx:q.value.length+1,fieldname:"",fieldtype:S,label:"",description:"",options:"",reqd:0,unique:0,read_only:0,hidden:0,default:"",depends_on:"",mandatory_depends_on:"",read_only_depends_on:"",bold:0,placeholder:"",collapsible:0,collapsible_depends_on:"",precision:"",length:0,non_negative:0,in_list_view:0,in_standard_filter:0,in_global_search:0,allow_bulk_edit:0,columns:0,permlevel:0,allow_on_submit:0,ignore_user_permissions:0,ignore_xss_filter:0,translatable:0,fetch_from:"",fetch_if_empty:0,report_hide:0,print_hide:0,print_hide_if_no_value:0,sort_options:0,remember_last_selected_value:0,is_virtual:0,search_index:0,documentation_url:"",validation_regex:"",validation_message:"",text_transform:"",auto_trim:"",showAdvanced:!1,advancedTab:"config"}),le=(S="field")=>{let p="Data";S==="section_break"?p="Section Break":S==="column_break"?p="Column Break":S==="html"&&(p="HTML");const d=x(p);q.value.push(d),j(),T("update",q.value)},P=S=>{const p=q.value[S].label||q.value[S].fieldtype;confirm(`Delete "${p}"?`)&&(q.value.splice(S,1),j(),T("update",q.value))},de=S=>{const p=ie({},q.value[S]);p.id=`field_${_.value++}`,p.fieldname=`${p.fieldname}_copy`,p.label=`${p.label} (Copy)`,q.value.splice(S+1,0,p),j(),T("update",q.value)},I=()=>{confirm("Clear all fields?")&&(q.value=[],T("update",[]))},j=()=>{q.value.forEach((S,p)=>{S.idx=p+1})},J=()=>{ae.value=!1,j(),T("update",q.value)},W=S=>{const p=q.value[S];!p.label||_e(p.fieldtype)||(p.fieldname=p.label.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),T("update",q.value))},Ae=S=>{const p=q.value[S];Ce(p.fieldtype)||(p.options=""),_e(p.fieldtype)&&(p.fieldname=""),T("update",q.value)},$e=S=>{q.value[S].showAdvanced=!q.value[S].showAdvanced},Ce=S=>["Select","Link","Table","Table MultiSelect","Small Text","Autocomplete"].includes(S),_e=S=>["Section Break","Column Break","HTML"].includes(S),it=S=>["Int","Float","Currency","Percent"].includes(S),rt=S=>S==="Select"||S==="Small Text"||S==="Autocomplete"?`Option 1
Option 2
Option 3`:S==="Link"?"DocType Name (e.g., Customer)":S==="Table"||S==="Table MultiSelect"?"Child DocType Name":"Enter options",B=S=>S==="Section Break"?"Section Label":S==="Column Break"?"Column Label (optional)":S==="HTML"?"HTML Field Label":"Field Label",ue=S=>({Data:"bi bi-fonts","Small Text":"bi bi-textarea-t",Text:"bi bi-textarea","Long Text":"bi bi-file-text","Text Editor":"bi bi-file-richtext",Int:"bi bi-hash",Float:"bi bi-123",Currency:"bi bi-currency-dollar",Percent:"bi bi-percent",Date:"bi bi-calendar-date",Datetime:"bi bi-calendar-event",Time:"bi bi-clock",Link:"bi bi-link-45deg","Dynamic Link":"bi bi-diagram-3",Table:"bi bi-table",Select:"bi bi-list-ul",Autocomplete:"bi bi-search",Check:"bi bi-check-square",Attach:"bi bi-paperclip","Attach Image":"bi bi-image","Section Break":"bi bi-layout-split","Column Break":"bi bi-layout-three-columns",HTML:"bi bi-code-square",Button:"bi bi-mouse",Rating:"bi bi-star",Signature:"bi bi-pen",Color:"bi bi-palette",Barcode:"bi bi-upc"})[S]||"bi bi-question-circle",Xe=S=>/^[a-z_][a-z0-9_]*$/.test(S),je=()=>{const S=[];let p=null,d=null,A=null;return q.value.forEach((h,Rt)=>{h.fieldtype==="Section Break"?(p={label:h.label||"",collapsible:h.collapsible,collapsible_depends_on:h.collapsible_depends_on,depends_on:h.depends_on,rows:[]},d={columns:[]},A={fields:[]},d.columns.push(A),p.rows.push(d),S.push(p)):h.fieldtype==="Column Break"?d&&(A={fields:[]},d.columns.push(A)):h.fieldtype!=="HTML"&&(p||(p={label:"",rows:[]},d={columns:[]},A={fields:[]},d.columns.push(A),p.rows.push(d),S.push(p)),A||(A={fields:[]},d.columns.push(A)),A.fields.push(h))}),S},qe=()=>{for(const p of q.value)if(!_e(p.fieldtype)){if(!p.label||!p.fieldname||!p.fieldtype){re("All fields must have a label, fieldname, and type");return}if(!Xe(p.fieldname)){re(`Invalid fieldname: ${p.fieldname}. Use lowercase letters, numbers, and underscores only.`);return}if(Ce(p.fieldtype)&&(!p.options||!p.options.trim())){re(`Options required for ${p.fieldtype} field: ${p.label}`);return}}const S=je();T("addFields",S),me(`${q.value.length} field(s) added to form!`),q.value=[]};return U({fields:q,addFieldsToBlock:qe,addField:le}),(S,p)=>(a(),n("div",ao,[e("div",no,[e("div",io,[e("button",{onClick:p[0]||(p[0]=d=>le("field")),class:"btn btn-primary btn-sm"},p[7]||(p[7]=[e("i",{class:"bi bi-plus-circle"},null,-1),D(" Add Field ")])),e("button",{onClick:p[1]||(p[1]=d=>le("section_break")),class:"btn btn-outline-primary btn-sm"},p[8]||(p[8]=[e("i",{class:"bi bi-layout-split"},null,-1),D(" Section Break ")])),e("button",{onClick:p[2]||(p[2]=d=>le("column_break")),class:"btn btn-outline-primary btn-sm"},p[9]||(p[9]=[e("i",{class:"bi bi-layout-three-columns"},null,-1),D(" Column Break ")])),e("button",{onClick:p[3]||(p[3]=d=>le("html")),class:"btn btn-outline-primary btn-sm"},p[10]||(p[10]=[e("i",{class:"bi bi-code-square"},null,-1),D(" HTML ")])),p[13]||(p[13]=e("div",{class:"vr"},null,-1)),e("button",{onClick:qe,class:"btn btn-success btn-sm",disabled:q.value.length===0},[p[11]||(p[11]=e("i",{class:"bi bi-check-circle"},null,-1)),D(" Add to Form ("+y(q.value.length)+") ",1)],8,ro),e("button",{onClick:I,class:"btn btn-outline-secondary btn-sm",disabled:q.value.length===0},p[12]||(p[12]=[e("i",{class:"bi bi-trash"},null,-1),D(" Clear All ")]),8,uo),e("div",co,[e("span",po,y(q.value.length)+" field(s)",1)])])]),e("div",mo,[q.value.length===0?(a(),n("div",vo,p[14]||(p[14]=[e("i",{class:"bi bi-inbox"},null,-1),e("p",null,'No fields yet. Click "Add Field" or add Section/Column breaks to start.',-1)]))):f("",!0),q.value.length>0?(a(),Et(M(Ws),{key:1,modelValue:q.value,"onUpdate:modelValue":p[5]||(p[5]=d=>q.value=d),"item-key":d=>d.id,handle:".field-drag-handle",onStart:p[6]||(p[6]=d=>ae.value=!0),onEnd:J,animation:200,"ghost-class":"ghost-field"},{item:Mt(({element:d,index:A})=>[e("div",{class:z(["field-item",{dragging:ae.value,"field-section-break":d.fieldtype==="Section Break","field-column-break":d.fieldtype==="Column Break","field-html":d.fieldtype==="HTML"}]),onMouseenter:h=>ye.value=A,onMouseleave:p[4]||(p[4]=h=>ye.value=null)},[e("div",bo,y(d.idx),1),e("div",{class:"field-type-indicator",title:d.fieldtype},[e("i",{class:z(ue(d.fieldtype))},null,2)],8,_o),e("div",ho,[p[39]||(p[39]=e("div",{class:"field-drag-handle"},[e("i",{class:"bi bi-grip-vertical"})],-1)),e("div",go,[e("div",yo,[e("div",ko,[k(e("input",{"onUpdate:modelValue":h=>d.label=h,placeholder:B(d.fieldtype),class:"form-control form-control-sm",onInput:h=>W(A)},null,40,wo),[[L,d.label]])]),e("div",$o,[k(e("select",{"onUpdate:modelValue":h=>d.fieldtype=h,class:"form-select form-select-sm",onChange:h=>Ae(A)},p[15]||(p[15]=[e("option",{value:""},"Select Type",-1),e("optgroup",{label:"Text"},[e("option",{value:"Data"},"Data (Single Line)"),e("option",{value:"Small Text"},"Small Text (Multi-select)"),e("option",{value:"Text"},"Text (Multi Line)"),e("option",{value:"Long Text"},"Long Text (Large)"),e("option",{value:"Text Editor"},"Text Editor (Rich Text)"),e("option",{value:"Markdown Editor"},"Markdown Editor"),e("option",{value:"HTML Editor"},"HTML Editor"),e("option",{value:"Code"},"Code")],-1),e("optgroup",{label:"Number"},[e("option",{value:"Int"},"Int (Integer)"),e("option",{value:"Float"},"Float (Decimal)"),e("option",{value:"Currency"},"Currency"),e("option",{value:"Percent"},"Percent"),e("option",{value:"Duration"},"Duration"),e("option",{value:"Rating"},"Rating")],-1),e("optgroup",{label:"Date & Time"},[e("option",{value:"Date"},"Date"),e("option",{value:"Datetime"},"Datetime"),e("option",{value:"Time"},"Time")],-1),e("optgroup",{label:"Link"},[e("option",{value:"Link"},"Link (Foreign Key)"),e("option",{value:"Dynamic Link"},"Dynamic Link"),e("option",{value:"Table"},"Table (Child Table)"),e("option",{value:"Table MultiSelect"},"Table MultiSelect")],-1),e("optgroup",{label:"Select"},[e("option",{value:"Select"},"Select (Dropdown)"),e("option",{value:"Autocomplete"},"Autocomplete")],-1),e("optgroup",{label:"Boolean"},[e("option",{value:"Check"},"Check (Checkbox)")],-1),e("optgroup",{label:"Attachment"},[e("option",{value:"Attach"},"Attach (File)"),e("option",{value:"Attach Image"},"Attach Image")],-1),e("optgroup",{label:"Layout"},[e("option",{value:"Section Break"},"Section Break"),e("option",{value:"Column Break"},"Column Break"),e("option",{value:"HTML"},"HTML")],-1),e("optgroup",{label:"Other"},[e("option",{value:"Button"},"Button"),e("option",{value:"Geolocation"},"Geolocation"),e("option",{value:"Barcode"},"Barcode"),e("option",{value:"Color"},"Color"),e("option",{value:"Icon"},"Icon"),e("option",{value:"Signature"},"Signature"),e("option",{value:"JSON"},"JSON")],-1)]),40,Co),[[we,d.fieldtype]])]),_e(d.fieldtype)?f("",!0):(a(),n("div",Fo,[e("div",Do,[p[16]||(p[16]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-tag"})],-1)),k(e("input",{"onUpdate:modelValue":h=>d.fieldname=h,type:"text",class:"form-control form-control-sm font-monospace",placeholder:"fieldname",readonly:!d.label},null,8,So),[[L,d.fieldname]])])])),e("div",Vo,[e("div",Ao,[e("button",{class:"btn btn-sm btn-outline-primary flex-fill",onClick:h=>$e(A),title:"Advanced Options"},p[17]||(p[17]=[e("i",{class:"bi bi-sliders"},null,-1)]),8,qo),e("button",{class:"btn btn-sm btn-outline-secondary",onClick:h=>de(A),title:"Duplicate"},p[18]||(p[18]=[e("i",{class:"bi bi-files"},null,-1)]),8,To),e("button",{class:"btn btn-sm btn-outline-danger",onClick:h=>P(A),title:"Delete"},p[19]||(p[19]=[e("i",{class:"bi bi-trash"},null,-1)]),8,Uo)])])]),_e(d.fieldtype)?f("",!0):(a(),n("div",Lo,[e("div",Eo,[Ce(d.fieldtype)?(a(),n("div",Mo,[d.fieldtype==="Select"||d.fieldtype==="Small Text"?k((a(),n("textarea",{key:0,"onUpdate:modelValue":h=>d.options=h,class:"form-control form-control-sm",rows:"2",placeholder:rt(d.fieldtype)},null,8,Bo)),[[L,d.options]]):k((a(),n("input",{key:1,"onUpdate:modelValue":h=>d.options=h,type:"text",class:"form-control form-control-sm",placeholder:rt(d.fieldtype)},null,8,Ro)),[[L,d.options]])])):f("",!0),e("div",Oo,[e("div",No,[e("div",zo,[k(e("input",{"onUpdate:modelValue":h=>d.reqd=h,type:"checkbox",class:"form-check-input",id:`reqd-${A}`,"true-value":1,"false-value":0},null,8,Po),[[X,d.reqd]]),e("label",{class:"form-check-label small",for:`reqd-${A}`},"Mandatory",8,Ho)]),e("div",jo,[k(e("input",{"onUpdate:modelValue":h=>d.read_only=h,type:"checkbox",class:"form-check-input",id:`ro-${A}`,"true-value":1,"false-value":0},null,8,Wo),[[X,d.read_only]]),e("label",{class:"form-check-label small",for:`ro-${A}`},"Read Only",8,Jo)]),e("div",Zo,[k(e("input",{"onUpdate:modelValue":h=>d.hidden=h,type:"checkbox",class:"form-check-input",id:`hide-${A}`,"true-value":1,"false-value":0},null,8,Go),[[X,d.hidden]]),e("label",{class:"form-check-label small",for:`hide-${A}`},"Hidden",8,Yo)]),e("div",Ko,[k(e("input",{"onUpdate:modelValue":h=>d.unique=h,type:"checkbox",class:"form-check-input",id:`uniq-${A}`,"true-value":1,"false-value":0},null,8,Qo),[[X,d.unique]]),e("label",{class:"form-check-label small",for:`uniq-${A}`},"Unique",8,Xo)]),e("div",xo,[k(e("input",{"onUpdate:modelValue":h=>d.bold=h,type:"checkbox",class:"form-check-input",id:`bold-${A}`,"true-value":1,"false-value":0},null,8,Io),[[X,d.bold]]),e("label",{class:"form-check-label small",for:`bold-${A}`},"Bold",8,ea)]),d.fieldtype==="Section Break"?(a(),n("div",ta,[k(e("input",{"onUpdate:modelValue":h=>d.collapsible=h,type:"checkbox",class:"form-check-input",id:`coll-${A}`,"true-value":1,"false-value":0},null,8,la),[[X,d.collapsible]]),e("label",{class:"form-check-label small",for:`coll-${A}`},"Collapsible",8,sa)])):f("",!0)])])])])),d.fieldtype==="HTML"?(a(),n("div",oa,[k(e("textarea",{"onUpdate:modelValue":h=>d.options=h,class:"form-control form-control-sm font-monospace",rows:"4",placeholder:"Enter HTML content here..."},null,8,aa),[[L,d.options]])])):f("",!0),d.showAdvanced?(a(),n("div",na,[e("ul",ia,[e("li",ra,[e("a",{class:z(["nav-link",{active:d.advancedTab==="config"}]),onClick:h=>d.advancedTab="config",href:"javascript:void(0)"}," Config ",10,da)]),e("li",ua,[e("a",{class:z(["nav-link",{active:d.advancedTab==="conditional"}]),onClick:h=>d.advancedTab="conditional",href:"javascript:void(0)"}," Conditional ",10,ca)]),e("li",pa,[e("a",{class:z(["nav-link",{active:d.advancedTab==="validation"}]),onClick:h=>d.advancedTab="validation",href:"javascript:void(0)"}," Validation ",10,ma)]),e("li",va,[e("a",{class:z(["nav-link",{active:d.advancedTab==="formatting"}]),onClick:h=>d.advancedTab="formatting",href:"javascript:void(0)"}," Formatting ",10,fa)])]),d.advancedTab==="config"?(a(),n("div",ba,[e("div",_a,[e("div",ha,[p[20]||(p[20]=e("label",{class:"form-label small"},"Description",-1)),k(e("textarea",{"onUpdate:modelValue":h=>d.description=h,class:"form-control form-control-sm",rows:"2",placeholder:"Help text for this field"},null,8,ga),[[L,d.description]])]),e("div",ya,[p[21]||(p[21]=e("label",{class:"form-label small"},"Default Value",-1)),k(e("input",{"onUpdate:modelValue":h=>d.default=h,type:"text",class:"form-control form-control-sm",placeholder:"Default value"},null,8,ka),[[L,d.default]])]),it(d.fieldtype)?(a(),n("div",wa,[p[22]||(p[22]=e("label",{class:"form-label small"},"Precision",-1)),k(e("input",{"onUpdate:modelValue":h=>d.precision=h,type:"number",class:"form-control form-control-sm",placeholder:"Decimal places"},null,8,$a),[[L,d.precision,void 0,{number:!0}]])])):f("",!0),d.fieldtype==="Data"?(a(),n("div",Ca,[p[23]||(p[23]=e("label",{class:"form-label small"},"Max Length",-1)),k(e("input",{"onUpdate:modelValue":h=>d.length=h,type:"number",class:"form-control form-control-sm",placeholder:"Maximum characters"},null,8,Fa),[[L,d.length,void 0,{number:!0}]])])):f("",!0),e("div",Da,[p[24]||(p[24]=e("label",{class:"form-label small"},"Placeholder",-1)),k(e("input",{"onUpdate:modelValue":h=>d.placeholder=h,type:"text",class:"form-control form-control-sm",placeholder:"Placeholder text"},null,8,Sa),[[L,d.placeholder]])]),e("div",Va,[p[25]||(p[25]=e("label",{class:"form-label small"},"Columns (Grid Width)",-1)),k(e("input",{"onUpdate:modelValue":h=>d.columns=h,type:"number",class:"form-control form-control-sm",placeholder:"1-12",min:"1",max:"12"},null,8,Aa),[[L,d.columns,void 0,{number:!0}]])]),e("div",qa,[e("div",Ta,[k(e("input",{"onUpdate:modelValue":h=>d.in_list_view=h,type:"checkbox",class:"form-check-input",id:`list-${A}`,"true-value":1,"false-value":0},null,8,Ua),[[X,d.in_list_view]]),e("label",{class:"form-check-label small",for:`list-${A}`},"Show in List View",8,La)]),e("div",Ea,[k(e("input",{"onUpdate:modelValue":h=>d.in_standard_filter=h,type:"checkbox",class:"form-check-input",id:`filt-${A}`,"true-value":1,"false-value":0},null,8,Ma),[[X,d.in_standard_filter]]),e("label",{class:"form-check-label small",for:`filt-${A}`},"In Standard Filter",8,Ba)]),e("div",Ra,[k(e("input",{"onUpdate:modelValue":h=>d.allow_on_submit=h,type:"checkbox",class:"form-check-input",id:`subm-${A}`,"true-value":1,"false-value":0},null,8,Oa),[[X,d.allow_on_submit]]),e("label",{class:"form-check-label small",for:`subm-${A}`},"Allow on Submit",8,Na)])])])])):f("",!0),d.advancedTab==="conditional"?(a(),n("div",za,[e("div",Pa,[e("div",Ha,[p[26]||(p[26]=e("label",{class:"form-label small"},"Depends On (Visibility)",-1)),k(e("input",{"onUpdate:modelValue":h=>d.depends_on=h,type:"text",class:"form-control form-control-sm font-monospace",placeholder:"eval:doc.field_name=='value'"},null,8,ja),[[L,d.depends_on]]),p[27]||(p[27]=e("small",{class:"text-muted"},"Example: eval:doc.status=='Active'",-1))]),e("div",Wa,[p[28]||(p[28]=e("label",{class:"form-label small"},"Mandatory Depends On",-1)),k(e("input",{"onUpdate:modelValue":h=>d.mandatory_depends_on=h,type:"text",class:"form-control form-control-sm font-monospace",placeholder:"eval:doc.field_name=='value'"},null,8,Ja),[[L,d.mandatory_depends_on]])]),e("div",Za,[p[29]||(p[29]=e("label",{class:"form-label small"},"Read Only Depends On",-1)),k(e("input",{"onUpdate:modelValue":h=>d.read_only_depends_on=h,type:"text",class:"form-control form-control-sm font-monospace",placeholder:"eval:doc.field_name=='value'"},null,8,Ga),[[L,d.read_only_depends_on]])]),d.fieldtype==="Section Break"?(a(),n("div",Ya,[p[30]||(p[30]=e("label",{class:"form-label small"},"Collapsible Depends On",-1)),k(e("input",{"onUpdate:modelValue":h=>d.collapsible_depends_on=h,type:"text",class:"form-control form-control-sm font-monospace",placeholder:"eval:doc.field_name=='value'"},null,8,Ka),[[L,d.collapsible_depends_on]])])):f("",!0)])])):f("",!0),d.advancedTab==="validation"?(a(),n("div",Qa,[e("div",Xa,[e("div",xa,[p[32]||(p[32]=e("label",{class:"form-label small"},"Validation Rule (Regex)",-1)),e("div",Ia,[k(e("input",{"onUpdate:modelValue":h=>d.validation_regex=h,type:"text",class:"form-control font-monospace",placeholder:"^[A-Z0-9]+$"},null,8,en),[[L,d.validation_regex]]),p[31]||(p[31]=e("button",{class:"btn btn-outline-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown"}," Presets ",-1)),e("ul",tn,[e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:h=>d.validation_regex="^[A-Za-z ]+$"},"Letters Only",8,ln)]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:h=>d.validation_regex="^[0-9]+$"},"Numbers Only",8,sn)]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:h=>d.validation_regex="^[A-Z0-9]+$"},"Uppercase Alphanumeric",8,on)]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:h=>d.validation_regex="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"},"Email",8,an)]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:h=>d.validation_regex="^[0-9]{10}$"},"Phone (10 digits)",8,nn)])])]),p[33]||(p[33]=e("small",{class:"text-muted"},"Regex pattern for validation",-1))]),e("div",rn,[p[34]||(p[34]=e("label",{class:"form-label small"},"Validation Message",-1)),k(e("input",{"onUpdate:modelValue":h=>d.validation_message=h,type:"text",class:"form-control form-control-sm",placeholder:"Custom error message"},null,8,dn),[[L,d.validation_message]])]),it(d.fieldtype)?(a(),n("div",un,[e("div",cn,[k(e("input",{"onUpdate:modelValue":h=>d.non_negative=h,type:"checkbox",class:"form-check-input",id:`nonneg-${A}`,"true-value":1,"false-value":0},null,8,pn),[[X,d.non_negative]]),e("label",{class:"form-check-label small",for:`nonneg-${A}`},"Non-Negative Only",8,mn)])])):f("",!0)])])):f("",!0),d.advancedTab==="formatting"?(a(),n("div",vn,[e("div",fn,[d.fieldtype==="Data"?(a(),n("div",bn,[p[36]||(p[36]=e("label",{class:"form-label small"},"Text Transform",-1)),k(e("select",{"onUpdate:modelValue":h=>d.text_transform=h,class:"form-select form-select-sm"},p[35]||(p[35]=[e("option",{value:""},"None",-1),e("option",{value:"uppercase"},"UPPERCASE",-1),e("option",{value:"lowercase"},"lowercase",-1),e("option",{value:"titlecase"},"Title Case",-1)]),8,_n),[[we,d.text_transform]])])):f("",!0),d.fieldtype==="Data"?(a(),n("div",hn,[p[38]||(p[38]=e("label",{class:"form-label small"},"Auto Trim",-1)),k(e("select",{"onUpdate:modelValue":h=>d.auto_trim=h,class:"form-select form-select-sm"},p[37]||(p[37]=[e("option",{value:""},"No Trim",-1),e("option",{value:"trim"},"Trim Both Ends",-1),e("option",{value:"trim_start"},"Trim Start",-1),e("option",{value:"trim_end"},"Trim End",-1)]),8,gn),[[we,d.auto_trim]])])):f("",!0),e("div",yn,[e("div",kn,[k(e("input",{"onUpdate:modelValue":h=>d.translatable=h,type:"checkbox",class:"form-check-input",id:`trans-${A}`,"true-value":1,"false-value":0},null,8,wn),[[X,d.translatable]]),e("label",{class:"form-check-label small",for:`trans-${A}`},"Translatable",8,$n)]),e("div",Cn,[k(e("input",{"onUpdate:modelValue":h=>d.print_hide=h,type:"checkbox",class:"form-check-input",id:`prthide-${A}`,"true-value":1,"false-value":0},null,8,Fn),[[X,d.print_hide]]),e("label",{class:"form-check-label small",for:`prthide-${A}`},"Hide in Print",8,Dn)])])])])):f("",!0)])):f("",!0)])])],42,fo)]),_:1},8,["modelValue","item-key"])):f("",!0)])]))}},Vn=Bt(Sn,[["__scopeId","data-v-bba5d51b"]]),An={class:""},qn={class:""},Tn={class:"d-flex justify-content-between align-items-center CancelNdSave"},Un={class:"d-flex align-items-center"},Ln={key:0,class:"font-16"},En=["disabled"],Mn={class:"form-container p-0 container-fluid mt-3"},Bn={class:"row g-4"},Rn={class:"col-lg-2 col-md-3 col-sm-12"},On={class:"steps-sticky-div"},Nn={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},zn=["onClick"],Pn={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},Hn={class:"step-text"},jn={class:"font-11"},Wn={class:"font-14"},Jn={class:"col-lg-10 col-md-9 col-sm-12 formbackground-color"},Zn={class:"px-2"},Gn={class:"form-content stepsDiv"},Yn={key:0},Kn={class:""},Qn={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},Xn={class:"container-fluid aboutFields p-0"},xn={class:"row"},In={class:"col-sm-12 col-md-12 mt-lg-3 p-lg-4"},ei={class:"container-fluid"},ti={class:"row g-3"},li={class:"col-md-6"},si={class:"position-relative"},oi={key:0,class:"font-12 position-absolute PredefinedLabel"},ai={key:1,class:"text-danger ErrorMsg ms-2"},ni={class:"col-md-6"},ii={key:0,class:"text-danger ErrorMsg ms-2"},ri={class:"col-md-6"},di={class:"col-md-6"},ui={key:0,class:"text-danger"},ci={class:"col-md-6"},pi={key:0,class:"text-danger"},mi={class:"col-md-6"},vi={key:0,class:"text-danger"},fi={class:"custom-option"},bi=["checked","onChange"],_i={class:"col-md-6"},hi={class:"col-md-6"},gi={key:0,class:"col-md-6"},yi={key:1,class:"col-md-6"},ki={key:2,class:"col-md-6"},wi={key:3,class:"col-md-6"},$i={class:"form-check d-flex align-items-center p-0 pe-3"},Ci=["disabled"],Fi={key:4,class:"col-md-6"},Di=["disabled"],Si={key:0,class:"list-group position-absolute w-100 z-3 formslist"},Vi=["onMousedown"],Ai={key:1,class:"zoho-form-builder"},qi={class:"zoho-toolbar"},Ti={class:"toolbar-left"},Ui={class:"zoho-tabs"},Li=["onClick"],Ei=["onClick"],Mi={class:"toolbar-right"},Bi={class:"zoho-builder-container"},Ri={key:0,class:"advanced-builder-wrapper"},Oi={class:"d-flex align-items-center justify-content-between w-100"},Ni={class:"mb-0 font-14 fw-bold"},zi={class:"btn btn-sm btn-link p-0 text-dark"},Pi={key:0,class:"library-content"},Hi={class:"zoho-form-canvas"},ji={class:"requestandAppHeader"},Wi={class:"d-flex justify-content-between align-items-center"},Ji={class:""},Zi={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},Gi={class:"text-center ms-2 mt-1"},Yi={key:0,class:"font-12 d-flex align-items-center"},Ki={class:"font-12 approver_type_div"},Qi={class:"font-12 fw-bold"},Xi={class:"font-12 text-danger ms-1"},xi={class:"d-flex align-items-center"},Ii={key:0,class:"role-container"},er={key:0,class:"role-text d-flex align-items-center"},tr={class:"role-label fw-bold"},lr={class:"role-names text-primary"},sr=["onClick"],or=["onClick"],ar=["onClick"],nr=["onClick"],ir={class:"pt-0 section_block"},rr={class:"d-flex justify-content-between align-items-center"},dr={class:"d-flex flex-column"},ur=["onUpdate:modelValue","onChange","onInput"],cr={key:0,class:"text-danger ps-3 font-10"},pr={class:"d-flex align-items-center"},mr=["onClick"],vr={class:"container-fluid"},fr={class:"d-flex justify-content-between align-items-center"},br={class:"rownames m-0"},_r=["onClick"],hr={class:"col"},gr={class:"row"},yr=["onMouseenter"],kr={class:"column_name d-flex align-items-center justify-content-between"},wr={class:"d-flex flex-column ps-2"},$r=["onUpdate:modelValue","onChange","onInput"],Cr={key:0,class:"text-danger ps-2 font-10"},Fr={class:"position-absolute top-0 end-0"},Dr=["onClick"],Sr=["onDrop"],Vr=["onMouseenter","onDragstart","onDrop"],Ar=["onDrop"],qr=["onDragstart","onDrop"],Tr={class:"d-flex justify-content-between"},Ur={class:"flex-column d-flex"},Lr=["onUpdate:modelValue","onChange","onInput"],Er={key:0,class:"text-danger font-10"},Mr={class:"FieldcopyRemove"},Br=["onClick"],Rr=["onClick"],Or=["onUpdate:modelValue","onChange"],Nr=["value"],zr={key:0},Pr=["onUpdate:modelValue"],Hr={key:0,class:"text-danger font-10"},jr={key:1},Wr=["for"],Jr=["id","onUpdate:modelValue","onInput","onFocus"],Zr={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},Gr=["onClick"],Yr={class:"d-flex align-items-center justify-content-between"},Kr={class:"d-flex align-items-center gap-2"},Qr={class:"d-flex align-items-center"},Xr=["onUpdate:modelValue","id"],xr=["for"],Ir=["onClick"],ed=["onUpdate:modelValue"],td={key:3,class:"text-danger font-10"},ld=["onDrop"],sd={class:"childtableShow"},od={class:"mt-2"},ad={key:0,class:"childTableContainer"},nd={key:0,class:"font-13"},id={key:1,class:"d-flex align-items-center gap-2"},rd={class:"d-flex align-items-center"},dd=["onUpdate:modelValue"],ud=["onClick"],cd={key:2,class:"table table-bordered rounded-table"},pd=["onDrop"],md=["draggable","onDragstart"],vd={key:0},fd=["onUpdate:modelValue","onInput"],bd={key:0,class:"text-danger font-11"},_d={key:1},hd={key:2},gd={class:"d-flex gap-1"},yd=["onUpdate:modelValue","onChange"],kd=["value"],wd={class:"d-flex"},$d={class:"d-flex align-items-center gap-2"},Cd={class:"d-flex align-items-center"},Fd=["onUpdate:modelValue"],Dd=["onClick"],Sd={key:0},Vd=["onUpdate:modelValue","onInput"],Ad={key:0,class:"text-danger font-10"},qd={key:1,class:"font-11 text-danger"},Td={key:3},Ud={key:3,class:"mb-2 mt-3"},Ld=["onClick"],Ed=["onClick"],Md=["onDrop"],Bd=["onDrop"],Rd={class:"d-flex justify-content-center align-items-center my-2"},Od=["onClick"],Nd={class:"font-13"},zd={key:0,class:"d-flex align-items-center gap-2"},Pd={class:"d-flex align-items-center"},Hd=["onUpdate:modelValue"],jd=["onClick"],Wd={class:"table table-bordered rounded-table"},Jd={key:0},Zd=["onUpdate:modelValue","onBlur"],Gd={key:0,class:"text-danger font-11 mt-1"},Yd={key:1},Kd={key:2},Qd={class:"d-flex gap-1 align-items-center"},Xd=["onUpdate:modelValue","onChange"],xd=["value"],Id=["onClick"],eu={key:0,class:"mt-1"},tu=["onUpdate:modelValue","onInput"],lu={key:1,class:"text-danger font-11 mt-1"},su={key:3},ou={class:"mb-2"},au=["onClick"],nu=["onClick"],iu=["onClick"],ru={key:0},du={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},uu=["onUpdate:modelValue","onBlur"],cu={key:0,class:"text-danger font-12"},pu={key:1,class:"text-danger font-12"},mu={class:"d-flex align-items-center gap-2"},vu={class:"d-flex align-items-center"},fu=["onUpdate:modelValue"],bu=["onClick"],_u=["onClick"],hu={class:"px-1 field-border"},gu={class:"d-flex justify-content-between"},yu=["onUpdate:modelValue","onBlur"],ku={key:0,class:"text-danger font-12"},wu={class:"d-flex align-items-center"},$u={class:"d-flex my-1"},Cu=["onUpdate:modelValue"],Fu=["onClick"],Du=["onClick"],Su=["onUpdate:modelValue"],Vu=["value"],Au={key:0},qu=["onUpdate:modelValue"],Tu={key:0,class:"text-danger font-10"},Uu={key:1,class:"text-danger font-12"},Lu=["onClick"],Eu=["onClick"],Mu={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},Bu=["onClick"],Ru={key:0,class:"m-2"},Ou={key:0,class:"zoho-properties-panel"},Nu={class:"properties-header"},zu={key:2},Pu={class:"stepperbackground d-flex align-items-center justify-content-between p-3"},Hu={class:"container-fluid mt-4 p-4"},ju={class:"card mb-4"},Wu={class:"card-body"},Ju={class:"row g-3"},Zu={class:"col-md-6"},Gu={class:"btn-group w-100",role:"group"},Yu={key:0,class:"col-md-6"},Ku={key:0,class:"card mb-4"},Qu={class:"card-body"},Xu={key:0,class:"table-responsive"},xu={class:"table table-bordered"},Iu=["onUpdate:modelValue"],ec={class:"form-check form-switch"},tc=["onUpdate:modelValue"],lc={class:"form-check-label font-12"},sc=["onClick"],oc=["onClick"],ac={key:1,class:"card mb-4"},nc={class:"card-body"},ic={class:"alert alert-success"},rc={class:"table-responsive"},dc={class:"table table-bordered"},uc={key:0,class:"badge bg-success"},cc={key:1,class:"badge bg-secondary"},pc={class:"text-muted"},mc={key:2,class:"card mb-4"},vc={class:"card-body"},fc={class:"alert alert-success"},bc={class:"table-responsive"},_c={class:"table table-bordered table-hover"},hc={class:"badge bg-dark"},gc={key:0,class:"badge bg-danger"},yc={key:1,class:"badge bg-secondary"},kc={key:0,class:"badge bg-info"},wc={key:1,class:"badge bg-warning text-dark"},$c={key:2,class:"badge bg-success"},Cc={key:3,class:"badge bg-secondary"},Fc={class:"text-muted"},Dc={key:3},Sc={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},Vc={class:"modal-dialog modal-dialog-centered"},Ac={class:"modal-content"},qc={class:"modal-body"},Tc=["placeholder"],Uc={class:"d-flex align-items-center gap-2"},Lc={class:"d-flex align-items-center py-2"},Ec={class:"modal fade",id:"formViewModal",tabindex:"-1","aria-labelledby":"formViewModalLabel","aria-hidden":"true"},Mc={class:"modal-dialog modal-xl modal-dialog-scrollable"},Bc={class:"modal-content"},Rc={class:"modal-body"},Oc={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},Nc={class:"offcanvas-header add_designationHeader"},zc={id:"offcanvasRightLabel",class:"font-14 fw-bold"},Pc={class:"offcanvas-body add_desig_offCanvas_body p-0"},Hc={class:""},jc={key:0,class:"p-3 approval-border-bottom"},Wc={class:"px-3 listofdesignations"},Jc={class:"my-1 d-flex justify-content-between"},Zc={class:"font-12 fw-bold"},Gc={class:"italic-style text-secondary font-12"},Yc={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},Kc={class:"d-flex align-items-center justify-content-between gap-1"},Qc={class:"form-check ps-1 d-flex align-items-center m-0"},Xc=["checked"],xc={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},Ic={key:0,class:"form-check d-flex align-items-center m-0"},ep={key:1},tp={key:1,class:"p-3"},lp=["value"],sp={key:2},op={class:""},ap={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},np={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},ip={class:"offcanvas-footer"},rp={class:"text-end p-3"},He="Select All",dp={__name:"FormStepper",setup(H){const U=Js(),R=Zs(),T=w(1),q=w([]);w([]);const ae=w([]),ye=w([]);ve([]);let _=ve([]),x=ve([]);const le=w([]),P=w([]),de=w([]),I=w(""),j=w(""),J=w("");let W=ve([]);const Ae=w("");w(!1),w(!1),w(!1);const $e=w(""),Ce=w(""),_e=w(""),it=w([]),rt=w([]),B=ve({}),ue=w([]),Xe=w(!1),je=w([]),qe=w(!1);let S=null;const p=w("");let d=w("");const A=w(null),h=w(null),Rt=w(null),Te=w(0),Ue=w(!1),We=w(!0),xe=w([]),Fe=w(null),ke=w("new"),dt=w([]),Je=w([]);w([]);const Le=w([]),Ee=pe(()=>Gs);w(!1);const ut=ve([]),ce=w({routepath:U.query.routepath,business_unit:U.query.business_unit,formId:U.query.id}),ct=w(""),Ze=w(!1),Ge=w(!1),Ot=[{label:"Public",value:1},{label:"Private",value:0}],Nt=pe({get(){return Ot.find(l=>l.value===g.value.as_web_view)},set(l){g.value.as_web_view=l?l.value:null}}),kt=pe({get(){return g.value.form_name||U.query.form_name||""},set(l){g.value.form_name=l}}),g=w({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${Ee.value.value||ce.value.business_unit||U.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:U.query.id?1:0,as_web_view:0,mail_id:""});Ve(()=>U.query.form_name,l=>{l&&(g.value.form_name=l,g.value.form_short_name=l)},{immediate:!0});const pt=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(l=>l.toLowerCase().trim()),zt=["Approver","Approved on","Approved By"].map(l=>l.toLowerCase().trim());function ml(l){return l.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}pe(()=>g.value),w(""),w(!1),Ve(Ee,l=>{l&&l.value&&(g.value.business_unit=l.value)},{immediate:!0});function vl(l){if(d==null||d==="new")return!1;const t=G(l).roles;if(l===0)return t.length===0;const s=G(l-1).roles;return s.length>0&&s[0]!==null&&s[0]!==""&&t.length===0}Ve(()=>g.value.form_name,l=>{g.value.form_name=l.trim()}),Ve(()=>g.value.form_short_name,l=>{g.value.form_short_name=l.trim()}),Ve(()=>g.value.series,l=>{g.value.series=l.trim()}),Ve(()=>ke.value,l=>{l==="existing"&&(_.splice(0,_.length),Le.value=[],W.length=0)});const Ie=w(null),Pt=(l,t,s,o,i,r)=>{Ie.value={blockIndex:t,sectionIndex:s,rowIndex:o,columnIndex:i,fieldIndex:r}},Me=(l,t,s,o,i,r)=>{if(l.preventDefault(),l.stopPropagation(),console.log("Field dropped at index:",{targetBlock:t,targetSection:s,targetRow:o,targetColumn:i,insertIndex:r,draggedField:Ie.value,draggedFieldType:A.value}),A.value){console.log("Dropping from field library:",A.value);const F=tl(A.value);if(!F){console.error("Failed to create field from type:",A.value);return}const V=_[t];if(!V){re("Target block not found");return}V.sections||(V.sections=[]),V.sections[s]||(V.sections[s]={label:"",rows:[]}),V.sections[s].rows||(V.sections[s].rows=[]),V.sections[s].rows[o]||(V.sections[s].rows[o]={label:"",columns:[]}),V.sections[s].rows[o].columns||(V.sections[s].rows[o].columns=[]),V.sections[s].rows[o].columns[i]||(V.sections[s].rows[o].columns[i]={label:"",fields:[]}),V.sections[s].rows[o].columns[i].fields.splice(r,0,F),console.log("Field added successfully:",F),me(`${F.label} field added`),A.value=null;return}if(!Ie.value){console.log("No dragged field found");return}const{blockIndex:c,sectionIndex:m,rowIndex:b,columnIndex:u,fieldIndex:v}=Ie.value,C=_[c].sections[m].rows[b].columns[u].fields,E=_[t].sections[s].rows[o].columns[i].fields;if(c===t&&m===s&&b===o&&u===i&&v===r)return;const $=C.splice(v,1)[0];C===E&&v<r&&r--,E.splice(r,0,$),Ie.value=null},Ye=w(""),fl=l=>Qe(this,null,function*(){const t=[["module","in",["User Forms"]],["istable","=",1]];l!=null&&l.trim()&&t.push(["name","=",`${l}`]);const s={fields:JSON.stringify(["name"]),filters:JSON.stringify(t),limit_page_length:"None",doctype:fe.doctypesList};try{return(yield K.get(Q.GetDoctypeData,{params:s})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),mt=w(null),Ht=l=>Qe(this,null,function*(){if(Ye.value="",mt.value=null,l.tableName){let t=l.tableName.trim();if(t.length>64){Ye.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(t)){Ye.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield fl(t);mt.value=o.find(i=>i.name.toLowerCase()===t.toLowerCase()),mt.value&&(Ye.value="Table already exists"),l.tableName=t}l.label&&(l.fieldname=ml(l.label))});function bl(){const l=g.value.is_linked_form;if(!l){je.value=[];return}clearTimeout(S),S=setTimeout(()=>{const t=[["business_unit","=",`${Ee.value.value}`],["name","like",`%${l}%`]],s={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(t),doctype:fe.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};K.get(`${Q.GetDoctypeData}`,{params:s}).then(o=>{je.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function _l(l){g.value.is_linked_form=l,qe.value=!1}function hl(){setTimeout(()=>{qe.value=!1},200)}ve({query:"",key:""});function De(l,t,s,o,i){return`${l}-${t}-${s}-${o}-${i}`}ve({});const et=ve({}),wt=ve({});function gl(l){wt[l]=!0}function yl(l,t,s,o,i,r){const c=De(t,s,o,i,r),m=[["istable","=",0]];l!=null&&l.trim()&&m.push(["name","like",`%${l}%`]);const b={fields:JSON.stringify(["name"]),filters:JSON.stringify(m),limit_page_length:"none",doctype:fe.doctypesList};K.get(Q.GetDoctypeData,{params:b}).then(u=>{et[c]=u.message.data||[]}).catch(u=>{console.error("Error fetching doctype list:",u),et[c]=[]})}function kl(l,t,s,o,i,r){_[l].sections[t].rows[s].columns[o].fields[i].options=r;const c=De(l,t,s,o,i);et[c]=[],wt[c]=!1}const wl=pe(()=>_!=null&&_.length?J.value===1?[0]:Array.from({length:J.value},(l,t)=>t).filter(l=>l<J.value):[]),Se=w(null),Be=w(null),$l=(l,t,s,o,i)=>{Se.value={blockIndex:l,sectionIndex:t,rowIndex:s,columnIndex:o,fieldIndex:i}},Cl=()=>{Se.value=null},Fl=(l,t,s,o,i)=>Se.value&&Se.value.blockIndex===l&&Se.value.sectionIndex===t&&Se.value.rowIndex===s&&Se.value.columnIndex===o&&Se.value.fieldIndex===i,Dl=(l,t,s,o)=>{Be.value={blockIndex:l,sectionIndex:t,rowIndex:s,columnIndex:o}},Sl=()=>{Be.value=null},Vl=(l,t,s,o)=>Be.value&&Be.value.blockIndex===l&&Be.value.sectionIndex===t&&Be.value.rowIndex===s&&Be.value.columnIndex===o,jt=w([{form_json:""}]),Re=w("");Ys(()=>{Gt(),Re.value=U.query.Clone,d.value=U.query.id||"new",Re.value==="1"&&(g.value.series=""),d.value!=null&&d.value!=null&&d.value!="new"&&(Zt(),At()),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?Xe.value=!0:Xe.value=!1;let l=localStorage.getItem("Bu");if(g.value.business_unit=l,U.query.preId==="PreDefine"){const t=localStorage.getItem("form_json");if(t){jt.value[0].form_json=t;const s=jt.value[0],o=JSON.parse(s.form_json),i=al(o.fields);ue.value=o.child_table_fields,i.forEach(r=>{_.push(r)})}}});const Oe=w(null),se=ve({}),Wt=w(null),Al=l=>{Oe.value=l},ql=()=>{Oe.value=null},Tl=l=>{l.preventDefault()},Ul=(l,t)=>{const s=l.target.closest("tr");if(!s)return;const o=Array.from(s.parentNode.children).indexOf(s);if(o!==Oe.value){const i=t[Oe.value];t.splice(Oe.value,1),t.splice(o,0,i),Oe.value=o}},Ll=w([]),$t=l=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(l.fieldtype)&&l.options){const t=l.options.split(`
`).map(i=>i.trim()).filter(i=>i),s=[],o=new Set;return t.forEach(i=>{const r=i.toLowerCase();o.has(r)||(o.add(r),s.push(i))}),`
`+s.join(`
`)}else if(["Link","Table"].includes(l.fieldtype)&&l.options)return l.options.trim();return l.options},El=(l,t)=>{const s=_[l].sections[t];s.childTables||(s.childTables=[]);const o=s.childTables.length;s.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[ie({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},ut.fieldtype==="Select"&&ut.options?{options:ut.options?`
${ut.options}`:`
`}:{})],newTable:!0})},Ml=(l,t,s)=>{const o=_[l].sections[t].childTables[s];o.columns||(o.columns=[]),o.columns.push(ie({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},Bl=(l,t,s)=>{_[l].sections[t].childTables.splice(s,1)},Rl=(l,t,s,o)=>{_[l].sections[t].childTables[s].columns.splice(o,1)};function Ol(l,t,s,o,i,r){var u;const c=`${t}-${s}-${o}`;B[c]||(B[c]={columns:[]});const m={},b=((u=l.label)==null?void 0:u.trim())||"";if(!b)m.label="Field Label is required";else{const v=b.toLowerCase();if(pt.includes(v)&&!zt.includes(v))m.label=`"${b}" is a restricted field label`;else if(b.length>64)m.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(b))m.label="Field Label can only contain letters, numbers, and single spaces between words";else{const C=r.map((E,$)=>{var F;return{label:(F=E.label)==null?void 0:F.trim().toLowerCase(),index:$}}).filter(E=>E.label===v);if(C.length>1){const E=C[0].index;i!==E&&(m.label=`"${b}" is already used in this table`)}}}B[c].columns[i]=m}function vt(l,t,s){var r;B[t]||(B[t]={});const o=[],i=((r=l.label)==null?void 0:r.trim())||"";i||o.push("Label is required"),i.length>64&&o.push("Label cannot exceed 64 characters"),i&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(i)&&o.push("No special characters allowed"),i&&pt.includes(i.toLowerCase().trim())&&o.push("This label is restricted"),i&&ue.value[t].map(b=>{var u;return(u=b.label)==null?void 0:u.trim().toLowerCase()}).filter(Boolean).filter(b=>b===i.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),l.fieldtype||o.push("Field type is required"),l.fieldtype==="Select"&&(!l.options||l.options.trim()==="")&&o.push("Options are required"),B[t][s]=o}const Nl=(l,t,s)=>{var c;const o=_[l].sections[t].childTables[s],i={tableName:!1,columns:[]};let r=!1;return(c=o.tableName)!=null&&c.trim()||(i.tableName="Table name is required.",r=!0),o.columns.forEach((m,b)=>{var v,C;const u={};(v=m.label)!=null&&v.trim()||(u.label="Field Label is required",r=!0),(C=m.fieldtype)!=null&&C.trim()||(u.fieldtype="Please select field type",r=!0),i.columns[b]=u}),B[`${l}-${t}-${s}`]=i,r},zl=(l,t,s)=>{var i,r;const o=(r=(i=_[l])==null?void 0:i.sections)==null?void 0:r[t];o&&!Array.isArray(o[s])&&(o[s]=[])},Pl=l=>l?l.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",Hl=(l,t,s)=>{if(Nl(l,t,s)){re("Please fix validation errors before creating the table",{transition:"zoom"});return}if(mt.value){re("Table already exists",{transition:"zoom"});return}const i=_[l].sections[t].childTables[s],r=_[l].sections[t];i.columns=i.columns.map((m,b)=>ze(ie({},m),{idx:b,options:$t(m)})),i.newTable=!1;const c={form_short_name:i.tableName,fields:i.columns,idx:i.idx,as_a_block:i.as_a_block?i.as_a_block:"false"};K.post(Q.childtable,c).then(m=>{var b,u,v;if(m){zl(l,t,"afterCreated"),r.afterCreated[s]=ie({},i),me("Table created successfully!");const C=(v=(u=(b=m.message)==null?void 0:b[0])==null?void 0:u[0])==null?void 0:v.child_doc;C&&(_[l].sections[t].childTables[s]=ze(ie(ie({},_[l].sections[t].childTables[s]),C),{newTable:!1}))}}).catch(m=>{console.error("Error creating table:",m)})},tt=(l,t,s,o=[])=>{var c;se[t]||(se[t]=[]),se[t]=se[t].filter(m=>m!==s),B[t]||(B[t]=[]),B[t][s]=[];const i=[],r=((c=l.label)==null?void 0:c.trim())||"";if(r?pt.includes(r.toLowerCase())?i.push("This label is restricted"):r.length>64?i.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(r)||i.push("Only letters, numbers, and single spaces allowed"):i.push("Label is required"),o.length){const m=r.toLowerCase(),b=o.map((u,v)=>{var C;return{label:(C=u.label)==null?void 0:C.trim().toLowerCase(),idx:v}}).filter(u=>u.label===m);if(b.length>1){const u=b[0].idx;s!==u?(i.push("Duplicate label not allowed"),l._duplicate=!0):l._duplicate=!1}else l._duplicate=!1}return l.fieldtype||i.push("Field type is required"),l.fieldtype==="Select"&&(!l.options||!l.options.trim())&&i.push("Options are required"),B[t][s]=i,i.length>0&&se[t].push(s),i.length===0},jl=(l,t,s)=>{const i=_[l].sections[t].afterCreated.find(m=>m.tableName===s);if(!i)return;const r=i.columns.length,c={fieldname:"",fieldtype:"",idx:r+1,label:"",value:"",isNew:!0,description:""};i.columns.push(c),tt(c,s,r,i.columns)},Jt=w([]),Wl=(l,t,s,o)=>{const r=_[l].sections[t].afterCreated.find(m=>m.tableName===s);if(!r)return;r.columns.splice(o,1),r.columns.forEach((m,b)=>{m.idx=b+1});const c=se.value[s];c&&(se.value[s]=c.filter(m=>m!==o).map(m=>m>o?m-1:m))},Jl=(l,t,s)=>{const i=_[l].sections[t].afterCreated.find(r=>r.tableName===s);if(i){if(ee[s]){se[s]=[];let r=!0;if(i.columns.forEach((b,u)=>{tt(b,s,u,i.columns)||(r=!1)}),!r){re("Please fix the errors in the highlighted fields before saving!");return}const c=i.columns.map((C,v)=>{var E=C,{isNew:b}=E,u=Ut(E,["isNew"]);return ze(ie({},u),{idx:v+1,options:$t(u)})}),m={form_short_name:Pl(s),fields:c,as_a_block:i.description};K.post(Q.childtable,m).then(b=>{Jt.value=b.data,me("Fields updated successfully!")}).catch(b=>{console.error("âŒ Saving fields failed:",b)})}ee[s]=!ee[s]}},ee=ve({}),Zl=l=>{ue.value[l]||(ue.value[l]=[]);const t=ue.value[l].length+1;ue.value[l].push({fieldname:"",fieldtype:"",idx:t,label:"",value:"",isNew:!0,description:"",options:ue.value[l].options?`
${ue.value[l].options}`:""})},Gl=(l,t)=>{ue.value[l]&&ue.value[l].splice(t,1)},Yl=(l,t)=>{if(!l)return;se.value||(se.value={}),se.value[l]||(se.value[l]=[]);const s=ue.value[l];if(s){if(ee[l]){se.value[l]=[];let o=!0;if(s.forEach((c,m)=>{var u;vt(c,l,m);const b=(u=B[l])==null?void 0:u[m];b&&b.length>0&&(se.value[l].push(m),o=!1),c.label&&(c.label=c.label.trim())}),!o){re("Please fix the errors before saving");return}const i=s.map((u,b)=>{var v=u,{isNew:c}=v,m=Ut(v,["isNew"]);return ze(ie({},m),{idx:b+1,options:$t(m)})}),r={form_short_name:l,fields:i,as_a_block:t};K.post(Q.childtable,r).then(c=>{Jt.value=c.data,me("Fields updated successfully!")}).catch(c=>{console.error("âŒ Saving fields failed:",c)})}ee[l]=!ee[l],Wt.value=ee[l]?l:null}},Kl=w([{id:1,label:"Form Info",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Form Fields",stepno:"Step 2",icon:"bi bi-grid-3x3-gap"},{id:3,label:"Workflow Setup",stepno:"Step 3",icon:"bi bi-diagram-3"},{id:4,label:"Print Format",stepno:"Step 4",icon:"ri-checkbox-circle-line"}]),Ct=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],ft=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],Ql=pe(()=>[He,...ae.value]),Xl=pe(()=>{const l=g.value.accessible_departments;return l.includes(He)?"All Selected":l.length>1?`${l[0]}.. +${l.length-1} more selected`:l.join(", ")}),xl=l=>l===He?g.value.accessible_departments.length===ae.value.length:g.value.accessible_departments.includes(l),Il=(l,t)=>{l===He?t.target.checked?g.value.accessible_departments=[...ae.value]:g.value.accessible_departments=[]:(t.target.checked?g.value.accessible_departments.push(l):g.value.accessible_departments=g.value.accessible_departments.filter(s=>s!==l),g.value.accessible_departments.length===ae.value.length?g.value.accessible_departments=[...ae.value]:g.value.accessible_departments=g.value.accessible_departments.filter(s=>s!==He))},es=l=>{l===He&&(g.value.accessible_departments=[...ae.value])},ts=l=>{l===He&&(g.value.accessible_departments=[])},Ft=w(!1),lt=pe(()=>{var t;let l=[...le.value];if(Ge.value&&(l=l.filter(s=>s.is_hod===1)),(t=Ae.value)!=null&&t.trim()){const s=Ae.value.toLowerCase();l=l.filter(o=>o.role.toLowerCase().includes(s))}return l.sort((s,o)=>s.role.localeCompare(o.role)),l.sort((s,o)=>{const i=P.value.includes(s.role),r=P.value.includes(o.role);return i===r?0:i?1:-1}),l.map(s=>s.role)}),ls=pe(()=>{const l=lt.value;return l.length>0&&l.every(t=>P.value.includes(t))});Ve([P,lt],()=>{const l=lt.value;Ft.value=l.length>0&&l.every(t=>P.value.includes(t))},{immediate:!0,deep:!0});function ss(l){const t=l.target.checked,s=le.value.filter(o=>{var i;return!(Ge.value&&o.is_hod!==1||(i=Ae.value)!=null&&i.trim()&&!o.role.toLowerCase().includes(Ae.value.toLowerCase()))}).map(o=>o.role);t?P.value=Array.from(new Set([...P.value,...s])):P.value=P.value.filter(o=>!s.includes(o)),Ft.value=t}function os(){P.value=[],Ft.value=!1,Ge.value=!1}const he=w("");function as(){const l=_[J.value];if(!l||!l.sections){console.error("Error: Invalid block or sections not found.");return}let t={type:J.value==0?"requestor":"approver",roles:P.value,approval_required:Ce.value,approver_can_edit:_e.value,fields:l.sections.flatMap(Lt),idx:J.value};J.value!==0&&(t.view_only_reportee=he.value==="ViewOnlyReportee"?1:0,t.all_approvals_required=he.value==="all_approvals_required"?1:0,t.requester_as_a_approver=he.value==="requester_as_a_approver"?1:0,t.on_rejection=$e.value?$e.value:0);const s=W.findIndex(o=>o.idx===t.idx);s!==-1?W[s]=t:W.push(t),rs()}function G(l){const t=W.filter(i=>i.idx===l);if(t.length===0)return{roles:[]};if(t.length===1)return t[0];const s=ie({},t[0]),o=[];return t.forEach(i=>{i.roles&&Array.isArray(i.roles)&&o.push(...i.roles)}),s.roles=o,console.log(`getWorkflowSetup(${l}): Found ${t.length} entries, merged roles:`,o),s}function ns(l){const t=G(l),s=t.roles||[];P.value=[...s],$e.value=t.on_rejection,Ce.value=t.approval_required,_e.value=t.approver_can_edit,t.view_only_reportee===1?he.value="ViewOnlyReportee":t.all_approvals_required===1?he.value="all_approvals_required":t.requester_as_a_approver===1?he.value="requester_as_a_approver":he.value=""}const Dt=l=>{Ge.value=!1,Ae.value="",he.value="",$e.value="",g.value.accessible_departments.length&&is(l,g.value.accessible_departments),J.value=l,ns(l)};function is(l,t){let s={index:l,departments:t,property:g.value.business_unit};K.post(Q.addDesignationroles,s).then(o=>{o.message&&(le.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function rs(){K.post(Q.add_roles_WF,{workflow_setup:W,doctype:g.value.form_short_name,business_unit:g.value.business_unit}).then(l=>{console.log(l),J.value==0?me("Requestor Added"):me(`Approver-${J.value} Added`)})}function ds(){R.push({path:ce.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function us(){g.value.form_name="",g.value.form_short_name="",g.value.owner_of_the_form="",g.value.business_unit="",g.value.form_category="",g.value.accessible_departments=[]}const cs=l=>{if(_t.value){re("Please check all required fields before proceeding.");return}l<T.value?Vt():l>T.value&&St()},St=()=>{if(_t.value){re("Please check all required fields before proceeding.");return}T.value<4&&(T.value+=1,T.value===4&&(ht.value=_))},Vt=()=>{T.value>1&&(T.value-=1)},ps=w([]);function Zt(){const l={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:fe.EzyFormDefinitions,doc_id:d.value};K.get(Q.GetDoctypeData,{params:l}).then(t=>{var o;let s=t==null?void 0:t.message.data;if(s){s.accessible_departments&&(s.accessible_departments=s.accessible_departments.split(",")),g.value=ze(ie(ie({},g.value),s),{owner_of_the_form:s.owner_of_the_form||g.value.owner_of_the_form||""});const i=JSON.parse((o=t.message.data)==null?void 0:o.form_json);it.value=i.workflow,p.value=i.fields.filter(c=>c.fieldtype==="Table"),ps.value=i.fields.filter(c=>c.fieldtype==="Table"),Ze.value=t.message.data.is_landscape;let r=al(JSON.parse(s==null?void 0:s.form_json).fields);ue.value=JSON.parse(t.message.data.form_json).child_table_fields,Ll.value=[],rt.value=[],r.forEach((c,m)=>{_.push(c)}),JSON.parse(s==null?void 0:s.form_json).workflow.forEach((c,m)=>{W.push(c)})}}).catch(t=>{console.error("Error fetching  data:",t)})}function ms(){const l={};ct.value&&(l.print_format=ct.value),Ze.value!==void 0&&Ze.value!==null&&(l.is_landscape=Ze.value),K.put(Q.resource+fe.EzyFormDefinitions+`/${U.query.id}`,l).then(t=>{console.log(t),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),me("Print Format Added Successfully")}).catch(t=>{console.error("Error fetching  data:",t)})}function Gt(){const l={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${ce.value.business_unit||U.query.business_unit}`,doctype:fe.departments};K.get(Q.GetDoctypeData,{params:l}).then(t=>{var s;(s=t==null?void 0:t.message.data)!=null&&s.length&&(ye.value=t.message.data.map(o=>o.name),ae.value=t.message.data.map(o=>o.name))}).catch(t=>{console.error("Error fetching department data:",t)})}w(""),Ve(()=>g.value.owner_of_the_form,l=>{l&&At(l)});function At(l){l&&typeof l=="string"&&l.trim()!==""&&vs(l)}function vs(l){const t={fields:JSON.stringify(["ezy_departments_items"]),doctype:fe.departments,doc_id:l};K.get(Q.GetDoctypeData,{params:t}).then(s=>{var o;(o=s==null?void 0:s.message.data)!=null&&o.ezy_departments_items&&(q.value=s.message.data.ezy_departments_items.map(i=>i.category))}).catch(s=>{console.error("Error fetching categories data:",s)})}function qt(l){let t=Xs(_);const s=ze(ie({},g.value),{fields:t,doctype:fe.EzyFormDefinitions,workflow_setup:W,form_status:l==="save"?"Created":"Draft"});s.accessible_departments=s.accessible_departments.toString(),K.post(Q.savedata,s).then(o=>{if(o&&o.message&&o.message.message){let i=localStorage.getItem("preName");if(i){let r={installed:"Yes"};K.put(`${Q.resource}${fe.preDefinedForm}/${i}`,r).then(c=>{localStorage.removeItem("preName")}).catch(c=>{console.error("Error fetching ezyForms data:",c)})}if(R.push({params:{paramid:o.message.message},query:{id:o.message.message}}),d.value=o.message.message,d&&d!=="new"&&(_.splice(0,_.length),Zt()),W.length<_.length)pl("Add Workflow");else if(Kt.value===!0){me("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let r=localStorage.getItem("routepath");l==="save"?R.push({path:r}):l==="Draft"&&R.push({path:r})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const bt=w(""),Yt=()=>{var s,o;const l=_.length,t={label:l===0?"requestor":`approver-${l}`,parent:`${(s=Ee.value)==null?void 0:s.value}-${(o=g.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${Ee.value.value}-${g.value.form_short_name}`,childTables:[],afterCreated:{},rows:l===0?[{label:`row_0_0_${l}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${l}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${l}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};_.push(t),ul(()=>{bt.value&&bt.value.scrollTo({top:bt.value.scrollHeight,behavior:"smooth"})})},Kt=w(!1),Qt=l=>{let t=_[l];t.parent&&x.push(t);let s=[];W.length>l&&W[l].roles&&(s=[...W[l].roles]),_.splice(l,1),W.length>l&&W.splice(l,1),_.forEach((o,i)=>{o.sections.forEach((r,c)=>{r.rows.forEach((m,b)=>{m.columns.forEach((u,v)=>{ge(i,c,b,v)})})})}),s.length&&fs(s,l)};function fs(l,t){const s={role:l,level:t,document_type:g.value.form_name,short_name:g.value.form_short_name,property:g.value.business_unit};K.post(Q.deleteAssigneRoles,s).then(o=>{o&&qt()})}const bs=(l,t)=>{const s={label:"",parent:`${Ee.value.value}-${g.value.form_short_name}`,rows:[{label:`row_0_${t}_${l}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};_[l].sections.splice(t+1,0,s)},_s=(l,t)=>{let s=_[l].sections[t];s.parent&&x.push(s),_[l].sections.splice(t,1),_[l].sections.forEach((o,i)=>{o.rows.forEach((r,c)=>{r.columns.forEach((m,b)=>{ge(l,i,c,b)})})})},hs=(l,t,s)=>{_[l].sections[t].rows[s].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},gs=(l,t,s,o)=>{const r=_[l].sections[t].rows[s].columns,c=r[o];c.parent&&x.push(c),r.length===1?_[l].sections[t].rows.splice(s,1):r.splice(o,1),_[l].sections.forEach((m,b)=>{m.rows.forEach((u,v)=>{u.columns.forEach((C,E)=>{ge(l,b,v,E)})})})},ys=(l,t,s,o)=>{_[l].sections[t].rows[s].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},ks=(l,t,s,o,i)=>{let r=_[l].sections[t].rows[s].columns[o].fields[i];r.parent&&x.push(r),_[l].sections[t].rows[s].columns[o].fields.splice(i,1)},ws=(l,t,s,o,i)=>{const r=_[l].sections[t].rows[s].columns[o].fields[i],c=ie({},r);c.name=`${r.name} Name the field`,_[l].sections[t].rows[s].columns[o].fields.splice(i+1,0,c)},$s=(l,t,s,o,i)=>{const r=cl(_);_.splice(0,_.length,...r);let c=_[l].sections[t].rows[s].columns[o].fields[i].fieldtype;(c!=="Select"||c!=="radio"||c!=="multiselect")&&(_[l].sections[t].rows[s].columns[o].fields[i].options="")};function Cs(l){return pt.includes(l==null?void 0:l.trim().toLowerCase())}function Fs(l){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(l)||l.includes('"')||l.includes("'")}function Ds(l){return l.flatMap(t=>{var s;return[(s=t.label)==null?void 0:s.trim().toLowerCase(),...t.sections.flatMap(o=>{var i;return[(i=o.label)==null?void 0:i.trim().toLowerCase(),...o.rows.flatMap(r=>r.columns.flatMap(c=>{var m;return[(m=c.label)==null?void 0:m.trim().toLowerCase(),...c.fields.map(b=>{var u;return(u=b.label)==null?void 0:u.trim().toLowerCase()})]}))]})]}).filter(t=>t!==""&&!zt.includes(t))}function ge(l,t,s,o,i){const c=Ds(_).filter((u,v,C)=>C.indexOf(u)!==v),m=cl(_);_.splice(0,_.length,...m);function b(u,v){if(!u){v.errorMsg="";return}Cs(u)?v.errorMsg="Entered label is restricted":Fs(u)?v.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:u.length>64?v.errorMsg="Label should not exceed 64 characters":v.errorMsg=c.includes(u.trim().toLowerCase())?"Duplicate Label Name":""}i!==void 0&&b(_[l].sections[t].rows[s].columns[o].fields[i].label,_[l].sections[t].rows[s].columns[o].fields[i]),i===void 0&&o!==void 0&&b(_[l].sections[t].rows[s].columns[o].label,_[l].sections[t].rows[s].columns[o]),o===void 0&&i===void 0&&b(_[l].sections[t].label,_[l].sections[t]),_.forEach(u=>{u.sections.forEach(v=>{b(v.label,v),v.rows.forEach(C=>{C.columns.forEach(E=>{b(E.label,E),E.fields.forEach($=>{b($.label,$)})})})})})}const Tt=pe(()=>{function l(t){return!t||typeof t!="object"?!1:"fieldtype"in t&&t.fieldtype===""||"error"in t&&t.error||"errorMsg"in t&&t.errorMsg||["Select","Table MultiSelect"].includes(t.fieldtype)&&(!t.options||t.options.trim()==="")?!0:Array.isArray(t)?t.some(l):Object.values(t).some(l)}return l(_)}),_t=pe(()=>I.value.length>0||j.value.length>0||!g.value.form_category||!g.value.owner_of_the_form||g.value.accessible_departments.length===0),Ss=pe(()=>_.some(l=>l.sections.some(t=>t.rows.some(s=>s.columns.some(o=>o.fields.some(i=>i.label&&i.fieldtype))))));function Xt(l,t){let s=l.target.value.trim();if(!s){t==="form_name"?I.value="Input cannot be empty or only spaces":t==="form_short_name"&&(j.value="Input cannot be empty or only spaces");return}if(s.length>63){t==="form_name"?I.value="Name cannot exceed 63 characters":t==="form_short_name"&&(j.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(s)){t==="form_short_name"&&(j.value="First character must be a letter");return}else j.value="";if(t==="form_short_name"&&s.length<2){j.value="Short name must have at least 2 letters";return}if(t==="form_short_name"&&/[^a-zA-Z ]/.test(s)){j.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(s)){t==="form_name"?I.value="Special characters are not allowed":t==="form_short_name"&&(j.value="Special characters are not allowed");return}else t==="form_name"?I.value="":t==="form_short_name"&&(j.value="");const o=[[t,"=",`${s}`],["business_unit","=",`${g.value.business_unit}`]],i={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:fe.EzyFormDefinitions};K.get(`${Q.GetDoctypeData}`,{params:i}).then(r=>{de.value=r.message.data,t==="form_name"?I.value=s&&de.value.some(c=>c.form_name&&c.form_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":t==="form_short_name"&&(j.value=s&&de.value.some(c=>c.form_short_name&&c.form_short_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(r=>{console.error("Error fetching ezyForms data:",r),t==="form_name"?I.value="":t==="form_short_name"&&(j.value="")})}const Vs=l=>l===0?"1st row":l===1?"2nd row":l===2?"3rd row":`${l+1}th row`,ht=w([]),As=()=>{_.length&&(ht.value=_,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function qs(){K.post(Q.delete_form_items,{deleted_fields:x.flatMap(Lt),doctype:d}).then(l=>{var t;(t=l==null?void 0:l.message)!=null&&t.success&&qt()})}function xt(l){return Qe(this,null,function*(){if(Tt.value){re("Please fix the errors before proceeding.");return}Kt.value=!0;let t=x.flatMap(Lt);d!=null&&d!=null&&d!="new"&&t.length?qs():qt(l)})}const Ts=()=>{dt.value.push({role:"",autoApproval:!1,permissions:{}})},Us=l=>{dt.value.splice(l,1)},Ls=l=>{pl("Permission configuration modal will be implemented here")},It=()=>Qe(this,null,function*(){var l;if(!(xe.value.length>0))try{const t={doctype:"WF Roadmap",fields:JSON.stringify(["name","roadmap_title","document_type","workflow_levels","property","cluster_name"]),filters:JSON.stringify([])},s=yield K.get(Q.GetDoctypeData,{params:t});(l=s==null?void 0:s.message)!=null&&l.data&&(xe.value=s.message.data.map(o=>({roadmap_title:o.name,display_name:`${o.roadmap_title} (${o.document_type})`,document_type:o.document_type,workflow_levels:o.workflow_levels,property:o.property,cluster_name:o.cluster_name})),console.log("Fetched WF Road Maps:",xe.value))}catch(t){console.error("Error fetching WF Road Maps:",t),re("Failed to fetch workflow road maps")}}),el=l=>Qe(this,null,function*(){var t;try{console.log("Selected WF Road Map:",l);const s=yield K.get(`${Q.resource}${fe.wfRoadmap}/${l.roadmap_title}`),o=((t=s==null?void 0:s.data)==null?void 0:t.data)||(s==null?void 0:s.data)||{};console.log("WF Road Map Data:",o);const i=(o.wf_requestors&&o.wf_requestors.length>0,1),r={};o.wf_level_setup&&o.wf_level_setup.length>0&&o.wf_level_setup.forEach(u=>{r[u.level]||(r[u.level]=[]),r[u.level].push(u)});const c=Object.keys(r).length,m=i+c;for(console.log(`Required blocks: ${m} (1 requestor + ${c} approver levels)`),W=[],Je.value=[],Le.value=[];_.length>m;)_.pop();for(;_.length<m;)Yt();console.log(`Block adjustment complete: ${_.length} blocks`);let b=0;o.wf_requestors&&o.wf_requestors.length>0?(Je.value=o.wf_requestors,console.log(`Loaded ${o.wf_requestors.length} requestor role(s)`),o.wf_requestors.forEach(u=>{W.push({type:"requestor",roles:[u.requestor],auto_approval:u.auto_approval||0,columns_allowed:u.columns_allowed||"",fields:[],idx:0})})):console.warn("No Requestors found in roadmap, creating default requestor setup"),b=1,o.wf_level_setup&&o.wf_level_setup.length>0?(Le.value=o.wf_level_setup.sort((v,C)=>v.level-C.level),console.log(`Loaded ${o.wf_level_setup.length} approver level(s)`),Object.keys(r).sort((v,C)=>parseInt(v)-parseInt(C)).forEach(v=>{const C=r[v],E=b;console.log(`Level ${v} â†’ Block Index ${E}, Roles: ${C.length}`),C.forEach($=>{W.push({type:"approver",level:parseInt(v),roles:[$.role],approval_required:$.mandatory?1:0,approver_can_edit:0,view_only_reportee:$.view_only_reportee||0,all_approvals_required:$.all_approvals_required||0,requester_as_a_approver:$.requester_as_a_approver||0,on_rejection:$.on_rejection||0,columns_allowed:$.columns_allowed||"",fields:[],idx:E})}),b++})):console.warn("No approver levels found in roadmap"),console.log("Final blockArr length:",_.length),console.log("Final workflowSetup:",W),me(`Workflow configured! ${Je.value.length} requestor role(s), ${Le.value.length} approver level(s) across ${_.length} blocks.`),ul(()=>{Te.value=0})}catch(s){console.error("Error in handleWFRoadMapSelect:",s),re("Failed to load workflow. Please try again.")}}),Es=l=>{console.log("Field added from library:",l);const t=Te.value,s=_[t];if(!s){re("Please create a block first before adding fields");return}const o=tl(l);if(!o)return;s.sections||(s.sections=[]),s.sections.length===0&&s.sections.push({label:"",rows:[[{label:"",fields:[]}]]});const c=s.sections[0].rows[0][0];c.fields||(c.fields=[]),c.fields.push(o),console.log("Field added successfully:",o),me(`${o.label} field added successfully`)},Ms=l=>{console.log("Drag started:",l),A.value=l},Bs=()=>{console.log("Drag ended")},Rs=l=>{console.log("Advanced builder fields saved:",l),me(`${l.length} field(s) saved successfully!`)},Os=l=>{console.log("Advanced builder fields updated:",l)},Ns=l=>{const t=Te.value,s=_[t];if(!s){re("Please create a block first");return}s.sections||(s.sections=[]);let o=0;l.forEach(i=>{var C,E;const r=s.sections.length,c={label:i.label||"",parent:`${(C=Ee.value)==null?void 0:C.value}-${(E=g.value)==null?void 0:E.form_short_name}`,rows:[]},b={label:`row_0_${r}_${t}`,columns:[]},u=i.columns||1,v=Math.ceil(i.fields.length/u);for(let $=0;$<u;$++){const F={label:"",fields:[]},V=$*v,Y=Math.min(V+v,i.fields.length);i.fields.slice(V,Y).forEach(Z=>{const Ne=ie({label:Z.label,fieldname:Z.fieldname,fieldtype:Z.fieldtype,options:Z.options||"",reqd:Z.reqd||0,unique:Z.unique||0,description:Z.description||"",default:Z.default||"",read_only:Z.read_only||0,hidden:Z.hidden||0,depends_on:Z.depends_on||"",mandatory_depends_on:Z.mandatory_depends_on||"",read_only_depends_on:Z.read_only_depends_on||""},Z);F.fields.push(Ne),o++}),b.columns.push(F)}c.rows.push(b),s.sections.push(c)}),me(`Added ${l.length} section(s) with ${o} field(s) to ${t===0?"Requestor":`Approver ${t}`} Block`),Ue.value=!1},tl=l=>{console.log("Creating field from Frappe type:",l);const t=ft.find(r=>r.type===l);if(!t)return console.error("Field type not found:",l),console.error("Available types:",ft.map(r=>r.type)),re(`Field type "${l}" not found. Please try again.`),null;const s=Date.now(),o=Math.random().toString(36).substring(2,6),i=`field_${s}_${o}`;return{id:`field_${s}_${o}`,fieldname:i,label:t.label,fieldtype:t.type,options:"",reqd:0,read_only:0,hidden:0,description:"",default:"",placeholder:""}};return(l,t)=>(a(),n("div",null,[e("div",An,[e("div",qn,[e("div",Tn,[e("div",Un,[e("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:t[0]||(t[0]=s=>ds())},t[43]||(t[43]=[e("button",{class:"btn font-13 ms-3"},[e("i",{class:"bi bi-arrow-left"}),e("span",{class:"ms-2"},"Back")],-1)])),l.$route.query.id||l.$route.query.preId?(a(),n("span",Ln,"("+y(ce.value.formId||M(U).query.form_name)+")",1)):f("",!0)]),e("div",null,[T.value===2&&M(_).length&&!l.$route.query.id?(a(),n("button",{key:0,disabled:Tt.value||_t.value,style:Ks({cursor:Tt.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:t[1]||(t[1]=s=>xt("Draft"))},t[44]||(t[44]=[e("i",{class:"bi bi-bookmark-check-fill"},null,-1),D(" Save As Draft ")]),12,En)):f("",!0)])]),e("div",Mn,[e("div",Bn,[e("div",Rn,[e("div",On,[e("ul",Nn,[(a(!0),n(O,null,N(Kl.value,s=>(a(),n("li",{key:s.id,class:z({active:T.value===s.id,completed:T.value>s.id})},[e("div",{class:z(["d-flex gap-3 align-items-center",{"not-allowed":_t.value&&T.value+1===s.id}]),onClick:o=>cs(s.id)},[T.value>s.id?(a(),n("i",Pn)):(a(),n("i",{key:1,class:z(s.icon)},null,2)),e("div",Hn,[e("span",jn,y(s.stepno),1),t[45]||(t[45]=e("br",null,null,-1)),e("span",Wn,y(s.label),1)])],10,zn)],2))),128))])])]),e("div",Jn,[e("div",Zn,[e("div",Gn,[T.value===1?(a(),n("div",Yn,[e("div",Kn,[e("div",Qn,[t[46]||(t[46]=e("div",null,null,-1)),t[47]||(t[47]=e("h1",{class:"font-14 fw-bold m-0"},"Form Info",-1)),e("div",null,[!l.$route.query.id&&!l.$route.query.preId?(a(),n("button",{key:0,class:"btn btn-light font-12 mx-2",type:"button",onClick:us},"Clear Form")):f("",!0),T.value<5?(a(),Et(nl,{key:1,class:"btn btn-dark bg-dark text-white fw-bold font-13",name:"Next",onClick:St})):f("",!0)])])]),e("div",Xn,[e("div",xn,[t[63]||(t[63]=e("div",{class:"col-sm-none col-md-4"},null,-1)),e("div",In,[e("div",ei,[e("div",ti,[e("div",li,[e("div",si,[M(U).query.preId?(a(),n("span",oi,t[48]||(t[48]=[D("Predefined "),e("i",{class:"bi bi-check2-circle"},null,-1)]))):f("",!0),oe(nt,{disabled:(ce.value.formId&&ce.value.formId.length>0||M(U).query.form_name)&&Re.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Untitled Form",onChange:t[2]||(t[2]=s=>Xt(s,"form_name")),modelValue:kt.value,"onUpdate:modelValue":t[3]||(t[3]=s=>kt.value=s)},null,8,["disabled","modelValue"]),I.value?(a(),n("span",ai,y(I.value),1)):f("",!0)])]),e("div",ni,[oe(nt,{disabled:(ce.value.formId&&ce.value.formId.length>0||M(U).query.form_name)&&Re.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Untitled Form",onChange:t[4]||(t[4]=s=>Xt(s,"form_short_name")),modelValue:g.value.form_short_name,"onUpdate:modelValue":t[5]||(t[5]=s=>g.value.form_short_name=s)},null,8,["disabled","modelValue"]),j.value?(a(),n("span",ii,y(j.value),1)):f("",!0)]),e("div",ri,[oe(nt,{disabled:ce.value.formId&&ce.value.formId.length>0&&Re.value!=="1",labeltext:"Form Naming series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Naming series",modelValue:g.value.series,"onUpdate:modelValue":t[6]||(t[6]=s=>g.value.series=s)},null,8,["disabled","modelValue"]),t[49]||(t[49]=il('<small class="text-muted" style="font-size:12px;" data-v-ba866e10> Note : Enter <code data-v-ba866e10>YY-YY</code>, <code data-v-ba866e10>YYYY</code>, or <code data-v-ba866e10>ABC</code>. The system will default to the format <code data-v-ba866e10> 24-25-0001</code>, <code data-v-ba866e10> 2025-0001</code>, or <code data-v-ba866e10> ABC-0001</code> respectively. </small>',1))]),e("div",di,[e("label",null,[t[50]||(t[50]=D("Owner Of The Form ")),g.value.owner_of_the_form?f("",!0):(a(),n("span",ui,"*"))]),oe(M(Pe),{disabled:ce.value.formId&&ce.value.formId.length>0&&Re.value!=="1",onOpen:Gt,options:ye.value,onChange:At,modelValue:g.value.owner_of_the_form,"onUpdate:modelValue":t[7]||(t[7]=s=>g.value.owner_of_the_form=s),placeholder:"Select Department",multiple:!1,class:"font-11 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"])]),e("div",ci,[e("label",null,[t[51]||(t[51]=D("Form Category ")),g.value.form_category?f("",!0):(a(),n("span",pi,"*"))]),oe(M(Pe),{disabled:ce.value.formId&&ce.value.formId.length>0&&Re.value!=="1",options:q.value,modelValue:g.value.form_category,"onUpdate:modelValue":t[8]||(t[8]=s=>g.value.form_category=s),placeholder:"Select Category",multiple:!1,searchable:!0,class:"font-11 multiselect"},null,8,["disabled","options","modelValue"])]),e("div",mi,[e("label",null,[t[52]||(t[52]=D("Accessible to Department ")),g.value.accessible_departments.length?f("",!0):(a(),n("span",vi,"*"))]),oe(M(Pe),{modelValue:g.value.accessible_departments,"onUpdate:modelValue":t[10]||(t[10]=s=>g.value.accessible_departments=s),options:Ql.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Department",class:"font-11",onSelect:es,onRemove:ts,openDirection:"bottom"},{option:Mt(({option:s})=>[e("div",fi,[e("input",{type:"checkbox",checked:xl(s),class:"custom-checkbox",onChange:o=>Il(s,o),onClick:t[9]||(t[9]=be(()=>{},["stop"]))},null,40,bi),e("span",null,y(s),1)])]),selection:Mt(({values:s,isOpen:o})=>[s.length?k((a(),n("span",{key:0,class:"multiselect__single font-10"},y(Xl.value),513)),[[yt,!o]]):f("",!0)]),_:1},8,["modelValue","options"])]),e("div",_i,[t[53]||(t[53]=e("label",null,"Form Type",-1)),oe(M(Pe),{options:Ot,modelValue:Nt.value,"onUpdate:modelValue":t[11]||(t[11]=s=>Nt.value=s),placeholder:"Select Form Type",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:s=>s.value,class:"font-11 multiselect",openDirection:"top"},null,8,["modelValue","reduce"]),t[54]||(t[54]=e("small",{class:"text-muted font-12 ms-2"},"Note: Public form is accessible by anyone through QR code.",-1))]),e("div",hi,[t[55]||(t[55]=e("label",null,[D("Has Workflow "),e("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),oe(M(Pe),{options:["Yes","No"],modelValue:g.value.has_workflow,"onUpdate:modelValue":t[12]||(t[12]=s=>g.value.has_workflow=s),placeholder:"Select",multiple:!1,class:"font-11 multiselect",searchable:!0},null,8,["modelValue"])]),g.value.has_workflow==="Yes"?(a(),n("div",gi,[t[56]||(t[56]=e("label",null,[D("Use Existing Workflow "),e("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),oe(M(Pe),{onOpen:It,options:xe.value,modelValue:Fe.value,"onUpdate:modelValue":t[13]||(t[13]=s=>Fe.value=s),placeholder:"Select WF Road Map",multiple:!1,class:"font-11 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:el,openDirection:"bottom"},null,8,["options","modelValue"]),t[57]||(t[57]=e("small",{class:"text-muted font-12 ms-2"},[e("i",{class:"bi bi-info-circle me-1"}),D(" Select to auto-populate requestor and approver configurations ")],-1))])):f("",!0),g.value.as_web_view===1?(a(),n("div",yi,[t[58]||(t[58]=e("label",null,[D("Form Submit Response "),e("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),oe(nt,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit Response",modelValue:g.value.public_form_response,"onUpdate:modelValue":t[14]||(t[14]=s=>g.value.public_form_response=s)},null,8,["modelValue"])])):f("",!0),g.value.as_web_view===1?(a(),n("div",ki,[t[59]||(t[59]=e("label",null,[D("Submit Notification Email "),e("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),oe(nt,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit mail",modelValue:g.value.mail_id,"onUpdate:modelValue":t[15]||(t[15]=s=>g.value.mail_id=s)},null,8,["modelValue"]),t[60]||(t[60]=e("small",{class:"text-muted font-12 ms-2"},"Note : If multiple Emails, separate with commas (,).",-1))])):f("",!0),M(U).query.preId?(a(),n("div",wi,[e("div",$i,[k(e("input",{class:"form-check-input linketoCheck p-1",disabled:g.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":t[16]||(t[16]=s=>g.value.is_linked=s),"true-value":1,"false-value":0},null,8,Ci),[[X,g.value.is_linked]]),t[61]||(t[61]=e("label",{class:"form-check-label font-12 mx-2 mb-0 ps-1",for:"is_linked"}," Link ",-1))])])):f("",!0),g.value.is_linked?(a(),n("div",Fi,[t[62]||(t[62]=e("label",{for:"standardFormInput"},"Form",-1)),k(e("input",{type:"text",class:"form-control standardFormInput",id:"standardFormInput",disabled:g.value.is_predefined_doctype==1,"onUpdate:modelValue":t[17]||(t[17]=s=>g.value.is_linked_form=s),placeholder:"Type to search Form Name...",onInput:bl,onFocus:t[18]||(t[18]=s=>qe.value=!0),onBlur:hl},null,40,Di),[[L,g.value.is_linked_form]]),qe.value&&je.value.length?(a(),n("ul",Si,[(a(!0),n(O,null,N(je.value,(s,o)=>(a(),n("li",{class:"list-group-item formlistitem",key:o,onMousedown:be(i=>_l(s.name),["prevent"])},y(s.name),41,Vi))),128))])):f("",!0)])):f("",!0)])])]),t[64]||(t[64]=e("div",{class:"col-sm-none col-md-4"},null,-1))])])])):f("",!0),T.value===2?(a(),n("div",Ai,[e("div",qi,[e("div",Ti,[e("button",{onClick:t[19]||(t[19]=s=>Vt()),class:"btn btn-sm btn-light"},t[65]||(t[65]=[e("i",{class:"bi bi-chevron-left"},null,-1),D(" Back ")]))]),e("div",Ui,[(a(!0),n(O,null,N(M(_),(s,o)=>(a(),n("button",{key:o,class:z(["zoho-tab",{active:Te.value===o}]),onClick:i=>Te.value=o},[t[66]||(t[66]=e("i",{class:"bi bi-file-earmark-text me-1"},null,-1)),D(" "+y(o===0?"Requestor Block":`Approver Block ${o}`)+" ",1),M(_).length>1?(a(),n("i",{key:0,class:"bi bi-x-lg ms-2",onClick:be(i=>Qt(o),["stop"])},null,8,Ei)):f("",!0)],10,Li))),128))]),e("div",Mi,[e("button",{class:z(["btn btn-sm me-2",Ue.value?"btn-dark":"btn-outline-dark"]),onClick:t[20]||(t[20]=s=>Ue.value=!Ue.value),title:"Toggle Advanced Field Builder"},[e("i",{class:z(Ue.value?"bi bi-tools":"bi bi-grid-3x3-gap")},null,2),D(" "+y(Ue.value?"Advanced":"Simple"),1)],2),e("button",{class:"btn btn-sm btn-primary me-2",onClick:Yt},t[67]||(t[67]=[e("i",{class:"bi bi-plus-lg me-1"},null,-1),D("Add Block ")])),Ss.value?(a(),n("button",{key:0,class:"btn btn-sm btn-light me-2",onClick:As},t[68]||(t[68]=[e("i",{class:"bi bi-eye me-1"},null,-1),D("Preview ")]))):f("",!0),M(_).length?(a(),n("button",{key:1,class:"btn btn-sm btn-dark",onClick:t[21]||(t[21]=s=>xt("save"))},y(M(d)!=="new"?"Update Form":"Create Form"),1)):f("",!0)])]),e("div",Bi,[Ue.value?(a(),n("div",Ri,[t[69]||(t[69]=e("div",{class:"alert alert-info mb-3"},[e("i",{class:"bi bi-info-circle me-2"}),e("strong",null,"Advanced Mode:"),D(" Use this mode to access all Frappe field types and advanced field properties. Fields created here will be added to the current block. ")],-1)),oe(Vn,{ref_key:"frappeBuilderRef",ref:Rt,formName:kt.value,currentBlockIndex:Te.value,onSave:Rs,onUpdate:Os,onAddFields:Ns},null,8,["formName","currentBlockIndex"])])):(a(),n(O,{key:1},[e("aside",{class:z(["zoho-field-library",{collapsed:!We.value}])},[e("div",{class:"library-header",onClick:t[22]||(t[22]=s=>We.value=!We.value)},[e("div",Oi,[e("h6",Ni,[t[70]||(t[70]=e("i",{class:"bi bi-grid-3x3-gap me-2"},null,-1)),D(" "+y(We.value?"Field Types":"Fields"),1)]),e("button",zi,[e("i",{class:z(We.value?"bi bi-chevron-left":"bi bi-chevron-right")},null,2)])])]),We.value?(a(),n("div",Pi,[oe(oo,{fields:ft,onFieldAdd:Es,onFieldDragstart:Ms,onFieldDragend:Bs})])):f("",!0)],2),e("div",Hi,[e("div",{class:"canvas-inner",ref_key:"mainBlockRef",ref:bt},[(a(!0),n(O,null,N(M(_),(s,o)=>k((a(),n("div",{class:"block-level",key:o},[e("div",ji,[e("div",Wi,[e("div",Ji,[e("h6",Zi,y(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),e("div",Gi,[o!==0&&G(o).view_only_reportee||G(o).all_approvals_required||G(o).requester_as_a_approver?(a(),n("div",Yi,[e("span",Ki,y(G(o).view_only_reportee===1?"Reporting Manager only":"")+" "+y(G(o).all_approvals_required===1?"All of the selected approvers":"")+" "+y(G(o).requester_as_a_approver===1?"Approval by Requestor":""),1),e("span",null,[t[71]||(t[71]=e("span",{class:"ms-1"}," on rejection escalating to ",-1)),e("span",Qi,y(G(o).on_rejection?`Level ${G(o).on_rejection}`:"Requestor"),1)]),e("span",Xi,y(G(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):f("",!0)])]),e("div",xi,[M(d)&&M(W).length?(a(),n("div",Ii,[G(o)?(a(),n("label",er,[e("span",tr,y(G(o).roles.length>0?o===0?"Requestor Roles: ":"Approver Roles: ":""),1),e("span",lr,y(G(o).roles.slice(0,2).join(", ")),1),G(o).roles.length>2?(a(),n("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:i=>Dt(o),class:"more-count badge bg-primary ms-2",style:{cursor:"pointer"}}," +"+y(G(o).roles.length-2)+" more ",9,sr)):f("",!0)])):f("",!0)])):f("",!0),vl(o)&&M(d)!=null&&M(d)!=null&&M(d)!="new"&&G(o).roles.length===0?(a(),n("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:i=>Dt(o)},[t[72]||(t[72]=e("img",{src:xs,alt:"Add",class:"me-1"},null,-1)),D(" "+y(o===0?"Add Requestors":"Add Approvers"),1)],8,or)):f("",!0),M(d)!=null&&M(d)!=null&&M(d)!="new"&&G(o).roles.length>0?(a(),n("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:i=>Dt(o)},t[73]||(t[73]=[e("i",{class:"bi bi-pencil font-14"},null,-1)]),8,ar)):f("",!0),e("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:i=>Qt(o)},t[74]||(t[74]=[e("i",{class:"bi bi-trash me-1"},null,-1),D(" Delete Block ")]),8,nr)])])]),e("div",ir,[(a(!0),n(O,null,N(s.sections,(i,r)=>(a(),n("div",{key:"section-"+r,class:"dynamicSection mt-0 section"},[e("section",rr,[e("div",dr,[k(e("input",{"onUpdate:modelValue":c=>i.label=c,type:"text",class:z(["border-less-input","font-14",{"italic-style":!i.label},{"fw-medium":i.label}]),onChange:c=>ge(o,r),onInput:c=>ge(o,r),placeholder:"Untitled section"},null,42,ur),[[L,i.label]]),i.errorMsg?(a(),n("small",cr,y(i.errorMsg),1)):f("",!0)]),e("div",pr,[e("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:c=>_s(o,r)},t[75]||(t[75]=[e("i",{class:"bi bi-trash me-1"},null,-1),D(" Delete Section ")]),8,mr)])]),e("div",vr,[(a(!0),n(O,null,N(i.rows,(c,m)=>(a(),n("section",{class:"row dynamicRow row-container",key:"row-"+m},[e("div",fr,[e("label",br,y(Vs(m)),1),e("div",null,[c.columns.length<3?(a(),n("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:b=>hs(o,r,m)},t[76]||(t[76]=[e("i",{class:"bi bi-plus font-14"},null,-1),D(" Add Column ")]),8,_r)):f("",!0)])]),e("div",hr,[e("div",gr,[(a(!0),n(O,null,N(c.columns,(b,u)=>(a(),n("div",{key:"column-"+u,onMouseenter:v=>Dl(o,r,m,u),onMouseleave:Sl,class:"col p-0 dynamicColumn position-relative column-container"},[e("div",kr,[e("div",wr,[k(e("input",{"onUpdate:modelValue":v=>b.label=v,type:"text",class:z(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!b.label},{"fw-medium":b.label}]),onChange:v=>ge(o,r,m,u),onInput:v=>ge(o,r,m,u),placeholder:"Column Name"},null,42,$r),[[L,b.label]]),b.errorMsg?(a(),n("small",Cr,y(b.errorMsg),1)):f("",!0)]),k(e("div",Fr,[e("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:v=>gs(o,r,m,u)},t[77]||(t[77]=[e("i",{class:"bi bi-x-lg"},null,-1)]),8,Dr)],512),[[yt,Vl(o,r,m,u)]])]),b.fields.length===0?(a(),n("div",{key:0,class:"empty-drop-zone",onDragover:t[23]||(t[23]=be(()=>{},["prevent"])),onDrop:v=>Me(v,o,r,m,u,l.fieldIndex)},null,40,Sr)):f("",!0),(a(!0),n(O,null,N(b.fields,(v,C)=>{var E;return a(),n("div",{key:"field-"+C,onMouseenter:$=>$l(o,r,m,u,C),onMouseleave:Cl,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:$=>Pt($,o,r,m,u,C),onDragover:t[27]||(t[27]=be(()=>{},["prevent"])),onDrop:$=>Me($,o,r,m,u,C)},[e("div",{class:"drop-zone",onDragover:t[24]||(t[24]=be(()=>{},["prevent"])),onDrop:$=>Me($,o,r,m,u,C)},null,40,Ar),v.fieldtype!=="Table"?(a(),n("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:$=>Pt($,o,r,m,u,C),onDragover:t[25]||(t[25]=be(()=>{},["prevent"])),onDrop:$=>Me($,o,r,m,u,C)},[e("div",Tr,[e("div",Ur,[k(e("input",{"onUpdate:modelValue":$=>v.label=$,placeholder:"Name the field",class:z(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!v.label},{"fw-medium":v.label}]),onChange:$=>ge(o,r,m,u,C),onInput:$=>ge(o,r,m,u,C)},null,42,Lr),[[L,v.label]]),v.errorMsg?(a(),n("small",Er,y(v.errorMsg),1)):f("",!0)]),k(e("div",Mr,[e("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:$=>ws(o,r,m,u,C)},t[78]||(t[78]=[e("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,Br),e("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:$=>{ks(o,r,m,u,C),ge(o,r,m,u)}},t[79]||(t[79]=[e("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,Rr)],512),[[yt,Fl(o,r,m,u,C)]])]),k(e("select",{"onUpdate:modelValue":$=>v.fieldtype=$,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:$=>$s(o,r,m,u,C)},[t[80]||(t[80]=e("option",{value:""},"Select Type",-1)),(a(),n(O,null,N(ft,$=>e("option",{key:$,value:$.type},y($.label),9,Nr)),64))],40,Or),[[we,v.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(v.fieldtype)?(a(),n("div",zr,[t[81]||(t[81]=e("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),k(e("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":$=>v.options=$,class:"form-control shadow-none mb-1 font-12"},null,8,Pr),[[L,v.options]]),!v.options||v.options.trim()===""?(a(),n("small",Hr," Options are required for this field type. ")):f("",!0)])):f("",!0),v.fieldtype==="Link"?(a(),n("div",jr,[e("label",{class:"font-11 fw-light",for:"link-search-"+De(o,r,m,u,C)}," Search Doctype: ",8,Wr),k(e("input",{id:"link-search-"+De(o,r,m,u,C),type:"text","onUpdate:modelValue":$=>M(_)[o].sections[r].rows[m].columns[u].fields[C].options=$,onInput:$=>yl(M(_)[o].sections[r].rows[m].columns[u].fields[C].options,o,r,m,u,C),onFocus:$=>gl(De(o,r,m,u,C)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,Jr),[[L,M(_)[o].sections[r].rows[m].columns[u].fields[C].options]]),(E=et[De(o,r,m,u,C)])!=null&&E.length&&wt[De(o,r,m,u,C)]?(a(),n("ul",Zr,[(a(!0),n(O,null,N(et[De(o,r,m,u,C)],($,F)=>(a(),n("li",{key:F,onClick:V=>kl(o,r,m,u,C,$.name),class:"list-group-item list-group-item-action"},y($.name),9,Gr))),128))])):f("",!0)])):f("",!0),e("div",Yr,[e("div",Kr,[e("div",Qr,[k(e("input",{class:"font-12","onUpdate:modelValue":$=>v.reqd=$,"true-value":1,id:"mandatory-"+o+"-"+r+"-"+m+"-"+u+"-"+C,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,Xr),[[X,v.reqd]])]),e("div",null,[e("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+r+"-"+m+"-"+u+"-"+C},"Mandatory",8,xr)])]),e("div",null,[e("button",{class:"btn btn-sm font-12",onClick:$=>v.showDescription=!v.showDescription},y(v.showDescription?"Hide Description":v.description?"Edit Description":"Add Description"),9,Ir)])]),v.showDescription?k((a(),n("textarea",{key:2,"onUpdate:modelValue":$=>v.description=$,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,ed)),[[L,v.description]]):f("",!0),v.error?(a(),n("small",td,y(v.error),1)):f("",!0)],40,qr)):f("",!0),e("div",{class:"drop-zone",onDragover:t[26]||(t[26]=be(()=>{},["prevent"])),onDrop:$=>Me($,o,r,m,u,C)},null,40,ld),e("div",sd,[e("div",null,[e("div",null,[e("div",od,[v.fieldtype==="Table"?(a(),n("div",ad,[(a(!0),n(O,null,N(ue.value,($,F)=>(a(),n("div",{key:F,class:"childTable"},[F===v.fieldname||F===v.options?(a(),n("h5",nd,y(F.replace(/_/g," ")),1)):f("",!0),ee[F]&&F===Wt.value?(a(),n("div",id,[e("div",rd,[v.showDescription?k((a(),n("input",{key:0,"onUpdate:modelValue":V=>v.description=V,class:"form-control font-12",placeholder:"Enter field description"},null,8,dd)),[[L,v.description]]):f("",!0),e("button",{class:"btn btn-sm text-nowrap font-12",onClick:V=>v.showDescription=!v.showDescription},y(v.showDescription?"Hide Description":v.description?"Edit Description":"Add Description"),9,ud)])])):f("",!0),F===v.options||F===v.fieldname?(a(),n("table",cd,[t[85]||(t[85]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Label"),e("th",null,"Field Type")])],-1)),e("tbody",{onDragover:be(Tl,["prevent"]),onDrop:V=>Ul(V,$)},[(a(!0),n(O,null,N($,(V,Y)=>{var Ke,Z,Ne,st,ot,at,ne;return a(),n("tr",{key:Y,draggable:ee[F],onDragstart:te=>Al(Y),onDragend:ql,class:z({dragging:Oe.value===Y})},[e("td",null,y(Y+1),1),ee[F]?(a(),n("td",vd,[k(e("input",{"onUpdate:modelValue":te=>V.label=te,onInput:te=>vt(V,F,Y),placeholder:"Field Label",class:z(["form-control",{"border-1 border-danger":(Z=(Ke=B[F])==null?void 0:Ke[Y])==null?void 0:Z.length}])},null,42,fd),[[L,V.label]]),(st=(Ne=B[F])==null?void 0:Ne[Y])!=null&&st.length?(a(),n("div",bd,[(a(!0),n(O,null,N(B[F][Y],(te,zs)=>(a(),n("div",{key:zs},y(te),1))),128))])):f("",!0)])):(a(),n("td",_d,y(V.label),1)),ee[F]?(a(),n("td",hd,[e("div",gd,[k(e("select",{"onUpdate:modelValue":te=>V.fieldtype=te,onChange:te=>vt(V,F,Y),class:z(["form-select form-select-sm",{"border-1 border-danger":(at=(ot=B[F])==null?void 0:ot[Y])==null?void 0:at.length}])},[t[82]||(t[82]=e("option",{value:""},"Select Type",-1)),(a(),n(O,null,N(Ct,te=>e("option",{key:te.type,value:te.type},y(te.label),9,kd)),64))],42,yd),[[we,V.fieldtype]]),e("div",wd,[e("div",$d,[e("div",Cd,[k(e("input",{class:"font-12 form-control-sm","onUpdate:modelValue":te=>V.description=te,placeholder:"description",type:"text"},null,8,Fd),[[L,V.description]])])]),e("button",{class:"btn btn-light btn-sm",onClick:te=>Gl(F,Y)},t[83]||(t[83]=[e("i",{class:"bi bi-x-lg"},null,-1)]),8,Dd)])]),["Select"].includes(V.fieldtype)?(a(),n("div",Sd,[t[84]||(t[84]=e("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),k(e("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":te=>V.options=te,onInput:te=>vt(V,F,Y),class:"form-control shadow-none mb-1 font-12"},null,40,Vd),[[L,V.options]]),!V.options||V.options.trim()===""?(a(),n("small",Ad," Options are required for this field type. ")):f("",!0)])):f("",!0),(ne=se[F])!=null&&ne.includes(Y)?(a(),n("span",qd,"Type required**")):f("",!0)])):(a(),n("td",Td,y(V.fieldtype),1))],42,md)}),128))],40,pd)])):f("",!0),v.fieldtype==="Table"&&(v.label===F||v.fieldname===F)?(a(),n("div",Ud,[e("button",{class:"btn btn-light btn-sm mx-2",onClick:V=>Yl(F,v.description)},y(ee[F]?"Save":"Edit"),9,Ld),ee[F]?(a(),n("button",{key:0,class:"btn btn-light btn-sm",onClick:V=>Zl(F)}," Add More Field ",8,Ed)):f("",!0)])):f("",!0)]))),128))])):f("",!0)])])])])],40,Vr)}),128)),e("div",{class:"drop-zone-bottom",onDragover:t[28]||(t[28]=be(()=>{},["prevent"])),onDrop:v=>Me(v,o,r,m,u,b.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,Md),e("div",{class:"drop-zone",onDragover:t[29]||(t[29]=be(()=>{},["prevent"])),onDrop:v=>Me(v,o,r,m,u,l.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,Bd),e("div",Rd,[e("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:v=>ys(o,r,m,u)},t[86]||(t[86]=[e("i",{class:"bi bi-plus fs-5"},null,-1),e("span",null,"Add Field",-1)]),8,Od)])],40,yr))),128))])])]))),128)),e("div",null,[(a(!0),n(O,null,N(i.afterCreated,(c,m)=>(a(),n("div",{key:m,class:"childTable dynamicColumn m-0 p-2"},[e("h5",Nd,y(c.tableName),1),ee[c.tableName]?(a(),n("div",zd,[e("div",Pd,[c.showDescription?k((a(),n("input",{key:0,"onUpdate:modelValue":b=>c.description=b,class:"form-control font-12",placeholder:"Enter field description"},null,8,Hd)),[[L,c.description]]):f("",!0),e("button",{class:"btn btn-sm text-nowrap font-12",onClick:b=>c.showDescription=!c.showDescription},y(c.showDescription?"Hide Description":c.description?"Edit Description":"Add Description"),9,jd)])])):f("",!0),e("table",Wd,[t[92]||(t[92]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Label"),e("th",null,"Field Type")])],-1)),e("tbody",null,[(a(!0),n(O,null,N(c.columns,(b,u)=>{var v,C,E,$;return a(),n("tr",{key:u},[e("td",null,y(u+1),1),ee[c.tableName]?(a(),n("td",Jd,[k(e("input",{"onUpdate:modelValue":F=>b.label=F,placeholder:"Field Label",class:z(["form-control",{"border-1 border-danger":(v=se[c.tableName])==null?void 0:v.includes(u)}]),onBlur:F=>{var V;b.label=(V=b.label)==null?void 0:V.trim(),tt(b,c.tableName,u,c.columns)}},null,42,Zd),[[L,b.label]]),(C=B[c.tableName])!=null&&C[u]?(a(),n("div",Gd,[(a(!0),n(O,null,N(B[c.tableName][u],(F,V)=>(a(),n("span",{key:V},[D(y(F)+" ",1),t[87]||(t[87]=e("br",null,null,-1))]))),128))])):f("",!0)])):(a(),n("td",Yd,y(b.label),1)),ee[c.tableName]?(a(),n("td",Kd,[e("div",Qd,[k(e("select",{"onUpdate:modelValue":F=>b.fieldtype=F,class:z(["form-select form-select-sm",{"border-1 border-danger":(E=se[c.tableName])==null?void 0:E.includes(u)}]),onChange:F=>tt(b,c.tableName,u,c.columns)},[t[88]||(t[88]=e("option",{value:""},"Select Type",-1)),(a(),n(O,null,N(Ct,F=>e("option",{key:F.type,value:F.type},y(F.label),9,xd)),64))],42,Xd),[[we,b.fieldtype]]),e("button",{class:"btn btn-light btn-sm",onClick:F=>Wl(o,r,c.tableName,u)},t[89]||(t[89]=[e("i",{class:"bi bi-x-lg"},null,-1)]),8,Id)]),b.fieldtype==="Select"?(a(),n("div",eu,[t[90]||(t[90]=e("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),k(e("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":F=>b.options=F,class:"form-control shadow-none mb-1 font-12",onInput:F=>tt(b,c.tableName,u,c.columns)},null,40,tu),[[L,b.options]])])):f("",!0),($=B[c.tableName])!=null&&$[u]?(a(),n("div",lu,[(a(!0),n(O,null,N(B[c.tableName][u],(F,V)=>(a(),n("span",{key:V},[D(y(F),1),t[91]||(t[91]=e("br",null,null,-1))]))),128))])):f("",!0)])):(a(),n("td",su,y(b.fieldtype),1))])}),128))])]),e("div",ou,[e("button",{class:"btn btn-light btn-sm mx-2",onClick:b=>Jl(o,r,c.tableName)},y(ee[c.tableName]?"Save":"Edit"),9,au),ee[c.tableName]?(a(),n("button",{key:0,class:"btn btn-light btn-sm",onClick:b=>jl(o,r,c.tableName)}," Add More Field ",8,nu)):f("",!0)])]))),128))])]),e("div",null,[e("div",null,[o==0?(a(),n("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:c=>El(o,r)}," Add New Table ",8,iu)):f("",!0),(a(!0),n(O,null,N(i.childTables,(c,m)=>{var b;return a(),n("div",{key:`table-${o}-${r}-${m}`,class:"child-table"},[c.newTable?(a(),n("div",ru,[e("div",du,[e("div",null,[e("span",{class:z(c.tableName?"d-none":"text-danger")},"*",2),k(e("input",{"onUpdate:modelValue":u=>c.tableName=u,placeholder:"Table Name",onBlur:u=>Ht(c),class:z(["border-less-input font-14 p-0 inputHeight",{"italic-style":!c.tableName,"fw-medium":c.tableName}])},null,42,uu),[[L,c.tableName]]),(b=B[`${o}-${r}-${m}`])!=null&&b.tableName?(a(),n("div",cu,y(B[`${o}-${r}-${m}`].tableName),1)):f("",!0),Ye.value?(a(),n("div",pu,y(Ye.value),1)):f("",!0),e("div",mu,[e("div",vu,[c.showDescription?k((a(),n("input",{key:0,"onUpdate:modelValue":u=>c.as_a_block=u,class:"form-control font-12",placeholder:"Enter field description"},null,8,fu)),[[L,c.as_a_block]]):f("",!0),e("button",{class:"btn btn-sm text-nowrap font-12",onClick:u=>c.showDescription=!c.showDescription},y(c.showDescription?"Hide Description":c.description?"Edit Description":"Add Description"),9,bu)])])]),e("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:u=>Bl(o,r,m)},t[93]||(t[93]=[e("i",{class:"bi bi-trash"},null,-1),D(" Remove Table ")]),8,_u)]),(a(!0),n(O,null,N(c.columns,(u,v)=>{var C,E,$,F,V,Y,Ke,Z,Ne,st,ot,at;return a(),n("div",{key:v,class:"dynamicField"},[e("div",hu,[e("div",gu,[e("div",null,[e("span",{class:z(u.label?"d-none":"text-danger")},"*",2),k(e("input",{"onUpdate:modelValue":ne=>u.label=ne,placeholder:"Name the field",onBlur:()=>{Ht(u),Ol(u,o,r,m,v,c.columns)},class:z(["border-less-input font-14 p-0 inputHeight",{"italic-style":!u.label,"fw-medium":u.label,"is-invalid":($=(E=(C=B[`${o}-${r}-${m}`])==null?void 0:C.columns)==null?void 0:E[v])==null?void 0:$.label}])},null,42,yu),[[L,u.label]]),(Y=(V=(F=B[`${o}-${r}-${m}`])==null?void 0:F.columns)==null?void 0:V[v])!=null&&Y.label?(a(),n("div",ku,y(B[`${o}-${r}-${m}`].columns[v].label),1)):f("",!0)]),e("div",wu,[e("div",$u,[u.showDescription?k((a(),n("input",{key:0,"onUpdate:modelValue":ne=>u.description=ne,class:"form-control font-12",placeholder:"Enter field description"},null,8,Cu)),[[L,u.description]]):f("",!0),e("button",{class:"btn btn-sm text-nowrap font-12",onClick:ne=>u.showDescription=!u.showDescription},y(u.showDescription?"Hide Description":u.description?"Edit Description":"Add Description"),9,Fu)]),e("button",{class:"btn btn-sm trash-btn py-0",onClick:ne=>Rl(o,r,m,v)},t[94]||(t[94]=[e("i",{class:"bi bi-x-lg"},null,-1)]),8,Du)])]),k(e("select",{"onUpdate:modelValue":ne=>u.fieldtype=ne,class:z(["form-select font-13 mb-1",{"is-invalid":(Ne=(Z=(Ke=B[`${o}-${r}-${m}`])==null?void 0:Ke.columns)==null?void 0:Z[v])==null?void 0:Ne.fieldtype}])},[t[95]||(t[95]=e("option",{value:""},"Select Type",-1)),(a(),n(O,null,N(Ct,ne=>e("option",{key:ne.type,value:ne.type},y(ne.label),9,Vu)),64))],10,Su),[[we,u.fieldtype]]),["Select"].includes(u.fieldtype)?(a(),n("div",Au,[t[96]||(t[96]=e("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),k(e("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":ne=>u.options=ne,class:"form-control shadow-none mb-1 font-12"},null,8,qu),[[L,u.options]]),!u.options||u.options.trim()===""?(a(),n("small",Tu," Options are required for this field type. ")):f("",!0)])):f("",!0),(at=(ot=(st=B[`${o}-${r}-${m}`])==null?void 0:st.columns)==null?void 0:ot[v])!=null&&at.fieldtype?(a(),n("div",Uu,y(B[`${o}-${r}-${m}`].columns[v].fieldtype),1)):f("",!0)])])}),128)),e("button",{class:"btn btn-light btn-sm addField mx-1",onClick:u=>Ml(o,r,m)},t[97]||(t[97]=[e("i",{class:"bi bi-plus"},null,-1),D(" Add Field ")]),8,Lu),e("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:u=>Hl(o,r,m)}," Create Table ",8,Eu),t[98]||(t[98]=e("hr",null,null,-1))])):f("",!0)])}),128))])]),e("div",Mu,[e("button",{class:"btn btn-light border font-12",onClick:c=>bs(o,r)},t[99]||(t[99]=[e("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),D(" Add Section ")]),8,Bu)])]))),128)),o===0?(a(),n("div",Ru)):f("",!0)])])),[[yt,o===Te.value]])),128))],512)]),h.value?(a(),n("aside",Ou,[e("div",Nu,[t[101]||(t[101]=e("h6",{class:"mb-0"},"Field Properties",-1)),e("button",{class:"btn btn-sm btn-link p-0",onClick:t[30]||(t[30]=s=>h.value=null)},t[100]||(t[100]=[e("i",{class:"bi bi-x-lg"},null,-1)]))]),t[102]||(t[102]=e("div",{class:"properties-content"},[e("p",{class:"text-muted small"},"Select a field to edit its properties")],-1))])):f("",!0)],64))])])):f("",!0),T.value===3?(a(),n("div",zu,[e("div",Pu,[e("button",{onClick:t[31]||(t[31]=s=>Vt()),class:"btn btn-sm btn-light"},t[103]||(t[103]=[e("i",{class:"bi bi-chevron-left"},null,-1),D(" Back ")])),t[105]||(t[105]=e("h1",{class:"font-14 fw-bold m-0"},"Workflow Setup",-1)),e("button",{class:"btn btn-sm btn-dark",onClick:St},t[104]||(t[104]=[D(" Next "),e("i",{class:"bi bi-chevron-right"},null,-1)]))]),e("div",Hu,[e("div",ju,[t[111]||(t[111]=e("div",{class:"card-header bg-light"},[e("h6",{class:"mb-0 fw-bold"},[e("i",{class:"bi bi-diagram-3 me-2"}),D("Workflow Configuration")])],-1)),e("div",Wu,[e("div",Ju,[e("div",Zu,[t[108]||(t[108]=e("label",{class:"form-label fw-bold"},"Workflow Type",-1)),e("div",Gu,[k(e("input",{type:"radio",class:"btn-check",name:"workflowType",id:"existingWorkflow",value:"existing","onUpdate:modelValue":t[32]||(t[32]=s=>ke.value=s)},null,512),[[rl,ke.value]]),t[106]||(t[106]=e("label",{class:"btn btn-outline-primary",for:"existingWorkflow"},[e("i",{class:"bi bi-folder me-1"}),D("Use Existing ")],-1)),k(e("input",{type:"radio",class:"btn-check",name:"workflowType",id:"newWorkflow",value:"new","onUpdate:modelValue":t[33]||(t[33]=s=>ke.value=s),checked:""},null,512),[[rl,ke.value]]),t[107]||(t[107]=e("label",{class:"btn btn-outline-primary",for:"newWorkflow"},[e("i",{class:"bi bi-plus-circle me-1"}),D("Create New ")],-1))])]),ke.value==="existing"?(a(),n("div",Yu,[t[109]||(t[109]=e("label",{class:"form-label fw-bold"},"Select Workflow",-1)),oe(M(Pe),{onOpen:It,options:xe.value,modelValue:Fe.value,"onUpdate:modelValue":t[34]||(t[34]=s=>Fe.value=s),placeholder:"Select WF Road Map",multiple:!1,class:"font-11 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:el,openDirection:"bottom"},null,8,["options","modelValue"]),t[110]||(t[110]=e("small",{class:"text-muted font-12 mt-1 d-block"},[e("i",{class:"bi bi-info-circle me-1"}),D("Auto-populates requestors and approvers ")],-1))])):f("",!0)])])]),ke.value==="new"?(a(),n("div",Ku,[t[117]||(t[117]=e("div",{class:"card-header bg-light"},[e("h6",{class:"mb-0 fw-bold"},[e("i",{class:"bi bi-person-plus me-2"}),D("Requestor Configuration")])],-1)),e("div",Qu,[t[116]||(t[116]=e("p",{class:"text-muted font-12 mb-3"},[e("i",{class:"bi bi-info-circle me-1"}),D(" Define who can submit requests for this form based on WF Requestors ")],-1)),e("button",{class:"btn btn-primary btn-sm mb-3",onClick:Ts},t[112]||(t[112]=[e("i",{class:"bi bi-plus-lg me-1"},null,-1),D("Add Requestor Role ")])),dt.value.length>0?(a(),n("div",Xu,[e("table",xu,[t[115]||(t[115]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{width:"40%"},"Role"),e("th",{width:"30%"},"Auto Approval"),e("th",{width:"20%"},"Permissions"),e("th",{width:"10%"},"Action")])],-1)),e("tbody",null,[(a(!0),n(O,null,N(dt.value,(s,o)=>(a(),n("tr",{key:o},[e("td",null,[k(e("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":i=>s.role=i,placeholder:"Enter role name"},null,8,Iu),[[L,s.role]])]),e("td",null,[e("div",ec,[k(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":i=>s.autoApproval=i},null,8,tc),[[X,s.autoApproval]]),e("label",lc,y(s.autoApproval?"Yes":"No"),1)])]),e("td",null,[e("button",{class:"btn btn-sm btn-outline-secondary",onClick:i=>Ls()},t[113]||(t[113]=[e("i",{class:"bi bi-gear"},null,-1),D(" Configure ")]),8,sc)]),e("td",null,[e("button",{class:"btn btn-sm btn-danger",onClick:i=>Us(o)},t[114]||(t[114]=[e("i",{class:"bi bi-trash"},null,-1)]),8,oc)])]))),128))])])])):f("",!0)])])):f("",!0),ke.value==="existing"&&Fe.value&&Je.value.length>0?(a(),n("div",ac,[t[123]||(t[123]=e("div",{class:"card-header bg-success text-white"},[e("h6",{class:"mb-0 fw-bold"},[e("i",{class:"bi bi-check-circle me-2"}),D("Loaded Requestors")])],-1)),e("div",nc,[e("div",ic,[t[118]||(t[118]=e("i",{class:"bi bi-check-circle me-1"},null,-1)),e("strong",null,y(Je.value.length),1),t[119]||(t[119]=D(" requestor role(s) loaded from ")),e("strong",null,y(Fe.value.display_name),1)]),e("div",rc,[e("table",dc,[t[121]||(t[121]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Role"),e("th",null,"Auto Approval"),e("th",null,"Columns Allowed")])],-1)),e("tbody",null,[(a(!0),n(O,null,N(Je.value,(s,o)=>(a(),n("tr",{key:o},[e("td",null,[e("strong",null,y(s.requestor),1)]),e("td",null,[s.auto_approval?(a(),n("span",uc,t[120]||(t[120]=[e("i",{class:"bi bi-check-circle me-1"},null,-1),D("Yes ")]))):(a(),n("span",cc,"No"))]),e("td",null,[e("small",pc,y(s.columns_allowed||"All fields"),1)])]))),128))])])]),t[122]||(t[122]=e("div",{class:"alert alert-info mt-3"},[e("i",{class:"bi bi-info-circle me-1"}),D(" Go to "),e("strong",null,"Step 2"),D(" and click "),e("strong",null,'"Add Requestors"'),D(" to select specific designations for these roles ")],-1))])])):f("",!0),ke.value==="existing"&&Fe.value&&Le.value.length>0?(a(),n("div",mc,[t[132]||(t[132]=e("div",{class:"card-header bg-primary text-white"},[e("h6",{class:"mb-0 fw-bold"},[e("i",{class:"bi bi-diagram-3 me-2"}),D("Loaded Approval Workflow")])],-1)),e("div",vc,[e("div",fc,[t[124]||(t[124]=e("i",{class:"bi bi-check-circle me-1"},null,-1)),e("strong",null,y(Le.value.length),1),t[125]||(t[125]=D(" approval level(s) loaded from ")),e("strong",null,y(Fe.value.display_name),1)]),e("div",bc,[e("table",_c,[t[130]||(t[130]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{width:"10%"},"Level"),e("th",{width:"25%"},"Role"),e("th",{width:"15%"},"Mandatory"),e("th",{width:"20%"},"Approval Type"),e("th",{width:"30%"},"Columns Allowed")])],-1)),e("tbody",null,[(a(!0),n(O,null,N(Le.value,(s,o)=>(a(),n("tr",{key:o},[e("td",null,[e("span",hc,"Level "+y(s.level),1)]),e("td",null,[e("strong",null,y(s.role),1)]),e("td",null,[s.mandatory?(a(),n("span",gc,t[126]||(t[126]=[e("i",{class:"bi bi-exclamation-circle me-1"},null,-1),D("Required ")]))):(a(),n("span",yc,"Optional"))]),e("td",null,[s.view_only_reportee?(a(),n("span",kc,t[127]||(t[127]=[e("i",{class:"bi bi-person me-1"},null,-1),D("Reporting Manager ")]))):s.all_approvals_required?(a(),n("span",wc,t[128]||(t[128]=[e("i",{class:"bi bi-people me-1"},null,-1),D("All Users ")]))):s.requester_as_a_approver?(a(),n("span",$c,t[129]||(t[129]=[e("i",{class:"bi bi-person-check me-1"},null,-1),D("Requestor ")]))):(a(),n("span",Cc," Any One "))]),e("td",null,[e("small",Fc,y(s.columns_allowed||"All fields"),1)])]))),128))])])]),t[131]||(t[131]=e("div",{class:"alert alert-info mt-3"},[e("i",{class:"bi bi-info-circle me-1"}),D(" Go to "),e("strong",null,"Step 2"),D(" and click "),e("strong",null,'"Add Approvers"'),D(" for each level to select specific designations ")],-1))])])):f("",!0),t[133]||(t[133]=il('<div class="card mt-4" data-v-ba866e10><div class="card-header bg-light" data-v-ba866e10><h6 class="mb-0 fw-bold" data-v-ba866e10><i class="bi bi-shield-check me-2" data-v-ba866e10></i>System Generated Fields</h6></div><div class="card-body" data-v-ba866e10><div class="alert alert-secondary mb-3" data-v-ba866e10><i class="bi bi-info-circle me-2" data-v-ba866e10></i> These fields are automatically included for all requestors. </div><div class="row g-3" data-v-ba866e10><div class="col-md-6" data-v-ba866e10><div class="field-preview-card" data-v-ba866e10><label class="form-label fw-bold" data-v-ba866e10>Requestor Name</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-ba866e10></div></div><div class="col-md-6" data-v-ba866e10><div class="field-preview-card" data-v-ba866e10><label class="form-label fw-bold" data-v-ba866e10>Requestor Email</label><input type="email" class="form-control" value="Auto-populated from user profile" disabled data-v-ba866e10></div></div><div class="col-md-6" data-v-ba866e10><div class="field-preview-card" data-v-ba866e10><label class="form-label fw-bold" data-v-ba866e10>Request Date</label><input type="text" class="form-control" value="Auto-populated on submission" disabled data-v-ba866e10></div></div><div class="col-md-6" data-v-ba866e10><div class="field-preview-card" data-v-ba866e10><label class="form-label fw-bold" data-v-ba866e10>Department</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-ba866e10></div></div></div></div></div>',1))])])):f("",!0),T.value===4?(a(),n("div",Dc,[t[134]||(t[134]=e("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[e("div",null,[e("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),e("div")],-1)),oe(dl,{blockArr:ht.value},null,8,["blockArr"])])):f("",!0)])])])])])])]),e("div",Sc,[e("div",Vc,[e("div",Ac,[t[138]||(t[138]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",qc,[t[136]||(t[136]=e("label",{for:""},"Form Name",-1)),k(e("input",{"onUpdate:modelValue":t[35]||(t[35]=s=>ct.value=s),multiple:!1,placeholder:M(U).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,Tc),[[L,ct.value]]),e("div",Uc,[e("div",Lc,[k(e("input",{class:"font-12","onUpdate:modelValue":t[36]||(t[36]=s=>Ze.value=s),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[X,Ze.value]])]),t[135]||(t[135]=e("div",null,[e("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),e("div",{class:"modal-footer"},[t[137]||(t[137]=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),e("button",{type:"button",class:"btn btn-dark",onClick:ms},"Add Print Format")])])])]),e("div",Ec,[e("div",Mc,[e("div",Bc,[t[139]||(t[139]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"formViewModalLabel"},"Form Preview"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Rc,[oe(dl,{blockArr:ht.value},null,8,["blockArr"])]),t[140]||(t[140]=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])]),e("div",Oc,[e("div",Nc,[e("span",zc,y(J.value==0?"Add Requestors":`Approval Settings - Level ${J.value}`),1),t[141]||(t[141]=e("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),e("div",Pc,[e("div",Hc,[J.value!==0?(a(),n("div",jc,[t[143]||(t[143]=e("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),k(e("select",{"onUpdate:modelValue":t[37]||(t[37]=s=>he.value=s),class:"form-select shadow-none font-12"},t[142]||(t[142]=[e("option",{value:""},"Any one of the selected approvers",-1),e("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),e("option",{value:"all_approvals_required"},"All of the selected approvers",-1),e("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[we,he.value]])])):f("",!0),e("div",Wc,[e("div",Jc,[e("span",Zc," Select "+y(J.value===0?"Requestors":"Approvers"),1),e("span",Gc,y(P.value.length)+" Selected ",1)]),le.value.length?(a(),n("div",Yc,[e("div",Kc,[e("div",Qc,[e("input",{type:"checkbox",id:"selectAll",checked:ls.value,onChange:ss,class:"form-check-input me-2 designationCheckBox"},null,40,Xc),e("label",xc," Select all designation ("+y(lt.value.length)+") ",1)]),J.value!==0?(a(),n("div",Ic,[k(e("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":t[38]||(t[38]=s=>Ge.value=s),class:"form-check-input me-2 designationCheckBox"},null,512),[[X,Ge.value]]),t[144]||(t[144]=e("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):f("",!0),e("div",null,[P.value.length?(a(),n("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:os},t[145]||(t[145]=[e("i",{class:"bi bi-x"},null,-1),D(" Clear all ")]))):f("",!0)])]),le.value.length?(a(),Et(M(Qs),{key:0,multiple:!0,modelValue:P.value,"onUpdate:modelValue":t[39]||(t[39]=s=>P.value=s),options:lt.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):f("",!0)],512)):(a(),n("div",ep,t[146]||(t[146]=[e("div",{class:"d-flex justify-content-center"},[e("span",null,"No Designations Found")],-1)])))]),J.value!==0?(a(),n("div",tp,[t[147]||(t[147]=e("div",null,[e("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),k(e("select",{"onUpdate:modelValue":t[40]||(t[40]=s=>$e.value=s),class:"form-select shadow-none font-12 mt-1 me-2"},[(a(!0),n(O,null,N(wl.value,s=>(a(),n("option",{key:s,value:s},y(s===0?"Requestor":"Approver Level "+s),9,lp))),128))],512),[[we,$e.value,void 0,{number:!0}]])])):f("",!0),J.value!==0?(a(),n("div",sp,[e("div",op,[e("div",ap,[k(e("input",{"onUpdate:modelValue":t[41]||(t[41]=s=>Ce.value=s),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[X,Ce.value]]),t[148]||(t[148]=e("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),Xe.value===!0?(a(),n("div",np,[k(e("input",{"onUpdate:modelValue":t[42]||(t[42]=s=>_e.value=s),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[X,_e.value]]),t[149]||(t[149]=e("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):f("",!0)])])):f("",!0)]),e("div",ip,[e("div",rp,[oe(nl,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:as,name:J.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},pp=Bt(dp,[["__scopeId","data-v-ba866e10"]]);export{pp as default};
