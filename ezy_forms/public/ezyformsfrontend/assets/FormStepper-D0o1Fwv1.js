var Tl=Object.defineProperty,Ul=Object.defineProperties;var Rl=Object.getOwnPropertyDescriptors;var mt=Object.getOwnPropertySymbols;var Yt=Object.prototype.hasOwnProperty,Kt=Object.prototype.propertyIsEnumerable;var Gt=(R,F,q)=>F in R?Tl(R,F,{enumerable:!0,configurable:!0,writable:!0,value:q}):R[F]=q,te=(R,F)=>{for(var q in F||(F={}))Yt.call(F,q)&&Gt(R,q,F[q]);if(mt)for(var q of mt(F))Kt.call(F,q)&&Gt(R,q,F[q]);return R},ye=(R,F)=>Ul(R,Rl(F));var Dt=(R,F)=>{var q={};for(var $ in R)Yt.call(R,$)&&F.indexOf($)<0&&(q[$]=R[$]);if(R!=null&&mt)for(var $ of mt(R))F.indexOf($)<0&&Kt.call(R,$)&&(q[$]=R[$]);return q};var Te=(R,F,q)=>new Promise(($,re)=>{var le=G=>{try{v(q.next(G))}catch(ne){re(ne)}},Fe=G=>{try{v(q.throw(G))}catch(ne){re(ne)}},v=G=>G.done?$(G.value):Promise.resolve(G.value).then(le,Fe);v((q=q.apply(R,F)).next())});import{_ as os,r as b,x as se,o as i,c as d,d as t,i as D,j as M,F as E,h as L,t as h,u as Ml,M as Ol,e as oe,E as Bl,w as we,f as zl,a6 as Qt,K as ce,y as z,z as H,L as S,l as _,a7 as Nl,m as C,n as N,Z as Xt,S as xt,b as X,O as Ge,B as It,R as ke,Q as es,X as ie,v as ft,N as Ce,k as Ue,a8 as ts,a9 as ss,aa as Pl,U as ae,H as pe,ab as Ft,a2 as jl,ac as ls,D as $t,ad as Hl}from"./index-DGkXveTt.js";const Wl="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",Jl={class:"simple-field-library"},Zl={class:"field-search"},Gl={class:"field-types-grid"},Yl=["onDragstart","onClick"],Kl={__name:"SimpleFieldLibrary",props:{fields:{type:Array,required:!0}},emits:["field-add","field-dragstart","field-dragend"],setup(R,{emit:F}){const q=R,$=F,re=b(""),le=b(!1),Fe=se(()=>{if(!re.value)return q.fields;const T=re.value.toLowerCase();return q.fields.filter(I=>I.label.toLowerCase().includes(T))}),v=(T,I)=>{le.value=!0,T.dataTransfer.effectAllowed="copy",T.dataTransfer.setData("text/plain",I.type),$("field-dragstart",I.type)},G=()=>{le.value=!1,$("field-dragend")},ne=T=>{$("field-add",T.type)};return(T,I)=>(i(),d("div",Jl,[t("div",Zl,[I[1]||(I[1]=t("i",{class:"bi bi-search"},null,-1)),D(t("input",{"onUpdate:modelValue":I[0]||(I[0]=Y=>re.value=Y),type:"text",placeholder:"Search fields",class:"search-input"},null,512),[[M,re.value]])]),t("div",Gl,[(i(!0),d(E,null,L(Fe.value,Y=>(i(),d("button",{key:Y.type,class:"field-type-btn",draggable:!0,onDragstart:K=>v(K,Y),onDragend:G,onClick:K=>ne(Y)},h(Y.label),41,Yl))),128))])]))}},Ql=os(Kl,[["__scopeId","data-v-cb64d6f9"]]),Xl={class:""},xl={class:""},Il={class:"d-flex justify-content-between align-items-center CancelNdSave"},eo={class:"d-flex align-items-center"},to={key:0,class:"font-16"},so=["disabled"],lo={class:"form-container p-0 container-fluid mt-3"},oo={class:"row g-4"},ao={class:"col-lg-2 col-md-3 col-sm-12"},no={class:"steps-sticky-div"},io={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},ro=["onClick"],uo={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},co={class:"step-text"},po={class:"font-11"},mo={class:"font-14"},fo={class:"col-lg-10 col-md-9 col-sm-12 formbackground-color"},vo={class:"px-2"},_o={class:"form-content stepsDiv"},bo={key:0},ho={class:""},go={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},yo={class:"container-fluid aboutFields p-0"},wo={class:"row"},ko={class:"col-sm-12 col-md-12 mt-lg-3 p-lg-4"},Co={class:"container-fluid"},Do={class:"row g-3"},Fo={class:"col-md-6"},$o={class:"position-relative"},So={key:0,class:"font-12 position-absolute PredefinedLabel"},Ao={key:1,class:"text-danger ErrorMsg ms-2"},qo={class:"col-md-6"},Vo={key:0,class:"text-danger ErrorMsg ms-2"},Eo={class:"col-md-6"},Lo={class:"col-md-6"},To={key:0,class:"text-danger"},Uo={class:"col-md-6"},Ro={key:0,class:"text-danger"},Mo={class:"col-md-6"},Oo={key:0,class:"text-danger"},Bo={class:"custom-option"},zo=["checked","onChange"],No={class:"col-md-6"},Po={class:"col-md-6"},jo={key:0,class:"col-md-6"},Ho={key:1,class:"col-md-6"},Wo={key:2,class:"col-md-6"},Jo={key:3,class:"col-md-6"},Zo={class:"form-check d-flex align-items-center p-0 pe-3"},Go=["disabled"],Yo={key:4,class:"col-md-6"},Ko=["disabled"],Qo={key:0,class:"list-group position-absolute w-100 z-3 formslist"},Xo=["onMousedown"],xo={key:1,class:"zoho-form-builder"},Io={class:"zoho-toolbar"},ea={class:"toolbar-left"},ta={class:"zoho-tabs"},sa=["onClick"],la=["onClick"],oa={class:"toolbar-right"},aa={class:"zoho-builder-container"},na={class:"d-flex align-items-center justify-content-between w-100"},ia={class:"mb-0 font-14 fw-bold"},ra={class:"btn btn-sm btn-link p-0 text-dark"},da={key:0,class:"library-content"},ua={class:"zoho-form-canvas"},ca={class:"requestandAppHeader"},pa={class:"d-flex justify-content-between align-items-center"},ma={class:""},fa={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},va={class:"text-center ms-2 mt-1"},_a={key:0,class:"font-12 d-flex align-items-center"},ba={class:"font-12 approver_type_div"},ha={class:"font-12 fw-bold"},ga={class:"font-12 text-danger ms-1"},ya={class:"d-flex align-items-center"},wa={key:0,class:"role-container"},ka={key:0,class:"role-text d-flex align-items-center"},Ca={class:"role-label fw-bold"},Da={class:"role-names"},Fa=["onClick"],$a=["onClick"],Sa=["onClick"],Aa=["onClick"],qa={class:"pt-0 section_block"},Va={class:"d-flex justify-content-between align-items-center"},Ea={class:"d-flex flex-column"},La=["onUpdate:modelValue","onChange","onInput"],Ta={key:0,class:"text-danger ps-3 font-10"},Ua={class:"d-flex align-items-center"},Ra=["onClick"],Ma={class:"container-fluid"},Oa={class:"d-flex justify-content-between align-items-center"},Ba={class:"rownames m-0"},za=["onClick"],Na={class:"col"},Pa={class:"row"},ja=["onMouseenter"],Ha={class:"column_name d-flex align-items-center justify-content-between"},Wa={class:"d-flex flex-column ps-2"},Ja=["onUpdate:modelValue","onChange","onInput"],Za={key:0,class:"text-danger ps-2 font-10"},Ga={class:"position-absolute top-0 end-0"},Ya=["onClick"],Ka=["onDrop"],Qa=["onMouseenter","onDragstart","onDrop"],Xa=["onDrop"],xa=["onDragstart","onDrop"],Ia={class:"d-flex justify-content-between"},en={class:"flex-column d-flex"},tn=["onUpdate:modelValue","onChange","onInput"],sn={key:0,class:"text-danger font-10"},ln={class:"FieldcopyRemove"},on=["onClick"],an=["onClick"],nn=["onUpdate:modelValue","onChange"],rn=["value"],dn={key:0},un=["onUpdate:modelValue"],cn={key:0,class:"text-danger font-10"},pn={key:1},mn=["for"],fn=["id","onUpdate:modelValue","onInput","onFocus"],vn={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},_n=["onClick"],bn={class:"d-flex align-items-center justify-content-between"},hn={class:"d-flex align-items-center gap-2"},gn={class:"d-flex align-items-center"},yn=["onUpdate:modelValue","id"],wn=["for"],kn=["onClick"],Cn=["onUpdate:modelValue"],Dn={key:3,class:"text-danger font-10"},Fn=["onDrop"],$n={class:"childtableShow"},Sn={class:"mt-2"},An={key:0,class:"childTableContainer"},qn={key:0,class:"font-13"},Vn={key:1,class:"d-flex align-items-center gap-2"},En={class:"d-flex align-items-center"},Ln=["onUpdate:modelValue"],Tn=["onClick"],Un={key:2,class:"table table-bordered rounded-table"},Rn=["onDrop"],Mn=["draggable","onDragstart"],On={key:0},Bn=["onUpdate:modelValue","onInput"],zn={key:0,class:"text-danger font-11"},Nn={key:1},Pn={key:2},jn={class:"d-flex gap-1"},Hn=["onUpdate:modelValue","onChange"],Wn=["value"],Jn={class:"d-flex"},Zn={class:"d-flex align-items-center gap-2"},Gn={class:"d-flex align-items-center"},Yn=["onUpdate:modelValue"],Kn=["onClick"],Qn={key:0},Xn=["onUpdate:modelValue","onInput"],xn={key:0,class:"text-danger font-10"},In={key:1,class:"font-11 text-danger"},ei={key:3},ti={key:3,class:"mb-2 mt-3"},si=["onClick"],li=["onClick"],oi=["onDrop"],ai=["onDrop"],ni={class:"d-flex justify-content-center align-items-center my-2"},ii=["onClick"],ri={class:"font-13"},di={key:0,class:"d-flex align-items-center gap-2"},ui={class:"d-flex align-items-center"},ci=["onUpdate:modelValue"],pi=["onClick"],mi={class:"table table-bordered rounded-table"},fi={key:0},vi=["onUpdate:modelValue","onBlur"],_i={key:0,class:"text-danger font-11 mt-1"},bi={key:1},hi={key:2},gi={class:"d-flex gap-1 align-items-center"},yi=["onUpdate:modelValue","onChange"],wi=["value"],ki=["onClick"],Ci={key:0,class:"mt-1"},Di=["onUpdate:modelValue","onInput"],Fi={key:1,class:"text-danger font-11 mt-1"},$i={key:3},Si={class:"mb-2"},Ai=["onClick"],qi=["onClick"],Vi=["onClick"],Ei={key:0},Li={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},Ti=["onUpdate:modelValue","onBlur"],Ui={key:0,class:"text-danger font-12"},Ri={key:1,class:"text-danger font-12"},Mi={class:"d-flex align-items-center gap-2"},Oi={class:"d-flex align-items-center"},Bi=["onUpdate:modelValue"],zi=["onClick"],Ni=["onClick"],Pi={class:"px-1 field-border"},ji={class:"d-flex justify-content-between"},Hi=["onUpdate:modelValue","onBlur"],Wi={key:0,class:"text-danger font-12"},Ji={class:"d-flex align-items-center"},Zi={class:"d-flex my-1"},Gi=["onUpdate:modelValue"],Yi=["onClick"],Ki=["onClick"],Qi=["onUpdate:modelValue"],Xi=["value"],xi={key:0},Ii=["onUpdate:modelValue"],er={key:0,class:"text-danger font-10"},tr={key:1,class:"text-danger font-12"},sr=["onClick"],lr=["onClick"],or={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},ar=["onClick"],nr={key:0,class:"m-2"},ir={key:0,class:"zoho-properties-panel"},rr={class:"properties-header"},dr={key:2},ur={class:"stepperbackground d-flex align-items-center justify-content-between p-3"},cr={class:"container-fluid mt-4 p-4"},pr={class:"card mb-4"},mr={class:"card-body"},fr={class:"row g-3"},vr={class:"col-md-6"},_r={class:"btn-group w-100",role:"group"},br={key:0,class:"col-md-6"},hr={key:0,class:"card"},gr={class:"card-body"},yr={key:0,class:"mt-3"},wr={class:"table-responsive"},kr={class:"table table-bordered"},Cr=["onUpdate:modelValue"],Dr={class:"form-check form-switch"},Fr=["onUpdate:modelValue"],$r=["onClick"],Sr=["onClick"],Ar={key:3},qr={class:"stepperbackground d-flex align-items-center justify-content-between p-3"},Vr={class:"container-fluid mt-4 p-4"},Er={key:0},Lr={class:"alert alert-secondary"},Tr={key:1},Ur={key:4},Rr={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},Mr={class:"modal-dialog modal-dialog-centered"},Or={class:"modal-content"},Br={class:"modal-body"},zr=["placeholder"],Nr={class:"d-flex align-items-center gap-2"},Pr={class:"d-flex align-items-center py-2"},jr={class:"modal fade",id:"formViewModal",tabindex:"-1","aria-labelledby":"formViewModalLabel","aria-hidden":"true"},Hr={class:"modal-dialog modal-xl modal-dialog-scrollable"},Wr={class:"modal-content"},Jr={class:"modal-body"},Zr={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},Gr={class:"offcanvas-header add_designationHeader"},Yr={id:"offcanvasRightLabel",class:"font-14 fw-bold"},Kr={class:"offcanvas-body add_desig_offCanvas_body p-0"},Qr={class:""},Xr={class:""},xr={key:0,class:"p-3 approval-border-bottom"},Ir={key:0,class:""},ed={class:"px-3 listofdesignations"},td={class:"my-1 d-flex justify-content-between"},sd={class:"font-12 fw-bold"},ld={class:"italic-style text-secondary font-12"},od={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},ad={class:"d-flex align-items-center justify-content-between gap-1"},nd={class:"form-check ps-1 d-flex align-items-center m-0"},id=["checked"],rd={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},dd={key:0,class:"form-check d-flex align-items-center m-0"},ud={key:1},cd={key:0,class:"p-3"},pd=["value"],md={key:1},fd={class:""},vd={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},_d={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},bd={class:"offcanvas-footer"},hd={class:"text-end p-3"},De="Select All",gd={__name:"FormStepper",setup(R){const F=Ml(),q=Ol(),$=b(1),re=b([]);b([]);const le=b([]),Fe=b([]);oe([]);let v=oe([]),G=oe([]);const ne=b([]),T=b([]),I=b([]),Y=b(""),K=b(""),O=b("");let W=oe([]);const Re=b("");b(!1),b(!1),b(!1);const $e=b(""),Ye=b(""),Ke=b(""),as=b([]),ns=b([]),A=oe({}),ee=b([]),vt=b(!1),Qe=b([]),Xe=b(!1);let St=null;const is=b("");let U=b("");const ve=b(null),At=b(null),Se=b(!0),xe=b(0),Me=b([]),Ie=b(null),Ae=b("new"),et=b([]),qe=se(()=>Bl);b(!1);const tt=oe([]),x=b({routepath:F.query.routepath,business_unit:F.query.business_unit,formId:F.query.id}),st=b(""),Ve=b(!1),Ee=b(!1),qt=[{label:"Public",value:1},{label:"Private",value:0}],Vt=se({get(){return qt.find(s=>s.value===f.value.as_web_view)},set(s){f.value.as_web_view=s?s.value:null}}),Et=se({get(){return f.value.form_name||F.query.form_name||""},set(s){f.value.form_name=s}}),f=b({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${qe.value.value||x.value.business_unit||F.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:F.query.id?1:0,as_web_view:0,mail_id:""});we(()=>F.query.form_name,s=>{s&&(f.value.form_name=s,f.value.form_short_name=s)},{immediate:!0});const lt=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(s=>s.toLowerCase().trim()),Lt=["Approver","Approved on","Approved By"].map(s=>s.toLowerCase().trim());function rs(s){return s.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}se(()=>f.value),b(""),b(!1),we(qe,s=>{s&&s.value&&(f.value.business_unit=s.value)},{immediate:!0});function ds(s){if(U==null||U==="new")return!1;const e=B(s).roles;if(s===0)return e.length===0;const l=B(s-1).roles;return l.length>0&&l[0]!==null&&l[0]!==""&&e.length===0}we(()=>f.value.form_name,s=>{f.value.form_name=s.trim()}),we(()=>f.value.form_short_name,s=>{f.value.form_short_name=s.trim()}),we(()=>f.value.series,s=>{f.value.series=s.trim()});const Oe=b(null),Tt=(s,e,l,o,a,n)=>{Oe.value={blockIndex:e,sectionIndex:l,rowIndex:o,columnIndex:a,fieldIndex:n}},_e=(s,e,l,o,a,n)=>{if(s.preventDefault(),s.stopPropagation(),console.log("Field dropped at index:",{targetBlock:e,targetSection:l,targetRow:o,targetColumn:a,insertIndex:n,draggedField:Oe.value,draggedFieldType:ve.value}),ve.value){console.log("Dropping from field library:",ve.value);const g=Zt(ve.value);if(!g){console.error("Failed to create field from type:",ve.value);return}const k=v[e];if(!k){ae("Target block not found");return}k.sections||(k.sections=[]),k.sections[l]||(k.sections[l]={label:"",rows:[]}),k.sections[l].rows||(k.sections[l].rows=[]),k.sections[l].rows[o]||(k.sections[l].rows[o]={label:"",columns:[]}),k.sections[l].rows[o].columns||(k.sections[l].rows[o].columns=[]),k.sections[l].rows[o].columns[a]||(k.sections[l].rows[o].columns[a]={label:"",fields:[]}),k.sections[l].rows[o].columns[a].fields.splice(n,0,g),console.log("Field added successfully:",g),pe(`${g.label} field added`),ve.value=null;return}if(!Oe.value){console.log("No dragged field found");return}const{blockIndex:r,sectionIndex:c,rowIndex:m,columnIndex:u,fieldIndex:p}=Oe.value,w=v[r].sections[c].rows[m].columns[u].fields,V=v[e].sections[l].rows[o].columns[a].fields;if(r===e&&c===l&&m===o&&u===a&&p===n)return;const y=w.splice(p,1)[0];w===V&&p<n&&n--,V.splice(n,0,y),Oe.value=null},Le=b(""),us=s=>Te(this,null,function*(){const e=[["module","in",["User Forms"]],["istable","=",1]];s!=null&&s.trim()&&e.push(["name","=",`${s}`]);const l={fields:JSON.stringify(["name"]),filters:JSON.stringify(e),limit_page_length:"None",doctype:ce.doctypesList};try{return(yield z.get(H.GetDoctypeData,{params:l})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),ot=b(null),Ut=s=>Te(this,null,function*(){if(Le.value="",ot.value=null,s.tableName){let e=s.tableName.trim();if(e.length>64){Le.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(e)){Le.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield us(e);ot.value=o.find(a=>a.name.toLowerCase()===e.toLowerCase()),ot.value&&(Le.value="Table already exists"),s.tableName=e}s.label&&(s.fieldname=rs(s.label))});function cs(){const s=f.value.is_linked_form;if(!s){Qe.value=[];return}clearTimeout(St),St=setTimeout(()=>{const e=[["business_unit","=",`${qe.value.value}`],["name","like",`%${s}%`]],l={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(e),doctype:ce.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};z.get(`${H.GetDoctypeData}`,{params:l}).then(o=>{Qe.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function ps(s){f.value.is_linked_form=s,Xe.value=!1}function ms(){setTimeout(()=>{Xe.value=!1},200)}oe({query:"",key:""});function me(s,e,l,o,a){return`${s}-${e}-${l}-${o}-${a}`}oe({});const Be=oe({}),_t=oe({});function fs(s){_t[s]=!0}function vs(s,e,l,o,a,n){const r=me(e,l,o,a,n),c=[["istable","=",0]];s!=null&&s.trim()&&c.push(["name","like",`%${s}%`]);const m={fields:JSON.stringify(["name"]),filters:JSON.stringify(c),limit_page_length:"none",doctype:ce.doctypesList};z.get(H.GetDoctypeData,{params:m}).then(u=>{Be[r]=u.message.data||[]}).catch(u=>{console.error("Error fetching doctype list:",u),Be[r]=[]})}function _s(s,e,l,o,a,n){v[s].sections[e].rows[l].columns[o].fields[a].options=n;const r=me(s,e,l,o,a);Be[r]=[],_t[r]=!1}const bs=se(()=>v!=null&&v.length?O.value===1?[0]:Array.from({length:O.value},(s,e)=>e).filter(s=>s<O.value):[]),fe=b(null),be=b(null),hs=(s,e,l,o,a)=>{fe.value={blockIndex:s,sectionIndex:e,rowIndex:l,columnIndex:o,fieldIndex:a}},gs=()=>{fe.value=null},ys=(s,e,l,o,a)=>fe.value&&fe.value.blockIndex===s&&fe.value.sectionIndex===e&&fe.value.rowIndex===l&&fe.value.columnIndex===o&&fe.value.fieldIndex===a,ws=(s,e,l,o)=>{be.value={blockIndex:s,sectionIndex:e,rowIndex:l,columnIndex:o}},ks=()=>{be.value=null},Cs=(s,e,l,o)=>be.value&&be.value.blockIndex===s&&be.value.sectionIndex===e&&be.value.rowIndex===l&&be.value.columnIndex===o,Rt=b([{form_json:""}]),he=b("");zl(()=>{zt(),he.value=F.query.Clone,U.value=F.query.id||"new",he.value==="1"&&(f.value.series=""),U.value!=null&&U.value!=null&&U.value!="new"&&(Bt(),wt()),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?vt.value=!0:vt.value=!1;let s=localStorage.getItem("Bu");if(f.value.business_unit=s,F.query.preId==="PreDefine"){const e=localStorage.getItem("form_json");if(e){Rt.value[0].form_json=e;const l=Rt.value[0],o=JSON.parse(l.form_json),a=Qt(o.fields);ee.value=o.child_table_fields,a.forEach(n=>{v.push(n)})}}});const ge=b(null),J=oe({}),Mt=b(null),Ds=s=>{ge.value=s},Fs=()=>{ge.value=null},$s=s=>{s.preventDefault()},Ss=(s,e)=>{const l=s.target.closest("tr");if(!l)return;const o=Array.from(l.parentNode.children).indexOf(l);if(o!==ge.value){const a=e[ge.value];e.splice(ge.value,1),e.splice(o,0,a),ge.value=o}},As=b([]),bt=s=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(s.fieldtype)&&s.options){const e=s.options.split(`
`).map(a=>a.trim()).filter(a=>a),l=[],o=new Set;return e.forEach(a=>{const n=a.toLowerCase();o.has(n)||(o.add(n),l.push(a))}),`
`+l.join(`
`)}else if(["Link","Table"].includes(s.fieldtype)&&s.options)return s.options.trim();return s.options},qs=(s,e)=>{const l=v[s].sections[e];l.childTables||(l.childTables=[]);const o=l.childTables.length;l.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[te({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},tt.fieldtype==="Select"&&tt.options?{options:tt.options?`
${tt.options}`:`
`}:{})],newTable:!0})},Vs=(s,e,l)=>{const o=v[s].sections[e].childTables[l];o.columns||(o.columns=[]),o.columns.push(te({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},Es=(s,e,l)=>{v[s].sections[e].childTables.splice(l,1)},Ls=(s,e,l,o)=>{v[s].sections[e].childTables[l].columns.splice(o,1)};function Ts(s,e,l,o,a,n){var u;const r=`${e}-${l}-${o}`;A[r]||(A[r]={columns:[]});const c={},m=((u=s.label)==null?void 0:u.trim())||"";if(!m)c.label="Field Label is required";else{const p=m.toLowerCase();if(lt.includes(p)&&!Lt.includes(p))c.label=`"${m}" is a restricted field label`;else if(m.length>64)c.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(m))c.label="Field Label can only contain letters, numbers, and single spaces between words";else{const w=n.map((V,y)=>{var g;return{label:(g=V.label)==null?void 0:g.trim().toLowerCase(),index:y}}).filter(V=>V.label===p);if(w.length>1){const V=w[0].index;a!==V&&(c.label=`"${m}" is already used in this table`)}}}A[r].columns[a]=c}function at(s,e,l){var n;A[e]||(A[e]={});const o=[],a=((n=s.label)==null?void 0:n.trim())||"";a||o.push("Label is required"),a.length>64&&o.push("Label cannot exceed 64 characters"),a&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(a)&&o.push("No special characters allowed"),a&&lt.includes(a.toLowerCase().trim())&&o.push("This label is restricted"),a&&ee.value[e].map(m=>{var u;return(u=m.label)==null?void 0:u.trim().toLowerCase()}).filter(Boolean).filter(m=>m===a.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),s.fieldtype||o.push("Field type is required"),s.fieldtype==="Select"&&(!s.options||s.options.trim()==="")&&o.push("Options are required"),A[e][l]=o}const Us=(s,e,l)=>{var r;const o=v[s].sections[e].childTables[l],a={tableName:!1,columns:[]};let n=!1;return(r=o.tableName)!=null&&r.trim()||(a.tableName="Table name is required.",n=!0),o.columns.forEach((c,m)=>{var p,w;const u={};(p=c.label)!=null&&p.trim()||(u.label="Field Label is required",n=!0),(w=c.fieldtype)!=null&&w.trim()||(u.fieldtype="Please select field type",n=!0),a.columns[m]=u}),A[`${s}-${e}-${l}`]=a,n},Rs=(s,e,l)=>{var a,n;const o=(n=(a=v[s])==null?void 0:a.sections)==null?void 0:n[e];o&&!Array.isArray(o[l])&&(o[l]=[])},Ms=s=>s?s.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",Os=(s,e,l)=>{if(Us(s,e,l)){ae("Please fix validation errors before creating the table",{transition:"zoom"});return}if(ot.value){ae("Table already exists",{transition:"zoom"});return}const a=v[s].sections[e].childTables[l],n=v[s].sections[e];a.columns=a.columns.map((c,m)=>ye(te({},c),{idx:m,options:bt(c)})),a.newTable=!1;const r={form_short_name:a.tableName,fields:a.columns,idx:a.idx,as_a_block:a.as_a_block?a.as_a_block:"false"};z.post(H.childtable,r).then(c=>{var m,u,p;if(c){Rs(s,e,"afterCreated"),n.afterCreated[l]=te({},a),pe("Table created successfully!");const w=(p=(u=(m=c.message)==null?void 0:m[0])==null?void 0:u[0])==null?void 0:p.child_doc;w&&(v[s].sections[e].childTables[l]=ye(te(te({},v[s].sections[e].childTables[l]),w),{newTable:!1}))}}).catch(c=>{console.error("Error creating table:",c)})},ze=(s,e,l,o=[])=>{var r;J[e]||(J[e]=[]),J[e]=J[e].filter(c=>c!==l),A[e]||(A[e]=[]),A[e][l]=[];const a=[],n=((r=s.label)==null?void 0:r.trim())||"";if(n?lt.includes(n.toLowerCase())?a.push("This label is restricted"):n.length>64?a.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(n)||a.push("Only letters, numbers, and single spaces allowed"):a.push("Label is required"),o.length){const c=n.toLowerCase(),m=o.map((u,p)=>{var w;return{label:(w=u.label)==null?void 0:w.trim().toLowerCase(),idx:p}}).filter(u=>u.label===c);if(m.length>1){const u=m[0].idx;l!==u?(a.push("Duplicate label not allowed"),s._duplicate=!0):s._duplicate=!1}else s._duplicate=!1}return s.fieldtype||a.push("Field type is required"),s.fieldtype==="Select"&&(!s.options||!s.options.trim())&&a.push("Options are required"),A[e][l]=a,a.length>0&&J[e].push(l),a.length===0},Bs=(s,e,l)=>{const a=v[s].sections[e].afterCreated.find(c=>c.tableName===l);if(!a)return;const n=a.columns.length,r={fieldname:"",fieldtype:"",idx:n+1,label:"",value:"",isNew:!0,description:""};a.columns.push(r),ze(r,l,n,a.columns)},Ot=b([]),zs=(s,e,l,o)=>{const n=v[s].sections[e].afterCreated.find(c=>c.tableName===l);if(!n)return;n.columns.splice(o,1),n.columns.forEach((c,m)=>{c.idx=m+1});const r=J.value[l];r&&(J.value[l]=r.filter(c=>c!==o).map(c=>c>o?c-1:c))},Ns=(s,e,l)=>{const a=v[s].sections[e].afterCreated.find(n=>n.tableName===l);if(a){if(P[l]){J[l]=[];let n=!0;if(a.columns.forEach((m,u)=>{ze(m,l,u,a.columns)||(n=!1)}),!n){ae("Please fix the errors in the highlighted fields before saving!");return}const r=a.columns.map((w,p)=>{var V=w,{isNew:m}=V,u=Dt(V,["isNew"]);return ye(te({},u),{idx:p+1,options:bt(u)})}),c={form_short_name:Ms(l),fields:r,as_a_block:a.description};z.post(H.childtable,c).then(m=>{Ot.value=m.data,pe("Fields updated successfully!")}).catch(m=>{console.error("❌ Saving fields failed:",m)})}P[l]=!P[l]}},P=oe({}),Ps=s=>{ee.value[s]||(ee.value[s]=[]);const e=ee.value[s].length+1;ee.value[s].push({fieldname:"",fieldtype:"",idx:e,label:"",value:"",isNew:!0,description:"",options:ee.value[s].options?`
${ee.value[s].options}`:""})},js=(s,e)=>{ee.value[s]&&ee.value[s].splice(e,1)},Hs=(s,e)=>{if(!s)return;J.value||(J.value={}),J.value[s]||(J.value[s]=[]);const l=ee.value[s];if(l){if(P[s]){J.value[s]=[];let o=!0;if(l.forEach((r,c)=>{var u;at(r,s,c);const m=(u=A[s])==null?void 0:u[c];m&&m.length>0&&(J.value[s].push(c),o=!1),r.label&&(r.label=r.label.trim())}),!o){ae("Please fix the errors before saving");return}const a=l.map((u,m)=>{var p=u,{isNew:r}=p,c=Dt(p,["isNew"]);return ye(te({},c),{idx:m+1,options:bt(c)})}),n={form_short_name:s,fields:a,as_a_block:e};z.post(H.childtable,n).then(r=>{Ot.value=r.data,pe("Fields updated successfully!")}).catch(r=>{console.error("❌ Saving fields failed:",r)})}P[s]=!P[s],Mt.value=P[s]?s:null}},Ws=b([{id:1,label:"Form Info",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Form Fields",stepno:"Step 2",icon:"bi bi-grid-3x3-gap"},{id:3,label:"Requestor Block",stepno:"Step 3",icon:"bi bi-person-plus"},{id:4,label:"Approver Blocks",stepno:"Step 4",icon:"bi bi-people"},{id:5,label:"Print Format",stepno:"Step 5",icon:"ri-checkbox-circle-line"}]),ht=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],nt=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],Js=se(()=>[De,...le.value]),Zs=se(()=>{const s=f.value.accessible_departments;return s.includes(De)?"All Selected":s.length>1?`${s[0]}.. +${s.length-1} more selected`:s.join(", ")}),Gs=s=>s===De?f.value.accessible_departments.length===le.value.length:f.value.accessible_departments.includes(s),Ys=(s,e)=>{s===De?e.target.checked?f.value.accessible_departments=[...le.value]:f.value.accessible_departments=[]:(e.target.checked?f.value.accessible_departments.push(s):f.value.accessible_departments=f.value.accessible_departments.filter(l=>l!==s),f.value.accessible_departments.length===le.value.length?f.value.accessible_departments=[...le.value]:f.value.accessible_departments=f.value.accessible_departments.filter(l=>l!==De))},Ks=s=>{s===De&&(f.value.accessible_departments=[...le.value])},Qs=s=>{s===De&&(f.value.accessible_departments=[])},gt=b(!1),Ne=se(()=>{var e;let s=[...ne.value];if(Ee.value&&(s=s.filter(l=>l.is_hod===1)),(e=Re.value)!=null&&e.trim()){const l=Re.value.toLowerCase();s=s.filter(o=>o.role.toLowerCase().includes(l))}return s.sort((l,o)=>l.role.localeCompare(o.role)),s.sort((l,o)=>{const a=T.value.includes(l.role),n=T.value.includes(o.role);return a===n?0:a?1:-1}),s.map(l=>l.role)}),Xs=se(()=>{const s=Ne.value;return s.length>0&&s.every(e=>T.value.includes(e))});we([T,Ne],()=>{const s=Ne.value;gt.value=s.length>0&&s.every(e=>T.value.includes(e))},{immediate:!0,deep:!0});function xs(s){const e=s.target.checked,l=ne.value.filter(o=>{var a;return!(Ee.value&&o.is_hod!==1||(a=Re.value)!=null&&a.trim()&&!o.role.toLowerCase().includes(Re.value.toLowerCase()))}).map(o=>o.role);e?T.value=Array.from(new Set([...T.value,...l])):T.value=T.value.filter(o=>!l.includes(o)),gt.value=e}function Is(){T.value=[],gt.value=!1,Ee.value=!1}const de=b("");function el(){const s=v[O.value];if(!s||!s.sections){console.error("Error: Invalid block or sections not found.");return}let e={type:O.value==0?"requestor":"approver",roles:T.value,approval_required:Ye.value,approver_can_edit:Ke.value,fields:s.sections.flatMap(Ft),idx:O.value};O.value!==0&&(e.view_only_reportee=de.value==="ViewOnlyReportee"?1:0,e.all_approvals_required=de.value==="all_approvals_required"?1:0,e.requester_as_a_approver=de.value==="requester_as_a_approver"?1:0,e.on_rejection=$e.value?$e.value:0);const l=W.findIndex(o=>o.idx===e.idx);l!==-1?W[l]=e:W.push(e),ll()}function B(s){return W.find(e=>e.idx===s)||{roles:[]}}function tl(s){const e=B(s),l=e.roles||[];T.value=[...l],$e.value=e.on_rejection,Ye.value=e.approval_required,Ke.value=e.approver_can_edit,e.view_only_reportee===1?de.value="ViewOnlyReportee":e.all_approvals_required===1?de.value="all_approvals_required":e.requester_as_a_approver===1?de.value="requester_as_a_approver":de.value=""}const yt=s=>{Ee.value=!1,Re.value="",de.value="",$e.value="",f.value.accessible_departments.length&&sl(s,f.value.accessible_departments),O.value=s,tl(s)};function sl(s,e){let l={index:s,departments:e,property:f.value.business_unit};z.post(H.addDesignationroles,l).then(o=>{o.message&&(ne.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function ll(){z.post(H.add_roles_WF,{workflow_setup:W,doctype:f.value.form_short_name,business_unit:f.value.business_unit}).then(s=>{console.log(s),O.value==0?pe("Requestor Added"):pe(`Approver-${O.value} Added`)})}function ol(){q.push({path:x.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function al(){f.value.form_name="",f.value.form_short_name="",f.value.owner_of_the_form="",f.value.business_unit="",f.value.form_category="",f.value.accessible_departments=[]}const nl=s=>{if(ct.value){ae("Please check all required fields before proceeding.");return}s<$.value?rt():s>$.value&&it()},it=()=>{if(ct.value){ae("Please check all required fields before proceeding.");return}$.value<5&&($.value+=1,$.value===5&&(pt.value=v))},rt=()=>{$.value>1&&($.value-=1)},il=b([]);function Bt(){const s={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:ce.EzyFormDefinitions,doc_id:U.value};z.get(H.GetDoctypeData,{params:s}).then(e=>{var o;let l=e==null?void 0:e.message.data;if(l){l.accessible_departments&&(l.accessible_departments=l.accessible_departments.split(",")),f.value=ye(te(te({},f.value),l),{owner_of_the_form:l.owner_of_the_form||f.value.owner_of_the_form||""});const a=JSON.parse((o=e.message.data)==null?void 0:o.form_json);as.value=a.workflow,is.value=a.fields.filter(r=>r.fieldtype==="Table"),il.value=a.fields.filter(r=>r.fieldtype==="Table"),Ve.value=e.message.data.is_landscape;let n=Qt(JSON.parse(l==null?void 0:l.form_json).fields);ee.value=JSON.parse(e.message.data.form_json).child_table_fields,As.value=[],ns.value=[],n.forEach((r,c)=>{v.push(r)}),JSON.parse(l==null?void 0:l.form_json).workflow.forEach((r,c)=>{W.push(r)})}}).catch(e=>{console.error("Error fetching  data:",e)})}function rl(){const s={};st.value&&(s.print_format=st.value),Ve.value!==void 0&&Ve.value!==null&&(s.is_landscape=Ve.value),z.put(H.resource+ce.EzyFormDefinitions+`/${F.query.id}`,s).then(e=>{console.log(e),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),pe("Print Format Added Successfully")}).catch(e=>{console.error("Error fetching  data:",e)})}function zt(){const s={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${x.value.business_unit||F.query.business_unit}`,doctype:ce.departments};z.get(H.GetDoctypeData,{params:s}).then(e=>{var l;(l=e==null?void 0:e.message.data)!=null&&l.length&&(Fe.value=e.message.data.map(o=>o.name),le.value=e.message.data.map(o=>o.name))}).catch(e=>{console.error("Error fetching department data:",e)})}b(""),we(()=>f.value.owner_of_the_form,s=>{s&&wt(s)});function wt(s){s&&typeof s=="string"&&s.trim()!==""&&dl(s)}function dl(s){const e={fields:JSON.stringify(["ezy_departments_items"]),doctype:ce.departments,doc_id:s};z.get(H.GetDoctypeData,{params:e}).then(l=>{var o;(o=l==null?void 0:l.message.data)!=null&&o.ezy_departments_items&&(re.value=l.message.data.ezy_departments_items.map(a=>a.category))}).catch(l=>{console.error("Error fetching categories data:",l)})}function kt(s){let e=Hl(v);const l=ye(te({},f.value),{fields:e,doctype:ce.EzyFormDefinitions,workflow_setup:W,form_status:s==="save"?"Created":"Draft"});l.accessible_departments=l.accessible_departments.toString(),z.post(H.savedata,l).then(o=>{if(o&&o.message&&o.message.message){let a=localStorage.getItem("preName");if(a){let n={installed:"Yes"};z.put(`${H.resource}${ce.preDefinedForm}/${a}`,n).then(r=>{localStorage.removeItem("preName")}).catch(r=>{console.error("Error fetching ezyForms data:",r)})}if(q.push({params:{paramid:o.message.message},query:{id:o.message.message}}),U.value=o.message.message,U&&U!=="new"&&(v.splice(0,v.length),Bt()),W.length<v.length)$t("Add Workflow");else if(Nt.value===!0){pe("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let n=localStorage.getItem("routepath");s==="save"?q.push({path:n}):s==="Draft"&&q.push({path:n})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const dt=b(""),ut=()=>{var l,o;const s=v.length,e={label:s===0?"requestor":`approver-${s}`,parent:`${(l=qe.value)==null?void 0:l.value}-${(o=f.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${qe.value.value}-${f.value.form_short_name}`,childTables:[],afterCreated:{},rows:s===0?[{label:`row_0_0_${s}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${s}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${s}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};v.push(e),jl(()=>{dt.value&&dt.value.scrollTo({top:dt.value.scrollHeight,behavior:"smooth"})})},Nt=b(!1),Pt=s=>{let e=v[s];e.parent&&G.push(e);let l=[];W.length>s&&W[s].roles&&(l=[...W[s].roles]),v.splice(s,1),W.length>s&&W.splice(s,1),v.forEach((o,a)=>{o.sections.forEach((n,r)=>{n.rows.forEach((c,m)=>{c.columns.forEach((u,p)=>{ue(a,r,m,p)})})})}),l.length&&ul(l,s)};function ul(s,e){const l={role:s,level:e,document_type:f.value.form_name,short_name:f.value.form_short_name,property:f.value.business_unit};z.post(H.deleteAssigneRoles,l).then(o=>{o&&kt()})}const cl=(s,e)=>{const l={label:"",parent:`${qe.value.value}-${f.value.form_short_name}`,rows:[{label:`row_0_${e}_${s}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};v[s].sections.splice(e+1,0,l)},pl=(s,e)=>{let l=v[s].sections[e];l.parent&&G.push(l),v[s].sections.splice(e,1),v[s].sections.forEach((o,a)=>{o.rows.forEach((n,r)=>{n.columns.forEach((c,m)=>{ue(s,a,r,m)})})})},ml=(s,e,l)=>{v[s].sections[e].rows[l].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},fl=(s,e,l,o)=>{const n=v[s].sections[e].rows[l].columns,r=n[o];r.parent&&G.push(r),n.length===1?v[s].sections[e].rows.splice(l,1):n.splice(o,1),v[s].sections.forEach((c,m)=>{c.rows.forEach((u,p)=>{u.columns.forEach((w,V)=>{ue(s,m,p,V)})})})},vl=(s,e,l,o)=>{v[s].sections[e].rows[l].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},_l=(s,e,l,o,a)=>{let n=v[s].sections[e].rows[l].columns[o].fields[a];n.parent&&G.push(n),v[s].sections[e].rows[l].columns[o].fields.splice(a,1)},bl=(s,e,l,o,a)=>{const n=v[s].sections[e].rows[l].columns[o].fields[a],r=te({},n);r.name=`${n.name} Name the field`,v[s].sections[e].rows[l].columns[o].fields.splice(a+1,0,r)},hl=(s,e,l,o,a)=>{const n=ls(v);v.splice(0,v.length,...n);let r=v[s].sections[e].rows[l].columns[o].fields[a].fieldtype;(r!=="Select"||r!=="radio"||r!=="multiselect")&&(v[s].sections[e].rows[l].columns[o].fields[a].options="")};function gl(s){return lt.includes(s==null?void 0:s.trim().toLowerCase())}function yl(s){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(s)||s.includes('"')||s.includes("'")}function wl(s){return s.flatMap(e=>{var l;return[(l=e.label)==null?void 0:l.trim().toLowerCase(),...e.sections.flatMap(o=>{var a;return[(a=o.label)==null?void 0:a.trim().toLowerCase(),...o.rows.flatMap(n=>n.columns.flatMap(r=>{var c;return[(c=r.label)==null?void 0:c.trim().toLowerCase(),...r.fields.map(m=>{var u;return(u=m.label)==null?void 0:u.trim().toLowerCase()})]}))]})]}).filter(e=>e!==""&&!Lt.includes(e))}function ue(s,e,l,o,a){const r=wl(v).filter((u,p,w)=>w.indexOf(u)!==p),c=ls(v);v.splice(0,v.length,...c);function m(u,p){if(!u){p.errorMsg="";return}gl(u)?p.errorMsg="Entered label is restricted":yl(u)?p.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:u.length>64?p.errorMsg="Label should not exceed 64 characters":p.errorMsg=r.includes(u.trim().toLowerCase())?"Duplicate Label Name":""}a!==void 0&&m(v[s].sections[e].rows[l].columns[o].fields[a].label,v[s].sections[e].rows[l].columns[o].fields[a]),a===void 0&&o!==void 0&&m(v[s].sections[e].rows[l].columns[o].label,v[s].sections[e].rows[l].columns[o]),o===void 0&&a===void 0&&m(v[s].sections[e].label,v[s].sections[e]),v.forEach(u=>{u.sections.forEach(p=>{m(p.label,p),p.rows.forEach(w=>{w.columns.forEach(V=>{m(V.label,V),V.fields.forEach(y=>{m(y.label,y)})})})})})}const Ct=se(()=>{function s(e){return!e||typeof e!="object"?!1:"fieldtype"in e&&e.fieldtype===""||"error"in e&&e.error||"errorMsg"in e&&e.errorMsg||["Select","Table MultiSelect"].includes(e.fieldtype)&&(!e.options||e.options.trim()==="")?!0:Array.isArray(e)?e.some(s):Object.values(e).some(s)}return s(v)}),ct=se(()=>Y.value.length>0||K.value.length>0||!f.value.form_category||!f.value.owner_of_the_form||f.value.accessible_departments.length===0),kl=se(()=>v.some(s=>s.sections.some(e=>e.rows.some(l=>l.columns.some(o=>o.fields.some(a=>a.label&&a.fieldtype))))));function jt(s,e){let l=s.target.value.trim();if(!l){e==="form_name"?Y.value="Input cannot be empty or only spaces":e==="form_short_name"&&(K.value="Input cannot be empty or only spaces");return}if(l.length>63){e==="form_name"?Y.value="Name cannot exceed 63 characters":e==="form_short_name"&&(K.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(l)){e==="form_short_name"&&(K.value="First character must be a letter");return}else K.value="";if(e==="form_short_name"&&l.length<2){K.value="Short name must have at least 2 letters";return}if(e==="form_short_name"&&/[^a-zA-Z ]/.test(l)){K.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(l)){e==="form_name"?Y.value="Special characters are not allowed":e==="form_short_name"&&(K.value="Special characters are not allowed");return}else e==="form_name"?Y.value="":e==="form_short_name"&&(K.value="");const o=[[e,"=",`${l}`],["business_unit","=",`${f.value.business_unit}`]],a={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:ce.EzyFormDefinitions};z.get(`${H.GetDoctypeData}`,{params:a}).then(n=>{I.value=n.message.data,e==="form_name"?Y.value=l&&I.value.some(r=>r.form_name&&r.form_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":e==="form_short_name"&&(K.value=l&&I.value.some(r=>r.form_short_name&&r.form_short_name.replace(/\s+/g,"").toLowerCase()===l.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(n=>{console.error("Error fetching ezyForms data:",n),e==="form_name"?Y.value="":e==="form_short_name"&&(K.value="")})}const Cl=s=>s===0?"1st row":s===1?"2nd row":s===2?"3rd row":`${s+1}th row`,pt=b([]),Dl=()=>{v.length&&(pt.value=v,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function Fl(){z.post(H.delete_form_items,{deleted_fields:G.flatMap(Ft),doctype:U}).then(s=>{var e;(e=s==null?void 0:s.message)!=null&&e.success&&kt()})}function Ht(s){return Te(this,null,function*(){if(Ct.value){ae("Please fix the errors before proceeding.");return}Nt.value=!0;let e=G.flatMap(Ft);U!=null&&U!=null&&U!="new"&&e.length?Fl():kt(s)})}const $l=()=>{et.value.push({role:"",autoApproval:!1,permissions:{}})},Sl=s=>{et.value.splice(s,1)},Al=s=>{$t("Permission configuration modal will be implemented here")},Wt=()=>Te(this,null,function*(){var s;if(!(Me.value.length>0))try{const e={doctype:"WF Roadmap",fields:JSON.stringify(["name","roadmap_title","document_type","workflow_levels","property","cluster_name"]),filters:JSON.stringify([])},l=yield z.get(H.GetDoctypeData,{params:e});(s=l==null?void 0:l.message)!=null&&s.data&&(Me.value=l.message.data.map(o=>({roadmap_title:o.name,display_name:`${o.roadmap_title} (${o.document_type})`,document_type:o.document_type,workflow_levels:o.workflow_levels,property:o.property,cluster_name:o.cluster_name})),console.log("Fetched WF Road Maps:",Me.value))}catch(e){console.error("Error fetching WF Road Maps:",e),ae("Failed to fetch workflow road maps")}}),Jt=s=>Te(this,null,function*(){var e;if(s){console.log("Selected WF Road Map:",s);try{const l=yield z.get(`/api/resource/WF Roadmap/${s.roadmap_title}`);if((e=l==null?void 0:l.data)!=null&&e.data){const o=l.data.data;if(console.log("Full Roadmap Data:",o),o.wf_requestors&&o.wf_requestors.length>0&&(v.length===0&&ut(),$t(`Workflow loaded: ${o.wf_requestors.length} requestor(s), ${o.workflow_levels} approval level(s)`)),o.wf_level_setup&&o.wf_level_setup.length>0){const a=o.wf_level_setup,n=1+o.workflow_levels;for(;v.length<n;)ut();W.length=0,W.push({type:"requestor",roles:[]}),a.forEach((r,c)=>{W.push({type:"approver",level:r.level,roles:[r.role],approval_required:r.mandatory?"1":"0",approver_can_edit:"0",view_only_reportee:r.view_only_reportee||0,all_approvals_required:r.all_approvals_required||0,requester_as_a_approver:r.requester_as_a_approver||0,on_rejection:r.on_rejection||"",fields:[]})}),pe(`Loaded workflow: ${o.workflow_levels} approval level(s) configured`)}}}catch(l){console.error("Error loading WF Road Map details:",l),ae("Failed to load workflow configuration")}}}),ql=s=>{console.log("Field added from library:",s);const e=xe.value,l=v[e];if(!l){ae("Please create a block first before adding fields");return}const o=Zt(s);if(!o)return;l.sections||(l.sections=[]),l.sections.length===0&&l.sections.push({label:"",rows:[[{label:"",fields:[]}]]});const r=l.sections[0].rows[0][0];r.fields||(r.fields=[]),r.fields.push(o),console.log("Field added successfully:",o),pe(`${o.label} field added successfully`)},Vl=s=>{console.log("Drag started:",s),ve.value=s},El=()=>{console.log("Drag ended")},Zt=s=>{console.log("Creating field from Frappe type:",s);const e=nt.find(n=>n.type===s);if(!e)return console.error("Field type not found:",s),console.error("Available types:",nt.map(n=>n.type)),ae(`Field type "${s}" not found. Please try again.`),null;const l=Date.now(),o=Math.random().toString(36).substring(2,6),a=`field_${l}_${o}`;return{id:`field_${l}_${o}`,fieldname:a,label:e.label,fieldtype:e.type,options:"",reqd:0,read_only:0,hidden:0,description:"",default:"",placeholder:""}};return(s,e)=>(i(),d("div",null,[t("div",Xl,[t("div",xl,[t("div",Il,[t("div",eo,[t("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:e[0]||(e[0]=l=>ol())},e[43]||(e[43]=[t("button",{class:"btn font-13 ms-3"},[t("i",{class:"bi bi-arrow-left"}),t("span",{class:"ms-2"},"Back")],-1)])),s.$route.query.id||s.$route.query.preId?(i(),d("span",to,"("+h(x.value.formId||S(F).query.form_name)+")",1)):_("",!0)]),t("div",null,[$.value===2&&S(v).length&&!s.$route.query.id?(i(),d("button",{key:0,disabled:Ct.value||ct.value,style:Nl({cursor:Ct.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:e[1]||(e[1]=l=>Ht("Draft"))},e[44]||(e[44]=[t("i",{class:"bi bi-bookmark-check-fill"},null,-1),C(" Save As Draft ")]),12,so)):_("",!0)])]),t("div",lo,[t("div",oo,[t("div",ao,[t("div",no,[t("ul",io,[(i(!0),d(E,null,L(Ws.value,l=>(i(),d("li",{key:l.id,class:N({active:$.value===l.id,completed:$.value>l.id})},[t("div",{class:N(["d-flex gap-3 align-items-center",{"not-allowed":ct.value&&$.value+1===l.id}]),onClick:o=>nl(l.id)},[$.value>l.id?(i(),d("i",uo)):(i(),d("i",{key:1,class:N(l.icon)},null,2)),t("div",co,[t("span",po,h(l.stepno),1),e[45]||(e[45]=t("br",null,null,-1)),t("span",mo,h(l.label),1)])],10,ro)],2))),128))])])]),t("div",fo,[t("div",vo,[t("div",_o,[$.value===1?(i(),d("div",bo,[t("div",ho,[t("div",go,[e[46]||(e[46]=t("div",null,null,-1)),e[47]||(e[47]=t("h1",{class:"font-14 fw-bold m-0"},"Form Info",-1)),t("div",null,[!s.$route.query.id&&!s.$route.query.preId?(i(),d("button",{key:0,class:"btn btn-light font-12 mx-2",type:"button",onClick:al},"Clear Form")):_("",!0),$.value<5?(i(),Xt(xt,{key:1,class:"btn btn-dark bg-dark text-white fw-bold font-13",name:"Next",onClick:it})):_("",!0)])])]),t("div",yo,[t("div",wo,[e[63]||(e[63]=t("div",{class:"col-sm-none col-md-4"},null,-1)),t("div",ko,[t("div",Co,[t("div",Do,[t("div",Fo,[t("div",$o,[S(F).query.preId?(i(),d("span",So,e[48]||(e[48]=[C("Predefined "),t("i",{class:"bi bi-check2-circle"},null,-1)]))):_("",!0),X(Ge,{disabled:(x.value.formId&&x.value.formId.length>0||S(F).query.form_name)&&he.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Untitled Form",onChange:e[2]||(e[2]=l=>jt(l,"form_name")),modelValue:Et.value,"onUpdate:modelValue":e[3]||(e[3]=l=>Et.value=l)},null,8,["disabled","modelValue"]),Y.value?(i(),d("span",Ao,h(Y.value),1)):_("",!0)])]),t("div",qo,[X(Ge,{disabled:(x.value.formId&&x.value.formId.length>0||S(F).query.form_name)&&he.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Untitled Form",onChange:e[4]||(e[4]=l=>jt(l,"form_short_name")),modelValue:f.value.form_short_name,"onUpdate:modelValue":e[5]||(e[5]=l=>f.value.form_short_name=l)},null,8,["disabled","modelValue"]),K.value?(i(),d("span",Vo,h(K.value),1)):_("",!0)]),t("div",Eo,[X(Ge,{disabled:x.value.formId&&x.value.formId.length>0&&he.value!=="1",labeltext:"Form Naming series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Naming series",modelValue:f.value.series,"onUpdate:modelValue":e[6]||(e[6]=l=>f.value.series=l)},null,8,["disabled","modelValue"]),e[49]||(e[49]=It('<small class="text-muted" style="font-size:12px;" data-v-82779025> Note : Enter <code data-v-82779025>YY-YY</code>, <code data-v-82779025>YYYY</code>, or <code data-v-82779025>ABC</code>. The system will default to the format <code data-v-82779025> 24-25-0001</code>, <code data-v-82779025> 2025-0001</code>, or <code data-v-82779025> ABC-0001</code> respectively. </small>',1))]),t("div",Lo,[t("label",null,[e[50]||(e[50]=C("Owner Of The Form ")),f.value.owner_of_the_form?_("",!0):(i(),d("span",To,"*"))]),X(S(ke),{disabled:x.value.formId&&x.value.formId.length>0&&he.value!=="1",onOpen:zt,options:Fe.value,onChange:wt,modelValue:f.value.owner_of_the_form,"onUpdate:modelValue":e[7]||(e[7]=l=>f.value.owner_of_the_form=l),placeholder:"Select Department",multiple:!1,class:"font-11 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"])]),t("div",Uo,[t("label",null,[e[51]||(e[51]=C("Form Category ")),f.value.form_category?_("",!0):(i(),d("span",Ro,"*"))]),X(S(ke),{disabled:x.value.formId&&x.value.formId.length>0&&he.value!=="1",options:re.value,modelValue:f.value.form_category,"onUpdate:modelValue":e[8]||(e[8]=l=>f.value.form_category=l),placeholder:"Select Category",multiple:!1,searchable:!0,class:"font-11 multiselect"},null,8,["disabled","options","modelValue"])]),t("div",Mo,[t("label",null,[e[52]||(e[52]=C("Accessible to Department ")),f.value.accessible_departments.length?_("",!0):(i(),d("span",Oo,"*"))]),X(S(ke),{modelValue:f.value.accessible_departments,"onUpdate:modelValue":e[10]||(e[10]=l=>f.value.accessible_departments=l),options:Js.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Department",class:"font-11",onSelect:Ks,onRemove:Qs,openDirection:"bottom"},{option:es(({option:l})=>[t("div",Bo,[t("input",{type:"checkbox",checked:Gs(l),class:"custom-checkbox",onChange:o=>Ys(l,o),onClick:e[9]||(e[9]=ie(()=>{},["stop"]))},null,40,zo),t("span",null,h(l),1)])]),selection:es(({values:l,isOpen:o})=>[l.length?D((i(),d("span",{key:0,class:"multiselect__single font-10"},h(Zs.value),513)),[[ft,!o]]):_("",!0)]),_:1},8,["modelValue","options"])]),t("div",No,[e[53]||(e[53]=t("label",null,"Form Type",-1)),X(S(ke),{options:qt,modelValue:Vt.value,"onUpdate:modelValue":e[11]||(e[11]=l=>Vt.value=l),placeholder:"Select Form Type",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:l=>l.value,class:"font-11 multiselect",openDirection:"top"},null,8,["modelValue","reduce"]),e[54]||(e[54]=t("small",{class:"text-muted font-12 ms-2"},"Note: Public form is accessible by anyone through QR code.",-1))]),t("div",Po,[e[55]||(e[55]=t("label",null,[C("Has Workflow "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),X(S(ke),{options:["Yes","No"],modelValue:f.value.has_workflow,"onUpdate:modelValue":e[12]||(e[12]=l=>f.value.has_workflow=l),placeholder:"Select",multiple:!1,class:"font-11 multiselect",searchable:!0},null,8,["modelValue"])]),f.value.has_workflow==="Yes"?(i(),d("div",jo,[e[56]||(e[56]=t("label",null,[C("Use Existing Workflow "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),X(S(ke),{onOpen:Wt,options:Me.value,modelValue:Ie.value,"onUpdate:modelValue":e[13]||(e[13]=l=>Ie.value=l),placeholder:"Select WF Road Map",multiple:!1,class:"font-11 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:Jt,openDirection:"bottom"},null,8,["options","modelValue"]),e[57]||(e[57]=t("small",{class:"text-muted font-12 ms-2"},[t("i",{class:"bi bi-info-circle me-1"}),C(" Select to auto-populate requestor and approver configurations ")],-1))])):_("",!0),f.value.as_web_view===1?(i(),d("div",Ho,[e[58]||(e[58]=t("label",null,[C("Form Submit Response "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),X(Ge,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit Response",modelValue:f.value.public_form_response,"onUpdate:modelValue":e[14]||(e[14]=l=>f.value.public_form_response=l)},null,8,["modelValue"])])):_("",!0),f.value.as_web_view===1?(i(),d("div",Wo,[e[59]||(e[59]=t("label",null,[C("Submit Notification Email "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),X(Ge,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit mail",modelValue:f.value.mail_id,"onUpdate:modelValue":e[15]||(e[15]=l=>f.value.mail_id=l)},null,8,["modelValue"]),e[60]||(e[60]=t("small",{class:"text-muted font-12 ms-2"},"Note : If multiple Emails, separate with commas (,).",-1))])):_("",!0),S(F).query.preId?(i(),d("div",Jo,[t("div",Zo,[D(t("input",{class:"form-check-input linketoCheck p-1",disabled:f.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":e[16]||(e[16]=l=>f.value.is_linked=l),"true-value":1,"false-value":0},null,8,Go),[[Ce,f.value.is_linked]]),e[61]||(e[61]=t("label",{class:"form-check-label font-12 mx-2 mb-0 ps-1",for:"is_linked"}," Link ",-1))])])):_("",!0),f.value.is_linked?(i(),d("div",Yo,[e[62]||(e[62]=t("label",{for:"standardFormInput"},"Form",-1)),D(t("input",{type:"text",class:"form-control standardFormInput",id:"standardFormInput",disabled:f.value.is_predefined_doctype==1,"onUpdate:modelValue":e[17]||(e[17]=l=>f.value.is_linked_form=l),placeholder:"Type to search Form Name...",onInput:cs,onFocus:e[18]||(e[18]=l=>Xe.value=!0),onBlur:ms},null,40,Ko),[[M,f.value.is_linked_form]]),Xe.value&&Qe.value.length?(i(),d("ul",Qo,[(i(!0),d(E,null,L(Qe.value,(l,o)=>(i(),d("li",{class:"list-group-item formlistitem",key:o,onMousedown:ie(a=>ps(l.name),["prevent"])},h(l.name),41,Xo))),128))])):_("",!0)])):_("",!0)])])]),e[64]||(e[64]=t("div",{class:"col-sm-none col-md-4"},null,-1))])])])):_("",!0),$.value===2?(i(),d("div",xo,[t("div",Io,[t("div",ea,[t("button",{onClick:e[19]||(e[19]=l=>rt()),class:"btn btn-sm btn-light"},e[65]||(e[65]=[t("i",{class:"bi bi-chevron-left"},null,-1),C(" Back ")]))]),t("div",ta,[(i(!0),d(E,null,L(S(v),(l,o)=>(i(),d("button",{key:o,class:N(["zoho-tab",{active:xe.value===o}]),onClick:a=>xe.value=o},[e[66]||(e[66]=t("i",{class:"bi bi-file-earmark-text me-1"},null,-1)),C(" "+h(o===0?"Requestor Block":`Approver Block ${o}`)+" ",1),S(v).length>1?(i(),d("i",{key:0,class:"bi bi-x-lg ms-2",onClick:ie(a=>Pt(o),["stop"])},null,8,la)):_("",!0)],10,sa))),128))]),t("div",oa,[t("button",{class:"btn btn-sm btn-primary me-2",onClick:ut},e[67]||(e[67]=[t("i",{class:"bi bi-plus-lg me-1"},null,-1),C("Add Block ")])),kl.value?(i(),d("button",{key:0,class:"btn btn-sm btn-light me-2",onClick:Dl},e[68]||(e[68]=[t("i",{class:"bi bi-eye me-1"},null,-1),C("Preview ")]))):_("",!0),S(v).length?(i(),d("button",{key:1,class:"btn btn-sm btn-dark",onClick:e[20]||(e[20]=l=>Ht("save"))},h(S(U)!=="new"?"Update Form":"Create Form"),1)):_("",!0)])]),t("div",aa,[t("aside",{class:N(["zoho-field-library",{collapsed:!Se.value}])},[t("div",{class:"library-header",onClick:e[21]||(e[21]=l=>Se.value=!Se.value)},[t("div",na,[t("h6",ia,[e[69]||(e[69]=t("i",{class:"bi bi-grid-3x3-gap me-2"},null,-1)),C(" "+h(Se.value?"Field Types":"Fields"),1)]),t("button",ra,[t("i",{class:N(Se.value?"bi bi-chevron-left":"bi bi-chevron-right")},null,2)])])]),Se.value?(i(),d("div",da,[X(Ql,{fields:nt,onFieldAdd:ql,onFieldDragstart:Vl,onFieldDragend:El})])):_("",!0)],2),t("div",ua,[t("div",{class:"canvas-inner",ref_key:"mainBlockRef",ref:dt},[(i(!0),d(E,null,L(S(v),(l,o)=>D((i(),d("div",{class:"block-level",key:o},[t("div",ca,[t("div",pa,[t("div",ma,[t("h6",fa,h(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),t("div",va,[o!==0&&B(o).view_only_reportee||B(o).all_approvals_required||B(o).requester_as_a_approver?(i(),d("div",_a,[t("span",ba,h(B(o).view_only_reportee===1?"Reporting Manager only":"")+" "+h(B(o).all_approvals_required===1?"All of the selected approvers":"")+" "+h(B(o).requester_as_a_approver===1?"Approval by Requestor":""),1),t("span",null,[e[70]||(e[70]=t("span",{class:"ms-1"}," on rejection escalating to ",-1)),t("span",ha,h(B(o).on_rejection?`Level ${B(o).on_rejection}`:"Requestor"),1)]),t("span",ga,h(B(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):_("",!0)])]),t("div",ya,[S(U)&&S(W).length?(i(),d("div",wa,[B(o)?(i(),d("label",ka,[t("span",Ca,h(B(o).roles.length>0?o===0?"Requestor: ":"Approver: ":""),1),t("span",Da,h(B(o).roles.slice(0,2).join(", ")),1),B(o).roles.length>2?(i(),d("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:a=>yt(o),class:"more-count"}," +"+h(B(o).roles.length-2)+" more ",9,Fa)):_("",!0)])):_("",!0)])):_("",!0),ds(o)&&S(U)!=null&&S(U)!=null&&S(U)!="new"&&B(o).roles.length===0?(i(),d("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:a=>yt(o)},[e[71]||(e[71]=t("img",{src:Wl,alt:"Add",class:"me-1"},null,-1)),C(" "+h(o===0?"Add Requestors":"Add Approvers"),1)],8,$a)):_("",!0),S(U)!=null&&S(U)!=null&&S(U)!="new"&&B(o).roles.length>0?(i(),d("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:a=>yt(o)},e[72]||(e[72]=[t("i",{class:"bi bi-pencil font-14"},null,-1)]),8,Sa)):_("",!0),t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:a=>Pt(o)},e[73]||(e[73]=[t("i",{class:"bi bi-trash me-1"},null,-1),C(" Delete Block ")]),8,Aa)])])]),t("div",qa,[(i(!0),d(E,null,L(l.sections,(a,n)=>(i(),d("div",{key:"section-"+n,class:"dynamicSection mt-0 section"},[t("section",Va,[t("div",Ea,[D(t("input",{"onUpdate:modelValue":r=>a.label=r,type:"text",class:N(["border-less-input","font-14",{"italic-style":!a.label},{"fw-medium":a.label}]),onChange:r=>ue(o,n),onInput:r=>ue(o,n),placeholder:"Untitled section"},null,42,La),[[M,a.label]]),a.errorMsg?(i(),d("small",Ta,h(a.errorMsg),1)):_("",!0)]),t("div",Ua,[t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:r=>pl(o,n)},e[74]||(e[74]=[t("i",{class:"bi bi-trash me-1"},null,-1),C(" Delete Section ")]),8,Ra)])]),t("div",Ma,[(i(!0),d(E,null,L(a.rows,(r,c)=>(i(),d("section",{class:"row dynamicRow row-container",key:"row-"+c},[t("div",Oa,[t("label",Ba,h(Cl(c)),1),t("div",null,[r.columns.length<3?(i(),d("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:m=>ml(o,n,c)},e[75]||(e[75]=[t("i",{class:"bi bi-plus font-14"},null,-1),C(" Add Column ")]),8,za)):_("",!0)])]),t("div",Na,[t("div",Pa,[(i(!0),d(E,null,L(r.columns,(m,u)=>(i(),d("div",{key:"column-"+u,onMouseenter:p=>ws(o,n,c,u),onMouseleave:ks,class:"col p-0 dynamicColumn position-relative column-container"},[t("div",Ha,[t("div",Wa,[D(t("input",{"onUpdate:modelValue":p=>m.label=p,type:"text",class:N(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!m.label},{"fw-medium":m.label}]),onChange:p=>ue(o,n,c,u),onInput:p=>ue(o,n,c,u),placeholder:"Column Name"},null,42,Ja),[[M,m.label]]),m.errorMsg?(i(),d("small",Za,h(m.errorMsg),1)):_("",!0)]),D(t("div",Ga,[t("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:p=>fl(o,n,c,u)},e[76]||(e[76]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Ya)],512),[[ft,Cs(o,n,c,u)]])]),m.fields.length===0?(i(),d("div",{key:0,class:"empty-drop-zone",onDragover:e[22]||(e[22]=ie(()=>{},["prevent"])),onDrop:p=>_e(p,o,n,c,u,s.fieldIndex)},null,40,Ka)):_("",!0),(i(!0),d(E,null,L(m.fields,(p,w)=>{var V;return i(),d("div",{key:"field-"+w,onMouseenter:y=>hs(o,n,c,u,w),onMouseleave:gs,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:y=>Tt(y,o,n,c,u,w),onDragover:e[26]||(e[26]=ie(()=>{},["prevent"])),onDrop:y=>_e(y,o,n,c,u,w)},[t("div",{class:"drop-zone",onDragover:e[23]||(e[23]=ie(()=>{},["prevent"])),onDrop:y=>_e(y,o,n,c,u,w)},null,40,Xa),p.fieldtype!=="Table"?(i(),d("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:y=>Tt(y,o,n,c,u,w),onDragover:e[24]||(e[24]=ie(()=>{},["prevent"])),onDrop:y=>_e(y,o,n,c,u,w)},[t("div",Ia,[t("div",en,[D(t("input",{"onUpdate:modelValue":y=>p.label=y,placeholder:"Name the field",class:N(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!p.label},{"fw-medium":p.label}]),onChange:y=>ue(o,n,c,u,w),onInput:y=>ue(o,n,c,u,w)},null,42,tn),[[M,p.label]]),p.errorMsg?(i(),d("small",sn,h(p.errorMsg),1)):_("",!0)]),D(t("div",ln,[t("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:y=>bl(o,n,c,u,w)},e[77]||(e[77]=[t("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,on),t("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:y=>{_l(o,n,c,u,w),ue(o,n,c,u)}},e[78]||(e[78]=[t("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,an)],512),[[ft,ys(o,n,c,u,w)]])]),D(t("select",{"onUpdate:modelValue":y=>p.fieldtype=y,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:y=>hl(o,n,c,u,w)},[e[79]||(e[79]=t("option",{value:""},"Select Type",-1)),(i(),d(E,null,L(nt,y=>t("option",{key:y,value:y.type},h(y.label),9,rn)),64))],40,nn),[[Ue,p.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(p.fieldtype)?(i(),d("div",dn,[e[80]||(e[80]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":y=>p.options=y,class:"form-control shadow-none mb-1 font-12"},null,8,un),[[M,p.options]]),!p.options||p.options.trim()===""?(i(),d("small",cn," Options are required for this field type. ")):_("",!0)])):_("",!0),p.fieldtype==="Link"?(i(),d("div",pn,[t("label",{class:"font-11 fw-light",for:"link-search-"+me(o,n,c,u,w)}," Search Doctype: ",8,mn),D(t("input",{id:"link-search-"+me(o,n,c,u,w),type:"text","onUpdate:modelValue":y=>S(v)[o].sections[n].rows[c].columns[u].fields[w].options=y,onInput:y=>vs(S(v)[o].sections[n].rows[c].columns[u].fields[w].options,o,n,c,u,w),onFocus:y=>fs(me(o,n,c,u,w)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,fn),[[M,S(v)[o].sections[n].rows[c].columns[u].fields[w].options]]),(V=Be[me(o,n,c,u,w)])!=null&&V.length&&_t[me(o,n,c,u,w)]?(i(),d("ul",vn,[(i(!0),d(E,null,L(Be[me(o,n,c,u,w)],(y,g)=>(i(),d("li",{key:g,onClick:k=>_s(o,n,c,u,w,y.name),class:"list-group-item list-group-item-action"},h(y.name),9,_n))),128))])):_("",!0)])):_("",!0),t("div",bn,[t("div",hn,[t("div",gn,[D(t("input",{class:"font-12","onUpdate:modelValue":y=>p.reqd=y,"true-value":1,id:"mandatory-"+o+"-"+n+"-"+c+"-"+u+"-"+w,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,yn),[[Ce,p.reqd]])]),t("div",null,[t("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+n+"-"+c+"-"+u+"-"+w},"Mandatory",8,wn)])]),t("div",null,[t("button",{class:"btn btn-sm font-12",onClick:y=>p.showDescription=!p.showDescription},h(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,kn)])]),p.showDescription?D((i(),d("textarea",{key:2,"onUpdate:modelValue":y=>p.description=y,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,Cn)),[[M,p.description]]):_("",!0),p.error?(i(),d("small",Dn,h(p.error),1)):_("",!0)],40,xa)):_("",!0),t("div",{class:"drop-zone",onDragover:e[25]||(e[25]=ie(()=>{},["prevent"])),onDrop:y=>_e(y,o,n,c,u,w)},null,40,Fn),t("div",$n,[t("div",null,[t("div",null,[t("div",Sn,[p.fieldtype==="Table"?(i(),d("div",An,[(i(!0),d(E,null,L(ee.value,(y,g)=>(i(),d("div",{key:g,class:"childTable"},[g===p.fieldname||g===p.options?(i(),d("h5",qn,h(g.replace(/_/g," ")),1)):_("",!0),P[g]&&g===Mt.value?(i(),d("div",Vn,[t("div",En,[p.showDescription?D((i(),d("input",{key:0,"onUpdate:modelValue":k=>p.description=k,class:"form-control font-12",placeholder:"Enter field description"},null,8,Ln)),[[M,p.description]]):_("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:k=>p.showDescription=!p.showDescription},h(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,Tn)])])):_("",!0),g===p.options||g===p.fieldname?(i(),d("table",Un,[e[84]||(e[84]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Label"),t("th",null,"Field Type")])],-1)),t("tbody",{onDragover:ie($s,["prevent"]),onDrop:k=>Ss(k,y)},[(i(!0),d(E,null,L(y,(k,Z)=>{var Pe,je,He,We,Je,Ze,Q;return i(),d("tr",{key:Z,draggable:P[g],onDragstart:j=>Ds(Z),onDragend:Fs,class:N({dragging:ge.value===Z})},[t("td",null,h(Z+1),1),P[g]?(i(),d("td",On,[D(t("input",{"onUpdate:modelValue":j=>k.label=j,onInput:j=>at(k,g,Z),placeholder:"Field Label",class:N(["form-control",{"border-1 border-danger":(je=(Pe=A[g])==null?void 0:Pe[Z])==null?void 0:je.length}])},null,42,Bn),[[M,k.label]]),(We=(He=A[g])==null?void 0:He[Z])!=null&&We.length?(i(),d("div",zn,[(i(!0),d(E,null,L(A[g][Z],(j,Ll)=>(i(),d("div",{key:Ll},h(j),1))),128))])):_("",!0)])):(i(),d("td",Nn,h(k.label),1)),P[g]?(i(),d("td",Pn,[t("div",jn,[D(t("select",{"onUpdate:modelValue":j=>k.fieldtype=j,onChange:j=>at(k,g,Z),class:N(["form-select form-select-sm",{"border-1 border-danger":(Ze=(Je=A[g])==null?void 0:Je[Z])==null?void 0:Ze.length}])},[e[81]||(e[81]=t("option",{value:""},"Select Type",-1)),(i(),d(E,null,L(ht,j=>t("option",{key:j.type,value:j.type},h(j.label),9,Wn)),64))],42,Hn),[[Ue,k.fieldtype]]),t("div",Jn,[t("div",Zn,[t("div",Gn,[D(t("input",{class:"font-12 form-control-sm","onUpdate:modelValue":j=>k.description=j,placeholder:"description",type:"text"},null,8,Yn),[[M,k.description]])])]),t("button",{class:"btn btn-light btn-sm",onClick:j=>js(g,Z)},e[82]||(e[82]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Kn)])]),["Select"].includes(k.fieldtype)?(i(),d("div",Qn,[e[83]||(e[83]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":j=>k.options=j,onInput:j=>at(k,g,Z),class:"form-control shadow-none mb-1 font-12"},null,40,Xn),[[M,k.options]]),!k.options||k.options.trim()===""?(i(),d("small",xn," Options are required for this field type. ")):_("",!0)])):_("",!0),(Q=J[g])!=null&&Q.includes(Z)?(i(),d("span",In,"Type required**")):_("",!0)])):(i(),d("td",ei,h(k.fieldtype),1))],42,Mn)}),128))],40,Rn)])):_("",!0),p.fieldtype==="Table"&&(p.label===g||p.fieldname===g)?(i(),d("div",ti,[t("button",{class:"btn btn-light btn-sm mx-2",onClick:k=>Hs(g,p.description)},h(P[g]?"Save":"Edit"),9,si),P[g]?(i(),d("button",{key:0,class:"btn btn-light btn-sm",onClick:k=>Ps(g)}," Add More Field ",8,li)):_("",!0)])):_("",!0)]))),128))])):_("",!0)])])])])],40,Qa)}),128)),t("div",{class:"drop-zone-bottom",onDragover:e[27]||(e[27]=ie(()=>{},["prevent"])),onDrop:p=>_e(p,o,n,c,u,m.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,oi),t("div",{class:"drop-zone",onDragover:e[28]||(e[28]=ie(()=>{},["prevent"])),onDrop:p=>_e(p,o,n,c,u,s.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,ai),t("div",ni,[t("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:p=>vl(o,n,c,u)},e[85]||(e[85]=[t("i",{class:"bi bi-plus fs-5"},null,-1),t("span",null,"Add Field",-1)]),8,ii)])],40,ja))),128))])])]))),128)),t("div",null,[(i(!0),d(E,null,L(a.afterCreated,(r,c)=>(i(),d("div",{key:c,class:"childTable dynamicColumn m-0 p-2"},[t("h5",ri,h(r.tableName),1),P[r.tableName]?(i(),d("div",di,[t("div",ui,[r.showDescription?D((i(),d("input",{key:0,"onUpdate:modelValue":m=>r.description=m,class:"form-control font-12",placeholder:"Enter field description"},null,8,ci)),[[M,r.description]]):_("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:m=>r.showDescription=!r.showDescription},h(r.showDescription?"Hide Description":r.description?"Edit Description":"Add Description"),9,pi)])])):_("",!0),t("table",mi,[e[91]||(e[91]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Label"),t("th",null,"Field Type")])],-1)),t("tbody",null,[(i(!0),d(E,null,L(r.columns,(m,u)=>{var p,w,V,y;return i(),d("tr",{key:u},[t("td",null,h(u+1),1),P[r.tableName]?(i(),d("td",fi,[D(t("input",{"onUpdate:modelValue":g=>m.label=g,placeholder:"Field Label",class:N(["form-control",{"border-1 border-danger":(p=J[r.tableName])==null?void 0:p.includes(u)}]),onBlur:g=>{var k;m.label=(k=m.label)==null?void 0:k.trim(),ze(m,r.tableName,u,r.columns)}},null,42,vi),[[M,m.label]]),(w=A[r.tableName])!=null&&w[u]?(i(),d("div",_i,[(i(!0),d(E,null,L(A[r.tableName][u],(g,k)=>(i(),d("span",{key:k},[C(h(g)+" ",1),e[86]||(e[86]=t("br",null,null,-1))]))),128))])):_("",!0)])):(i(),d("td",bi,h(m.label),1)),P[r.tableName]?(i(),d("td",hi,[t("div",gi,[D(t("select",{"onUpdate:modelValue":g=>m.fieldtype=g,class:N(["form-select form-select-sm",{"border-1 border-danger":(V=J[r.tableName])==null?void 0:V.includes(u)}]),onChange:g=>ze(m,r.tableName,u,r.columns)},[e[87]||(e[87]=t("option",{value:""},"Select Type",-1)),(i(),d(E,null,L(ht,g=>t("option",{key:g.type,value:g.type},h(g.label),9,wi)),64))],42,yi),[[Ue,m.fieldtype]]),t("button",{class:"btn btn-light btn-sm",onClick:g=>zs(o,n,r.tableName,u)},e[88]||(e[88]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,ki)]),m.fieldtype==="Select"?(i(),d("div",Ci,[e[89]||(e[89]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":g=>m.options=g,class:"form-control shadow-none mb-1 font-12",onInput:g=>ze(m,r.tableName,u,r.columns)},null,40,Di),[[M,m.options]])])):_("",!0),(y=A[r.tableName])!=null&&y[u]?(i(),d("div",Fi,[(i(!0),d(E,null,L(A[r.tableName][u],(g,k)=>(i(),d("span",{key:k},[C(h(g),1),e[90]||(e[90]=t("br",null,null,-1))]))),128))])):_("",!0)])):(i(),d("td",$i,h(m.fieldtype),1))])}),128))])]),t("div",Si,[t("button",{class:"btn btn-light btn-sm mx-2",onClick:m=>Ns(o,n,r.tableName)},h(P[r.tableName]?"Save":"Edit"),9,Ai),P[r.tableName]?(i(),d("button",{key:0,class:"btn btn-light btn-sm",onClick:m=>Bs(o,n,r.tableName)}," Add More Field ",8,qi)):_("",!0)])]))),128))])]),t("div",null,[t("div",null,[o==0?(i(),d("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:r=>qs(o,n)}," Add New Table ",8,Vi)):_("",!0),(i(!0),d(E,null,L(a.childTables,(r,c)=>{var m;return i(),d("div",{key:`table-${o}-${n}-${c}`,class:"child-table"},[r.newTable?(i(),d("div",Ei,[t("div",Li,[t("div",null,[t("span",{class:N(r.tableName?"d-none":"text-danger")},"*",2),D(t("input",{"onUpdate:modelValue":u=>r.tableName=u,placeholder:"Table Name",onBlur:u=>Ut(r),class:N(["border-less-input font-14 p-0 inputHeight",{"italic-style":!r.tableName,"fw-medium":r.tableName}])},null,42,Ti),[[M,r.tableName]]),(m=A[`${o}-${n}-${c}`])!=null&&m.tableName?(i(),d("div",Ui,h(A[`${o}-${n}-${c}`].tableName),1)):_("",!0),Le.value?(i(),d("div",Ri,h(Le.value),1)):_("",!0),t("div",Mi,[t("div",Oi,[r.showDescription?D((i(),d("input",{key:0,"onUpdate:modelValue":u=>r.as_a_block=u,class:"form-control font-12",placeholder:"Enter field description"},null,8,Bi)),[[M,r.as_a_block]]):_("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:u=>r.showDescription=!r.showDescription},h(r.showDescription?"Hide Description":r.description?"Edit Description":"Add Description"),9,zi)])])]),t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:u=>Es(o,n,c)},e[92]||(e[92]=[t("i",{class:"bi bi-trash"},null,-1),C(" Remove Table ")]),8,Ni)]),(i(!0),d(E,null,L(r.columns,(u,p)=>{var w,V,y,g,k,Z,Pe,je,He,We,Je,Ze;return i(),d("div",{key:p,class:"dynamicField"},[t("div",Pi,[t("div",ji,[t("div",null,[t("span",{class:N(u.label?"d-none":"text-danger")},"*",2),D(t("input",{"onUpdate:modelValue":Q=>u.label=Q,placeholder:"Name the field",onBlur:()=>{Ut(u),Ts(u,o,n,c,p,r.columns)},class:N(["border-less-input font-14 p-0 inputHeight",{"italic-style":!u.label,"fw-medium":u.label,"is-invalid":(y=(V=(w=A[`${o}-${n}-${c}`])==null?void 0:w.columns)==null?void 0:V[p])==null?void 0:y.label}])},null,42,Hi),[[M,u.label]]),(Z=(k=(g=A[`${o}-${n}-${c}`])==null?void 0:g.columns)==null?void 0:k[p])!=null&&Z.label?(i(),d("div",Wi,h(A[`${o}-${n}-${c}`].columns[p].label),1)):_("",!0)]),t("div",Ji,[t("div",Zi,[u.showDescription?D((i(),d("input",{key:0,"onUpdate:modelValue":Q=>u.description=Q,class:"form-control font-12",placeholder:"Enter field description"},null,8,Gi)),[[M,u.description]]):_("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:Q=>u.showDescription=!u.showDescription},h(u.showDescription?"Hide Description":u.description?"Edit Description":"Add Description"),9,Yi)]),t("button",{class:"btn btn-sm trash-btn py-0",onClick:Q=>Ls(o,n,c,p)},e[93]||(e[93]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Ki)])]),D(t("select",{"onUpdate:modelValue":Q=>u.fieldtype=Q,class:N(["form-select font-13 mb-1",{"is-invalid":(He=(je=(Pe=A[`${o}-${n}-${c}`])==null?void 0:Pe.columns)==null?void 0:je[p])==null?void 0:He.fieldtype}])},[e[94]||(e[94]=t("option",{value:""},"Select Type",-1)),(i(),d(E,null,L(ht,Q=>t("option",{key:Q.type,value:Q.type},h(Q.label),9,Xi)),64))],10,Qi),[[Ue,u.fieldtype]]),["Select"].includes(u.fieldtype)?(i(),d("div",xi,[e[95]||(e[95]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),D(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":Q=>u.options=Q,class:"form-control shadow-none mb-1 font-12"},null,8,Ii),[[M,u.options]]),!u.options||u.options.trim()===""?(i(),d("small",er," Options are required for this field type. ")):_("",!0)])):_("",!0),(Ze=(Je=(We=A[`${o}-${n}-${c}`])==null?void 0:We.columns)==null?void 0:Je[p])!=null&&Ze.fieldtype?(i(),d("div",tr,h(A[`${o}-${n}-${c}`].columns[p].fieldtype),1)):_("",!0)])])}),128)),t("button",{class:"btn btn-light btn-sm addField mx-1",onClick:u=>Vs(o,n,c)},e[96]||(e[96]=[t("i",{class:"bi bi-plus"},null,-1),C(" Add Field ")]),8,sr),t("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:u=>Os(o,n,c)}," Create Table ",8,lr),e[97]||(e[97]=t("hr",null,null,-1))])):_("",!0)])}),128))])]),t("div",or,[t("button",{class:"btn btn-light border font-12",onClick:r=>cl(o,n)},e[98]||(e[98]=[t("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),C(" Add Section ")]),8,ar)])]))),128)),o===0?(i(),d("div",nr)):_("",!0)])])),[[ft,o===xe.value]])),128))],512)]),At.value?(i(),d("aside",ir,[t("div",rr,[e[100]||(e[100]=t("h6",{class:"mb-0"},"Field Properties",-1)),t("button",{class:"btn btn-sm btn-link p-0",onClick:e[29]||(e[29]=l=>At.value=null)},e[99]||(e[99]=[t("i",{class:"bi bi-x-lg"},null,-1)]))]),e[101]||(e[101]=t("div",{class:"properties-content"},[t("p",{class:"text-muted small"},"Select a field to edit its properties")],-1))])):_("",!0)])])):_("",!0),$.value===3?(i(),d("div",dr,[t("div",ur,[t("button",{onClick:e[30]||(e[30]=l=>rt()),class:"btn btn-sm btn-light"},e[102]||(e[102]=[t("i",{class:"bi bi-chevron-left"},null,-1),C(" Back ")])),e[104]||(e[104]=t("h1",{class:"font-14 fw-bold m-0"},"Requestor Block",-1)),t("button",{class:"btn btn-sm btn-dark",onClick:it},e[103]||(e[103]=[C(" Next "),t("i",{class:"bi bi-chevron-right"},null,-1)]))]),t("div",cr,[t("div",pr,[e[110]||(e[110]=t("div",{class:"card-header bg-light"},[t("h6",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-diagram-3 me-2"}),C("Workflow Configuration")])],-1)),t("div",mr,[t("div",fr,[t("div",vr,[e[107]||(e[107]=t("label",{class:"form-label fw-bold"},"Workflow Type",-1)),t("div",_r,[D(t("input",{type:"radio",class:"btn-check",name:"workflowType",id:"existingWorkflow",value:"existing","onUpdate:modelValue":e[31]||(e[31]=l=>Ae.value=l)},null,512),[[ts,Ae.value]]),e[105]||(e[105]=t("label",{class:"btn btn-outline-primary",for:"existingWorkflow"},[t("i",{class:"bi bi-folder me-1"}),C("Use Existing ")],-1)),D(t("input",{type:"radio",class:"btn-check",name:"workflowType",id:"newWorkflow",value:"new","onUpdate:modelValue":e[32]||(e[32]=l=>Ae.value=l),checked:""},null,512),[[ts,Ae.value]]),e[106]||(e[106]=t("label",{class:"btn btn-outline-primary",for:"newWorkflow"},[t("i",{class:"bi bi-plus-circle me-1"}),C("Create New ")],-1))])]),Ae.value==="existing"?(i(),d("div",br,[e[108]||(e[108]=t("label",{class:"form-label fw-bold"},"Select Workflow",-1)),X(S(ke),{onOpen:Wt,options:Me.value,modelValue:Ie.value,"onUpdate:modelValue":e[33]||(e[33]=l=>Ie.value=l),placeholder:"Select WF Road Map",multiple:!1,class:"font-11 multiselect",searchable:!0,label:"display_name","track-by":"roadmap_title",onSelect:Jt,openDirection:"bottom"},null,8,["options","modelValue"]),e[109]||(e[109]=t("small",{class:"text-muted font-12 ms-2"},[t("i",{class:"bi bi-info-circle me-1"}),C(" Auto-populates requestors and approvers ")],-1))])):_("",!0)])])]),Ae.value==="new"?(i(),d("div",hr,[e[117]||(e[117]=t("div",{class:"card-header bg-light"},[t("h6",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-person-plus me-2"}),C("Add Requestors")])],-1)),t("div",gr,[e[116]||(e[116]=t("div",{class:"alert alert-info mb-3"},[t("i",{class:"bi bi-info-circle me-2"}),t("strong",null,"Requestor Configuration:"),C(" Define who can submit requests for this form. ")],-1)),t("button",{class:"btn btn-primary btn-sm",onClick:$l},e[111]||(e[111]=[t("i",{class:"bi bi-plus-lg me-1"},null,-1),C("Add Requestor Role ")])),et.value.length>0?(i(),d("div",yr,[t("div",wr,[t("table",kr,[e[115]||(e[115]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{width:"40%"},"Role"),t("th",{width:"30%"},"Auto Approval"),t("th",{width:"20%"},"Permissions"),t("th",{width:"10%"},"Action")])],-1)),t("tbody",null,[(i(!0),d(E,null,L(et.value,(l,o)=>(i(),d("tr",{key:o},[t("td",null,[D(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":a=>l.role=a,placeholder:"Enter role name"},null,8,Cr),[[M,l.role]])]),t("td",null,[t("div",Dr,[D(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":a=>l.autoApproval=a},null,8,Fr),[[Ce,l.autoApproval]]),e[112]||(e[112]=t("label",{class:"form-check-label font-12"},"Enable",-1))])]),t("td",null,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:a=>Al()},e[113]||(e[113]=[t("i",{class:"bi bi-gear"},null,-1),C(" Configure ")]),8,$r)]),t("td",null,[t("button",{class:"btn btn-sm btn-danger",onClick:a=>Sl(o)},e[114]||(e[114]=[t("i",{class:"bi bi-trash"},null,-1)]),8,Sr)])]))),128))])])])])):_("",!0)])])):_("",!0),e[118]||(e[118]=It('<div class="card mt-4" data-v-82779025><div class="card-header bg-light" data-v-82779025><h6 class="mb-0 fw-bold" data-v-82779025><i class="bi bi-shield-check me-2" data-v-82779025></i>System Generated Fields</h6></div><div class="card-body" data-v-82779025><div class="alert alert-secondary mb-3" data-v-82779025><i class="bi bi-info-circle me-2" data-v-82779025></i> These fields are automatically included for all requestors. </div><div class="row g-3" data-v-82779025><div class="col-md-6" data-v-82779025><div class="field-preview-card" data-v-82779025><label class="form-label fw-bold" data-v-82779025>Requestor Name</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-82779025></div></div><div class="col-md-6" data-v-82779025><div class="field-preview-card" data-v-82779025><label class="form-label fw-bold" data-v-82779025>Requestor Email</label><input type="email" class="form-control" value="Auto-populated from user profile" disabled data-v-82779025></div></div><div class="col-md-6" data-v-82779025><div class="field-preview-card" data-v-82779025><label class="form-label fw-bold" data-v-82779025>Request Date</label><input type="text" class="form-control" value="Auto-populated on submission" disabled data-v-82779025></div></div><div class="col-md-6" data-v-82779025><div class="field-preview-card" data-v-82779025><label class="form-label fw-bold" data-v-82779025>Department</label><input type="text" class="form-control" value="Auto-populated from user profile" disabled data-v-82779025></div></div></div></div></div>',1))])])):_("",!0),$.value===4?(i(),d("div",Ar,[t("div",qr,[t("button",{onClick:e[34]||(e[34]=l=>rt()),class:"btn btn-sm btn-light"},e[119]||(e[119]=[t("i",{class:"bi bi-chevron-left"},null,-1),C(" Back ")])),e[121]||(e[121]=t("h1",{class:"font-14 fw-bold m-0"},"Approver Blocks",-1)),t("button",{class:"btn btn-sm btn-dark",onClick:it},e[120]||(e[120]=[C(" Next "),t("i",{class:"bi bi-chevron-right"},null,-1)]))]),t("div",Vr,[e[125]||(e[125]=t("div",{class:"alert alert-info"},[t("i",{class:"bi bi-info-circle me-2"}),t("strong",null,"Approval Workflow:"),C(" Configure multi-level approval process for this form. ")],-1)),t("button",{class:"btn btn-primary mb-3",onClick:ut},e[122]||(e[122]=[t("i",{class:"bi bi-plus-lg me-1"},null,-1),C("Add Approval Level ")])),S(v).length>1?(i(),d("div",Er,[t("div",Lr,[t("strong",null,h(S(v).length-1),1),e[123]||(e[123]=C(" approval level(s) configured "))])])):(i(),d("div",Tr,e[124]||(e[124]=[t("div",{class:"alert alert-warning"},[t("i",{class:"bi bi-exclamation-triangle me-2"}),C(' No approval levels configured yet. Click "Add Approval Level" to create one. ')],-1)])))])])):_("",!0),$.value===5?(i(),d("div",Ur,[e[126]||(e[126]=t("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[t("div",null,[t("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),t("div")],-1)),X(ss,{blockArr:pt.value},null,8,["blockArr"])])):_("",!0)])])])])])])]),t("div",Rr,[t("div",Mr,[t("div",Or,[e[130]||(e[130]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Br,[e[128]||(e[128]=t("label",{for:""},"Form Name",-1)),D(t("input",{"onUpdate:modelValue":e[35]||(e[35]=l=>st.value=l),multiple:!1,placeholder:S(F).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,zr),[[M,st.value]]),t("div",Nr,[t("div",Pr,[D(t("input",{class:"font-12","onUpdate:modelValue":e[36]||(e[36]=l=>Ve.value=l),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[Ce,Ve.value]])]),e[127]||(e[127]=t("div",null,[t("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),t("div",{class:"modal-footer"},[e[129]||(e[129]=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),t("button",{type:"button",class:"btn btn-dark",onClick:rl},"Add Print Format")])])])]),t("div",jr,[t("div",Hr,[t("div",Wr,[e[131]||(e[131]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"formViewModalLabel"},"Form Preview"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Jr,[X(ss,{blockArr:pt.value},null,8,["blockArr"])]),e[132]||(e[132]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])]),t("div",Zr,[t("div",Gr,[t("span",Yr,h(O.value==0?"Add designation for Requestors":`Approval Settings For
          Level-${O.value}`),1),e[133]||(e[133]=t("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),t("div",Kr,[t("div",Qr,[t("div",Xr,[O.value!==0?(i(),d("div",xr,[O.value!==0?(i(),d("div",Ir,[e[135]||(e[135]=t("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),D(t("select",{"onUpdate:modelValue":e[37]||(e[37]=l=>de.value=l),class:"form-select shadow-none font-12"},e[134]||(e[134]=[t("option",{value:""},"Any one of the selected approvers",-1),t("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),t("option",{value:"all_approvals_required"},"All of the selected approvers",-1),t("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[Ue,de.value]])])):_("",!0)])):_("",!0)])]),t("div",ed,[t("div",td,[t("span",sd," Select "+h(O.value===0?"Requestors":"Approvers"),1),t("span",ld,h(T.value.length)+" Selected ",1)]),ne.value.length?(i(),d("div",od,[t("div",ad,[t("div",nd,[t("input",{type:"checkbox",id:"selectAll",checked:Xs.value,onChange:xs,class:"form-check-input me-2 designationCheckBox"},null,40,id),t("label",rd," Select all designation ("+h(Ne.value.length)+") ",1)]),O.value!==0?(i(),d("div",dd,[D(t("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":e[38]||(e[38]=l=>Ee.value=l),class:"form-check-input me-2 designationCheckBox"},null,512),[[Ce,Ee.value]]),e[136]||(e[136]=t("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):_("",!0),t("div",null,[T.value.length?(i(),d("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:Is},e[137]||(e[137]=[t("i",{class:"bi bi-x"},null,-1),C(" Clear all ")]))):_("",!0)])]),ne.value.length?(i(),Xt(S(Pl),{key:0,multiple:!0,modelValue:T.value,"onUpdate:modelValue":e[39]||(e[39]=l=>T.value=l),options:Ne.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):_("",!0)],512)):(i(),d("div",ud,e[138]||(e[138]=[t("div",{class:"d-flex justify-content-center"},[t("span",null,"No Designations Found")],-1)])))]),O.value!==0?(i(),d("div",cd,[e[139]||(e[139]=t("div",null,[t("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),D(t("select",{"onUpdate:modelValue":e[40]||(e[40]=l=>$e.value=l),class:"form-select shadow-none font-12 mt-1 me-2"},[(i(!0),d(E,null,L(bs.value,l=>(i(),d("option",{key:l,value:l},h(l===0?"Requestor":"Approver Level "+l),9,pd))),128))],512),[[Ue,$e.value,void 0,{number:!0}]])])):_("",!0),O.value!==0?(i(),d("div",md,[t("div",fd,[t("div",vd,[D(t("input",{"onUpdate:modelValue":e[41]||(e[41]=l=>Ye.value=l),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Ce,Ye.value]]),e[140]||(e[140]=t("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),vt.value===!0?(i(),d("div",_d,[D(t("input",{"onUpdate:modelValue":e[42]||(e[42]=l=>Ke.value=l),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Ce,Ke.value]]),e[141]||(e[141]=t("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):_("",!0)])])):_("",!0)]),t("div",bd,[t("div",hd,[t("div",null,[X(xt,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:el,name:O.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},kd=os(gd,[["__scopeId","data-v-82779025"]]);export{kd as default};
