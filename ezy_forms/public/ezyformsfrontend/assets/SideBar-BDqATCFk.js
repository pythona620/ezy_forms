var Ie=Object.defineProperty,Fe=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var qe=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable;var ge=(v,i,c)=>i in v?Ie(v,i,{enumerable:!0,configurable:!0,writable:!0,value:c}):v[i]=c,ve=(v,i)=>{for(var c in i||(i={}))qe.call(i,c)&&ge(v,c,i[c]);if(pe)for(var c of pe(i))Pe.call(i,c)&&ge(v,c,i[c]);return v},he=(v,i)=>Fe(v,Le(i));import{q as me,u as fe,r as ye,o as n,c as r,b as e,z as q,A,a as x,v as P,y as T,j as U,t as f,I as ke,d as l,E as te,e as b,f as Se,l as K,m as X,p as se,w as Ce,X as Ue,B as ue,F as de,h as $,s as _e,Y as be,k as N,K as Y}from"./index-DXneRfP_.js";const Te="/assets/ezy_forms/ezyformsfrontend/assets/Image-DGmvfUlV.svg",Oe={class:"tabs-div"},Ve={class:"tab-list m-0 p-0"},ze={__name:"TabsComp",props:{tabs:{type:Array,required:!0}},emits:["activeTabValue"],setup(v,{emit:i}){const c=i,u=fe();function R(d){c("activeTabValue",d)}function D(d){return d.name==="Forms"?u.path.startsWith("/forms/department/"):u.path.startsWith(d.route)}return(d,O)=>{const E=ye("router-link");return n(),r("div",Oe,[e("ul",Ve,[(n(!0),r(q,null,A(v.tabs,(y,k)=>(n(),r("li",{key:k,class:"tab-item"},[x(E,{to:y.route,class:T(["tab-link",D(y)?"active-link":""]),onClick:V=>R(y.name)},{default:P(()=>[e("i",{class:T(y.icon)},null,2),U(" "+f(y.name),1)]),_:2},1032,["to","class","onClick"])]))),128))])])}}},Be=me(ze,[["__scopeId","data-v-8f7a87f4"]]),Ae={class:"position-sticky top-0 stickyheader"},Me={class:"container-fluid p-0"},Ge={class:"headerbackgound py-1"},je={class:"row"},Je={class:"col-7"},We={class:"mt-2 ms-2"},He={class:"col-3 d-flex justify-content-end align-items-center pe-1"},Ye={class:"d-flex gap-3 justify-content-end align-items-center m-0 me-2"},Ke={class:""},Xe={class:""},Qe={class:"logooutbtn m-0"},Ze={class:"btn-group dropdown navbar-nav ms-auto"},et={class:"dropdown-menu dropdown-menu-start p-2"},tt={class:"d-flex gap-2 align-items-center"},st={key:0},at={class:"d-flex justify-content-center align-items-center btn btn-dark"},ot={key:0,class:""},nt={class:"fw-medium font-13"},lt={key:1,class:""},rt={class:"fw-medium font-11"},it={class:"mt-2"},ct={class:"d-flex justify-content-center align-items-center"},ut={class:"mt-2"},dt={class:"d-flex justify-content-center align-items-center"},mt={class:"modal fade",id:"riaseRequestModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"riaseRequestModalLabel","aria-hidden":"true"},ft={class:"modal-dialog modal-dialog-centered modal-md"},pt={class:"modal-content"},gt={class:"modal-header"},vt={class:"modal-body"},ht={class:"mb-2"},_t={class:"mb-2"},bt={class:"modal fade",id:"changePassword","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"changePasswordLabel","aria-hidden":"true"},yt={class:"modal-dialog modal-dialog-centered modal-sm"},kt={class:"modal-content"},St={class:"modal-body"},Ct={class:"mb-2"},wt={class:"mb-2"},xt={key:0,class:"text-danger font-10 m-0 ps-2"},$t={class:"d-flex justify-content-center align-items-center p-3"},Rt={__name:"HeaderComp",props:["id"],setup(v){const i=ke(),c=l([{name:"Dashboard",icon:"bi bi-columns-gap",route:"/dashboard"},{name:"Forms",icon:"bi bi-file-earmark-text",route:"/forms"},{name:"To do",icon:"fa-solid fa-list-check",route:"/todo"},{name:"Settings",icon:"bi bi-gear",route:"/settings"},{name:"Archive",icon:"bi bi-archive",route:"/archived"}]),u=l({SelectedDepartment:"",selectedCategory:"",selectedform:""});l(!1);const R=fe();l([]);const D=l([]),d=l(te.value),O=l(""),E=l(""),y=l(""),k=l(""),V=l(""),I=l(""),M=l(""),ae=l([]),G=l([]),w=l([]),z=l([]),B=l([]),j=l(""),oe=l({limit_start:0,limitPageLength:100}),ne=b(()=>I.value.toLowerCase().includes("it")?c.value:c.value.filter(a=>a.name!=="Form Creation"));function J(){K.post(X.logout).then(a=>{console.log(a.data),localStorage.removeItem("UserName"),localStorage.removeItem("employeeData"),localStorage.removeItem("Bu"),localStorage.removeItem("USERROLE"),sessionStorage.removeItem("UserName"),sessionStorage.removeItem("employeeData"),sessionStorage.removeItem("Bu"),sessionStorage.removeItem("USERROLE"),i.push({path:"/"}).then(()=>{})})}function ce(){u.value.selectedCategory="",u.value.selectedform="",ae.value=[]}Se(()=>{p(),j.value=R.path;const a=JSON.parse(localStorage.getItem("employeeData")),t=JSON.parse(localStorage.getItem("UserName"));t?(y.value=t.full_name,t.full_name==="Administrator"?(M.value=t.full_name,O.value=t.full_name.charAt(0).toUpperCase()):a&&(M.value=t.full_name,O.value=a.emp_name.charAt(0).toUpperCase()||a.full_name.charAt(0).toUpperCase(),V.value=a.name,I.value=a.designation||"")):console.warn("No user data found in localStorage.")});const Q=b(()=>E.value&&k.value&&E.value!==k.value);function S(){if(Q.value){console.error("Passwords do not match.");return}const a=JSON.parse(localStorage.getItem("employeeData")),t={new_password:E.value};K.put(`${X.resource}${se.users}/${a.name}`,t).then(o=>{N.success("Password changed Successfully",{autoClose:300}),bootstrap.Modal.getInstance(document.getElementById("changePassword")).hide()}).catch(o=>{console.error("Error:",o)})}const p=()=>{const a={fields:JSON.stringify(["*"])};K.get(X.resource+se.wfSettingEzyForms,{params:a}).then(t=>{var o;(o=t==null?void 0:t.data)!=null&&o.length&&(G.value=t.data.map(C=>C.bu_code),G.value.length&&!d.value.length&&(d.value=G.value[0]))}).catch(t=>{console.error("Error fetching ezyForms data:",t)})};Ce(d,(a,t)=>{te.value=a,localStorage.setItem("Bu",te.value),sessionStorage.setItem("Bu",te.value),R.path.includes("forms")&&a!==t?s(!0):R.path.includes("forms")&&a===t&&s()});function g(){i.push({path:"/dashboard/maindash"})}function s(a=null){const t=[["business_unit","like",`%${d.value}%`]],o={fields:JSON.stringify(["*"]),filters:JSON.stringify(t),order_by:"`tabEzy Departments`.`department_name` asc"};K.get(X.resource+se.departments,{params:o}).then(C=>{if(C.data){z.value=C.data,B.value=z.value;const F=(z.value.length>0,"/forms/department/allforms");c.value=c.value.map(h=>h.name==="Forms"?he(ve({},h),{route:F}):h),w.value=z.value.map(h=>({route:h.name.replace(/\s+/g,"-").toLowerCase()})),a&&j.value.includes("/forms")&&De({route:F})}}).catch(C=>{console.error("Error fetching department data:",C)})}function m(a){var C,F;if(ae.value=[],u.value.selectedform=a,!a)return;let t=(C=localStorage.getItem("USERROLE"))==null?void 0:C.trim().toLowerCase();if(t=t==null?void 0:t.replace(/^"|"$/g,""),!t){N.error("User role is missing. Please log in again.",{autoClose:2e3});return}const o=D.value.find(h=>h.form_short_name===a);if(!o){N.error("Selected form does not exist in the fetched list.",{autoClose:2e3});return}try{const le=(F=JSON.parse(o.form_json).workflow)==null?void 0:F.find(_=>_.type==="requestor");if(!le||!Array.isArray(le.roles)){console.log("No requestor object or roles found."),N.error("Invalid requestor data.",{autoClose:2e3});return}const re=le.roles.map(_=>_.trim().toLowerCase()),W=_=>_.replace(/[^\x20-\x7E]/g,"").trim().toLowerCase(),Z=re.map(_=>W(_)),L=W(t);Z.forEach((_,ie)=>{console.log(`Comparing role[${ie}]: "${_}" with userRole: "${L}"`)});const H=Z.some(_=>_===L);console.log("Role Matching Result:",H),H?$e():(console.log("No matching role found."),N.error("You do not have permission to raise this request.",{autoClose:2e3}))}catch(h){N.error("Invalid form data. Please contact support.",{autoClose:2e3})}}function we(a){var F;let t=(F=localStorage.getItem("USERROLE"))==null?void 0:F.trim().toLowerCase();if(t=t==null?void 0:t.replace(/^"|"$/g,""),console.log("UserRole from localStorage:",`"${t}"`),!t){N.error("User role is missing. Please log in again.",{autoClose:2e3});return}const o=[["enable","=",1]];a&&o.push(["owner_of_the_form","like",a]);const C={fields:JSON.stringify(["*"]),limit_page_length:oe.value.limitPageLength,limit_start:oe.value.limit_start,filters:JSON.stringify(o),order_by:"`tabEzy Form Definitions`.`creation` desc"};K.get(`${X.resource}${se.EzyFormDefinitions}`,{params:C}).then(h=>{let re=h.data.filter(W=>{var Z;try{const L=JSON.parse(W.form_json),H=(Z=L==null?void 0:L.workflow)==null?void 0:Z.find(ee=>ee.type==="requestor");if(!H||!Array.isArray(H.roles))return!1;const _=H.roles.map(ee=>ee.trim().toLowerCase()),ie=ee=>ee.replace(/[^\x20-\x7E]/g,"").trim().toLowerCase(),Ee=_.map(ie),Ne=ie(t);return console.log(`Checking Form: ${W.form_short_name}`),Ee.includes(Ne)}catch(L){return console.error("Error parsing form_json for form:",W.form_short_name,L),!1}});re.length===0&&N.warning("No forms have been created in this department.",{autoClose:2e3,transition:"zoom"}),D.value=re}).catch(h=>{console.error("Error fetching ezyForms data:",h),N.error("Error fetching forms. Please try again.",{autoClose:2e3,transition:"zoom"})})}l([]),l("");function xe(){s()}function $e(){bootstrap.Modal.getInstance(document.getElementById("riaseRequestModal")).hide(),i.push({name:"RaiseRequest",query:{routepath:R.path,selectedCategory:u.value.selectedCategory,selectedForm:u.value.selectedform,business_unit:d.value}})}const Re=a=>{j.value=a.route,i.push(a.route)},De=a=>{a.route.includes("/forms")&&i.push(a.route)};return(a,t)=>(n(),r("div",null,[e("div",Ae,[e("div",Me,[e("div",Ge,[e("div",je,[e("div",{class:"col-2"},[e("div",{class:"d-flex gap-2 align-items-center"},[e("div",null,[e("img",{onClick:g,class:"imgmix img-fluid",src:Ue})])])]),e("div",Je,[e("div",We,[x(Be,{tabs:ne.value,onChangeTab:Re},null,8,["tabs"])])]),e("div",He,[e("div",Ye,[e("div",Ke,[x(ue,{class:"btn btn-danger raiseReqBtn d-flex justify-content-center align-items-center m-0 text-nowrap font-10",name:"Raise request","data-bs-toggle":"modal",onClick:xe,"data-bs-target":"#riaseRequestModal"})]),e("div",Xe,[x(de,{tag:"select",placeholder:"",class:"",name:"roles",id:"roles",Required:!1,modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=o=>d.value=o),options:G.value},null,8,["modelValue","options"])]),e("div",Qe,[e("div",Ze,[t[8]||(t[8]=e("button",{type:"button",class:"btn border-0 p-0 me-2 mt-0","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("img",{src:Te})],-1)),e("ul",et,[e("div",tt,[O.value?(n(),r("div",st,[e("li",at,f(O.value),1)])):$("",!0),e("div",null,[e("li",null,[V.value?(n(),r("div",ot,[e("span",nt,f(V.value),1)])):$("",!0),I.value?(n(),r("div",lt,[e("span",rt,f(I.value),1)])):$("",!0)])])]),e("li",it,[e("div",ct,[x(ue,{class:"changepass rounded-2 text-left",icon:"lock","data-bs-toggle":"modal","data-bs-target":"#changePassword",name:"Change Password"})])]),e("li",ut,[e("div",dt,[x(ue,{class:"logout rounded-2 text-left",icon:"box-arrow-right",onClick:t[1]||(t[1]=o=>J()),name:"Log Out"})])])])])])])])])])])]),e("div",mt,[e("div",ft,[e("div",pt,[e("div",gt,[t[9]||(t[9]=e("h5",{class:"modal-title font-14 fw-bold",id:"riaseRequestModalLabel"},"Raise Request",-1)),e("button",{onClick:t[2]||(t[2]=o=>ce()),type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]),e("div",vt,[e("div",ht,[t[10]||(t[10]=e("label",{class:"raise-label",for:""},"Department to raise",-1)),x(_e(be),{options:z.value.map(o=>o.name),onChange:we,modelValue:u.value.SelectedDepartment,"onUpdate:modelValue":t[3]||(t[3]=o=>u.value.SelectedDepartment=o),placeholder:"Select",multiple:!1,class:"font-11",searchable:!0},null,8,["options","modelValue"])]),e("div",_t,[t[11]||(t[11]=e("label",{class:"raise-label",for:""},"Form list",-1)),x(_e(be),{options:D.value.map(o=>o.name),modelValue:u.value.selectedform,"onUpdate:modelValue":t[4]||(t[4]=o=>u.value.selectedform=o),placeholder:"Select",onChange:m,multiple:!1,class:"font-11",searchable:!0},null,8,["options","modelValue"])])]),t[12]||(t[12]=e("div",null,[e("div",{class:"d-flex justify-content-center align-items-center p-3"})],-1))])])]),e("div",bt,[e("div",yt,[e("div",kt,[t[15]||(t[15]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title font-14 fw-bold",id:"changePasswordLabel"},"Change Password"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",St,[e("div",Ct,[t[13]||(t[13]=e("label",{class:"raise-label",for:"changepass"},"New Password",-1)),x(de,{class:"mb-3",tag:"input",type:"text",name:"changepass",id:"changepass",placeholder:"Enter",modelValue:E.value,"onUpdate:modelValue":t[5]||(t[5]=o=>E.value=o)},null,8,["modelValue"])]),e("div",wt,[t[14]||(t[14]=e("label",{class:"raise-label",for:"confirmpass"},"Confirm Password",-1)),x(de,{class:"",tag:"input",type:"text",name:"confirmpass",id:"confirmpass",placeholder:"Enter",modelValue:k.value,"onUpdate:modelValue":t[6]||(t[6]=o=>k.value=o)},null,8,["modelValue"]),Q.value?(n(),r("span",xt,"Passwords do not match.")):$("",!0)])]),e("div",null,[e("div",$t,[e("button",{class:"btn btn-dark font-12 w-100",type:"submit",onClick:t[7]||(t[7]=o=>S())}," Confirm New Password")])])])])])]))}},Zt=me(Rt,[["__scopeId","data-v-472e8082"]]),Dt={class:""},Et={class:"sidebar pt-2"},Nt={class:"font-12 m-0 text-muted ps-2"},It={class:"mt-1"},Ft={class:"list-unstyled"},Lt=["title"],qt={key:0,class:"font-10 m-0 text-muted ps-2"},Pt={key:1,class:"list-unstyled"},Ut=["title"],Tt={key:2,class:"font-10 m-0 text-muted ps-2"},Ot={key:3,class:"list-unstyled"},Vt=["title"],zt={key:4,class:"font-10 m-0 text-muted ps-2"},Bt={key:5,class:"list-unstyled"},At=["title"],Mt={key:1,class:"list-unstyled"},Gt={key:2,class:"list-unstyled"},jt=["title"],Jt="My Details",Wt="Master",Ht="Employee",Yt="System Settings",Kt={__name:"SideBar",setup(v){const i=b(()=>te.value),c=l({business_unit:""}),u=l({limitPageLength:"None",limitstart:0}),R=l([]),D=[{name:"Profile",icon:"bi bi-person-circle",route:"profile"},{name:"Department",icon:"bi bi-clock-history",route:"department"},{name:"Designation",icon:"bi bi-people",route:"designations"},{name:"Employees",icon:"bi bi-people",route:"employee"},{name:"System Settings",icon:"bi bi-people",route:"authenticationpage"}],d=[{name:"My Tasks",icon:"bi bi-bucket",route:"receivedform"},{name:"My Forms",icon:"bi bi-send",route:"raisedbyme"},{name:"My Team",icon:"bi bi-people",route:"myteam"},{name:"History",icon:"bi bi-clock-history",route:"history"}],O=[{name:"Created",icon:"bi bi-file-earmark-plus",route:"created"},{name:"Draft",icon:"bi bi-file-earmark-text",route:"draft"},{name:"Trash",icon:"bi bi-trash3",route:"trash"}],E=b(()=>d.filter(S=>S.name==="My Team"?J.value.includes("IT")||J.value.includes("HOD"):!0)),y=fe();ke();const k=b(()=>y.path.startsWith("/forms")),V=b(()=>y.path.startsWith("/settings")),I=b(()=>y.path.startsWith("/todo")),M=b(()=>y.path.startsWith("/create-form")),ae=b(()=>k.value?R.value:I.value?E.value:M.value?O:[]),G=b(()=>D.slice(0,1)),w=b(()=>J.value.toLowerCase().includes("it")?{thirdSettingsGroup:D.slice(1,3),forthSettingsGroup:D.slice(3,4),fifthSettingsGroup:D.slice(4)}:{thirdSettingsGroup:[],forthSettingsGroup:[]}),z=b(()=>k.value?"Departments":I.value?"Requests":M.value?"Forms":""),B=b(()=>k.value?"/forms":V.value?"/settings":I.value?"/todo":M.value?"/create-form":"/"),j=l([]),oe=l(""),ne=l(""),J=l("");Se(()=>{const S=JSON.parse(localStorage.getItem("employeeData")),p=JSON.parse(localStorage.getItem("UserName"));p?(oe.value=p.full_name,p.full_name==="Administrator"?ne.value=p.full_name:S&&(ne.value=p.full_name,J.value=S.designation||"")):console.warn("No user data found in localStorage.")});function ce(){const S=[["business_unit","like",`%${c.value.business_unit}%`]],p={fields:JSON.stringify(["*"]),limit_page_length:u.value.limitPageLength,limitstart:u.value.limitstart,filters:JSON.stringify(S),order_by:"`tabEzy Departments`.`department_name` asc"};K.get(X.resource+se.departments,{params:p}).then(g=>{g.data&&(j.value=g.data,R.value=j.value.sort((s,m)=>s.department_name.localeCompare(m.department_name)).map(s=>({name:s.department_name,route:s.name})))}).catch(g=>{console.error("Error fetching department data:",g)})}const Q=["bi-file-earmark-check","bi-question-octagon","bi-file-earmark-bar-graph","bi-card-checklist","bi-file-earmark-ruled","bi-journal-x","bi-clock-history","bi-percent"];return Ce([i,k],([S,p])=>{c.value.business_unit=S,p&&S.length&&ce()},{immediate:!0}),(S,p)=>{const g=ye("router-link");return n(),r("div",Dt,[e("div",Et,[e("h1",Nt,f(z.value),1),e("aside",It,[V.value?(n(),r(q,{key:0},[e("h2",{class:"font-10 m-0 text-muted ps-2"},f(Jt)),e("ul",Ft,[(n(!0),r(q,null,A(G.value,(s,m)=>(n(),Y(g,{key:m,to:`${B.value}/${s.route.toLowerCase()}`,class:"text-decoration-none text-black","active-class":"active-link"},{default:P(()=>[e("li",{title:s.name},[e("i",{class:T(`bi-icon ps-1 bg-transparent bi ${s.icon} me-3`)},null,2),U(" "+f(s.name),1)],8,Lt)]),_:2},1032,["to"]))),128))]),w.value.thirdSettingsGroup.length?(n(),r("h2",qt,f(Wt))):$("",!0),w.value.thirdSettingsGroup.length?(n(),r("ul",Pt,[(n(!0),r(q,null,A(w.value.thirdSettingsGroup,(s,m)=>(n(),Y(g,{key:m,to:`${B.value}/${s.route.toLowerCase()}`,class:"text-decoration-none text-black","active-class":"active-link"},{default:P(()=>[e("li",{title:s.name},[e("i",{class:T(`bi-icon ps-1 bg-transparent bi ${s.icon} me-3`)},null,2),U(" "+f(s.name),1)],8,Ut)]),_:2},1032,["to"]))),128))])):$("",!0),w.value.forthSettingsGroup.length?(n(),r("h2",Tt,f(Ht))):$("",!0),w.value.forthSettingsGroup.length?(n(),r("ul",Ot,[(n(!0),r(q,null,A(w.value.forthSettingsGroup,(s,m)=>(n(),Y(g,{key:m,to:`${B.value}/${s.route.toLowerCase()}`,class:"text-decoration-none text-black","active-class":"active-link"},{default:P(()=>[e("li",{title:s.name},[e("i",{class:T(`bi-icon ps-1 bg-transparent bi ${s.icon} me-3`)},null,2),U(" "+f(s.name),1)],8,Vt)]),_:2},1032,["to"]))),128))])):$("",!0),w.value.fifthSettingsGroup?(n(),r("h2",zt,f(Yt))):$("",!0),w.value.fifthSettingsGroup?(n(),r("ul",Bt,[(n(!0),r(q,null,A(w.value.fifthSettingsGroup,(s,m)=>(n(),Y(g,{key:m,to:`${B.value}/${s.route.toLowerCase()}`,class:"text-decoration-none text-black","active-class":"active-link"},{default:P(()=>[e("li",{title:s.name},[e("i",{class:T(`bi-icon ps-1 bg-transparent bi ${s.icon} me-3`)},null,2),U(" "+f(s.name),1)],8,At)]),_:2},1032,["to"]))),128))])):$("",!0)],64)):$("",!0),k.value?(n(),r("ul",Mt,[x(g,{to:"/forms/department/allforms",class:"text-decoration-none text-black","active-class":"active-link"},{default:P(()=>p[0]||(p[0]=[e("li",null,[e("i",{class:"bi-icon fs-6 bi bi-file-earmark-richtext me-3"}),U("All Forms")],-1)])),_:1}),(n(!0),r(q,null,A(R.value,(s,m)=>(n(),Y(g,{key:s.route,to:`/forms/department/${s.route}`,class:"text-decoration-none text-black","active-class":"active-link"},{default:P(()=>[e("li",null,[e("i",{class:T(["bi-icon","fs-6","bg-transparent",Q[m%Q.length],"me-3"])},null,2),U(" "+f(s.name),1)])]),_:2},1032,["to"]))),128))])):(n(),r("ul",Gt,[(n(!0),r(q,null,A(ae.value,(s,m)=>(n(),Y(g,{key:m,to:`${B.value}/${s.route?s.route.toLowerCase():""}`,class:"text-decoration-none text-black","active-class":"active-link"},{default:P(()=>[e("li",{title:s.name},[e("i",{class:T(`bi-icon ps-1 bg-transparent bi ${s.icon} me-3`)},null,2),U(" "+f(s.name),1)],8,jt)]),_:2},1032,["to"]))),128))]))])])])}}},es=me(Kt,[["__scopeId","data-v-1490c060"]]);export{Zt as H,es as S};
