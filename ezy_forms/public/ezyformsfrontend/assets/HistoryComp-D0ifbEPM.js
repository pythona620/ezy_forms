import{_ as L,M as S,u as A,x as f,E as F,r as t,w as B,o as E,c as I,d as r,t as O,b as g,G as U,P as M,y as V,z as H}from"./index-BICkGThB.js";const N={class:"d-flex justify-content-between align-items-center py-2"},T={class:"m-0 font-11 pt-1"},G={class:"mt-2"},j={__name:"HistoryComp",setup(z){const m=S(),v=A(),h=f(()=>F.value),d=t({business_unit:""}),k=t({limitPageLength:20,limit_start:0,filters:[]}),o=t(0),i=t(20),s=t(0),l=t([]),_=t([{th:"Request ID",td_key:"name"},{th:"Requester Name",td_key:"requester_name"},{th:"Requester Department",td_key:"department_name"},{th:"Last Action On",td_key:"modified"},{th:"Approval Status",td_key:"status"},{th:"Pending With",td_key:"assigned_to_users"},{th:"Linked ID",td_key:"linked_form_id"}]),R=t([{name:"View Request",icon:"fa-solid fa-eye"}]),u=t([]),y=t(null),p=t([]);function b(){const a={employee:JSON.parse(localStorage.getItem("employeeData")).emp_mail_id,approved_by_me:"1",property_field:d.value.business_unit};V.get(H.GetEmployeeForms,{params:a}).then(n=>{p.value=n.message||[],l.value=[...p.value],o.value=l.value.length,s.value=0,u.value=l.value.slice(0,i.value)}).catch(n=>{console.error(n)})}function q(e=p.value){const a=e.slice(s.value,s.value+i.value);u.value=a,o.value=e.length}function w(e){clearTimeout(y.value),y.value=setTimeout(()=>{l.value=p.value.filter(a=>_.value.every(n=>{const c=n.td_key;return e[c]?String(a[c]||"").toLowerCase().includes(String(e[c]).toLowerCase()):!0})),o.value=l.value.length,i.value=20,s.value=0,u.value=l.value.slice(0,i.value)},500)}function D(e){i.value=e,s.value=0,q()}function P(){s.value+=i.value;const e=l.value.slice(s.value,s.value+i.value);u.value=[...u.value,...e]}function C(e,a,n){n==="view"&&m.push({name:"ApproveRequest",query:{routepath:v.path,name:e.name,doctype_name:e.doctype_name,type:"myapprovals",readOnly:"true"}}),n==="td_key"&&e.linked_form_id&&m.push({name:"ApproveRequest",query:{routepath:v.path,name:e.linked_form_id,business_unit:e.property,type:"linkedForm",readOnly:"true"}})}const x=f(()=>({name:{type:"input"},requester_name:{type:"input"},department_name:{type:"input"},status:{type:"select",options:["In Progress","Completed","Request Cancelled"]}}));return B(h,e=>{d.value.business_unit=e,e.length&&b()},{immediate:!0}),(e,a)=>(E(),I("div",null,[r("div",N,[r("div",null,[a[0]||(a[0]=r("h1",{class:"m-0 font-13"},"My Approval Forms",-1)),r("p",T,O(o.value)+" Forms",1)])]),r("div",G,[g(U,{tHeaders:_.value,tData:u.value,isAging:"true",isAction:"true",viewType:"viewPdf",isCheckbox:"true",onUpdateFilters:w,"field-mapping":x.value,onCellClick:C,isFiltersoption:"true",actions:R.value},null,8,["tHeaders","tData","field-mapping","actions"]),g(M,{currentRecords:u.value.length,totalRecords:o.value,"items-per-page":k.value.limitPageLength,onUpdateValue:D,onLimitStart:P},null,8,["currentRecords","totalRecords","items-per-page"])])]))}},W=L(j,[["__scopeId","data-v-fd3c3179"]]);export{W as default};
