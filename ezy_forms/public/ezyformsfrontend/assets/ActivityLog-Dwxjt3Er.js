import{_ as k,x as C,E as D,r as e,w as u,e as P,K as w,y as A,z as N,o as U,c as E,d as r,b as v,G as S,P as V}from"./index-Bi6VkLA7.js";const j={class:"mt-2"},R={__name:"ActivityLog",setup(z){const f=C(()=>D.value),d=e(0),l=e([]);e(["yes","no"]),e([]),e(""),e(null),e(""),e([]),e({ezy_departments_items:[]});const g=e([]);e([{name:"View Categories",icon:"fa-solid fa-eye"}]);const t=e({limitPageLength:20,limit_start:0,filters:[]}),o=e({department_code:"",department_name:""}),y=e([]),p=e([{th:"User Name",td_key:"full_name"},{th:"User Id",td_key:"user"},{th:"Type of Activity",td_key:"subject"},{th:"Date",td_key:"communication_date"},{th:"Ip Address",td_key:"ip_address"},{th:"Status",td_key:"status"}]),h=e({full_name:{type:"input"},subject:{type:"input"},status:{type:"select",options:["Success","Failed"]}}),c=e({department_code:"",department_name:"",business_unit:"",ezy_departments_items:[]});u(()=>c.value.department_code,a=>{const s=a.trim().toLowerCase();y.value.filter(n=>n!==null).map(n=>n.trim().toLowerCase()).includes(s)?o.value.department_code="Department code already exists.":o.value.department_code=""}),u(()=>c.value.department_name,a=>{const s=a.trim().toLowerCase();g.value.filter(n=>n!==null).map(n=>n.trim().toLowerCase()).includes(s)?o.value.department_name="Department name already exists.":o.value.department_name=""}),P({applieddepartment_name:!1,applieddepartment_code:!1,department_name:"",department_code:""}),u(f,a=>{c.value.business_unit=a,a.length&&m()},{immediate:!0});const _=e(null);function L(a){clearTimeout(_.value),_.value=setTimeout(()=>{t.value.filters=[],p.value.forEach(s=>{const i=s.td_key;a[i]&&t.value.filters.push([i,"like",`%${a[i]}%`])}),t.value.limit_start=0,t.value.limitPageLength=20,m(t.value.filters)},500)}const b=a=>{t.value.limitPageLength=a,t.value.limit_start=0,m(t.value.filters)},x=([a,s])=>{t.value.limitPageLength=a,t.value.limit_start=s,m(t.value.filters)};function m(a){a&&(t.value.filters=a);const s={fields:JSON.stringify(["name","full_name","user","subject","communication_date","ip_address","status"]),filters:JSON.stringify(t.value.filters),limit_page_length:t.value.limitPageLength,limit_start:t.value.limit_start,doctype:w.ActivityLog,order_by:"`tabActivity Log`.`creation` desc"};A.get(N.GetDoctypeData,{params:s}).then(i=>{if(i.message){d.value=i.message.total_count;const n=i.message.data;t.value.limit_start===0?l.value=n:l.value=l.value.concat(n)}}).catch(i=>{console.error("Error fetching department data:",i)})}return(a,s)=>(U(),E("div",null,[s[0]||(s[0]=r("div",{class:"d-flex justify-content-between align-items-center py-2"},[r("div",null,[r("h1",{class:"mt-3 font-13"}," Activity Log ")]),r("div",{class:"d-flex gap-2 align-items-center"})],-1)),r("div",j,[v(S,{tHeaders:p.value,tData:l.value,isCheckbox:"true",isFiltersoption:"true","field-mapping":h.value,onUpdateFilters:L},null,8,["tHeaders","tData","field-mapping"]),v(V,{currentRecords:l.value.length,totalRecords:d.value,"items-per-page":t.value.limitPageLength,onUpdateValue:b,onLimitStart:x},null,8,["currentRecords","totalRecords","items-per-page"])])]))}},F=k(R,[["__scopeId","data-v-08dc9567"]]);export{F as default};
