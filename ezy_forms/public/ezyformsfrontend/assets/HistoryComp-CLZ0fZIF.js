import{_ as x,L,u as B,e as y,E as S,r as t,w as F,o as U,c as A,d as o,t as I,b as f,G as V,P as H,f as T,g as E}from"./index-DxID15hf.js";const O={class:"d-flex justify-content-between align-items-center py-2"},G={class:"m-0 font-11 pt-1"},M={class:"mt-2"},N={__name:"HistoryComp",setup(j){const v=L(),d=B(),h=y(()=>S.value),g=t({business_unit:""});t({limitPageLength:20,limit_start:0,filters:[]});const i=t(0);t([]),t([]),t([]),t([]),t(""),t([]),t([]),t(!1);const s=t([]),m=t([{th:"Request ID",td_key:"name"},{th:"Requested By",td_key:"requested_by"},{th:"Requested Department",td_key:"role"},{th:"Approval Status",td_key:"status"},{th:"Pending With",td_key:"assigned_to_users"},{th:"Linked ID",td_key:"linked_form_id"}]),k=t([{name:"View Request",icon:"fa-solid fa-eye"}]),n=t([]),_=t(null),r=t([]);function b(){T.post(E.get_approved_by_me).then(e=>{r.value=e.message||[],s.value=[...r.value],i.value=s.value.length,a.value=0,n.value=s.value.slice(0,l.value)}).catch(e=>{console.error(e)})}const l=t(20),a=t(0);function R(e=r.value){const u=e.slice(a.value,a.value+l.value);n.value=u,i.value=e.length}function w(e){clearTimeout(_.value),_.value=setTimeout(()=>{s.value=r.value.filter(u=>m.value.every(c=>{const p=c.td_key;return e[p]?String(u[p]||"").toLowerCase().includes(String(e[p]).toLowerCase()):!0})),i.value=s.value.length,l.value=20,a.value=0,n.value=s.value.slice(0,l.value)},500)}function q(e){l.value=e,a.value=0,R()}function C(){a.value+=l.value;const e=s.value.slice(a.value,a.value+l.value);n.value=[...n.value,...e]}function D(e,u,c){c==="view"&&v.push({name:"ApproveRequest",query:{routepath:d.path,name:e.name,doctype_name:e.doctype_name,type:"myapprovals",readOnly:"true"}}),c==="td_key"&&e.linked_form_id&&v.push({name:"ApproveRequest",query:{routepath:d.path,name:e.linked_form_id,business_unit:e.property,type:"linkedForm",readOnly:"true"}})}const P=y(()=>({name:{type:"input"},requested_by:{type:"input"},role:{type:"input"},status:{type:"select",options:["In Progress","Completed","Request Cancelled"]}}));return F(h,e=>{g.value.business_unit=e,e.length&&b()},{immediate:!0}),(e,u)=>(U(),A("div",null,[o("div",O,[o("div",null,[u[0]||(u[0]=o("h1",{class:"m-0 font-13"},"My Approval Forms",-1)),o("p",G,I(i.value)+" Forms",1)])]),o("div",M,[f(V,{tHeaders:m.value,tData:n.value,isAction:"true",viewType:"viewPdf",isCheckbox:"true",onUpdateFilters:w,"field-mapping":P.value,onCellClick:D,isFiltersoption:"true",actions:k.value},null,8,["tHeaders","tData","field-mapping","actions"]),f(H,{currentRecords:n.value.length,totalRecords:i.value,onUpdateValue:q,onLimitStart:C},null,8,["currentRecords","totalRecords"])])]))}},W=x(N,[["__scopeId","data-v-cfe29a9b"]]);export{W as default};
