var Ds=Object.defineProperty,Fs=Object.defineProperties;var Ss=Object.getOwnPropertyDescriptors;var nt=Object.getOwnPropertySymbols;var Yt=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable;var jt=(f,F,y)=>F in f?Ds(f,F,{enumerable:!0,configurable:!0,writable:!0,value:y}):f[F]=y,re=(f,F)=>{for(var y in F||(F={}))Yt.call(F,y)&&jt(f,y,F[y]);if(nt)for(var y of nt(F))Jt.call(F,y)&&jt(f,y,F[y]);return f},ye=(f,F)=>Fs(f,Ss(F));var yt=(f,F)=>{var y={};for(var C in f)Yt.call(f,C)&&F.indexOf(C)<0&&(y[C]=f[C]);if(f!=null&&nt)for(var C of nt(f))F.indexOf(C)<0&&Jt.call(f,C)&&(y[C]=f[C]);return y};var rt=(f,F,y)=>new Promise((C,q)=>{var E=V=>{try{h(y.next(V))}catch(Z){q(Z)}},G=V=>{try{h(y.throw(V))}catch(Z){q(Z)}},h=V=>V.done?C(V.value):Promise.resolve(V.value).then(E,G);h((y=y.apply(f,F)).next())});import{_ as Me,r as _,x as J,o as a,c as i,d as t,n as T,t as g,l as m,W as dt,X as de,b as ae,Q as wt,i as S,F as B,h as O,Z as Ue,v as Re,T as $s,m as P,g as qs,f as Wt,a6 as As,u as Ts,M as Ls,e as ue,E as Es,w as Se,a7 as Gt,K as me,y as te,z as le,L,a8 as Vs,S as Zt,O as Ge,B as Rs,R as Ze,N as Ee,j as Y,Y as Us,k as Ve,a9 as Ms,aa as Bs,U as he,H as _e,ab as _t,a2 as Os,ac as Kt,ad as Ps,D as zs}from"./index-BsSxkMRO.js";const Ns="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",Hs=["draggable","aria-label","onKeydown"],js={class:"field-card-icon"},Ys={class:"field-card-content"},Js={class:"field-card-title"},Gs={class:"field-card-description"},Zs={key:0,class:"field-card-drag-preview"},Ks={__name:"FieldCard",props:{field:{type:Object,required:!0},disabled:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["dragstart","dragend","click","add"],setup(f,{emit:F}){const y=f,C=F,q=_(!1),E=_(!1),G=J(()=>({"field-card--dragging":q.value,"field-card--disabled":y.disabled,"field-card--compact":y.compact,"field-card--hovered":E.value})),h=$=>{if(y.disabled)return;q.value=!0,$.dataTransfer.effectAllowed="copy",$.dataTransfer.setData("application/json",JSON.stringify({fieldType:y.field.id,fieldData:y.field}));const K=$.currentTarget.cloneNode(!0);K.style.opacity="0.8",K.style.transform="rotate(-2deg)",document.body.appendChild(K),$.dataTransfer.setDragImage(K,75,20),setTimeout(()=>{document.body.removeChild(K)},0),C("dragstart",{fieldType:y.field.id,fieldData:y.field,event:$})},V=$=>{q.value=!1,C("dragend",$)},Z=()=>{y.disabled||(C("click",y.field),C("add",y.field))};return($,K)=>(a(),i("div",{class:T(["field-card",G.value]),draggable:!f.disabled,onDragstart:h,onDragend:V,onClick:Z,role:"button",tabindex:"0","aria-label":`Add ${f.field.name} field`,onKeydown:[dt(Z,["enter"]),dt(de(Z,["prevent"]),["space"])]},[t("div",js,[t("i",{class:T(f.field.icon)},null,2)]),t("div",Ys,[t("h4",Js,g(f.field.name),1),t("p",Gs,g(f.field.description),1)]),K[0]||(K[0]=t("div",{class:"field-card-actions"},[t("i",{class:"bi bi-plus-circle"})],-1)),q.value?(a(),i("div",Zs,[t("i",{class:T(f.field.icon)},null,2),t("span",null,g(f.field.name),1)])):m("",!0)],42,Hs))}},Qt=Me(Ks,[["__scopeId","data-v-871ee6f1"]]),Ws=["aria-expanded","aria-controls","onKeydown"],Qs={class:"field-category-title"},Xs={class:"field-category-name"},xs={class:"field-category-count"},Is=["id"],eo={key:0,class:"field-category-description"},to={class:"field-category-fields"},lo={key:1,class:"field-category-empty"},so={__name:"FieldCategory",props:{category:{type:Object,required:!0},fields:{type:Array,default:()=>[]},initiallyCollapsed:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["field-dragstart","field-dragend","field-click","field-add","toggle"],setup(f,{emit:F}){const y=f,C=F,q=_(y.initiallyCollapsed||y.category.collapsed||!1),E=()=>{q.value=!q.value,C("toggle",{categoryId:y.category.id,isCollapsed:q.value})},G=$=>{C("field-dragstart",ye(re({},$),{categoryId:y.category.id}))},h=$=>{C("field-dragend",$)},V=$=>{C("field-click",{field:$,categoryId:y.category.id})},Z=$=>{C("field-add",{field:$,categoryId:y.category.id})};return($,K)=>(a(),i("div",{class:T(["field-category",{"field-category--collapsed":q.value}])},[t("div",{class:"field-category-header",onClick:E,role:"button",tabindex:"0","aria-expanded":!q.value,"aria-controls":`category-${f.category.id}`,onKeydown:[dt(E,["enter"]),dt(de(E,["prevent"]),["space"])]},[t("div",Qs,[t("i",{class:T([f.category.icon,"field-category-icon"])},null,2),t("h3",Xs,g(f.category.name),1),t("span",xs,"("+g(f.fields.length)+")",1)]),t("i",{class:T(["bi bi-chevron-down field-category-chevron",{"field-category-chevron--collapsed":q.value}])},null,2)],40,Ws),ae($s,{name:"category-expand"},{default:wt(()=>[S(t("div",{id:`category-${f.category.id}`,class:"field-category-content"},[f.category.description?(a(),i("p",eo,g(f.category.description),1)):m("",!0),t("div",to,[(a(!0),i(B,null,O(f.fields,x=>(a(),Ue(Qt,{key:x.id,field:x,compact:f.compact,onDragstart:G,onDragend:h,onClick:V,onAdd:Z},null,8,["field","compact"]))),128))]),f.fields.length===0?(a(),i("div",lo,K[0]||(K[0]=[t("i",{class:"bi bi-inbox"},null,-1),t("p",null,"No fields in this category",-1)]))):m("",!0)],8,Is),[[Re,!q.value]])]),_:1})],2))}},oo=Me(so,[["__scopeId","data-v-8c30728f"]]),ao=["for"],io={key:0,class:"text-input-required"},no={class:"text-input-container"},ro={key:0,class:"text-input-icon text-input-icon--left"},co=["id","type","value","placeholder","disabled","readonly","required","maxlength","minlength","aria-describedby","aria-invalid"],uo={key:1,class:"text-input-icon text-input-icon--right"},po=["aria-label"],fo={key:1,class:"text-input-hint"},mo=["id"],vo=["id"],ho={__name:"TextInput",props:{modelValue:{type:[String,Number],default:""},label:{type:String,default:""},type:{type:String,default:"text",validator:f=>["text","email","password","url","tel","number","search"].includes(f)},placeholder:{type:String,default:""},helpText:{type:String,default:""},errorMessage:{type:String,default:""},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},iconLeft:{type:String,default:""},iconRight:{type:String,default:""},size:{type:String,default:"md",validator:f=>["sm","md","lg"].includes(f)},maxLength:{type:Number,default:null},minLength:{type:Number,default:null}},emits:["update:modelValue","blur","focus","clear"],setup(f,{emit:F}){const y=f,C=F,q=J(()=>`text-input-${Math.random().toString(36).substr(2,9)}`),E=_(!1),G=J(()=>!!y.errorMessage),h=J(()=>[`text-input-wrapper--${y.size}`,{"text-input-wrapper--disabled":y.disabled,"text-input-wrapper--readonly":y.readonly,"text-input-wrapper--error":G.value,"text-input-wrapper--focused":E.value}]),V=J(()=>[`text-input--${y.size}`,{"text-input--with-icon-left":y.iconLeft,"text-input--with-icon-right":y.iconRight||y.clearable,"text-input--error":G.value}]),Z=N=>{C("update:modelValue",N.target.value)},$=N=>{E.value=!1,C("blur",N)},K=N=>{E.value=!0,C("focus",N)},x=()=>{C("update:modelValue",""),C("clear")};return(N,z)=>(a(),i("div",{class:T(["text-input-wrapper",h.value])},[f.label?(a(),i("label",{key:0,for:q.value,class:"text-input-label"},[P(g(f.label)+" ",1),f.required?(a(),i("span",io,"*")):m("",!0)],8,ao)):m("",!0),t("div",no,[f.iconLeft?(a(),i("span",ro,[t("i",{class:T(f.iconLeft)},null,2)])):m("",!0),t("input",{id:q.value,type:f.type,value:f.modelValue,placeholder:f.placeholder,disabled:f.disabled,readonly:f.readonly,required:f.required,maxlength:f.maxLength,minlength:f.minLength,class:T([V.value,"text-input"]),onInput:Z,onBlur:$,onFocus:K,"aria-describedby":f.helpText?`${q.value}-help`:void 0,"aria-invalid":G.value},null,42,co),f.iconRight||f.clearable?(a(),i("span",uo,[f.clearable&&f.modelValue&&!f.disabled?(a(),i("i",{key:0,class:"bi bi-x-circle text-input-clear",onClick:x,role:"button",tabindex:"0","aria-label":`Clear ${f.label||"input"}`},null,8,po)):f.iconRight?(a(),i("i",{key:1,class:T(f.iconRight)},null,2)):m("",!0)])):m("",!0)]),f.helpText||f.errorMessage?(a(),i("div",fo,[!G.value&&f.helpText?(a(),i("p",{key:0,id:`${q.value}-help`,class:"text-input-help"},g(f.helpText),9,mo)):m("",!0),G.value&&f.errorMessage?(a(),i("p",{key:1,id:`${q.value}-error`,class:"text-input-error"},[z[0]||(z[0]=t("i",{class:"bi bi-exclamation-circle"},null,-1)),P(" "+g(f.errorMessage),1)],8,vo)):m("",!0)])):m("",!0)],2))}},bo=Me(ho,[["__scopeId","data-v-5d216934"]]),go=["type","disabled","aria-label"],yo={__name:"IconButton",props:{type:{type:String,default:"button"},icon:{type:String,required:!0},variant:{type:String,default:"ghost",validator:f=>["solid","outline","ghost"].includes(f)},size:{type:String,default:"md",validator:f=>["sm","md","lg"].includes(f)},color:{type:String,default:"default",validator:f=>["default","primary","success","warning","error"].includes(f)},disabled:{type:Boolean,default:!1},ariaLabel:{type:String,required:!0},tooltip:{type:String,default:""}},emits:["click"],setup(f,{emit:F}){const y=f,C=F,q=J(()=>[`icon-button--${y.variant}`,`icon-button--${y.size}`,`icon-button--${y.color}`,{"icon-button--disabled":y.disabled}]),E=G=>{y.disabled||C("click",G)};return(G,h)=>{const V=qs("tooltip");return S((a(),i("button",{type:f.type,disabled:f.disabled,class:T([q.value,"icon-button"]),"aria-label":f.ariaLabel,onClick:E},[t("i",{class:T(f.icon)},null,2)],10,go)),[[V,f.tooltip]])}}},_o=Me(yo,[["__scopeId","data-v-b3b47a56"]]),wo=[{id:"basic",name:"Basic Fields",icon:"bi bi-input-cursor-text",collapsed:!1,description:"Essential form fields for text and numbers"},{id:"choice",name:"Choice Fields",icon:"bi bi-ui-checks",collapsed:!1,description:"Fields for selections and options"},{id:"datetime",name:"Date & Time",icon:"bi bi-calendar3",collapsed:!1,description:"Date, time, and datetime pickers"},{id:"file",name:"File & Media",icon:"bi bi-file-earmark-arrow-up",collapsed:!1,description:"Upload files, images, and signatures"},{id:"layout",name:"Layout Elements",icon:"bi bi-layout-text-sidebar",collapsed:!1,description:"Structure and organize your form"},{id:"advanced",name:"Advanced Fields",icon:"bi bi-gear",collapsed:!0,description:"Special purpose and computed fields"}],kt={text:{id:"text",category:"basic",name:"Text Input",icon:"bi bi-input-cursor-text",description:"Single line text input",frappe_fieldtype:"Data",defaultProps:{label:"Text Field",placeholder:"Enter text...",required:!1,maxLength:255,width:"100%"},validation:{supportedRules:["required","minLength","maxLength","pattern"]}},textarea:{id:"textarea",category:"basic",name:"Textarea",icon:"bi bi-textarea-t",description:"Multi-line text input",frappe_fieldtype:"Text",defaultProps:{label:"Text Area",placeholder:"Enter text...",rows:4,required:!1,maxLength:5e3,width:"100%"},validation:{supportedRules:["required","minLength","maxLength"]}},number:{id:"number",category:"basic",name:"Number",icon:"bi bi-hash",description:"Numeric input field",frappe_fieldtype:"Int",defaultProps:{label:"Number Field",placeholder:"0",required:!1,min:null,max:null,step:1,width:"100%"},validation:{supportedRules:["required","min","max"]}},email:{id:"email",category:"basic",name:"Email",icon:"bi bi-envelope",description:"Email address input",frappe_fieldtype:"Data",defaultProps:{label:"Email Address",placeholder:"email@example.com",required:!1,width:"100%"},validation:{supportedRules:["required","email"]}},phone:{id:"phone",category:"basic",name:"Phone",icon:"bi bi-telephone",description:"Phone number input",frappe_fieldtype:"Data",defaultProps:{label:"Phone Number",placeholder:"+1 (555) 000-0000",required:!1,width:"100%"},validation:{supportedRules:["required","phone"]}},url:{id:"url",category:"basic",name:"URL",icon:"bi bi-link-45deg",description:"Website URL input",frappe_fieldtype:"Data",defaultProps:{label:"Website URL",placeholder:"https://example.com",required:!1,width:"100%"},validation:{supportedRules:["required","url"]}},select:{id:"select",category:"choice",name:"Select Dropdown",icon:"bi bi-chevron-down",description:"Single selection dropdown",frappe_fieldtype:"Select",defaultProps:{label:"Select Field",placeholder:"Choose an option...",required:!1,options:["Option 1","Option 2","Option 3"],width:"100%"},validation:{supportedRules:["required"]}},multiselect:{id:"multiselect",category:"choice",name:"Multi Select",icon:"bi bi-ui-checks-grid",description:"Multiple selection dropdown",frappe_fieldtype:"MultiSelect",defaultProps:{label:"Multi Select Field",placeholder:"Choose options...",required:!1,options:["Option 1","Option 2","Option 3"],width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},radio:{id:"radio",category:"choice",name:"Radio Buttons",icon:"bi bi-record-circle",description:"Single choice radio buttons",frappe_fieldtype:"Select",defaultProps:{label:"Radio Field",required:!1,options:["Option 1","Option 2","Option 3"],layout:"vertical",width:"100%"},validation:{supportedRules:["required"]}},checkbox:{id:"checkbox",category:"choice",name:"Checkboxes",icon:"bi bi-check-square",description:"Multiple choice checkboxes",frappe_fieldtype:"MultiSelect",defaultProps:{label:"Checkbox Field",required:!1,options:["Option 1","Option 2","Option 3"],layout:"vertical",width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},toggle:{id:"toggle",category:"choice",name:"Toggle Switch",icon:"bi bi-toggle-on",description:"On/off switch",frappe_fieldtype:"Check",defaultProps:{label:"Toggle Field",required:!1,default:!1,width:"100%"},validation:{supportedRules:["required"]}},date:{id:"date",category:"datetime",name:"Date Picker",icon:"bi bi-calendar-date",description:"Date selection",frappe_fieldtype:"Date",defaultProps:{label:"Date Field",placeholder:"Select date...",required:!1,format:"YYYY-MM-DD",width:"100%"},validation:{supportedRules:["required","minDate","maxDate"]}},time:{id:"time",category:"datetime",name:"Time Picker",icon:"bi bi-clock",description:"Time selection",frappe_fieldtype:"Time",defaultProps:{label:"Time Field",placeholder:"Select time...",required:!1,format:"HH:mm:ss",width:"100%"},validation:{supportedRules:["required"]}},datetime:{id:"datetime",category:"datetime",name:"DateTime Picker",icon:"bi bi-calendar3",description:"Date and time selection",frappe_fieldtype:"Datetime",defaultProps:{label:"DateTime Field",placeholder:"Select date and time...",required:!1,format:"YYYY-MM-DD HH:mm:ss",width:"100%"},validation:{supportedRules:["required","minDate","maxDate"]}},fileupload:{id:"fileupload",category:"file",name:"File Upload",icon:"bi bi-file-earmark-arrow-up",description:"Upload files",frappe_fieldtype:"Attach",defaultProps:{label:"File Upload",required:!1,acceptedTypes:["pdf","doc","docx","xls","xlsx","txt"],maxSize:10485760,multiple:!1,width:"100%"},validation:{supportedRules:["required","fileType","fileSize"]}},imageupload:{id:"imageupload",category:"file",name:"Image Upload",icon:"bi bi-image",description:"Upload images",frappe_fieldtype:"Attach Image",defaultProps:{label:"Image Upload",required:!1,acceptedTypes:["jpg","jpeg","png","gif"],maxSize:5242880,multiple:!1,width:"100%"},validation:{supportedRules:["required","fileType","fileSize","imageDimensions"]}},signature:{id:"signature",category:"file",name:"Signature Pad",icon:"bi bi-pen",description:"Digital signature capture",frappe_fieldtype:"Signature",defaultProps:{label:"Signature",required:!1,width:"100%",height:200},validation:{supportedRules:["required"]}},sectionbreak:{id:"sectionbreak",category:"layout",name:"Section Break",icon:"bi bi-layout-split",description:"Divide form into sections",frappe_fieldtype:"Section Break",defaultProps:{label:"Section Break",collapsible:!1,collapsed:!1,width:"100%"},validation:{supportedRules:[]}},columnbreak:{id:"columnbreak",category:"layout",name:"Column Break",icon:"bi bi-layout-three-columns",description:"Create columns",frappe_fieldtype:"Column Break",defaultProps:{width:"50%"},validation:{supportedRules:[]}},heading:{id:"heading",category:"layout",name:"Heading",icon:"bi bi-type-h1",description:"Add heading text",frappe_fieldtype:"HTML",defaultProps:{label:"Heading Text",level:2,text:"Heading",width:"100%"},validation:{supportedRules:[]}},paragraph:{id:"paragraph",category:"layout",name:"Paragraph",icon:"bi bi-paragraph",description:"Add description text",frappe_fieldtype:"HTML",defaultProps:{label:"Paragraph Text",text:"Your text here...",width:"100%"},validation:{supportedRules:[]}},divider:{id:"divider",category:"layout",name:"Divider",icon:"bi bi-dash-lg",description:"Horizontal divider line",frappe_fieldtype:"HTML",defaultProps:{width:"100%"},validation:{supportedRules:[]}},table:{id:"table",category:"advanced",name:"Table/Grid",icon:"bi bi-table",description:"Child table for multiple rows",frappe_fieldtype:"Table",defaultProps:{label:"Table Field",required:!1,columns:[],width:"100%"},validation:{supportedRules:["required","minRows","maxRows"]}},link:{id:"link",category:"advanced",name:"Link Field",icon:"bi bi-box-arrow-up-right",description:"Link to another DocType",frappe_fieldtype:"Link",defaultProps:{label:"Link Field",placeholder:"Select...",required:!1,doctype:"",width:"100%"},validation:{supportedRules:["required"]}},dynamiclist:{id:"dynamiclist",category:"advanced",name:"Dynamic List",icon:"bi bi-list-ul",description:"Repeatable list of items",frappe_fieldtype:"Dynamic Link",defaultProps:{label:"Dynamic List",required:!1,minItems:1,maxItems:null,width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},formula:{id:"formula",category:"advanced",name:"Formula Field",icon:"bi bi-calculator",description:"Calculated field",frappe_fieldtype:"Data",defaultProps:{label:"Formula Field",formula:"",readonly:!0,width:"100%"},validation:{supportedRules:[]}},qrcode:{id:"qrcode",category:"advanced",name:"QR Code",icon:"bi bi-qr-code",description:"Generate QR code",frappe_fieldtype:"Barcode",defaultProps:{label:"QR Code Field",data:"",size:200,width:"100%"},validation:{supportedRules:[]}}};function ko(f){return Object.values(kt).filter(F=>F.category===f)}function Co(f){const F=f.toLowerCase();return Object.values(kt).filter(y=>y.name.toLowerCase().includes(F)||y.description.toLowerCase().includes(F))}const Do={class:"field-library-header"},Fo={class:"field-library-content"},So={class:"field-library-search"},$o={key:0,class:"field-library-results"},qo={key:0},Ao={key:1,class:"field-library-no-results"},To={key:1,class:"field-library-search-results"},Lo={key:2,class:"field-library-categories"},Eo={key:0,class:"field-library-collapsed-indicator"},Vo={__name:"FieldLibraryPanel",props:{collapsible:{type:Boolean,default:!0},initiallyCollapsed:{type:Boolean,default:!1},compactMode:{type:Boolean,default:!1},hiddenCategories:{type:Array,default:()=>[]},hiddenFields:{type:Array,default:()=>[]}},emits:["field-dragstart","field-dragend","field-click","field-add","collapse","expand"],setup(f,{emit:F}){const y=f,C=F,q=_(""),E=_(y.initiallyCollapsed),G=_({}),h=J(()=>wo.filter(U=>!y.hiddenCategories.includes(U.id))),V=J(()=>q.value?Co(q.value).filter(j=>!y.hiddenFields.includes(j.id)):[]);function Z(U){return ko(U).filter(ce=>!y.hiddenFields.includes(ce.id))}function $(){E.value=!E.value,C(E.value?"collapse":"expand")}function K(U){}function x(U){C("field-dragstart",U)}function N(U){C("field-dragend",U)}function z(U){C("field-click",U)}function I(U){C("field-add",U)}function we(U){G.value[U.categoryId]=U.isCollapsed}function ve(U){if((U.ctrlKey||U.metaKey)&&U.key==="k"){U.preventDefault();const j=document.querySelector(".field-library-search input");j&&j.focus()}}return Wt(()=>{document.addEventListener("keydown",ve)}),As(()=>{document.removeEventListener("keydown",ve)}),(U,j)=>(a(),i("div",{class:T(["field-library-panel",{"field-library-panel--collapsed":E.value}])},[t("div",Do,[j[1]||(j[1]=t("div",{class:"field-library-title"},[t("i",{class:"bi bi-grid-3x3-gap"}),t("h2",null,"Add Fields")],-1)),f.collapsible?(a(),Ue(_o,{key:0,icon:E.value?"bi bi-chevron-right":"bi bi-chevron-left",variant:"ghost",size:"sm","aria-label":"Toggle field library",onClick:$},null,8,["icon"])):m("",!0)]),S(t("div",Fo,[t("div",So,[ae(bo,{modelValue:q.value,"onUpdate:modelValue":[j[0]||(j[0]=ce=>q.value=ce),K],type:"search",placeholder:"Search fields...","icon-left":"bi bi-search",clearable:!0,size:"sm"},null,8,["modelValue"])]),q.value?(a(),i("div",$o,[V.value.length>0?(a(),i("p",qo,g(V.value.length)+" field"+g(V.value.length!==1?"s":"")+" found ",1)):(a(),i("p",Ao,[j[2]||(j[2]=t("i",{class:"bi bi-search"},null,-1)),P(' No fields found matching "'+g(q.value)+'" ',1)]))])):m("",!0),q.value&&V.value.length>0?(a(),i("div",To,[(a(!0),i(B,null,O(V.value,ce=>(a(),Ue(Qt,{key:ce.id,field:ce,compact:f.compactMode,onDragstart:x,onDragend:N,onClick:z,onAdd:I},null,8,["field","compact"]))),128))])):(a(),i("div",Lo,[(a(!0),i(B,null,O(h.value,ce=>(a(),Ue(oo,{key:ce.id,category:ce,fields:Z(ce.id),compact:f.compactMode,onFieldDragstart:x,onFieldDragend:N,onFieldClick:z,onFieldAdd:I,onToggle:we},null,8,["category","fields","compact"]))),128))])),j[3]||(j[3]=t("div",{class:"field-library-help"},[t("i",{class:"bi bi-info-circle"}),t("p",null,"Drag fields to the canvas or click to add")],-1))],512),[[Re,!E.value]]),E.value?(a(),i("div",Eo,j[4]||(j[4]=[t("i",{class:"bi bi-grid-3x3-gap"},null,-1),t("span",null,"Fields",-1)]))):m("",!0)],2))}},Ro=Me(Vo,[["__scopeId","data-v-12f238c7"]]),Uo={class:""},Mo={class:""},Bo={class:"d-flex justify-content-between align-items-center CancelNdSave"},Oo={class:"d-flex align-items-center"},Po={key:0,class:"font-16"},zo=["disabled"],No={class:"form-container p-0 container-fluid mt-1"},Ho={class:"row"},jo={class:"col-lg-2 col-md-2 col-sm-12"},Yo={class:"steps-sticky-div"},Jo={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},Go=["onClick"],Zo={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},Ko={class:"step-text"},Wo={class:"font-11"},Qo={class:"font-14"},Xo={class:"col-lg-10 col-md-10 col-sm-12 formbackground-color"},xo={class:""},Io={class:"form-content stepsDiv"},ea={key:0},ta={class:""},la={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},sa={class:"container-fluid aboutFields p-0"},oa={class:"row"},aa={class:"col-sm-12 col-md-12 mt-lg-3 p-lg-4"},ia={class:"container-fluid"},na={class:"row g-3"},ra={class:"col-md-6"},da={class:"position-relative"},ca={key:0,class:"font-12 position-absolute PredefinedLabel"},ua={key:1,class:"text-danger ErrorMsg ms-2"},pa={class:"col-md-6"},fa={key:0,class:"text-danger ErrorMsg ms-2"},ma={class:"col-md-6"},va={class:"col-md-6"},ha={key:0,class:"text-danger"},ba={class:"col-md-6"},ga={key:0,class:"text-danger"},ya={class:"col-md-6"},_a={key:0,class:"text-danger"},wa={class:"custom-option"},ka=["checked","onChange"],Ca={class:"col-md-6"},Da={class:"col-md-6"},Fa={key:0,class:"col-md-6"},Sa={key:1,class:"col-md-6"},$a={key:2,class:"col-md-6"},qa={class:"form-check d-flex align-items-center p-0 pe-3"},Aa=["disabled"],Ta={key:3,class:"col-md-6"},La=["disabled"],Ea={key:0,class:"list-group position-absolute w-100 z-3 formslist"},Va=["onMousedown"],Ra={key:1,class:"zoho-form-builder"},Ua={class:"zoho-toolbar"},Ma={class:"toolbar-left"},Ba={class:"zoho-tabs"},Oa=["onClick"],Pa=["onClick"],za={class:"toolbar-right"},Na={class:"zoho-builder-container"},Ha={class:"zoho-field-library"},ja={class:"library-header"},Ya={key:0,class:"library-content"},Ja={class:"zoho-form-canvas"},Ga={class:"requestandAppHeader"},Za={class:"d-flex justify-content-between align-items-center"},Ka={class:""},Wa={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},Qa={class:"text-center ms-2 mt-1"},Xa={key:0,class:"font-12 d-flex align-items-center"},xa={class:"font-12 approver_type_div"},Ia={class:"font-12 fw-bold"},ei={class:"font-12 text-danger ms-1"},ti={class:"d-flex align-items-center"},li={key:0,class:"role-container"},si={key:0,class:"role-text d-flex align-items-center"},oi={class:"role-label fw-bold"},ai={class:"role-names"},ii=["onClick"],ni=["onClick"],ri=["onClick"],di=["onClick"],ci={class:"pt-0 section_block"},ui={class:"d-flex justify-content-between align-items-center"},pi={class:"d-flex flex-column"},fi=["onUpdate:modelValue","onChange","onInput"],mi={key:0,class:"text-danger ps-3 font-10"},vi={class:"d-flex align-items-center"},hi=["onClick"],bi={class:"container-fluid"},gi={class:"d-flex justify-content-between align-items-center"},yi={class:"rownames m-0"},_i=["onClick"],wi={class:"col"},ki={class:"row"},Ci=["onMouseenter"],Di={class:"column_name d-flex align-items-center justify-content-between"},Fi={class:"d-flex flex-column ps-2"},Si=["onUpdate:modelValue","onChange","onInput"],$i={key:0,class:"text-danger ps-2 font-10"},qi={class:"position-absolute top-0 end-0"},Ai=["onClick"],Ti=["onDrop"],Li=["onMouseenter","onDragstart","onDrop"],Ei=["onDrop"],Vi=["onDragstart","onDrop"],Ri={class:"d-flex justify-content-between"},Ui={class:"flex-column d-flex"},Mi=["onUpdate:modelValue","onChange","onInput"],Bi={key:0,class:"text-danger font-10"},Oi={class:"FieldcopyRemove"},Pi=["onClick"],zi=["onClick"],Ni=["onUpdate:modelValue","onChange"],Hi=["value"],ji={key:0},Yi=["onUpdate:modelValue"],Ji={key:0,class:"text-danger font-10"},Gi={key:1},Zi=["for"],Ki=["id","onUpdate:modelValue","onInput","onFocus"],Wi={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},Qi=["onClick"],Xi={class:"d-flex align-items-center justify-content-between"},xi={class:"d-flex align-items-center gap-2"},Ii={class:"d-flex align-items-center"},en=["onUpdate:modelValue","id"],tn=["for"],ln=["onClick"],sn=["onUpdate:modelValue"],on={key:3,class:"text-danger font-10"},an=["onDrop"],nn={class:"childtableShow"},rn={class:"mt-2"},dn={key:0,class:"childTableContainer"},cn={key:0,class:"font-13"},un={key:1,class:"d-flex align-items-center gap-2"},pn={class:"d-flex align-items-center"},fn=["onUpdate:modelValue"],mn=["onClick"],vn={key:2,class:"table table-bordered rounded-table"},hn=["onDrop"],bn=["draggable","onDragstart"],gn={key:0},yn=["onUpdate:modelValue","onInput"],_n={key:0,class:"text-danger font-11"},wn={key:1},kn={key:2},Cn={class:"d-flex gap-1"},Dn=["onUpdate:modelValue","onChange"],Fn=["value"],Sn={class:"d-flex"},$n={class:"d-flex align-items-center gap-2"},qn={class:"d-flex align-items-center"},An=["onUpdate:modelValue"],Tn=["onClick"],Ln={key:0},En=["onUpdate:modelValue","onInput"],Vn={key:0,class:"text-danger font-10"},Rn={key:1,class:"font-11 text-danger"},Un={key:3},Mn={key:3,class:"mb-2 mt-3"},Bn=["onClick"],On=["onClick"],Pn=["onDrop"],zn=["onDrop"],Nn={class:"d-flex justify-content-center align-items-center my-2"},Hn=["onClick"],jn={class:"font-13"},Yn={key:0,class:"d-flex align-items-center gap-2"},Jn={class:"d-flex align-items-center"},Gn=["onUpdate:modelValue"],Zn=["onClick"],Kn={class:"table table-bordered rounded-table"},Wn={key:0},Qn=["onUpdate:modelValue","onBlur"],Xn={key:0,class:"text-danger font-11 mt-1"},xn={key:1},In={key:2},er={class:"d-flex gap-1 align-items-center"},tr=["onUpdate:modelValue","onChange"],lr=["value"],sr=["onClick"],or={key:0,class:"mt-1"},ar=["onUpdate:modelValue","onInput"],ir={key:1,class:"text-danger font-11 mt-1"},nr={key:3},rr={class:"mb-2"},dr=["onClick"],cr=["onClick"],ur=["onClick"],pr={key:0},fr={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},mr=["onUpdate:modelValue","onBlur"],vr={key:0,class:"text-danger font-12"},hr={key:1,class:"text-danger font-12"},br={class:"d-flex align-items-center gap-2"},gr={class:"d-flex align-items-center"},yr=["onUpdate:modelValue"],_r=["onClick"],wr=["onClick"],kr={class:"px-1 field-border"},Cr={class:"d-flex justify-content-between"},Dr=["onUpdate:modelValue","onBlur"],Fr={key:0,class:"text-danger font-12"},Sr={class:"d-flex align-items-center"},$r={class:"d-flex my-1"},qr=["onUpdate:modelValue"],Ar=["onClick"],Tr=["onClick"],Lr=["onUpdate:modelValue"],Er=["value"],Vr={key:0},Rr=["onUpdate:modelValue"],Ur={key:0,class:"text-danger font-10"},Mr={key:1,class:"text-danger font-12"},Br=["onClick"],Or=["onClick"],Pr={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},zr=["onClick"],Nr={key:0,class:"m-2"},Hr={key:0,class:"zoho-properties-panel"},jr={class:"properties-header"},Yr={key:2},Jr={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},Gr={class:"modal-dialog modal-dialog-centered"},Zr={class:"modal-content"},Kr={class:"modal-body"},Wr=["placeholder"],Qr={class:"d-flex align-items-center gap-2"},Xr={class:"d-flex align-items-center py-2"},xr={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},Ir={class:"offcanvas-header add_designationHeader"},ed={id:"offcanvasRightLabel",class:"font-14 fw-bold"},td={class:"offcanvas-body add_desig_offCanvas_body p-0"},ld={class:""},sd={class:""},od={key:0,class:"p-3 approval-border-bottom"},ad={key:0,class:""},id={class:"px-3 listofdesignations"},nd={class:"my-1 d-flex justify-content-between"},rd={class:"font-12 fw-bold"},dd={class:"italic-style text-secondary font-12"},cd={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},ud={class:"d-flex align-items-center justify-content-between gap-1"},pd={class:"form-check ps-1 d-flex align-items-center m-0"},fd=["checked"],md={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},vd={key:0,class:"form-check d-flex align-items-center m-0"},hd={key:1},bd={key:0,class:"p-3"},gd=["value"],yd={key:1},_d={class:""},wd={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},kd={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},Cd={class:"offcanvas-footer"},Dd={class:"text-end p-3"},$e="Select All",Fd={__name:"FormStepper",setup(f){const F=Ts(),y=Ls(),C=_(1),q=_([]);_([]);const E=_([]),G=_([]);ue([]);let h=ue([]),V=ue([]);const Z=_([]),$=_([]),K=_([]),x=_(""),N=_(""),z=_("");let I=ue([]);const we=_("");_(!1),_(!1),_(!1);const ve=_(""),U=_(""),j=_(""),ce=_([]),Xt=_([]),R=ue({}),ie=_([]),ct=_(!1),Ke=_([]),We=_(!1);let Ct=null;const xt=_("");let H=_("");const It=_(null),Dt=_(null),Qe=_(!0),Xe=_(0),qe=J(()=>Es);_(!1);const xe=ue([]),ne=_({routepath:F.query.routepath,business_unit:F.query.business_unit,formId:F.query.id}),Ie=_(""),Ae=_(!1),Te=_(!1),Ft=[{label:"Public",value:1},{label:"Private",value:0}],St=J({get(){return Ft.find(l=>l.value===b.value.as_web_view)},set(l){b.value.as_web_view=l?l.value:null}}),$t=J({get(){return b.value.form_name||F.query.form_name||""},set(l){b.value.form_name=l}}),b=_({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${qe.value.value||ne.value.business_unit||F.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:F.query.id?1:0,as_web_view:0,mail_id:""});Se(()=>F.query.form_name,l=>{l&&(b.value.form_name=l,b.value.form_short_name=l)},{immediate:!0});const et=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(l=>l.toLowerCase().trim()),qt=["Approver","Approved on","Approved By"].map(l=>l.toLowerCase().trim());function el(l){return l.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}const tl=J(()=>b.value);_(""),_(!1),Se(qe,l=>{l&&l.value&&(b.value.business_unit=l.value)},{immediate:!0});function ll(l){if(H==null||H==="new")return!1;const e=W(l).roles;if(l===0)return e.length===0;const s=W(l-1).roles;return s.length>0&&s[0]!==null&&s[0]!==""&&e.length===0}Se(()=>b.value.form_name,l=>{b.value.form_name=l.trim()}),Se(()=>b.value.form_short_name,l=>{b.value.form_short_name=l.trim()}),Se(()=>b.value.series,l=>{b.value.series=l.trim()});const tt=_(null),At=(l,e,s,o,r,n)=>{tt.value={blockIndex:e,sectionIndex:s,rowIndex:o,columnIndex:r,fieldIndex:n}},ke=(l,e,s,o,r,n)=>{if(!tt.value)return;const{blockIndex:d,sectionIndex:u,rowIndex:v,columnIndex:c,fieldIndex:p}=tt.value,k=h[d].sections[u].rows[v].columns[c].fields,M=h[e].sections[s].rows[o].columns[r].fields;if(d===e&&u===s&&v===o&&c===r&&p===n)return;const w=k.splice(p,1)[0];k===M&&p<n&&n--,M.splice(n,0,w),tt.value=null},Le=_(""),sl=l=>rt(this,null,function*(){const e=[["module","in",["User Forms"]],["istable","=",1]];l!=null&&l.trim()&&e.push(["name","=",`${l}`]);const s={fields:JSON.stringify(["name"]),filters:JSON.stringify(e),limit_page_length:"None",doctype:me.doctypesList};try{return(yield te.get(le.GetDoctypeData,{params:s})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),lt=_(null),Tt=l=>rt(this,null,function*(){if(Le.value="",lt.value=null,l.tableName){let e=l.tableName.trim();if(e.length>64){Le.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(e)){Le.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield sl(e);lt.value=o.find(r=>r.name.toLowerCase()===e.toLowerCase()),lt.value&&(Le.value="Table already exists"),l.tableName=e}l.label&&(l.fieldname=el(l.label))});function ol(){const l=b.value.is_linked_form;if(!l){Ke.value=[];return}clearTimeout(Ct),Ct=setTimeout(()=>{const e=[["business_unit","=",`${qe.value.value}`],["name","like",`%${l}%`]],s={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(e),doctype:me.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};te.get(`${le.GetDoctypeData}`,{params:s}).then(o=>{Ke.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function al(l){b.value.is_linked_form=l,We.value=!1}function il(){setTimeout(()=>{We.value=!1},200)}ue({query:"",key:""});function be(l,e,s,o,r){return`${l}-${e}-${s}-${o}-${r}`}ue({});const Be=ue({}),ut=ue({});function nl(l){ut[l]=!0}function rl(l,e,s,o,r,n){const d=be(e,s,o,r,n),u=[["istable","=",0]];l!=null&&l.trim()&&u.push(["name","like",`%${l}%`]);const v={fields:JSON.stringify(["name"]),filters:JSON.stringify(u),limit_page_length:"none",doctype:me.doctypesList};te.get(le.GetDoctypeData,{params:v}).then(c=>{Be[d]=c.message.data||[]}).catch(c=>{console.error("Error fetching doctype list:",c),Be[d]=[]})}function dl(l,e,s,o,r,n){h[l].sections[e].rows[s].columns[o].fields[r].options=n;const d=be(l,e,s,o,r);Be[d]=[],ut[d]=!1}const cl=J(()=>h!=null&&h.length?z.value===1?[0]:Array.from({length:z.value},(l,e)=>e).filter(l=>l<z.value):[]),ge=_(null),Ce=_(null),ul=(l,e,s,o,r)=>{ge.value={blockIndex:l,sectionIndex:e,rowIndex:s,columnIndex:o,fieldIndex:r}},pl=()=>{ge.value=null},fl=(l,e,s,o,r)=>ge.value&&ge.value.blockIndex===l&&ge.value.sectionIndex===e&&ge.value.rowIndex===s&&ge.value.columnIndex===o&&ge.value.fieldIndex===r,ml=(l,e,s,o)=>{Ce.value={blockIndex:l,sectionIndex:e,rowIndex:s,columnIndex:o}},vl=()=>{Ce.value=null},hl=(l,e,s,o)=>Ce.value&&Ce.value.blockIndex===l&&Ce.value.sectionIndex===e&&Ce.value.rowIndex===s&&Ce.value.columnIndex===o,Lt=_([{form_json:""}]),De=_("");Wt(()=>{Bt(),De.value=F.query.Clone,H.value=F.query.id||"new",De.value==="1"&&(b.value.series=""),H.value!=null&&H.value!=null&&H.value!="new"&&(Mt(),ht()),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?ct.value=!0:ct.value=!1;let l=localStorage.getItem("Bu");if(b.value.business_unit=l,F.query.preId==="PreDefine"){const e=localStorage.getItem("form_json");if(e){Lt.value[0].form_json=e;const s=Lt.value[0],o=JSON.parse(s.form_json),r=Gt(o.fields);ie.value=o.child_table_fields,r.forEach(n=>{h.push(n)})}}});const Fe=_(null),ee=ue({}),Et=_(null),bl=l=>{Fe.value=l},gl=()=>{Fe.value=null},yl=l=>{l.preventDefault()},_l=(l,e)=>{const s=l.target.closest("tr");if(!s)return;const o=Array.from(s.parentNode.children).indexOf(s);if(o!==Fe.value){const r=e[Fe.value];e.splice(Fe.value,1),e.splice(o,0,r),Fe.value=o}},wl=_([]),pt=l=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(l.fieldtype)&&l.options){const e=l.options.split(`
`).map(r=>r.trim()).filter(r=>r),s=[],o=new Set;return e.forEach(r=>{const n=r.toLowerCase();o.has(n)||(o.add(n),s.push(r))}),`
`+s.join(`
`)}else if(["Link","Table"].includes(l.fieldtype)&&l.options)return l.options.trim();return l.options},kl=(l,e)=>{const s=h[l].sections[e];s.childTables||(s.childTables=[]);const o=s.childTables.length;s.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[re({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},xe.fieldtype==="Select"&&xe.options?{options:xe.options?`
${xe.options}`:`
`}:{})],newTable:!0})},Cl=(l,e,s)=>{const o=h[l].sections[e].childTables[s];o.columns||(o.columns=[]),o.columns.push(re({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},Dl=(l,e,s)=>{h[l].sections[e].childTables.splice(s,1)},Fl=(l,e,s,o)=>{h[l].sections[e].childTables[s].columns.splice(o,1)};function Sl(l,e,s,o,r,n){var c;const d=`${e}-${s}-${o}`;R[d]||(R[d]={columns:[]});const u={},v=((c=l.label)==null?void 0:c.trim())||"";if(!v)u.label="Field Label is required";else{const p=v.toLowerCase();if(et.includes(p)&&!qt.includes(p))u.label=`"${v}" is a restricted field label`;else if(v.length>64)u.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(v))u.label="Field Label can only contain letters, numbers, and single spaces between words";else{const k=n.map((M,w)=>{var D;return{label:(D=M.label)==null?void 0:D.trim().toLowerCase(),index:w}}).filter(M=>M.label===p);if(k.length>1){const M=k[0].index;r!==M&&(u.label=`"${v}" is already used in this table`)}}}R[d].columns[r]=u}function st(l,e,s){var n;R[e]||(R[e]={});const o=[],r=((n=l.label)==null?void 0:n.trim())||"";r||o.push("Label is required"),r.length>64&&o.push("Label cannot exceed 64 characters"),r&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(r)&&o.push("No special characters allowed"),r&&et.includes(r.toLowerCase().trim())&&o.push("This label is restricted"),r&&ie.value[e].map(v=>{var c;return(c=v.label)==null?void 0:c.trim().toLowerCase()}).filter(Boolean).filter(v=>v===r.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),l.fieldtype||o.push("Field type is required"),l.fieldtype==="Select"&&(!l.options||l.options.trim()==="")&&o.push("Options are required"),R[e][s]=o}const $l=(l,e,s)=>{var d;const o=h[l].sections[e].childTables[s],r={tableName:!1,columns:[]};let n=!1;return(d=o.tableName)!=null&&d.trim()||(r.tableName="Table name is required.",n=!0),o.columns.forEach((u,v)=>{var p,k;const c={};(p=u.label)!=null&&p.trim()||(c.label="Field Label is required",n=!0),(k=u.fieldtype)!=null&&k.trim()||(c.fieldtype="Please select field type",n=!0),r.columns[v]=c}),R[`${l}-${e}-${s}`]=r,n},ql=(l,e,s)=>{var r,n;const o=(n=(r=h[l])==null?void 0:r.sections)==null?void 0:n[e];o&&!Array.isArray(o[s])&&(o[s]=[])},Al=l=>l?l.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",Tl=(l,e,s)=>{if($l(l,e,s)){he("Please fix validation errors before creating the table",{transition:"zoom"});return}if(lt.value){he("Table already exists",{transition:"zoom"});return}const r=h[l].sections[e].childTables[s],n=h[l].sections[e];r.columns=r.columns.map((u,v)=>ye(re({},u),{idx:v,options:pt(u)})),r.newTable=!1;const d={form_short_name:r.tableName,fields:r.columns,idx:r.idx,as_a_block:r.as_a_block?r.as_a_block:"false"};te.post(le.childtable,d).then(u=>{var v,c,p;if(u){ql(l,e,"afterCreated"),n.afterCreated[s]=re({},r),_e("Table created successfully!");const k=(p=(c=(v=u.message)==null?void 0:v[0])==null?void 0:c[0])==null?void 0:p.child_doc;k&&(h[l].sections[e].childTables[s]=ye(re(re({},h[l].sections[e].childTables[s]),k),{newTable:!1}))}}).catch(u=>{console.error("Error creating table:",u)})},Oe=(l,e,s,o=[])=>{var d;ee[e]||(ee[e]=[]),ee[e]=ee[e].filter(u=>u!==s),R[e]||(R[e]=[]),R[e][s]=[];const r=[],n=((d=l.label)==null?void 0:d.trim())||"";if(n?et.includes(n.toLowerCase())?r.push("This label is restricted"):n.length>64?r.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(n)||r.push("Only letters, numbers, and single spaces allowed"):r.push("Label is required"),o.length){const u=n.toLowerCase(),v=o.map((c,p)=>{var k;return{label:(k=c.label)==null?void 0:k.trim().toLowerCase(),idx:p}}).filter(c=>c.label===u);if(v.length>1){const c=v[0].idx;s!==c?(r.push("Duplicate label not allowed"),l._duplicate=!0):l._duplicate=!1}else l._duplicate=!1}return l.fieldtype||r.push("Field type is required"),l.fieldtype==="Select"&&(!l.options||!l.options.trim())&&r.push("Options are required"),R[e][s]=r,r.length>0&&ee[e].push(s),r.length===0},Ll=(l,e,s)=>{const r=h[l].sections[e].afterCreated.find(u=>u.tableName===s);if(!r)return;const n=r.columns.length,d={fieldname:"",fieldtype:"",idx:n+1,label:"",value:"",isNew:!0,description:""};r.columns.push(d),Oe(d,s,n,r.columns)},Vt=_([]),El=(l,e,s,o)=>{const n=h[l].sections[e].afterCreated.find(u=>u.tableName===s);if(!n)return;n.columns.splice(o,1),n.columns.forEach((u,v)=>{u.idx=v+1});const d=ee.value[s];d&&(ee.value[s]=d.filter(u=>u!==o).map(u=>u>o?u-1:u))},Vl=(l,e,s)=>{const r=h[l].sections[e].afterCreated.find(n=>n.tableName===s);if(r){if(Q[s]){ee[s]=[];let n=!0;if(r.columns.forEach((v,c)=>{Oe(v,s,c,r.columns)||(n=!1)}),!n){he("Please fix the errors in the highlighted fields before saving!");return}const d=r.columns.map((k,p)=>{var M=k,{isNew:v}=M,c=yt(M,["isNew"]);return ye(re({},c),{idx:p+1,options:pt(c)})}),u={form_short_name:Al(s),fields:d,as_a_block:r.description};te.post(le.childtable,u).then(v=>{Vt.value=v.data,_e("Fields updated successfully!")}).catch(v=>{console.error("❌ Saving fields failed:",v)})}Q[s]=!Q[s]}},Q=ue({}),Rl=l=>{ie.value[l]||(ie.value[l]=[]);const e=ie.value[l].length+1;ie.value[l].push({fieldname:"",fieldtype:"",idx:e,label:"",value:"",isNew:!0,description:"",options:ie.value[l].options?`
${ie.value[l].options}`:""})},Ul=(l,e)=>{ie.value[l]&&ie.value[l].splice(e,1)},Ml=(l,e)=>{if(!l)return;ee.value||(ee.value={}),ee.value[l]||(ee.value[l]=[]);const s=ie.value[l];if(s){if(Q[l]){ee.value[l]=[];let o=!0;if(s.forEach((d,u)=>{var c;st(d,l,u);const v=(c=R[l])==null?void 0:c[u];v&&v.length>0&&(ee.value[l].push(u),o=!1),d.label&&(d.label=d.label.trim())}),!o){he("Please fix the errors before saving");return}const r=s.map((c,v)=>{var p=c,{isNew:d}=p,u=yt(p,["isNew"]);return ye(re({},u),{idx:v+1,options:pt(u)})}),n={form_short_name:l,fields:r,as_a_block:e};te.post(le.childtable,n).then(d=>{Vt.value=d.data,_e("Fields updated successfully!")}).catch(d=>{console.error("❌ Saving fields failed:",d)})}Q[l]=!Q[l],Et.value=Q[l]?l:null}},Bl=_([{id:1,label:"About Form",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Fields & Workflow",stepno:"Step 2",icon:"bi bi-question-circle"},{id:3,label:"Print Format",stepno:"Step 3",icon:"ri-checkbox-circle-line"}]),ft=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],Ol=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],Pl=J(()=>[$e,...E.value]),zl=J(()=>{const l=b.value.accessible_departments;return l.includes($e)?"All Selected":l.length>1?`${l[0]}.. +${l.length-1} more selected`:l.join(", ")}),Nl=l=>l===$e?b.value.accessible_departments.length===E.value.length:b.value.accessible_departments.includes(l),Hl=(l,e)=>{l===$e?e.target.checked?b.value.accessible_departments=[...E.value]:b.value.accessible_departments=[]:(e.target.checked?b.value.accessible_departments.push(l):b.value.accessible_departments=b.value.accessible_departments.filter(s=>s!==l),b.value.accessible_departments.length===E.value.length?b.value.accessible_departments=[...E.value]:b.value.accessible_departments=b.value.accessible_departments.filter(s=>s!==$e))},jl=l=>{l===$e&&(b.value.accessible_departments=[...E.value])},Yl=l=>{l===$e&&(b.value.accessible_departments=[])},mt=_(!1),Pe=J(()=>{var e;let l=[...Z.value];if(Te.value&&(l=l.filter(s=>s.is_hod===1)),(e=we.value)!=null&&e.trim()){const s=we.value.toLowerCase();l=l.filter(o=>o.role.toLowerCase().includes(s))}return l.sort((s,o)=>s.role.localeCompare(o.role)),l.sort((s,o)=>{const r=$.value.includes(s.role),n=$.value.includes(o.role);return r===n?0:r?1:-1}),l.map(s=>s.role)}),Jl=J(()=>{const l=Pe.value;return l.length>0&&l.every(e=>$.value.includes(e))});Se([$,Pe],()=>{const l=Pe.value;mt.value=l.length>0&&l.every(e=>$.value.includes(e))},{immediate:!0,deep:!0});function Gl(l){const e=l.target.checked,s=Z.value.filter(o=>{var r;return!(Te.value&&o.is_hod!==1||(r=we.value)!=null&&r.trim()&&!o.role.toLowerCase().includes(we.value.toLowerCase()))}).map(o=>o.role);e?$.value=Array.from(new Set([...$.value,...s])):$.value=$.value.filter(o=>!s.includes(o)),mt.value=e}function Zl(){$.value=[],mt.value=!1,Te.value=!1}const pe=_("");function Kl(){const l=h[z.value];if(!l||!l.sections){console.error("Error: Invalid block or sections not found.");return}let e={type:z.value==0?"requestor":"approver",roles:$.value,approval_required:U.value,approver_can_edit:j.value,fields:l.sections.flatMap(_t),idx:z.value};z.value!==0&&(e.view_only_reportee=pe.value==="ViewOnlyReportee"?1:0,e.all_approvals_required=pe.value==="all_approvals_required"?1:0,e.requester_as_a_approver=pe.value==="requester_as_a_approver"?1:0,e.on_rejection=ve.value?ve.value:0);const s=I.findIndex(o=>o.idx===e.idx);s!==-1?I[s]=e:I.push(e),Xl()}function W(l){return I.find(e=>e.idx===l)||{roles:[]}}function Wl(l){const e=W(l),s=e.roles||[];$.value=[...s],ve.value=e.on_rejection,U.value=e.approval_required,j.value=e.approver_can_edit,e.view_only_reportee===1?pe.value="ViewOnlyReportee":e.all_approvals_required===1?pe.value="all_approvals_required":e.requester_as_a_approver===1?pe.value="requester_as_a_approver":pe.value=""}const vt=l=>{Te.value=!1,we.value="",pe.value="",ve.value="",b.value.accessible_departments.length&&Ql(l,b.value.accessible_departments),z.value=l,Wl(l)};function Ql(l,e){let s={index:l,departments:e,property:b.value.business_unit};te.post(le.addDesignationroles,s).then(o=>{o.message&&(Z.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function Xl(){te.post(le.add_roles_WF,{workflow_setup:I,doctype:b.value.form_short_name,business_unit:b.value.business_unit}).then(l=>{console.log(l),z.value==0?_e("Requestor Added"):_e(`Approver-${z.value} Added`)})}function xl(){y.push({path:ne.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function Il(){b.value.form_name="",b.value.form_short_name="",b.value.owner_of_the_form="",b.value.business_unit="",b.value.form_category="",b.value.accessible_departments=[]}const es=l=>{if(at.value){he("Please check all required fields before proceeding.");return}l<C.value?Ut():l>C.value&&Rt()},Rt=()=>{if(at.value){he("Please check all required fields before proceeding.");return}C.value<3&&(C.value+=1,C.value===3&&(it.value=h))},Ut=()=>{C.value>1&&(C.value-=1)},ts=_([]);function Mt(){const l={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:me.EzyFormDefinitions,doc_id:H.value};te.get(le.GetDoctypeData,{params:l}).then(e=>{var o;let s=e==null?void 0:e.message.data;if(s){s.accessible_departments&&(s.accessible_departments=s.accessible_departments.split(",")),b.value=ye(re(re({},b.value),s),{owner_of_the_form:s.owner_of_the_form||b.value.owner_of_the_form||""});const r=JSON.parse((o=e.message.data)==null?void 0:o.form_json);ce.value=r.workflow,xt.value=r.fields.filter(d=>d.fieldtype==="Table"),ts.value=r.fields.filter(d=>d.fieldtype==="Table"),Ae.value=e.message.data.is_landscape;let n=Gt(JSON.parse(s==null?void 0:s.form_json).fields);ie.value=JSON.parse(e.message.data.form_json).child_table_fields,wl.value=[],Xt.value=[],n.forEach((d,u)=>{h.push(d)}),JSON.parse(s==null?void 0:s.form_json).workflow.forEach((d,u)=>{I.push(d)})}}).catch(e=>{console.error("Error fetching  data:",e)})}function ls(){const l={};Ie.value&&(l.print_format=Ie.value),Ae.value!==void 0&&Ae.value!==null&&(l.is_landscape=Ae.value),te.put(le.resource+me.EzyFormDefinitions+`/${F.query.id}`,l).then(e=>{console.log(e),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),_e("Print Format Added Successfully")}).catch(e=>{console.error("Error fetching  data:",e)})}function Bt(){const l={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${ne.value.business_unit||F.query.business_unit}`,doctype:me.departments};te.get(le.GetDoctypeData,{params:l}).then(e=>{var s;(s=e==null?void 0:e.message.data)!=null&&s.length&&(G.value=e.message.data.map(o=>o.name),E.value=e.message.data.map(o=>o.name))}).catch(e=>{console.error("Error fetching department data:",e)})}_(""),Se(()=>b.value.owner_of_the_form,l=>{l&&ht(l)});function ht(l){l&&typeof l=="string"&&l.trim()!==""&&ss(l)}function ss(l){const e={fields:JSON.stringify(["ezy_departments_items"]),doctype:me.departments,doc_id:l};te.get(le.GetDoctypeData,{params:e}).then(s=>{var o;(o=s==null?void 0:s.message.data)!=null&&o.ezy_departments_items&&(q.value=s.message.data.ezy_departments_items.map(r=>r.category))}).catch(s=>{console.error("Error fetching categories data:",s)})}function bt(l){let e=Ps(h);const s=ye(re({},b.value),{fields:e,doctype:me.EzyFormDefinitions,workflow_setup:I,form_status:l==="save"?"Created":"Draft"});s.accessible_departments=s.accessible_departments.toString(),te.post(le.savedata,s).then(o=>{if(o&&o.message&&o.message.message){let r=localStorage.getItem("preName");if(r){let n={installed:"Yes"};te.put(`${le.resource}${me.preDefinedForm}/${r}`,n).then(d=>{localStorage.removeItem("preName")}).catch(d=>{console.error("Error fetching ezyForms data:",d)})}if(y.push({params:{paramid:o.message.message},query:{id:o.message.message}}),H.value=o.message.message,H&&H!=="new"&&(h.splice(0,h.length),Mt()),I.length<h.length)zs("Add Workflow");else if(Pt.value===!0){_e("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let n=localStorage.getItem("routepath");l==="save"?y.push({path:n}):l==="Draft"&&y.push({path:n})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const ot=_(""),Ot=()=>{var s,o;const l=h.length,e={label:l===0?"requestor":`approver-${l}`,parent:`${(s=qe.value)==null?void 0:s.value}-${(o=b.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${qe.value.value}-${b.value.form_short_name}`,childTables:[],afterCreated:{},rows:l===0?[{label:`row_0_0_${l}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${l}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${l}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};h.push(e),Os(()=>{ot.value&&ot.value.scrollTo({top:ot.value.scrollHeight,behavior:"smooth"})})},Pt=_(!1),zt=l=>{let e=h[l];e.parent&&V.push(e);let s=[];I.length>l&&I[l].roles&&(s=[...I[l].roles]),h.splice(l,1),I.length>l&&I.splice(l,1),h.forEach((o,r)=>{o.sections.forEach((n,d)=>{n.rows.forEach((u,v)=>{u.columns.forEach((c,p)=>{fe(r,d,v,p)})})})}),s.length&&os(s,l)};function os(l,e){const s={role:l,level:e,document_type:b.value.form_name,short_name:b.value.form_short_name,property:b.value.business_unit};te.post(le.deleteAssigneRoles,s).then(o=>{o&&bt()})}const as=(l,e)=>{const s={label:"",parent:`${qe.value.value}-${b.value.form_short_name}`,rows:[{label:`row_0_${e}_${l}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};h[l].sections.splice(e+1,0,s)},is=(l,e)=>{let s=h[l].sections[e];s.parent&&V.push(s),h[l].sections.splice(e,1),h[l].sections.forEach((o,r)=>{o.rows.forEach((n,d)=>{n.columns.forEach((u,v)=>{fe(l,r,d,v)})})})},ns=(l,e,s)=>{h[l].sections[e].rows[s].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},rs=(l,e,s,o)=>{const n=h[l].sections[e].rows[s].columns,d=n[o];d.parent&&V.push(d),n.length===1?h[l].sections[e].rows.splice(s,1):n.splice(o,1),h[l].sections.forEach((u,v)=>{u.rows.forEach((c,p)=>{c.columns.forEach((k,M)=>{fe(l,v,p,M)})})})},ds=(l,e,s,o)=>{h[l].sections[e].rows[s].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},cs=(l,e,s,o,r)=>{let n=h[l].sections[e].rows[s].columns[o].fields[r];n.parent&&V.push(n),h[l].sections[e].rows[s].columns[o].fields.splice(r,1)},us=(l,e,s,o,r)=>{const n=h[l].sections[e].rows[s].columns[o].fields[r],d=re({},n);d.name=`${n.name} Name the field`,h[l].sections[e].rows[s].columns[o].fields.splice(r+1,0,d)},ps=(l,e,s,o,r)=>{const n=Kt(h);h.splice(0,h.length,...n);let d=h[l].sections[e].rows[s].columns[o].fields[r].fieldtype;(d!=="Select"||d!=="radio"||d!=="multiselect")&&(h[l].sections[e].rows[s].columns[o].fields[r].options="")};function fs(l){return et.includes(l==null?void 0:l.trim().toLowerCase())}function ms(l){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(l)||l.includes('"')||l.includes("'")}function vs(l){return l.flatMap(e=>{var s;return[(s=e.label)==null?void 0:s.trim().toLowerCase(),...e.sections.flatMap(o=>{var r;return[(r=o.label)==null?void 0:r.trim().toLowerCase(),...o.rows.flatMap(n=>n.columns.flatMap(d=>{var u;return[(u=d.label)==null?void 0:u.trim().toLowerCase(),...d.fields.map(v=>{var c;return(c=v.label)==null?void 0:c.trim().toLowerCase()})]}))]})]}).filter(e=>e!==""&&!qt.includes(e))}function fe(l,e,s,o,r){const d=vs(h).filter((c,p,k)=>k.indexOf(c)!==p),u=Kt(h);h.splice(0,h.length,...u);function v(c,p){if(!c){p.errorMsg="";return}fs(c)?p.errorMsg="Entered label is restricted":ms(c)?p.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:c.length>64?p.errorMsg="Label should not exceed 64 characters":p.errorMsg=d.includes(c.trim().toLowerCase())?"Duplicate Label Name":""}r!==void 0&&v(h[l].sections[e].rows[s].columns[o].fields[r].label,h[l].sections[e].rows[s].columns[o].fields[r]),r===void 0&&o!==void 0&&v(h[l].sections[e].rows[s].columns[o].label,h[l].sections[e].rows[s].columns[o]),o===void 0&&r===void 0&&v(h[l].sections[e].label,h[l].sections[e]),h.forEach(c=>{c.sections.forEach(p=>{v(p.label,p),p.rows.forEach(k=>{k.columns.forEach(M=>{v(M.label,M),M.fields.forEach(w=>{v(w.label,w)})})})})})}const gt=J(()=>{function l(e){return!e||typeof e!="object"?!1:"fieldtype"in e&&e.fieldtype===""||"error"in e&&e.error||"errorMsg"in e&&e.errorMsg||["Select","Table MultiSelect"].includes(e.fieldtype)&&(!e.options||e.options.trim()==="")?!0:Array.isArray(e)?e.some(l):Object.values(e).some(l)}return l(h)}),at=J(()=>x.value.length>0||N.value.length>0||!b.value.form_category||!b.value.owner_of_the_form||b.value.accessible_departments.length===0),hs=J(()=>h.some(l=>l.sections.some(e=>e.rows.some(s=>s.columns.some(o=>o.fields.some(r=>r.label&&r.fieldtype))))));function Nt(l,e){let s=l.target.value.trim();if(!s){e==="form_name"?x.value="Input cannot be empty or only spaces":e==="form_short_name"&&(N.value="Input cannot be empty or only spaces");return}if(s.length>63){e==="form_name"?x.value="Name cannot exceed 63 characters":e==="form_short_name"&&(N.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(s)){e==="form_short_name"&&(N.value="First character must be a letter");return}else N.value="";if(e==="form_short_name"&&s.length<2){N.value="Short name must have at least 2 letters";return}if(e==="form_short_name"&&/[^a-zA-Z ]/.test(s)){N.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(s)){e==="form_name"?x.value="Special characters are not allowed":e==="form_short_name"&&(N.value="Special characters are not allowed");return}else e==="form_name"?x.value="":e==="form_short_name"&&(N.value="");const o=[[e,"=",`${s}`],["business_unit","=",`${b.value.business_unit}`]],r={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:me.EzyFormDefinitions};te.get(`${le.GetDoctypeData}`,{params:r}).then(n=>{K.value=n.message.data,e==="form_name"?x.value=s&&K.value.some(d=>d.form_name&&d.form_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":e==="form_short_name"&&(N.value=s&&K.value.some(d=>d.form_short_name&&d.form_short_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(n=>{console.error("Error fetching ezyForms data:",n),e==="form_name"?x.value="":e==="form_short_name"&&(N.value="")})}const bs=l=>l===0?"1st row":l===1?"2nd row":l===2?"3rd row":`${l+1}th row`,it=_([]),gs=()=>{h.length&&(it.value=h,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function ys(){te.post(le.delete_form_items,{deleted_fields:V.flatMap(_t),doctype:H}).then(l=>{var e;(e=l==null?void 0:l.message)!=null&&e.success&&bt()})}function Ht(l){return rt(this,null,function*(){if(gt.value){he("Please fix the errors before proceeding.");return}Pt.value=!0;let e=V.flatMap(_t);H!=null&&H!=null&&H!="new"&&e.length?ys():bt(l)})}const _s=l=>{console.log("Field added from library:",l);const e=Xe.value,s=h[e];if(!s){he("Please create a block first before adding fields");return}const o=ks(l);if(!o)return;s.sections||(s.sections=[]),s.sections.length===0&&s.sections.push({label:"",rows:[[{fields:[]}]]});const d=s.sections[0].rows[0][0];d.fields||(d.fields=[]),d.fields.push(o),console.log("Field added successfully:",o),_e(`${o.label} field added successfully`)},ws=l=>{console.log("Drag started:",l),It.value=l},ks=l=>{var n,d,u,v;const e=kt[l];if(!e)return console.error("Field type not found:",l),he("Field type not found"),null;const s=Date.now(),o=Math.random().toString(36).substring(2,6),r=`${l}_${s}_${o}`;return{id:`field_${s}_${o}`,fieldname:r,label:e.name,fieldtype:e.frappe_fieldtype,options:((n=e.defaultProps)==null?void 0:n.options)||"",reqd:(d=e.defaultProps)!=null&&d.required?1:0,read_only:0,hidden:0,description:e.description||"",default:((u=e.defaultProps)==null?void 0:u.default)||"",placeholder:((v=e.defaultProps)==null?void 0:v.placeholder)||""}};return(l,e)=>(a(),i("div",null,[t("div",Uo,[t("div",Mo,[t("div",Bo,[t("div",Oo,[t("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:e[0]||(e[0]=s=>xl())},e[37]||(e[37]=[t("button",{class:"btn font-13 ms-3"},[t("i",{class:"bi bi-arrow-left"}),t("span",{class:"ms-2"},"Back")],-1)])),l.$route.query.id||l.$route.query.preId?(a(),i("span",Po,"("+g(ne.value.formId||L(F).query.form_name)+")",1)):m("",!0)]),t("div",null,[C.value===2&&L(h).length&&!l.$route.query.id?(a(),i("button",{key:0,disabled:gt.value||at.value,style:Vs({cursor:gt.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:e[1]||(e[1]=s=>Ht("Draft"))},e[38]||(e[38]=[t("i",{class:"bi bi-bookmark-check-fill"},null,-1),P(" Save As Draft ")]),12,zo)):m("",!0)])]),t("div",No,[t("div",Ho,[t("div",jo,[t("div",Yo,[t("ul",Jo,[(a(!0),i(B,null,O(Bl.value,s=>(a(),i("li",{key:s.id,class:T({active:C.value===s.id,completed:C.value>s.id})},[t("div",{class:T(["d-flex gap-3 align-items-center",{"not-allowed":at.value&&C.value+1===s.id}]),onClick:o=>es(s.id)},[C.value>s.id?(a(),i("i",Zo)):(a(),i("i",{key:1,class:T(s.icon)},null,2)),t("div",Ko,[t("span",Wo,g(s.stepno),1),e[39]||(e[39]=t("br",null,null,-1)),t("span",Qo,g(s.label),1)])],10,Go)],2))),128))])])]),t("div",Xo,[t("div",xo,[t("div",Io,[C.value===1?(a(),i("div",ea,[t("div",ta,[t("div",la,[e[40]||(e[40]=t("div",null,null,-1)),e[41]||(e[41]=t("h1",{class:"font-14 fw-bold m-0"},"About Form",-1)),t("div",null,[!l.$route.query.id&&!l.$route.query.preId?(a(),i("button",{key:0,class:"btn btn-light font-12 mx-2",type:"button",onClick:Il},"Clear Form")):m("",!0),C.value<3?(a(),Ue(Zt,{key:1,class:"btn btn-dark bg-dark text-white fw-bold font-13",name:"Next",onClick:Rt})):m("",!0)])])]),t("div",sa,[t("div",oa,[e[55]||(e[55]=t("div",{class:"col-sm-none col-md-4"},null,-1)),t("div",aa,[t("div",ia,[t("div",na,[t("div",ra,[t("div",da,[L(F).query.preId?(a(),i("span",ca,e[42]||(e[42]=[P("Predefined "),t("i",{class:"bi bi-check2-circle"},null,-1)]))):m("",!0),ae(Ge,{disabled:(ne.value.formId&&ne.value.formId.length>0||L(F).query.form_name)&&De.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Untitled Form",onChange:e[2]||(e[2]=s=>Nt(s,"form_name")),modelValue:$t.value,"onUpdate:modelValue":e[3]||(e[3]=s=>$t.value=s)},null,8,["disabled","modelValue"]),x.value?(a(),i("span",ua,g(x.value),1)):m("",!0)])]),t("div",pa,[ae(Ge,{disabled:(ne.value.formId&&ne.value.formId.length>0||L(F).query.form_name)&&De.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Untitled Form",onChange:e[4]||(e[4]=s=>Nt(s,"form_short_name")),modelValue:b.value.form_short_name,"onUpdate:modelValue":e[5]||(e[5]=s=>b.value.form_short_name=s)},null,8,["disabled","modelValue"]),N.value?(a(),i("span",fa,g(N.value),1)):m("",!0)]),t("div",ma,[ae(Ge,{disabled:ne.value.formId&&ne.value.formId.length>0&&De.value!=="1",labeltext:"Form Naming series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Naming series",modelValue:b.value.series,"onUpdate:modelValue":e[6]||(e[6]=s=>b.value.series=s)},null,8,["disabled","modelValue"]),e[43]||(e[43]=Rs('<small class="text-muted" style="font-size:12px;" data-v-cbc05f4c> Note : Enter <code data-v-cbc05f4c>YY-YY</code>, <code data-v-cbc05f4c>YYYY</code>, or <code data-v-cbc05f4c>ABC</code>. The system will default to the format <code data-v-cbc05f4c> 24-25-0001</code>, <code data-v-cbc05f4c> 2025-0001</code>, or <code data-v-cbc05f4c> ABC-0001</code> respectively. </small>',1))]),t("div",va,[t("label",null,[e[44]||(e[44]=P("Owner Of The Form ")),b.value.owner_of_the_form?m("",!0):(a(),i("span",ha,"*"))]),ae(L(Ze),{disabled:ne.value.formId&&ne.value.formId.length>0&&De.value!=="1",onOpen:Bt,options:G.value,onChange:ht,modelValue:b.value.owner_of_the_form,"onUpdate:modelValue":e[7]||(e[7]=s=>b.value.owner_of_the_form=s),placeholder:"Select Department",multiple:!1,class:"font-11 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"])]),t("div",ba,[t("label",null,[e[45]||(e[45]=P("Form Category ")),b.value.form_category?m("",!0):(a(),i("span",ga,"*"))]),ae(L(Ze),{disabled:ne.value.formId&&ne.value.formId.length>0&&De.value!=="1",options:q.value,modelValue:b.value.form_category,"onUpdate:modelValue":e[8]||(e[8]=s=>b.value.form_category=s),placeholder:"Select Category",multiple:!1,searchable:!0,class:"font-11 multiselect"},null,8,["disabled","options","modelValue"])]),t("div",ya,[t("label",null,[e[46]||(e[46]=P("Accessible to Department ")),b.value.accessible_departments.length?m("",!0):(a(),i("span",_a,"*"))]),ae(L(Ze),{modelValue:b.value.accessible_departments,"onUpdate:modelValue":e[10]||(e[10]=s=>b.value.accessible_departments=s),options:Pl.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Department",class:"font-11",onSelect:jl,onRemove:Yl,openDirection:"bottom"},{option:wt(({option:s})=>[t("div",wa,[t("input",{type:"checkbox",checked:Nl(s),class:"custom-checkbox",onChange:o=>Hl(s,o),onClick:e[9]||(e[9]=de(()=>{},["stop"]))},null,40,ka),t("span",null,g(s),1)])]),selection:wt(({values:s,isOpen:o})=>[s.length?S((a(),i("span",{key:0,class:"multiselect__single font-10"},g(zl.value),513)),[[Re,!o]]):m("",!0)]),_:1},8,["modelValue","options"])]),t("div",Ca,[e[47]||(e[47]=t("label",null,"Form Type",-1)),ae(L(Ze),{options:Ft,modelValue:St.value,"onUpdate:modelValue":e[11]||(e[11]=s=>St.value=s),placeholder:"Select Form Type",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:s=>s.value,class:"font-11 multiselect",openDirection:"top"},null,8,["modelValue","reduce"]),e[48]||(e[48]=t("small",{class:"text-muted font-12 ms-2"},"Note: Public form is accessible by anyone through QR code.",-1))]),t("div",Da,[e[49]||(e[49]=t("label",null,[P("Has Workflow "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(L(Ze),{options:["Yes","No"],modelValue:b.value.has_workflow,"onUpdate:modelValue":e[12]||(e[12]=s=>b.value.has_workflow=s),placeholder:"Select",multiple:!1,class:"font-11 multiselect",searchable:!0},null,8,["modelValue"])]),b.value.as_web_view===1?(a(),i("div",Fa,[e[50]||(e[50]=t("label",null,[P("Form Submit Response "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(Ge,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit Response",modelValue:b.value.public_form_response,"onUpdate:modelValue":e[13]||(e[13]=s=>b.value.public_form_response=s)},null,8,["modelValue"])])):m("",!0),b.value.as_web_view===1?(a(),i("div",Sa,[e[51]||(e[51]=t("label",null,[P("Submit Notification Email "),t("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(Ge,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit mail",modelValue:b.value.mail_id,"onUpdate:modelValue":e[14]||(e[14]=s=>b.value.mail_id=s)},null,8,["modelValue"]),e[52]||(e[52]=t("small",{class:"text-muted font-12 ms-2"},"Note : If multiple Emails, separate with commas (,).",-1))])):m("",!0),L(F).query.preId?(a(),i("div",$a,[t("div",qa,[S(t("input",{class:"form-check-input linketoCheck p-1",disabled:b.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":e[15]||(e[15]=s=>b.value.is_linked=s),"true-value":1,"false-value":0},null,8,Aa),[[Ee,b.value.is_linked]]),e[53]||(e[53]=t("label",{class:"form-check-label font-12 mx-2 mb-0 ps-1",for:"is_linked"}," Link ",-1))])])):m("",!0),b.value.is_linked?(a(),i("div",Ta,[e[54]||(e[54]=t("label",{for:"standardFormInput"},"Form",-1)),S(t("input",{type:"text",class:"form-control standardFormInput",id:"standardFormInput",disabled:b.value.is_predefined_doctype==1,"onUpdate:modelValue":e[16]||(e[16]=s=>b.value.is_linked_form=s),placeholder:"Type to search Form Name...",onInput:ol,onFocus:e[17]||(e[17]=s=>We.value=!0),onBlur:il},null,40,La),[[Y,b.value.is_linked_form]]),We.value&&Ke.value.length?(a(),i("ul",Ea,[(a(!0),i(B,null,O(Ke.value,(s,o)=>(a(),i("li",{class:"list-group-item formlistitem",key:o,onMousedown:de(r=>al(s.name),["prevent"])},g(s.name),41,Va))),128))])):m("",!0)])):m("",!0)])])]),e[56]||(e[56]=t("div",{class:"col-sm-none col-md-4"},null,-1))])])])):m("",!0),C.value===2?(a(),i("div",Ra,[t("div",Ua,[t("div",Ma,[t("button",{onClick:e[18]||(e[18]=s=>Ut()),class:"btn btn-sm btn-light"},e[57]||(e[57]=[t("i",{class:"bi bi-chevron-left"},null,-1),P(" Back ")]))]),t("div",Ba,[(a(!0),i(B,null,O(L(h),(s,o)=>(a(),i("button",{key:o,class:T(["zoho-tab",{active:Xe.value===o}]),onClick:r=>Xe.value=o},[e[58]||(e[58]=t("i",{class:"bi bi-file-earmark-text me-1"},null,-1)),P(" "+g(o===0?"Requestor Block":`Approver Block ${o}`)+" ",1),L(h).length>1?(a(),i("i",{key:0,class:"bi bi-x-lg ms-2",onClick:de(r=>zt(o),["stop"])},null,8,Pa)):m("",!0)],10,Oa))),128)),t("button",{class:"zoho-tab zoho-tab-add",onClick:Ot},e[59]||(e[59]=[t("i",{class:"bi bi-plus-lg"},null,-1),P(" Add Block ")]))]),t("div",za,[hs.value?(a(),i("button",{key:0,class:"btn btn-sm btn-light me-2",onClick:gs},e[60]||(e[60]=[t("i",{class:"bi bi-eye me-1"},null,-1),P("Preview ")]))):m("",!0),L(h).length?(a(),i("button",{key:1,class:"btn btn-sm btn-dark",onClick:e[19]||(e[19]=s=>Ht("save"))},g(L(H)!=="new"?"Update Form":"Create Form"),1)):m("",!0)])]),t("div",Na,[t("aside",Ha,[t("div",ja,[e[61]||(e[61]=t("h6",{class:"mb-0"},"Field Types",-1)),t("button",{class:"btn btn-sm btn-link p-0",onClick:e[20]||(e[20]=s=>Qe.value=!Qe.value)},[t("i",{class:T(Qe.value?"bi bi-chevron-left":"bi bi-chevron-right")},null,2)])]),Qe.value?(a(),i("div",Ya,[ae(Ro,{collapsible:!1,onFieldAdd:_s,onFieldDragstart:ws})])):m("",!0)]),t("div",Ja,[t("div",{class:"canvas-inner",ref_key:"mainBlockRef",ref:ot},[ae(Us,{blockArr:it.value,formDescriptions:tl.value,childHeaders:ie.value},null,8,["blockArr","formDescriptions","childHeaders"]),(a(!0),i(B,null,O(L(h),(s,o)=>S((a(),i("div",{class:"block-level",key:o},[t("div",Ga,[t("div",Za,[t("div",Ka,[t("h6",Wa,g(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),t("div",Qa,[o!==0&&W(o).view_only_reportee||W(o).all_approvals_required||W(o).requester_as_a_approver?(a(),i("div",Xa,[t("span",xa,g(W(o).view_only_reportee===1?"Reporting Manager only":"")+" "+g(W(o).all_approvals_required===1?"All of the selected approvers":"")+" "+g(W(o).requester_as_a_approver===1?"Approval by Requestor":""),1),t("span",null,[e[62]||(e[62]=t("span",{class:"ms-1"}," on rejection escalating to ",-1)),t("span",Ia,g(W(o).on_rejection?`Level ${W(o).on_rejection}`:"Requestor"),1)]),t("span",ei,g(W(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):m("",!0)])]),t("div",ti,[L(H)&&L(I).length?(a(),i("div",li,[W(o)?(a(),i("label",si,[t("span",oi,g(W(o).roles.length>0?o===0?"Requestor: ":"Approver: ":""),1),t("span",ai,g(W(o).roles.slice(0,2).join(", ")),1),W(o).roles.length>2?(a(),i("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:r=>vt(o),class:"more-count"}," +"+g(W(o).roles.length-2)+" more ",9,ii)):m("",!0)])):m("",!0)])):m("",!0),ll(o)&&L(H)!=null&&L(H)!=null&&L(H)!="new"&&W(o).roles.length===0?(a(),i("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:r=>vt(o)},[e[63]||(e[63]=t("img",{src:Ns,alt:"Add",class:"me-1"},null,-1)),P(" "+g(o===0?"Add Requestors":"Add Approvers"),1)],8,ni)):m("",!0),L(H)!=null&&L(H)!=null&&L(H)!="new"&&W(o).roles.length>0?(a(),i("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:r=>vt(o)},e[64]||(e[64]=[t("i",{class:"bi bi-pencil font-14"},null,-1)]),8,ri)):m("",!0),t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:r=>zt(o)},e[65]||(e[65]=[t("i",{class:"bi bi-trash me-1"},null,-1),P(" Delete Block ")]),8,di)])])]),t("div",ci,[(a(!0),i(B,null,O(s.sections,(r,n)=>(a(),i("div",{key:"section-"+n,class:"dynamicSection mt-0 section"},[t("section",ui,[t("div",pi,[S(t("input",{"onUpdate:modelValue":d=>r.label=d,type:"text",class:T(["border-less-input","font-14",{"italic-style":!r.label},{"fw-medium":r.label}]),onChange:d=>fe(o,n),onInput:d=>fe(o,n),placeholder:"Untitled section"},null,42,fi),[[Y,r.label]]),r.errorMsg?(a(),i("small",mi,g(r.errorMsg),1)):m("",!0)]),t("div",vi,[t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:d=>is(o,n)},e[66]||(e[66]=[t("i",{class:"bi bi-trash me-1"},null,-1),P(" Delete Section ")]),8,hi)])]),t("div",bi,[(a(!0),i(B,null,O(r.rows,(d,u)=>(a(),i("section",{class:"row dynamicRow row-container",key:"row-"+u},[t("div",gi,[t("label",yi,g(bs(u)),1),t("div",null,[d.columns.length<3?(a(),i("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:v=>ns(o,n,u)},e[67]||(e[67]=[t("i",{class:"bi bi-plus font-14"},null,-1),P(" Add Column ")]),8,_i)):m("",!0)])]),t("div",wi,[t("div",ki,[(a(!0),i(B,null,O(d.columns,(v,c)=>(a(),i("div",{key:"column-"+c,onMouseenter:p=>ml(o,n,u,c),onMouseleave:vl,class:"col p-0 dynamicColumn position-relative column-container"},[t("div",Di,[t("div",Fi,[S(t("input",{"onUpdate:modelValue":p=>v.label=p,type:"text",class:T(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!v.label},{"fw-medium":v.label}]),onChange:p=>fe(o,n,u,c),onInput:p=>fe(o,n,u,c),placeholder:"Column Name"},null,42,Si),[[Y,v.label]]),v.errorMsg?(a(),i("small",$i,g(v.errorMsg),1)):m("",!0)]),S(t("div",qi,[t("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:p=>rs(o,n,u,c)},e[68]||(e[68]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Ai)],512),[[Re,hl(o,n,u,c)]])]),v.fields.length===0?(a(),i("div",{key:0,class:"empty-drop-zone",onDragover:e[21]||(e[21]=de(()=>{},["prevent"])),onDrop:p=>ke(p,o,n,u,c,l.fieldIndex)},null,40,Ti)):m("",!0),(a(!0),i(B,null,O(v.fields,(p,k)=>{var M;return a(),i("div",{key:"field-"+k,onMouseenter:w=>ul(o,n,u,c,k),onMouseleave:pl,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:w=>At(w,o,n,u,c,k),onDragover:e[25]||(e[25]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},[t("div",{class:"drop-zone",onDragover:e[22]||(e[22]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},null,40,Ei),p.fieldtype!=="Table"?(a(),i("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:w=>At(w,o,n,u,c,k),onDragover:e[23]||(e[23]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},[t("div",Ri,[t("div",Ui,[S(t("input",{"onUpdate:modelValue":w=>p.label=w,placeholder:"Name the field",class:T(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!p.label},{"fw-medium":p.label}]),onChange:w=>fe(o,n,u,c,k),onInput:w=>fe(o,n,u,c,k)},null,42,Mi),[[Y,p.label]]),p.errorMsg?(a(),i("small",Bi,g(p.errorMsg),1)):m("",!0)]),S(t("div",Oi,[t("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:w=>us(o,n,u,c,k)},e[69]||(e[69]=[t("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,Pi),t("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:w=>{cs(o,n,u,c,k),fe(o,n,u,c)}},e[70]||(e[70]=[t("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,zi)],512),[[Re,fl(o,n,u,c,k)]])]),S(t("select",{"onUpdate:modelValue":w=>p.fieldtype=w,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:w=>ps(o,n,u,c,k)},[e[71]||(e[71]=t("option",{value:""},"Select Type",-1)),(a(),i(B,null,O(Ol,w=>t("option",{key:w,value:w.type},g(w.label),9,Hi)),64))],40,Ni),[[Ve,p.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(p.fieldtype)?(a(),i("div",ji,[e[72]||(e[72]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":w=>p.options=w,class:"form-control shadow-none mb-1 font-12"},null,8,Yi),[[Y,p.options]]),!p.options||p.options.trim()===""?(a(),i("small",Ji," Options are required for this field type. ")):m("",!0)])):m("",!0),p.fieldtype==="Link"?(a(),i("div",Gi,[t("label",{class:"font-11 fw-light",for:"link-search-"+be(o,n,u,c,k)}," Search Doctype: ",8,Zi),S(t("input",{id:"link-search-"+be(o,n,u,c,k),type:"text","onUpdate:modelValue":w=>L(h)[o].sections[n].rows[u].columns[c].fields[k].options=w,onInput:w=>rl(L(h)[o].sections[n].rows[u].columns[c].fields[k].options,o,n,u,c,k),onFocus:w=>nl(be(o,n,u,c,k)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,Ki),[[Y,L(h)[o].sections[n].rows[u].columns[c].fields[k].options]]),(M=Be[be(o,n,u,c,k)])!=null&&M.length&&ut[be(o,n,u,c,k)]?(a(),i("ul",Wi,[(a(!0),i(B,null,O(Be[be(o,n,u,c,k)],(w,D)=>(a(),i("li",{key:D,onClick:A=>dl(o,n,u,c,k,w.name),class:"list-group-item list-group-item-action"},g(w.name),9,Qi))),128))])):m("",!0)])):m("",!0),t("div",Xi,[t("div",xi,[t("div",Ii,[S(t("input",{class:"font-12","onUpdate:modelValue":w=>p.reqd=w,"true-value":1,id:"mandatory-"+o+"-"+n+"-"+u+"-"+c+"-"+k,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,en),[[Ee,p.reqd]])]),t("div",null,[t("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+n+"-"+u+"-"+c+"-"+k},"Mandatory",8,tn)])]),t("div",null,[t("button",{class:"btn btn-sm font-12",onClick:w=>p.showDescription=!p.showDescription},g(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,ln)])]),p.showDescription?S((a(),i("textarea",{key:2,"onUpdate:modelValue":w=>p.description=w,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,sn)),[[Y,p.description]]):m("",!0),p.error?(a(),i("small",on,g(p.error),1)):m("",!0)],40,Vi)):m("",!0),t("div",{class:"drop-zone",onDragover:e[24]||(e[24]=de(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},null,40,an),t("div",nn,[t("div",null,[t("div",null,[t("div",rn,[p.fieldtype==="Table"?(a(),i("div",dn,[(a(!0),i(B,null,O(ie.value,(w,D)=>(a(),i("div",{key:D,class:"childTable"},[D===p.fieldname||D===p.options?(a(),i("h5",cn,g(D.replace(/_/g," ")),1)):m("",!0),Q[D]&&D===Et.value?(a(),i("div",un,[t("div",pn,[p.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":A=>p.description=A,class:"form-control font-12",placeholder:"Enter field description"},null,8,fn)),[[Y,p.description]]):m("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:A=>p.showDescription=!p.showDescription},g(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,mn)])])):m("",!0),D===p.options||D===p.fieldname?(a(),i("table",vn,[e[76]||(e[76]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Label"),t("th",null,"Field Type")])],-1)),t("tbody",{onDragover:de(yl,["prevent"]),onDrop:A=>_l(A,w)},[(a(!0),i(B,null,O(w,(A,se)=>{var ze,Ne,He,je,Ye,Je,oe;return a(),i("tr",{key:se,draggable:Q[D],onDragstart:X=>bl(se),onDragend:gl,class:T({dragging:Fe.value===se})},[t("td",null,g(se+1),1),Q[D]?(a(),i("td",gn,[S(t("input",{"onUpdate:modelValue":X=>A.label=X,onInput:X=>st(A,D,se),placeholder:"Field Label",class:T(["form-control",{"border-1 border-danger":(Ne=(ze=R[D])==null?void 0:ze[se])==null?void 0:Ne.length}])},null,42,yn),[[Y,A.label]]),(je=(He=R[D])==null?void 0:He[se])!=null&&je.length?(a(),i("div",_n,[(a(!0),i(B,null,O(R[D][se],(X,Cs)=>(a(),i("div",{key:Cs},g(X),1))),128))])):m("",!0)])):(a(),i("td",wn,g(A.label),1)),Q[D]?(a(),i("td",kn,[t("div",Cn,[S(t("select",{"onUpdate:modelValue":X=>A.fieldtype=X,onChange:X=>st(A,D,se),class:T(["form-select form-select-sm",{"border-1 border-danger":(Je=(Ye=R[D])==null?void 0:Ye[se])==null?void 0:Je.length}])},[e[73]||(e[73]=t("option",{value:""},"Select Type",-1)),(a(),i(B,null,O(ft,X=>t("option",{key:X.type,value:X.type},g(X.label),9,Fn)),64))],42,Dn),[[Ve,A.fieldtype]]),t("div",Sn,[t("div",$n,[t("div",qn,[S(t("input",{class:"font-12 form-control-sm","onUpdate:modelValue":X=>A.description=X,placeholder:"description",type:"text"},null,8,An),[[Y,A.description]])])]),t("button",{class:"btn btn-light btn-sm",onClick:X=>Ul(D,se)},e[74]||(e[74]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Tn)])]),["Select"].includes(A.fieldtype)?(a(),i("div",Ln,[e[75]||(e[75]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":X=>A.options=X,onInput:X=>st(A,D,se),class:"form-control shadow-none mb-1 font-12"},null,40,En),[[Y,A.options]]),!A.options||A.options.trim()===""?(a(),i("small",Vn," Options are required for this field type. ")):m("",!0)])):m("",!0),(oe=ee[D])!=null&&oe.includes(se)?(a(),i("span",Rn,"Type required**")):m("",!0)])):(a(),i("td",Un,g(A.fieldtype),1))],42,bn)}),128))],40,hn)])):m("",!0),p.fieldtype==="Table"&&(p.label===D||p.fieldname===D)?(a(),i("div",Mn,[t("button",{class:"btn btn-light btn-sm mx-2",onClick:A=>Ml(D,p.description)},g(Q[D]?"Save":"Edit"),9,Bn),Q[D]?(a(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:A=>Rl(D)}," Add More Field ",8,On)):m("",!0)])):m("",!0)]))),128))])):m("",!0)])])])])],40,Li)}),128)),t("div",{class:"drop-zone-bottom",onDragover:e[26]||(e[26]=de(()=>{},["prevent"])),onDrop:p=>ke(p,o,n,u,c,v.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,Pn),t("div",{class:"drop-zone",onDragover:e[27]||(e[27]=de(()=>{},["prevent"])),onDrop:p=>ke(p,o,n,u,c,l.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,zn),t("div",Nn,[t("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:p=>ds(o,n,u,c)},e[77]||(e[77]=[t("i",{class:"bi bi-plus fs-5"},null,-1),t("span",null,"Add Field",-1)]),8,Hn)])],40,Ci))),128))])])]))),128)),t("div",null,[(a(!0),i(B,null,O(r.afterCreated,(d,u)=>(a(),i("div",{key:u,class:"childTable dynamicColumn m-0 p-2"},[t("h5",jn,g(d.tableName),1),Q[d.tableName]?(a(),i("div",Yn,[t("div",Jn,[d.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":v=>d.description=v,class:"form-control font-12",placeholder:"Enter field description"},null,8,Gn)),[[Y,d.description]]):m("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:v=>d.showDescription=!d.showDescription},g(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,Zn)])])):m("",!0),t("table",Kn,[e[83]||(e[83]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Label"),t("th",null,"Field Type")])],-1)),t("tbody",null,[(a(!0),i(B,null,O(d.columns,(v,c)=>{var p,k,M,w;return a(),i("tr",{key:c},[t("td",null,g(c+1),1),Q[d.tableName]?(a(),i("td",Wn,[S(t("input",{"onUpdate:modelValue":D=>v.label=D,placeholder:"Field Label",class:T(["form-control",{"border-1 border-danger":(p=ee[d.tableName])==null?void 0:p.includes(c)}]),onBlur:D=>{var A;v.label=(A=v.label)==null?void 0:A.trim(),Oe(v,d.tableName,c,d.columns)}},null,42,Qn),[[Y,v.label]]),(k=R[d.tableName])!=null&&k[c]?(a(),i("div",Xn,[(a(!0),i(B,null,O(R[d.tableName][c],(D,A)=>(a(),i("span",{key:A},[P(g(D)+" ",1),e[78]||(e[78]=t("br",null,null,-1))]))),128))])):m("",!0)])):(a(),i("td",xn,g(v.label),1)),Q[d.tableName]?(a(),i("td",In,[t("div",er,[S(t("select",{"onUpdate:modelValue":D=>v.fieldtype=D,class:T(["form-select form-select-sm",{"border-1 border-danger":(M=ee[d.tableName])==null?void 0:M.includes(c)}]),onChange:D=>Oe(v,d.tableName,c,d.columns)},[e[79]||(e[79]=t("option",{value:""},"Select Type",-1)),(a(),i(B,null,O(ft,D=>t("option",{key:D.type,value:D.type},g(D.label),9,lr)),64))],42,tr),[[Ve,v.fieldtype]]),t("button",{class:"btn btn-light btn-sm",onClick:D=>El(o,n,d.tableName,c)},e[80]||(e[80]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,sr)]),v.fieldtype==="Select"?(a(),i("div",or,[e[81]||(e[81]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":D=>v.options=D,class:"form-control shadow-none mb-1 font-12",onInput:D=>Oe(v,d.tableName,c,d.columns)},null,40,ar),[[Y,v.options]])])):m("",!0),(w=R[d.tableName])!=null&&w[c]?(a(),i("div",ir,[(a(!0),i(B,null,O(R[d.tableName][c],(D,A)=>(a(),i("span",{key:A},[P(g(D),1),e[82]||(e[82]=t("br",null,null,-1))]))),128))])):m("",!0)])):(a(),i("td",nr,g(v.fieldtype),1))])}),128))])]),t("div",rr,[t("button",{class:"btn btn-light btn-sm mx-2",onClick:v=>Vl(o,n,d.tableName)},g(Q[d.tableName]?"Save":"Edit"),9,dr),Q[d.tableName]?(a(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:v=>Ll(o,n,d.tableName)}," Add More Field ",8,cr)):m("",!0)])]))),128))])]),t("div",null,[t("div",null,[o==0?(a(),i("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:d=>kl(o,n)}," Add New Table ",8,ur)):m("",!0),(a(!0),i(B,null,O(r.childTables,(d,u)=>{var v;return a(),i("div",{key:`table-${o}-${n}-${u}`,class:"child-table"},[d.newTable?(a(),i("div",pr,[t("div",fr,[t("div",null,[t("span",{class:T(d.tableName?"d-none":"text-danger")},"*",2),S(t("input",{"onUpdate:modelValue":c=>d.tableName=c,placeholder:"Table Name",onBlur:c=>Tt(d),class:T(["border-less-input font-14 p-0 inputHeight",{"italic-style":!d.tableName,"fw-medium":d.tableName}])},null,42,mr),[[Y,d.tableName]]),(v=R[`${o}-${n}-${u}`])!=null&&v.tableName?(a(),i("div",vr,g(R[`${o}-${n}-${u}`].tableName),1)):m("",!0),Le.value?(a(),i("div",hr,g(Le.value),1)):m("",!0),t("div",br,[t("div",gr,[d.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":c=>d.as_a_block=c,class:"form-control font-12",placeholder:"Enter field description"},null,8,yr)),[[Y,d.as_a_block]]):m("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:c=>d.showDescription=!d.showDescription},g(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,_r)])])]),t("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:c=>Dl(o,n,u)},e[84]||(e[84]=[t("i",{class:"bi bi-trash"},null,-1),P(" Remove Table ")]),8,wr)]),(a(!0),i(B,null,O(d.columns,(c,p)=>{var k,M,w,D,A,se,ze,Ne,He,je,Ye,Je;return a(),i("div",{key:p,class:"dynamicField"},[t("div",kr,[t("div",Cr,[t("div",null,[t("span",{class:T(c.label?"d-none":"text-danger")},"*",2),S(t("input",{"onUpdate:modelValue":oe=>c.label=oe,placeholder:"Name the field",onBlur:()=>{Tt(c),Sl(c,o,n,u,p,d.columns)},class:T(["border-less-input font-14 p-0 inputHeight",{"italic-style":!c.label,"fw-medium":c.label,"is-invalid":(w=(M=(k=R[`${o}-${n}-${u}`])==null?void 0:k.columns)==null?void 0:M[p])==null?void 0:w.label}])},null,42,Dr),[[Y,c.label]]),(se=(A=(D=R[`${o}-${n}-${u}`])==null?void 0:D.columns)==null?void 0:A[p])!=null&&se.label?(a(),i("div",Fr,g(R[`${o}-${n}-${u}`].columns[p].label),1)):m("",!0)]),t("div",Sr,[t("div",$r,[c.showDescription?S((a(),i("input",{key:0,"onUpdate:modelValue":oe=>c.description=oe,class:"form-control font-12",placeholder:"Enter field description"},null,8,qr)),[[Y,c.description]]):m("",!0),t("button",{class:"btn btn-sm text-nowrap font-12",onClick:oe=>c.showDescription=!c.showDescription},g(c.showDescription?"Hide Description":c.description?"Edit Description":"Add Description"),9,Ar)]),t("button",{class:"btn btn-sm trash-btn py-0",onClick:oe=>Fl(o,n,u,p)},e[85]||(e[85]=[t("i",{class:"bi bi-x-lg"},null,-1)]),8,Tr)])]),S(t("select",{"onUpdate:modelValue":oe=>c.fieldtype=oe,class:T(["form-select font-13 mb-1",{"is-invalid":(He=(Ne=(ze=R[`${o}-${n}-${u}`])==null?void 0:ze.columns)==null?void 0:Ne[p])==null?void 0:He.fieldtype}])},[e[86]||(e[86]=t("option",{value:""},"Select Type",-1)),(a(),i(B,null,O(ft,oe=>t("option",{key:oe.type,value:oe.type},g(oe.label),9,Er)),64))],10,Lr),[[Ve,c.fieldtype]]),["Select"].includes(c.fieldtype)?(a(),i("div",Vr,[e[87]||(e[87]=t("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),S(t("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":oe=>c.options=oe,class:"form-control shadow-none mb-1 font-12"},null,8,Rr),[[Y,c.options]]),!c.options||c.options.trim()===""?(a(),i("small",Ur," Options are required for this field type. ")):m("",!0)])):m("",!0),(Je=(Ye=(je=R[`${o}-${n}-${u}`])==null?void 0:je.columns)==null?void 0:Ye[p])!=null&&Je.fieldtype?(a(),i("div",Mr,g(R[`${o}-${n}-${u}`].columns[p].fieldtype),1)):m("",!0)])])}),128)),t("button",{class:"btn btn-light btn-sm addField mx-1",onClick:c=>Cl(o,n,u)},e[88]||(e[88]=[t("i",{class:"bi bi-plus"},null,-1),P(" Add Field ")]),8,Br),t("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:c=>Tl(o,n,u)}," Create Table ",8,Or),e[89]||(e[89]=t("hr",null,null,-1))])):m("",!0)])}),128))])]),t("div",Pr,[t("button",{class:"btn btn-light border font-12",onClick:d=>as(o,n)},e[90]||(e[90]=[t("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),P(" Add Section ")]),8,zr)])]))),128)),o===0?(a(),i("div",Nr)):m("",!0)])])),[[Re,o===Xe.value]])),128)),t("div",{class:T(["d-flex justify-content-center align-items-center add-block-btn-div py-4  ",{"background-color-white":L(h).length}])},[t("button",{class:"btn btn-light border d-flex align-items-center font-12",onClick:Ot},[e[91]||(e[91]=t("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1)),P(" "+g(L(h).length===0?"Add Requestor Block":"Add Approval Block"),1)])],2)],512)]),Dt.value?(a(),i("aside",Hr,[t("div",jr,[e[93]||(e[93]=t("h6",{class:"mb-0"},"Field Properties",-1)),t("button",{class:"btn btn-sm btn-link p-0",onClick:e[28]||(e[28]=s=>Dt.value=null)},e[92]||(e[92]=[t("i",{class:"bi bi-x-lg"},null,-1)]))]),e[94]||(e[94]=t("div",{class:"properties-content"},[t("p",{class:"text-muted small"},"Select a field to edit its properties")],-1))])):m("",!0)])])):m("",!0),C.value===3?(a(),i("div",Yr,[e[95]||(e[95]=t("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[t("div",null,[t("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),t("div")],-1)),ae(Ms,{blockArr:it.value},null,8,["blockArr"])])):m("",!0)])])])])])])]),t("div",Jr,[t("div",Gr,[t("div",Zr,[e[99]||(e[99]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Kr,[e[97]||(e[97]=t("label",{for:""},"Form Name",-1)),S(t("input",{"onUpdate:modelValue":e[29]||(e[29]=s=>Ie.value=s),multiple:!1,placeholder:L(F).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,Wr),[[Y,Ie.value]]),t("div",Qr,[t("div",Xr,[S(t("input",{class:"font-12","onUpdate:modelValue":e[30]||(e[30]=s=>Ae.value=s),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[Ee,Ae.value]])]),e[96]||(e[96]=t("div",null,[t("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),t("div",{class:"modal-footer"},[e[98]||(e[98]=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),t("button",{type:"button",class:"btn btn-dark",onClick:ls},"Add Print Format")])])])]),t("div",xr,[t("div",Ir,[t("span",ed,g(z.value==0?"Add designation for Requestors":`Approval Settings For
          Level-${z.value}`),1),e[100]||(e[100]=t("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),t("div",td,[t("div",ld,[t("div",sd,[z.value!==0?(a(),i("div",od,[z.value!==0?(a(),i("div",ad,[e[102]||(e[102]=t("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),S(t("select",{"onUpdate:modelValue":e[31]||(e[31]=s=>pe.value=s),class:"form-select shadow-none font-12"},e[101]||(e[101]=[t("option",{value:""},"Any one of the selected approvers",-1),t("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),t("option",{value:"all_approvals_required"},"All of the selected approvers",-1),t("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[Ve,pe.value]])])):m("",!0)])):m("",!0)])]),t("div",id,[t("div",nd,[t("span",rd," Select "+g(z.value===0?"Requestors":"Approvers"),1),t("span",dd,g($.value.length)+" Selected ",1)]),Z.value.length?(a(),i("div",cd,[t("div",ud,[t("div",pd,[t("input",{type:"checkbox",id:"selectAll",checked:Jl.value,onChange:Gl,class:"form-check-input me-2 designationCheckBox"},null,40,fd),t("label",md," Select all designation ("+g(Pe.value.length)+") ",1)]),z.value!==0?(a(),i("div",vd,[S(t("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":e[32]||(e[32]=s=>Te.value=s),class:"form-check-input me-2 designationCheckBox"},null,512),[[Ee,Te.value]]),e[103]||(e[103]=t("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):m("",!0),t("div",null,[$.value.length?(a(),i("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:Zl},e[104]||(e[104]=[t("i",{class:"bi bi-x"},null,-1),P(" Clear all ")]))):m("",!0)])]),Z.value.length?(a(),Ue(L(Bs),{key:0,multiple:!0,modelValue:$.value,"onUpdate:modelValue":e[33]||(e[33]=s=>$.value=s),options:Pe.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):m("",!0)],512)):(a(),i("div",hd,e[105]||(e[105]=[t("div",{class:"d-flex justify-content-center"},[t("span",null,"No Designations Found")],-1)])))]),z.value!==0?(a(),i("div",bd,[e[106]||(e[106]=t("div",null,[t("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),S(t("select",{"onUpdate:modelValue":e[34]||(e[34]=s=>ve.value=s),class:"form-select shadow-none font-12 mt-1 me-2"},[(a(!0),i(B,null,O(cl.value,s=>(a(),i("option",{key:s,value:s},g(s===0?"Requestor":"Approver Level "+s),9,gd))),128))],512),[[Ve,ve.value,void 0,{number:!0}]])])):m("",!0),z.value!==0?(a(),i("div",yd,[t("div",_d,[t("div",wd,[S(t("input",{"onUpdate:modelValue":e[35]||(e[35]=s=>U.value=s),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Ee,U.value]]),e[107]||(e[107]=t("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),ct.value===!0?(a(),i("div",kd,[S(t("input",{"onUpdate:modelValue":e[36]||(e[36]=s=>j.value=s),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Ee,j.value]]),e[108]||(e[108]=t("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):m("",!0)])])):m("",!0)]),t("div",Cd,[t("div",Dd,[t("div",null,[ae(Zt,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:Kl,name:z.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},qd=Me(Fd,[["__scopeId","data-v-cbc05f4c"]]);export{qd as default};
