import{q as R,d as n,I as T,e as C,u as q,D as O,f as U,w as V,o as B,c as I,b as l,t as J,a as h,_ as j,P as H,L as M,E as G,l as g,m as y,p as v,k as K}from"./index-DXneRfP_.js";const Q={class:"d-flex formsticky align-items-center justify-content-between py-2"},W={class:"m-0 font-11 pt-1"},X={class:"mt-2"},Y={__name:"DraftComp",setup(Z){const m=n(0),P=n({}),r=n([]);n([]);const S=n([]),f=T(),$=n(null),d=C(()=>G.value),_=q();O([]),U(()=>{});function w(e,t){t.name==="View form"&&(e!=null&&e.form_json?f.push({name:"FormPreviewComp",query:{routepath:_.path,form_short_name:e.form_short_name}}):(console.warn(" There is no form fields "),F(e))),t.name==="Edit Form"&&F(e)}const x=n([{name:"View form",icon:"fa-solid fa-eye"},{name:"Edit Form",icon:"fa-solid fa-edit"}]),s=n({limit_start:0,limitPageLength:20,form_name:"",form_short_name:"",accessible_departments:"[]",business_unit:"",form_category:"",owner_of_the_form:"",search:""});V(d,e=>{s.value.business_unit=e,e.length&&(r.value=[],u())},{immediate:!0});const b=n([{th:"Name",td_key:"name"},{th:"Form name",td_key:"form_name"},{th:"Form category",td_key:"form_category"},{th:"Owner of form",td_key:"owner_of_the_form"},{th:"Accessible departments",td_key:"accessible_departments"},{th:"Status",td_key:"form_status"},{th:"Enable/Disable",td_key:"enable"}]);function F(e=null){e==null?f.push({query:{routepath:_.path,business_unit:d.value},name:"FormStepper"}):f.push({query:{routepath:_.path,business_unit:d.value,id:e.name},name:"FormStepper",params:{paramid:e.name}})}const L=e=>{s.value.limitPageLength=e,s.value.limit_start=0,u()},D=([e,t])=>{s.value.limitPageLength=e,s.value.limit_start=t,u()};function N(e,t,c){const a=e.enable=="1"||e.enable===1,o=a?"Disable":"Enable";confirm(`Are you sure you want to ${o}  ${e.name} Form?`)&&(e.enable=a?0:1,g.put(`${y.resource}${v.EzyFormDefinitions}/${e.name}`,e).then(i=>{K.success(`Form ${o}d successfully`,{autoClose:700}),window.location.reload()}).catch(i=>{console.error("Error updating toggle:",i)}))}const k=n(null);function z(e){clearTimeout(k.value),k.value=setTimeout(()=>{const t=[];b.value.forEach(c=>{const a=c.td_key;e[a]&&t.push(a,"like",`%${e[a]}%`)}),u(t.length?t:void 0)},500)}const E=n([]);function u(e){const t=[["business_unit","like",`%${s.value.business_unit}%`],["form_status","=","Draft"],["enable","=",1]];e&&t.push(e);const c={fields:JSON.stringify(["*"]),filters:JSON.stringify(t),limit_page_length:s.value.limitPageLength,limit_start:s.value.limit_start,order_by:"`tabEzy Form Definitions`.`creation` desc"},a={fields:JSON.stringify(["count(name) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(t)};g.get(`${y.resource}${v.EzyFormDefinitions}`,{params:a}).then(o=>{m.value=o.data[0].total_count}).catch(o=>{console.error("Error fetching ezyForms data:",o)}),g.get(`${y.resource}${v.EzyFormDefinitions}`,{params:c}).then(o=>{const i=o.data;s.value.limit_start===0?(r.value=i,E.value=[...new Set(i.map(p=>p.form_category))],S.value=[...new Set(i.map(p=>p.owner_of_the_form))]):r.value=r.value.concat(i)}).catch(o=>{console.error("Error fetching ezyForms data:",o)})}const A=C(()=>({form_category:{type:"select",options:E.value},form_name:{type:"input"},owner_of_the_form:{type:"input"}}));return(e,t)=>(B(),I("div",null,[l("div",Q,[l("div",null,[t[0]||(t[0]=l("h1",{class:"m-0 font-13"},"Forms in Draft",-1)),l("p",W,J(m.value)+" forms available",1)]),t[1]||(t[1]=l("div",{class:"d-flex align-items-center gap-2"},null,-1))]),l("div",X,[h(j,{tHeaders:b.value,tData:r.value,isAction:"true",actionType:"dropdown",enableDisable:"true",onActionClicked:w,isFiltersoption:"true","field-mapping":A.value,actions:x.value,onToggleClick:N,onUpdateFilters:z,isCheckbox:"true"},null,8,["tHeaders","tData","field-mapping","actions"]),h(H,{currentRecords:r.value.length,totalRecords:m.value,onUpdateValue:L,onLimitStart:D},null,8,["currentRecords","totalRecords"])]),h(M,{blockArr:$.value,formDescriptions:P.value},null,8,["blockArr","formDescriptions"])]))}},te=R(Y,[["__scopeId","data-v-b92ff923"]]);export{te as default};
