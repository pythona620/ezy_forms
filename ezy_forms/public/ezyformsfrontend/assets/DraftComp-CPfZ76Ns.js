var J=Object.defineProperty;var $=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var N=(f,l,n)=>l in f?J(f,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):f[l]=n,O=(f,l)=>{for(var n in l||(l={}))H.call(l,n)&&N(f,n,l[n]);if($)for(var n of $(l))G.call(l,n)&&N(f,n,l[n]);return f};import{p as K,d as m,f as E,e as A,q as Q,w as W,C as X,o as r,c as i,b as o,t as _,g as b,h as d,a as p,_ as Y,P as Z,F as y,E as ee,j as te,l as B,m as U,n as L}from"./index-B-ZWE6ER.js";import{F as oe}from"./FormPreview-BWxa4xB1.js";const se={class:"d-flex justify-content-between align-items-center formsticky"},ae={class:"m-0 font-11 pt-1"},le={class:"d-flex gap-2 align-items-center"},ne={class:"me-2"},re={key:0,class:"process-date font-12 m-0"},ie={key:1,class:"process-date font-12 m-0"},de={key:2,class:"process-date font-12 m-0"},me={key:3,class:"process-date font-12 m-0"},ce={key:4,class:"process-date font-12 m-0"},fe={type:"button",class:"filterbtn d-flex align-items-center position-relative","data-bs-toggle":"modal","data-bs-target":"#exampleModal"},pe={key:0,class:"badge badge-light colorappiled"},ue={class:"mt-2"},_e={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},be={class:"modal-dialog modal-xl"},ve={class:"modal-content"},ge={class:"modal-body"},ye={class:"row"},he={class:"col-4"},ke={class:"col-4"},we={class:"col-4"},Fe={class:"col-4"},xe={class:"col-4"},Se={__name:"DraftComp",setup(f){const l=m(0),n=E(()=>ee.value);A([]),Q(()=>{});const F=m(null);function M(s,t){t.name==="View form"&&(s!=null&&s.form_json?(x.value=O({},s),F.value=te(JSON.parse(s==null?void 0:s.form_json).fields),new bootstrap.Modal(document.getElementById("formViewModal"),{}).show()):(console.warn(" There is no form fields "),R(s))),t.name==="Edit Form"&&R(s)}const z=m([{name:"View form",icon:"fa-solid fa-eye"},{name:"Edit Form",icon:"fa-solid fa-edit"},{name:"Edit accessibility to dept.",icon:"fa-solid fa-users"},{name:"Share this form",icon:"fa-solid fa-share-alt"},{name:"Download Print format",icon:"fa-solid fa-download"},{name:"In-active this form",icon:"fa-solid fa-ban"}]),x=m({}),v=m([]),e=A({appliedform_name:!1,appliedform_category:!1,appliedaccessible_departments:!1,appliedStatus:!1,appledowner_of_the_form:!1,form_name:"",form_category:"",accessible_departments:"",active:"",owner_of_the_form:""}),S=E(()=>[{value:e.form_category,applied:e.appliedform_category},{value:e.form_name,applied:e.appliedform_name},{value:e.active,applied:e.appliedStatus},{value:e.accessible_departments,applied:e.appliedaccessible_departments},{value:e.owner_of_the_form,applied:e.appledowner_of_the_form}].filter(s=>s.applied&&s.value).length);function g(s){s==="form_name"?(e.form_name="",e.appliedform_name=!1):s==="form_category"?(e.form_category="",e.appliedform_category=!1):s==="accessible_departments"?(e.accessible_departments="",e.appliedaccessible_departments=!1):s==="active"?(e.active="",e.appliedStatus=!1):s==="owner_of_the_form"&&(e.owner_of_the_form="",e.appledowner_of_the_form=!1),C()}function C(){e.appliedform_name=!!e.form_name,e.appliedform_category=!!e.form_category,e.appliedaccessible_departments=!!e.accessible_departments,e.appliedStatus=!!e.active,e.appledowner_of_the_form=!!e.owner_of_the_form,h()}const c=m({limit_start:0,limitPageLength:100,form_name:"",form_short_name:"",accessible_departments:"[]",business_unit:"",form_category:"",owner_of_the_form:"",search:""});W(n,s=>{c.value.business_unit=s,s.length&&(console.log(s,"new value of business unit"),v.value=[],h())},{immediate:!0});const j=m([{th:"Name",td_key:"name"},{th:"Form name",td_key:"form_name"},{th:"Form category",td_key:"form_category"},{th:"Owner of form",td_key:"owner_of_the_form"},{th:"Accessible departments",td_key:"accessible_departments"},{th:"Status",td_key:"active"}]),V=X();function R(s=null){s==null?V.push({name:"FormStepper"}):V.push({name:"FormStepper",params:{paramid:s.name}})}const T=s=>{c.value.limitPageLength=s,c.value.limit_start=0,h()},D=([s,t])=>{c.value.limitPageLength=s,c.value.limit_start=t,h()};function I(){e.value={Requested_id:"",Requested_dept:"",Owner_OF_Form:"",Form_Category:"",Form_Name:"",Requested_Period:"",Approval_status:"",RequestedId:""}}const q=m([]);m([]);const P=m([]);function h(){const s=[["business_unit","like",`%${c.value.business_unit}%`],["form_status","=","Draft"]];e.form_name&&s.push(["form_name","like",`%${e.form_name}%`]),e.form_category&&s.push(["form_category","like",`${e.form_category}`]),e.accessible_departments&&s.push(["accessible_departments","like",`${e.accessible_departments}`]),e.active&&s.push(["active","like",`${e.active}`]),e.owner_of_the_form&&s.push(["owner_of_the_form","like",e.owner_of_the_form]);const t={fields:JSON.stringify(["*"]),filters:JSON.stringify(s),limit_page_length:c.value.limitPageLength,limit_start:c.value.limit_start,order_by:"`tabEzy Form Definitions`.`creation` desc"},a={fields:JSON.stringify(["count( `tabEzy Form Definitions`.`name`) AS total_count"]),limitPageLength:"None",filters:JSON.stringify(s)};B.get(`${U.resource}${L.EzyFormDefinitions}`,{params:a}).then(u=>{l.value=u.data[0].total_count}).catch(u=>{console.error("Error fetching ezyForms data:",u)}),B.get(`${U.resource}${L.EzyFormDefinitions}`,{params:t}).then(u=>{const k=u.data;c.value.limit_start===0?(v.value=k,q.value=[...new Set(k.map(w=>w.form_category))],P.value=[...new Set(k.map(w=>w.owner_of_the_form))]):v.value=v.value.concat(k)}).catch(u=>{console.error("Error fetching ezyForms data:",u)})}return(s,t)=>(r(),i("div",null,[o("div",se,[o("div",null,[t[10]||(t[10]=o("h1",{class:"m-0 font-13"},"Forms Master",-1)),o("p",ae,_(l.value)+" forms available",1)]),o("div",le,[o("div",null,[o("div",ne,[e.form_name&&e.appliedform_name?(r(),i("span",re,[b(_(e.form_name)+" ",1),e.form_name?(r(),i("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[0]||(t[0]=a=>g("form_name"))},t[11]||(t[11]=[o("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0),e.form_category&&e.appliedform_category?(r(),i("span",ie,[b(_(e.form_category)+" ",1),e.form_category?(r(),i("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[1]||(t[1]=a=>g("form_category"))},t[12]||(t[12]=[o("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0),e.accessible_departments&&e.appliedaccessible_departments?(r(),i("span",de,[b(_(e.accessible_departments)+" ",1),e.accessible_departments?(r(),i("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[2]||(t[2]=a=>g("accessible_departments"))},t[13]||(t[13]=[o("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0),e.active&&e.appliedStatus?(r(),i("span",me,[b(_(e.active)+" ",1),e.active?(r(),i("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[3]||(t[3]=a=>g("active"))},t[14]||(t[14]=[o("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0),e.owner_of_the_form&&e.appledowner_of_the_form?(r(),i("span",ce,[b(_(e.owner_of_the_form)+" ",1),e.owner_of_the_form?(r(),i("span",{key:0,class:"badge badge-icon rounded-3 text-white",onClick:t[4]||(t[4]=a=>g("owner_of_the_form"))},t[15]||(t[15]=[o("i",{class:"ri-close-line close-icon text-dark rounded-3"},null,-1)]))):d("",!0)])):d("",!0)])]),o("div",null,[o("button",fe,[t[16]||(t[16]=o("span",null,[o("i",{class:"ri-filter-2-line"})],-1)),S.value!==0?(r(),i("span",pe," ( "+_(S.value)+") ",1)):d("",!0)])])])]),o("div",ue,[p(Y,{tHeaders:j.value,tData:v.value,isAction:"true",actionType:"dropdown",onActionClicked:M,actions:z.value,isCheckbox:"true"},null,8,["tHeaders","tData","actions"]),p(Z,{currentRecords:v.value.length,totalRecords:l.value,onUpdateValue:T,onLimitStart:D},null,8,["currentRecords","totalRecords"])]),o("div",_e,[o("div",be,[o("div",ve,[o("div",ge,[o("div",ye,[o("div",he,[t[17]||(t[17]=o("label",{class:"font-13 ps-1",for:"Requested"},"Form Name:",-1)),p(y,{class:"mb-3",tag:"input",type:"search",name:"Requested",id:"Requested",placeholder:"Search",modelValue:e.form_name,"onUpdate:modelValue":t[5]||(t[5]=a=>e.form_name=a)},null,8,["modelValue"])]),o("div",ke,[t[18]||(t[18]=o("label",{class:"font-13 ps-1",for:"dept"},"Form Category:",-1)),p(y,{tag:"select",placeholder:"Form Category",class:"mb-3",name:"dept",modelValue:e.form_category,"onUpdate:modelValue":t[6]||(t[6]=a=>e.form_category=a),id:"dept",Required:!1,options:q.value},null,8,["modelValue","options"])]),o("div",we,[t[19]||(t[19]=o("label",{class:"font-13 ps-1",for:"dept"},"Accessible departments:",-1)),p(y,{class:"",tag:"input",type:"search",name:"Requested",id:"Requested",placeholder:"Search",modelValue:e.accessible_departments,"onUpdate:modelValue":t[7]||(t[7]=a=>e.accessible_departments=a)},null,8,["modelValue"]),t[20]||(t[20]=o("span",{class:"m-0 font-10 ps-2"},"Note:Please seperate departments with commas",-1))]),o("div",Fe,[t[21]||(t[21]=o("label",{class:"font-13 ps-1",for:"dept"},"Status:",-1)),p(y,{tag:"select",placeholder:"Status",class:"mb-3",name:"dept",modelValue:e.active,"onUpdate:modelValue":t[8]||(t[8]=a=>e.active=a),id:"dept",Required:!1,options:["Active","Draft"]},null,8,["modelValue"])]),o("div",xe,[t[22]||(t[22]=o("label",{class:"font-13 ps-1",for:"dept"},"Owner OF Form:",-1)),p(y,{tag:"select",placeholder:"Owner Of The Form",class:"mb-3",name:"dept",modelValue:e.owner_of_the_form,"onUpdate:modelValue":t[9]||(t[9]=a=>e.owner_of_the_form=a),id:"dept",Required:!1,options:P.value},null,8,["modelValue","options"])])])]),o("div",{class:"modal-footer"},[o("button",{type:"button",class:"cancelfilter border-0 text-nowrap font-10",onClick:I,"data-bs-dismiss":"modal"},t[23]||(t[23]=[o("span",{class:"font-14 me-1"},"x",-1),b("Cancel Filter")])),o("button",{type:"button",class:"applyfilter text-nowrap border-0 btn btn-dark text-white font-10 d-flex justify-content-center align-items-center","data-bs-dismiss":"modal",onClick:C},t[24]||(t[24]=[o("span",{class:"font-16 me-1"},[o("i",{class:"bi bi-check2"})],-1),b(" Apply Filter")]))])])])]),p(oe,{blockArr:F.value,formDescriptions:x.value},null,8,["blockArr","formDescriptions"])]))}},qe=K(Se,[["__scopeId","data-v-873b83a8"]]);export{qe as default};
