var ks=Object.defineProperty,Cs=Object.defineProperties;var Ds=Object.getOwnPropertyDescriptors;var at=Object.getOwnPropertySymbols;var Pt=Object.prototype.hasOwnProperty,zt=Object.prototype.propertyIsEnumerable;var Bt=(f,F,y)=>F in f?ks(f,F,{enumerable:!0,configurable:!0,writable:!0,value:y}):f[F]=y,re=(f,F)=>{for(var y in F||(F={}))Pt.call(F,y)&&Bt(f,y,F[y]);if(at)for(var y of at(F))zt.call(F,y)&&Bt(f,y,F[y]);return f},ye=(f,F)=>Cs(f,Ds(F));var gt=(f,F)=>{var y={};for(var C in f)Pt.call(f,C)&&F.indexOf(C)<0&&(y[C]=f[C]);if(f!=null&&at)for(var C of at(f))F.indexOf(C)<0&&zt.call(f,C)&&(y[C]=f[C]);return y};var it=(f,F,y)=>new Promise((C,q)=>{var L=V=>{try{h(y.next(V))}catch(Z){q(Z)}},G=V=>{try{h(y.throw(V))}catch(Z){q(Z)}},h=V=>V.done?C(V.value):Promise.resolve(V.value).then(L,G);h((y=y.apply(f,F)).next())});import{_ as Ue,r as _,x as J,o as a,c as i,d as l,n as T,t as b,l as v,W as nt,X as ue,b as ae,Q as yt,i as $,F as B,h as P,Z as Re,v as Ze,T as Fs,m as H,g as Ss,f as Yt,a6 as $s,u as qs,M as As,e as ce,E as Ts,w as Se,a7 as Nt,K as me,y as te,z as le,L as E,a8 as Ls,S as Ht,O as Je,B as Es,R as Ge,N as Ee,j as Y,Y as Vs,k as Ve,a9 as Rs,aa as Us,U as he,H as _e,ab as bt,a2 as Ms,ac as jt,ad as Os,D as Bs}from"./index-D_k4ZnJS.js";const Ps="/assets/ezy_forms/ezyformsfrontend/assets/oui_app-users-roles-C_V_SNI2.svg",zs=["draggable","aria-label","onKeydown"],Ns={class:"field-card-icon"},Hs={class:"field-card-content"},js={class:"field-card-title"},Ys={class:"field-card-description"},Js={key:0,class:"field-card-drag-preview"},Gs={__name:"FieldCard",props:{field:{type:Object,required:!0},disabled:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["dragstart","dragend","click","add"],setup(f,{emit:F}){const y=f,C=F,q=_(!1),L=_(!1),G=J(()=>({"field-card--dragging":q.value,"field-card--disabled":y.disabled,"field-card--compact":y.compact,"field-card--hovered":L.value})),h=S=>{if(y.disabled)return;q.value=!0,S.dataTransfer.effectAllowed="copy",S.dataTransfer.setData("application/json",JSON.stringify({fieldType:y.field.id,fieldData:y.field}));const K=S.currentTarget.cloneNode(!0);K.style.opacity="0.8",K.style.transform="rotate(-2deg)",document.body.appendChild(K),S.dataTransfer.setDragImage(K,75,20),setTimeout(()=>{document.body.removeChild(K)},0),C("dragstart",{fieldType:y.field.id,fieldData:y.field,event:S})},V=S=>{q.value=!1,C("dragend",S)},Z=()=>{y.disabled||(C("click",y.field),C("add",y.field))};return(S,K)=>(a(),i("div",{class:T(["field-card",G.value]),draggable:!f.disabled,onDragstart:h,onDragend:V,onClick:Z,role:"button",tabindex:"0","aria-label":`Add ${f.field.name} field`,onKeydown:[nt(Z,["enter"]),nt(ue(Z,["prevent"]),["space"])]},[l("div",Ns,[l("i",{class:T(f.field.icon)},null,2)]),l("div",Hs,[l("h4",js,b(f.field.name),1),l("p",Ys,b(f.field.description),1)]),K[0]||(K[0]=l("div",{class:"field-card-actions"},[l("i",{class:"bi bi-plus-circle"})],-1)),q.value?(a(),i("div",Js,[l("i",{class:T(f.field.icon)},null,2),l("span",null,b(f.field.name),1)])):v("",!0)],42,zs))}},Jt=Ue(Gs,[["__scopeId","data-v-871ee6f1"]]),Zs=["aria-expanded","aria-controls","onKeydown"],Ks={class:"field-category-title"},Ws={class:"field-category-name"},Qs={class:"field-category-count"},Xs=["id"],xs={key:0,class:"field-category-description"},Is={class:"field-category-fields"},eo={key:1,class:"field-category-empty"},to={__name:"FieldCategory",props:{category:{type:Object,required:!0},fields:{type:Array,default:()=>[]},initiallyCollapsed:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["field-dragstart","field-dragend","field-click","field-add","toggle"],setup(f,{emit:F}){const y=f,C=F,q=_(y.initiallyCollapsed||y.category.collapsed||!1),L=()=>{q.value=!q.value,C("toggle",{categoryId:y.category.id,isCollapsed:q.value})},G=S=>{C("field-dragstart",ye(re({},S),{categoryId:y.category.id}))},h=S=>{C("field-dragend",S)},V=S=>{C("field-click",{field:S,categoryId:y.category.id})},Z=S=>{C("field-add",{field:S,categoryId:y.category.id})};return(S,K)=>(a(),i("div",{class:T(["field-category",{"field-category--collapsed":q.value}])},[l("div",{class:"field-category-header",onClick:L,role:"button",tabindex:"0","aria-expanded":!q.value,"aria-controls":`category-${f.category.id}`,onKeydown:[nt(L,["enter"]),nt(ue(L,["prevent"]),["space"])]},[l("div",Ks,[l("i",{class:T([f.category.icon,"field-category-icon"])},null,2),l("h3",Ws,b(f.category.name),1),l("span",Qs,"("+b(f.fields.length)+")",1)]),l("i",{class:T(["bi bi-chevron-down field-category-chevron",{"field-category-chevron--collapsed":q.value}])},null,2)],40,Zs),ae(Fs,{name:"category-expand"},{default:yt(()=>[$(l("div",{id:`category-${f.category.id}`,class:"field-category-content"},[f.category.description?(a(),i("p",xs,b(f.category.description),1)):v("",!0),l("div",Is,[(a(!0),i(B,null,P(f.fields,x=>(a(),Re(Jt,{key:x.id,field:x,compact:f.compact,onDragstart:G,onDragend:h,onClick:V,onAdd:Z},null,8,["field","compact"]))),128))]),f.fields.length===0?(a(),i("div",eo,K[0]||(K[0]=[l("i",{class:"bi bi-inbox"},null,-1),l("p",null,"No fields in this category",-1)]))):v("",!0)],8,Xs),[[Ze,!q.value]])]),_:1})],2))}},lo=Ue(to,[["__scopeId","data-v-8c30728f"]]),so=["for"],oo={key:0,class:"text-input-required"},ao={class:"text-input-container"},io={key:0,class:"text-input-icon text-input-icon--left"},no=["id","type","value","placeholder","disabled","readonly","required","maxlength","minlength","aria-describedby","aria-invalid"],ro={key:1,class:"text-input-icon text-input-icon--right"},co=["aria-label"],uo={key:1,class:"text-input-hint"},po=["id"],fo=["id"],mo={__name:"TextInput",props:{modelValue:{type:[String,Number],default:""},label:{type:String,default:""},type:{type:String,default:"text",validator:f=>["text","email","password","url","tel","number","search"].includes(f)},placeholder:{type:String,default:""},helpText:{type:String,default:""},errorMessage:{type:String,default:""},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},iconLeft:{type:String,default:""},iconRight:{type:String,default:""},size:{type:String,default:"md",validator:f=>["sm","md","lg"].includes(f)},maxLength:{type:Number,default:null},minLength:{type:Number,default:null}},emits:["update:modelValue","blur","focus","clear"],setup(f,{emit:F}){const y=f,C=F,q=J(()=>`text-input-${Math.random().toString(36).substr(2,9)}`),L=_(!1),G=J(()=>!!y.errorMessage),h=J(()=>[`text-input-wrapper--${y.size}`,{"text-input-wrapper--disabled":y.disabled,"text-input-wrapper--readonly":y.readonly,"text-input-wrapper--error":G.value,"text-input-wrapper--focused":L.value}]),V=J(()=>[`text-input--${y.size}`,{"text-input--with-icon-left":y.iconLeft,"text-input--with-icon-right":y.iconRight||y.clearable,"text-input--error":G.value}]),Z=z=>{C("update:modelValue",z.target.value)},S=z=>{L.value=!1,C("blur",z)},K=z=>{L.value=!0,C("focus",z)},x=()=>{C("update:modelValue",""),C("clear")};return(z,M)=>(a(),i("div",{class:T(["text-input-wrapper",h.value])},[f.label?(a(),i("label",{key:0,for:q.value,class:"text-input-label"},[H(b(f.label)+" ",1),f.required?(a(),i("span",oo,"*")):v("",!0)],8,so)):v("",!0),l("div",ao,[f.iconLeft?(a(),i("span",io,[l("i",{class:T(f.iconLeft)},null,2)])):v("",!0),l("input",{id:q.value,type:f.type,value:f.modelValue,placeholder:f.placeholder,disabled:f.disabled,readonly:f.readonly,required:f.required,maxlength:f.maxLength,minlength:f.minLength,class:T([V.value,"text-input"]),onInput:Z,onBlur:S,onFocus:K,"aria-describedby":f.helpText?`${q.value}-help`:void 0,"aria-invalid":G.value},null,42,no),f.iconRight||f.clearable?(a(),i("span",ro,[f.clearable&&f.modelValue&&!f.disabled?(a(),i("i",{key:0,class:"bi bi-x-circle text-input-clear",onClick:x,role:"button",tabindex:"0","aria-label":`Clear ${f.label||"input"}`},null,8,co)):f.iconRight?(a(),i("i",{key:1,class:T(f.iconRight)},null,2)):v("",!0)])):v("",!0)]),f.helpText||f.errorMessage?(a(),i("div",uo,[!G.value&&f.helpText?(a(),i("p",{key:0,id:`${q.value}-help`,class:"text-input-help"},b(f.helpText),9,po)):v("",!0),G.value&&f.errorMessage?(a(),i("p",{key:1,id:`${q.value}-error`,class:"text-input-error"},[M[0]||(M[0]=l("i",{class:"bi bi-exclamation-circle"},null,-1)),H(" "+b(f.errorMessage),1)],8,fo)):v("",!0)])):v("",!0)],2))}},vo=Ue(mo,[["__scopeId","data-v-5d216934"]]),ho=["type","disabled","aria-label"],go={__name:"IconButton",props:{type:{type:String,default:"button"},icon:{type:String,required:!0},variant:{type:String,default:"ghost",validator:f=>["solid","outline","ghost"].includes(f)},size:{type:String,default:"md",validator:f=>["sm","md","lg"].includes(f)},color:{type:String,default:"default",validator:f=>["default","primary","success","warning","error"].includes(f)},disabled:{type:Boolean,default:!1},ariaLabel:{type:String,required:!0},tooltip:{type:String,default:""}},emits:["click"],setup(f,{emit:F}){const y=f,C=F,q=J(()=>[`icon-button--${y.variant}`,`icon-button--${y.size}`,`icon-button--${y.color}`,{"icon-button--disabled":y.disabled}]),L=G=>{y.disabled||C("click",G)};return(G,h)=>{const V=Ss("tooltip");return $((a(),i("button",{type:f.type,disabled:f.disabled,class:T([q.value,"icon-button"]),"aria-label":f.ariaLabel,onClick:L},[l("i",{class:T(f.icon)},null,2)],10,ho)),[[V,f.tooltip]])}}},bo=Ue(go,[["__scopeId","data-v-b3b47a56"]]),yo=[{id:"basic",name:"Basic Fields",icon:"bi bi-input-cursor-text",collapsed:!1,description:"Essential form fields for text and numbers"},{id:"choice",name:"Choice Fields",icon:"bi bi-ui-checks",collapsed:!1,description:"Fields for selections and options"},{id:"datetime",name:"Date & Time",icon:"bi bi-calendar3",collapsed:!1,description:"Date, time, and datetime pickers"},{id:"file",name:"File & Media",icon:"bi bi-file-earmark-arrow-up",collapsed:!1,description:"Upload files, images, and signatures"},{id:"layout",name:"Layout Elements",icon:"bi bi-layout-text-sidebar",collapsed:!1,description:"Structure and organize your form"},{id:"advanced",name:"Advanced Fields",icon:"bi bi-gear",collapsed:!0,description:"Special purpose and computed fields"}],_t={text:{id:"text",category:"basic",name:"Text Input",icon:"bi bi-input-cursor-text",description:"Single line text input",frappe_fieldtype:"Data",defaultProps:{label:"Text Field",placeholder:"Enter text...",required:!1,maxLength:255,width:"100%"},validation:{supportedRules:["required","minLength","maxLength","pattern"]}},textarea:{id:"textarea",category:"basic",name:"Textarea",icon:"bi bi-textarea-t",description:"Multi-line text input",frappe_fieldtype:"Text",defaultProps:{label:"Text Area",placeholder:"Enter text...",rows:4,required:!1,maxLength:5e3,width:"100%"},validation:{supportedRules:["required","minLength","maxLength"]}},number:{id:"number",category:"basic",name:"Number",icon:"bi bi-hash",description:"Numeric input field",frappe_fieldtype:"Int",defaultProps:{label:"Number Field",placeholder:"0",required:!1,min:null,max:null,step:1,width:"100%"},validation:{supportedRules:["required","min","max"]}},email:{id:"email",category:"basic",name:"Email",icon:"bi bi-envelope",description:"Email address input",frappe_fieldtype:"Data",defaultProps:{label:"Email Address",placeholder:"email@example.com",required:!1,width:"100%"},validation:{supportedRules:["required","email"]}},phone:{id:"phone",category:"basic",name:"Phone",icon:"bi bi-telephone",description:"Phone number input",frappe_fieldtype:"Data",defaultProps:{label:"Phone Number",placeholder:"+1 (555) 000-0000",required:!1,width:"100%"},validation:{supportedRules:["required","phone"]}},url:{id:"url",category:"basic",name:"URL",icon:"bi bi-link-45deg",description:"Website URL input",frappe_fieldtype:"Data",defaultProps:{label:"Website URL",placeholder:"https://example.com",required:!1,width:"100%"},validation:{supportedRules:["required","url"]}},select:{id:"select",category:"choice",name:"Select Dropdown",icon:"bi bi-chevron-down",description:"Single selection dropdown",frappe_fieldtype:"Select",defaultProps:{label:"Select Field",placeholder:"Choose an option...",required:!1,options:["Option 1","Option 2","Option 3"],width:"100%"},validation:{supportedRules:["required"]}},multiselect:{id:"multiselect",category:"choice",name:"Multi Select",icon:"bi bi-ui-checks-grid",description:"Multiple selection dropdown",frappe_fieldtype:"MultiSelect",defaultProps:{label:"Multi Select Field",placeholder:"Choose options...",required:!1,options:["Option 1","Option 2","Option 3"],width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},radio:{id:"radio",category:"choice",name:"Radio Buttons",icon:"bi bi-record-circle",description:"Single choice radio buttons",frappe_fieldtype:"Select",defaultProps:{label:"Radio Field",required:!1,options:["Option 1","Option 2","Option 3"],layout:"vertical",width:"100%"},validation:{supportedRules:["required"]}},checkbox:{id:"checkbox",category:"choice",name:"Checkboxes",icon:"bi bi-check-square",description:"Multiple choice checkboxes",frappe_fieldtype:"MultiSelect",defaultProps:{label:"Checkbox Field",required:!1,options:["Option 1","Option 2","Option 3"],layout:"vertical",width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},toggle:{id:"toggle",category:"choice",name:"Toggle Switch",icon:"bi bi-toggle-on",description:"On/off switch",frappe_fieldtype:"Check",defaultProps:{label:"Toggle Field",required:!1,default:!1,width:"100%"},validation:{supportedRules:["required"]}},date:{id:"date",category:"datetime",name:"Date Picker",icon:"bi bi-calendar-date",description:"Date selection",frappe_fieldtype:"Date",defaultProps:{label:"Date Field",placeholder:"Select date...",required:!1,format:"YYYY-MM-DD",width:"100%"},validation:{supportedRules:["required","minDate","maxDate"]}},time:{id:"time",category:"datetime",name:"Time Picker",icon:"bi bi-clock",description:"Time selection",frappe_fieldtype:"Time",defaultProps:{label:"Time Field",placeholder:"Select time...",required:!1,format:"HH:mm:ss",width:"100%"},validation:{supportedRules:["required"]}},datetime:{id:"datetime",category:"datetime",name:"DateTime Picker",icon:"bi bi-calendar3",description:"Date and time selection",frappe_fieldtype:"Datetime",defaultProps:{label:"DateTime Field",placeholder:"Select date and time...",required:!1,format:"YYYY-MM-DD HH:mm:ss",width:"100%"},validation:{supportedRules:["required","minDate","maxDate"]}},fileupload:{id:"fileupload",category:"file",name:"File Upload",icon:"bi bi-file-earmark-arrow-up",description:"Upload files",frappe_fieldtype:"Attach",defaultProps:{label:"File Upload",required:!1,acceptedTypes:["pdf","doc","docx","xls","xlsx","txt"],maxSize:10485760,multiple:!1,width:"100%"},validation:{supportedRules:["required","fileType","fileSize"]}},imageupload:{id:"imageupload",category:"file",name:"Image Upload",icon:"bi bi-image",description:"Upload images",frappe_fieldtype:"Attach Image",defaultProps:{label:"Image Upload",required:!1,acceptedTypes:["jpg","jpeg","png","gif"],maxSize:5242880,multiple:!1,width:"100%"},validation:{supportedRules:["required","fileType","fileSize","imageDimensions"]}},signature:{id:"signature",category:"file",name:"Signature Pad",icon:"bi bi-pen",description:"Digital signature capture",frappe_fieldtype:"Signature",defaultProps:{label:"Signature",required:!1,width:"100%",height:200},validation:{supportedRules:["required"]}},sectionbreak:{id:"sectionbreak",category:"layout",name:"Section Break",icon:"bi bi-layout-split",description:"Divide form into sections",frappe_fieldtype:"Section Break",defaultProps:{label:"Section Break",collapsible:!1,collapsed:!1,width:"100%"},validation:{supportedRules:[]}},columnbreak:{id:"columnbreak",category:"layout",name:"Column Break",icon:"bi bi-layout-three-columns",description:"Create columns",frappe_fieldtype:"Column Break",defaultProps:{width:"50%"},validation:{supportedRules:[]}},heading:{id:"heading",category:"layout",name:"Heading",icon:"bi bi-type-h1",description:"Add heading text",frappe_fieldtype:"HTML",defaultProps:{label:"Heading Text",level:2,text:"Heading",width:"100%"},validation:{supportedRules:[]}},paragraph:{id:"paragraph",category:"layout",name:"Paragraph",icon:"bi bi-paragraph",description:"Add description text",frappe_fieldtype:"HTML",defaultProps:{label:"Paragraph Text",text:"Your text here...",width:"100%"},validation:{supportedRules:[]}},divider:{id:"divider",category:"layout",name:"Divider",icon:"bi bi-dash-lg",description:"Horizontal divider line",frappe_fieldtype:"HTML",defaultProps:{width:"100%"},validation:{supportedRules:[]}},table:{id:"table",category:"advanced",name:"Table/Grid",icon:"bi bi-table",description:"Child table for multiple rows",frappe_fieldtype:"Table",defaultProps:{label:"Table Field",required:!1,columns:[],width:"100%"},validation:{supportedRules:["required","minRows","maxRows"]}},link:{id:"link",category:"advanced",name:"Link Field",icon:"bi bi-box-arrow-up-right",description:"Link to another DocType",frappe_fieldtype:"Link",defaultProps:{label:"Link Field",placeholder:"Select...",required:!1,doctype:"",width:"100%"},validation:{supportedRules:["required"]}},dynamiclist:{id:"dynamiclist",category:"advanced",name:"Dynamic List",icon:"bi bi-list-ul",description:"Repeatable list of items",frappe_fieldtype:"Dynamic Link",defaultProps:{label:"Dynamic List",required:!1,minItems:1,maxItems:null,width:"100%"},validation:{supportedRules:["required","minItems","maxItems"]}},formula:{id:"formula",category:"advanced",name:"Formula Field",icon:"bi bi-calculator",description:"Calculated field",frappe_fieldtype:"Data",defaultProps:{label:"Formula Field",formula:"",readonly:!0,width:"100%"},validation:{supportedRules:[]}},qrcode:{id:"qrcode",category:"advanced",name:"QR Code",icon:"bi bi-qr-code",description:"Generate QR code",frappe_fieldtype:"Barcode",defaultProps:{label:"QR Code Field",data:"",size:200,width:"100%"},validation:{supportedRules:[]}}};function _o(f){return Object.values(_t).filter(F=>F.category===f)}function wo(f){const F=f.toLowerCase();return Object.values(_t).filter(y=>y.name.toLowerCase().includes(F)||y.description.toLowerCase().includes(F))}const ko={class:"field-library-header"},Co={class:"field-library-content"},Do={class:"field-library-search"},Fo={key:0,class:"field-library-results"},So={key:0},$o={key:1,class:"field-library-no-results"},qo={key:1,class:"field-library-search-results"},Ao={key:2,class:"field-library-categories"},To={key:0,class:"field-library-collapsed-indicator"},Lo={__name:"FieldLibraryPanel",props:{collapsible:{type:Boolean,default:!0},initiallyCollapsed:{type:Boolean,default:!1},compactMode:{type:Boolean,default:!1},hiddenCategories:{type:Array,default:()=>[]},hiddenFields:{type:Array,default:()=>[]}},emits:["field-dragstart","field-dragend","field-click","field-add","collapse","expand"],setup(f,{emit:F}){const y=f,C=F,q=_(""),L=_(y.initiallyCollapsed),G=_({}),h=J(()=>yo.filter(U=>!y.hiddenCategories.includes(U.id))),V=J(()=>q.value?wo(q.value).filter(j=>!y.hiddenFields.includes(j.id)):[]);function Z(U){return _o(U).filter(de=>!y.hiddenFields.includes(de.id))}function S(){L.value=!L.value,C(L.value?"collapse":"expand")}function K(U){}function x(U){C("field-dragstart",U)}function z(U){C("field-dragend",U)}function M(U){C("field-click",U)}function I(U){C("field-add",U)}function we(U){G.value[U.categoryId]=U.isCollapsed}function ve(U){if((U.ctrlKey||U.metaKey)&&U.key==="k"){U.preventDefault();const j=document.querySelector(".field-library-search input");j&&j.focus()}}return Yt(()=>{document.addEventListener("keydown",ve)}),$s(()=>{document.removeEventListener("keydown",ve)}),(U,j)=>(a(),i("div",{class:T(["field-library-panel",{"field-library-panel--collapsed":L.value}])},[l("div",ko,[j[1]||(j[1]=l("div",{class:"field-library-title"},[l("i",{class:"bi bi-grid-3x3-gap"}),l("h2",null,"Add Fields")],-1)),f.collapsible?(a(),Re(bo,{key:0,icon:L.value?"bi bi-chevron-right":"bi bi-chevron-left",variant:"ghost",size:"sm","aria-label":"Toggle field library",onClick:S},null,8,["icon"])):v("",!0)]),$(l("div",Co,[l("div",Do,[ae(vo,{modelValue:q.value,"onUpdate:modelValue":[j[0]||(j[0]=de=>q.value=de),K],type:"search",placeholder:"Search fields...","icon-left":"bi bi-search",clearable:!0,size:"sm"},null,8,["modelValue"])]),q.value?(a(),i("div",Fo,[V.value.length>0?(a(),i("p",So,b(V.value.length)+" field"+b(V.value.length!==1?"s":"")+" found ",1)):(a(),i("p",$o,[j[2]||(j[2]=l("i",{class:"bi bi-search"},null,-1)),H(' No fields found matching "'+b(q.value)+'" ',1)]))])):v("",!0),q.value&&V.value.length>0?(a(),i("div",qo,[(a(!0),i(B,null,P(V.value,de=>(a(),Re(Jt,{key:de.id,field:de,compact:f.compactMode,onDragstart:x,onDragend:z,onClick:M,onAdd:I},null,8,["field","compact"]))),128))])):(a(),i("div",Ao,[(a(!0),i(B,null,P(h.value,de=>(a(),Re(lo,{key:de.id,category:de,fields:Z(de.id),compact:f.compactMode,onFieldDragstart:x,onFieldDragend:z,onFieldClick:M,onFieldAdd:I,onToggle:we},null,8,["category","fields","compact"]))),128))])),j[3]||(j[3]=l("div",{class:"field-library-help"},[l("i",{class:"bi bi-info-circle"}),l("p",null,"Drag fields to the canvas or click to add")],-1))],512),[[Ze,!L.value]]),L.value?(a(),i("div",To,j[4]||(j[4]=[l("i",{class:"bi bi-grid-3x3-gap"},null,-1),l("span",null,"Fields",-1)]))):v("",!0)],2))}},Eo=Ue(Lo,[["__scopeId","data-v-12f238c7"]]),Vo={class:""},Ro={class:""},Uo={class:"d-flex justify-content-between align-items-center CancelNdSave"},Mo={class:"d-flex align-items-center"},Oo={key:0,class:"font-16"},Bo=["disabled"],Po={class:"form-container p-0 container-fluid mt-1"},zo={class:"row"},No={class:"col-lg-2 col-md-2 col-sm-12"},Ho={class:"steps-sticky-div"},jo={class:"steps d-sm-inline-flex d-md-block m-0 p-0"},Yo=["onClick"],Jo={key:0,class:"ri-checkbox-circle-fill completedStepIcon"},Go={class:"step-text"},Zo={class:"font-11"},Ko={class:"font-14"},Wo={class:"col-lg-10 col-md-10 col-sm-12 formbackground-color"},Qo={class:""},Xo={class:"form-content stepsDiv"},xo={key:0},Io={class:""},ea={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},ta={class:"container-fluid aboutFields p-0"},la={class:"row"},sa={class:"col-sm-12 col-md-12 mt-lg-3 p-lg-4"},oa={class:"container-fluid"},aa={class:"row g-3"},ia={class:"col-md-6"},na={class:"position-relative"},ra={key:0,class:"font-12 position-absolute PredefinedLabel"},da={key:1,class:"text-danger ErrorMsg ms-2"},ca={class:"col-md-6"},ua={key:0,class:"text-danger ErrorMsg ms-2"},pa={class:"col-md-6"},fa={class:"col-md-6"},ma={key:0,class:"text-danger"},va={class:"col-md-6"},ha={key:0,class:"text-danger"},ga={class:"col-md-6"},ba={key:0,class:"text-danger"},ya={class:"custom-option"},_a=["checked","onChange"],wa={class:"col-md-6"},ka={class:"col-md-6"},Ca={key:0,class:"col-md-6"},Da={key:1,class:"col-md-6"},Fa={key:2,class:"col-md-6"},Sa={class:"form-check d-flex align-items-center p-0 pe-3"},$a=["disabled"],qa={key:3,class:"col-md-6"},Aa=["disabled"],Ta={key:0,class:"list-group position-absolute w-100 z-3 formslist"},La=["onMousedown"],Ea={key:1},Va={class:""},Ra={class:"stepperbackground ps-2 pe-2 m-0 d-flex justify-content-between align-items-center"},Ua={class:"d-flex gap-2 align-items-center"},Ma={class:"form-builder-with-library"},Oa={key:0,class:"field-library-container"},Ba={class:"form-canvas-container"},Pa={class:"requestandAppHeader"},za={class:"d-flex justify-content-between align-items-center"},Na={class:""},Ha={class:"ps-2 mb-0 fw-bolder font-14 blockTitle"},ja={class:"text-center ms-2 mt-1"},Ya={key:0,class:"font-12 d-flex align-items-center"},Ja={class:"font-12 approver_type_div"},Ga={class:"font-12 fw-bold"},Za={class:"font-12 text-danger ms-1"},Ka={class:"d-flex align-items-center"},Wa={key:0,class:"role-container"},Qa={key:0,class:"role-text d-flex align-items-center"},Xa={class:"role-label fw-bold"},xa={class:"role-names"},Ia=["onClick"],ei=["onClick"],ti=["onClick"],li=["onClick"],si={class:"pt-0 section_block"},oi={class:"d-flex justify-content-between align-items-center"},ai={class:"d-flex flex-column"},ii=["onUpdate:modelValue","onChange","onInput"],ni={key:0,class:"text-danger ps-3 font-10"},ri={class:"d-flex align-items-center"},di=["onClick"],ci={class:"container-fluid"},ui={class:"d-flex justify-content-between align-items-center"},pi={class:"rownames m-0"},fi=["onClick"],mi={class:"col"},vi={class:"row"},hi=["onMouseenter"],gi={class:"column_name d-flex align-items-center justify-content-between"},bi={class:"d-flex flex-column ps-2"},yi=["onUpdate:modelValue","onChange","onInput"],_i={key:0,class:"text-danger ps-2 font-10"},wi={class:"position-absolute top-0 end-0"},ki=["onClick"],Ci=["onDrop"],Di=["onMouseenter","onDragstart","onDrop"],Fi=["onDrop"],Si=["onDragstart","onDrop"],$i={class:"d-flex justify-content-between"},qi={class:"flex-column d-flex"},Ai=["onUpdate:modelValue","onChange","onInput"],Ti={key:0,class:"text-danger font-10"},Li={class:"FieldcopyRemove"},Ei=["onClick"],Vi=["onClick"],Ri=["onUpdate:modelValue","onChange"],Ui=["value"],Mi={key:0},Oi=["onUpdate:modelValue"],Bi={key:0,class:"text-danger font-10"},Pi={key:1},zi=["for"],Ni=["id","onUpdate:modelValue","onInput","onFocus"],Hi={key:0,class:"list-group mt-1",style:{"max-height":"200px","overflow-y":"auto"}},ji=["onClick"],Yi={class:"d-flex align-items-center justify-content-between"},Ji={class:"d-flex align-items-center gap-2"},Gi={class:"d-flex align-items-center"},Zi=["onUpdate:modelValue","id"],Ki=["for"],Wi=["onClick"],Qi=["onUpdate:modelValue"],Xi={key:3,class:"text-danger font-10"},xi=["onDrop"],Ii={class:"childtableShow"},en={class:"mt-2"},tn={key:0,class:"childTableContainer"},ln={key:0,class:"font-13"},sn={key:1,class:"d-flex align-items-center gap-2"},on={class:"d-flex align-items-center"},an=["onUpdate:modelValue"],nn=["onClick"],rn={key:2,class:"table table-bordered rounded-table"},dn=["onDrop"],cn=["draggable","onDragstart"],un={key:0},pn=["onUpdate:modelValue","onInput"],fn={key:0,class:"text-danger font-11"},mn={key:1},vn={key:2},hn={class:"d-flex gap-1"},gn=["onUpdate:modelValue","onChange"],bn=["value"],yn={class:"d-flex"},_n={class:"d-flex align-items-center gap-2"},wn={class:"d-flex align-items-center"},kn=["onUpdate:modelValue"],Cn=["onClick"],Dn={key:0},Fn=["onUpdate:modelValue","onInput"],Sn={key:0,class:"text-danger font-10"},$n={key:1,class:"font-11 text-danger"},qn={key:3},An={key:3,class:"mb-2 mt-3"},Tn=["onClick"],Ln=["onClick"],En=["onDrop"],Vn=["onDrop"],Rn={class:"d-flex justify-content-center align-items-center my-2"},Un=["onClick"],Mn={class:"font-13"},On={key:0,class:"d-flex align-items-center gap-2"},Bn={class:"d-flex align-items-center"},Pn=["onUpdate:modelValue"],zn=["onClick"],Nn={class:"table table-bordered rounded-table"},Hn={key:0},jn=["onUpdate:modelValue","onBlur"],Yn={key:0,class:"text-danger font-11 mt-1"},Jn={key:1},Gn={key:2},Zn={class:"d-flex gap-1 align-items-center"},Kn=["onUpdate:modelValue","onChange"],Wn=["value"],Qn=["onClick"],Xn={key:0,class:"mt-1"},xn=["onUpdate:modelValue","onInput"],In={key:1,class:"text-danger font-11 mt-1"},er={key:3},tr={class:"mb-2"},lr=["onClick"],sr=["onClick"],or=["onClick"],ar={key:0},ir={class:"d-flex justify-content-between align-items-center mt-1 mb-2"},nr=["onUpdate:modelValue","onBlur"],rr={key:0,class:"text-danger font-12"},dr={key:1,class:"text-danger font-12"},cr={class:"d-flex align-items-center gap-2"},ur={class:"d-flex align-items-center"},pr=["onUpdate:modelValue"],fr=["onClick"],mr=["onClick"],vr={class:"px-1 field-border"},hr={class:"d-flex justify-content-between"},gr=["onUpdate:modelValue","onBlur"],br={key:0,class:"text-danger font-12"},yr={class:"d-flex align-items-center"},_r={class:"d-flex my-1"},wr=["onUpdate:modelValue"],kr=["onClick"],Cr=["onClick"],Dr=["onUpdate:modelValue"],Fr=["value"],Sr={key:0},$r=["onUpdate:modelValue"],qr={key:0,class:"text-danger font-10"},Ar={key:1,class:"text-danger font-12"},Tr=["onClick"],Lr=["onClick"],Er={class:"d-flex justify-content-center align-items-center py-2 add-section-btn"},Vr=["onClick"],Rr={key:0,class:"m-2"},Ur={key:2},Mr={class:"modal fade",id:"customFormatModal",tabindex:"-1","aria-labelledby":"customFormatModalLabel","aria-hidden":"true"},Or={class:"modal-dialog modal-dialog-centered"},Br={class:"modal-content"},Pr={class:"modal-body"},zr=["placeholder"],Nr={class:"d-flex align-items-center gap-2"},Hr={class:"d-flex align-items-center py-2"},jr={class:"offcanvas addOffCanvas offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},Yr={class:"offcanvas-header add_designationHeader"},Jr={id:"offcanvasRightLabel",class:"font-14 fw-bold"},Gr={class:"offcanvas-body add_desig_offCanvas_body p-0"},Zr={class:""},Kr={class:""},Wr={key:0,class:"p-3 approval-border-bottom"},Qr={key:0,class:""},Xr={class:"px-3 listofdesignations"},xr={class:"my-1 d-flex justify-content-between"},Ir={class:"font-12 fw-bold"},ed={class:"italic-style text-secondary font-12"},td={key:0,ref:"resizableDiv",class:"my-1 disgnationlist_div"},ld={class:"d-flex align-items-center justify-content-between gap-1"},sd={class:"form-check ps-1 d-flex align-items-center m-0"},od=["checked"],ad={for:"selectAll",class:"form-check-label SelectallDesignation mt-2 fw-bold"},id={key:0,class:"form-check d-flex align-items-center m-0"},nd={key:1},rd={key:0,class:"p-3"},dd=["value"],cd={key:1},ud={class:""},pd={class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},fd={key:0,class:"px-4 py-1 mt-2 d-flex align-items-center user-select-none"},md={class:"offcanvas-footer"},vd={class:"text-end p-3"},$e="Select All",hd={__name:"FormStepper",setup(f){const F=qs(),y=As(),C=_(1),q=_([]);_([]);const L=_([]),G=_([]);ce([]);let h=ce([]),V=ce([]);const Z=_([]),S=_([]),K=_([]),x=_(""),z=_(""),M=_("");let I=ce([]);const we=_("");_(!1),_(!1),_(!1);const ve=_(""),U=_(""),j=_(""),de=_([]),Gt=_([]),R=ce({}),ie=_([]),rt=_(!1),Ke=_([]),We=_(!1);let wt=null;const Zt=_("");let N=_("");const Kt=_(null);_(null);const Wt=_(!0),qe=J(()=>Ts);_(!1);const Qe=ce([]),ne=_({routepath:F.query.routepath,business_unit:F.query.business_unit,formId:F.query.id}),Xe=_(""),Ae=_(!1),Te=_(!1),kt=[{label:"Public",value:1},{label:"Private",value:0}],Ct=J({get(){return kt.find(t=>t.value===g.value.as_web_view)},set(t){g.value.as_web_view=t?t.value:null}}),Dt=J({get(){return g.value.form_name||F.query.form_name||""},set(t){g.value.form_name=t}}),g=_({form_name:"",form_short_name:"",accessible_departments:[],business_unit:`${qe.value.value||ne.value.business_unit||F.query.business_unit}`,form_category:"",owner_of_the_form:"",series:"",has_workflow:"",workflow_check:"",is_linked:0,is_linked_form:"",is_predefined_doctype:F.query.id?1:0,as_web_view:0,mail_id:""});Se(()=>F.query.form_name,t=>{t&&(g.value.form_name=t,g.value.form_short_name=t)},{immediate:!0});const xe=["name","parent","creation","owner","modified","modified_by","parentfield","parenttype","file_list","flags","docstatus","idx","doctype","company_field","business_unit"].map(t=>t.toLowerCase().trim()),Ft=["Approver","Approved on","Approved By"].map(t=>t.toLowerCase().trim());function Qt(t){return t.toLowerCase().replace(/\s+/g,"_").replace(/[^\w_]/g,"")}const Xt=J(()=>g.value);_(""),_(!1),Se(qe,t=>{t&&t.value&&(g.value.business_unit=t.value)},{immediate:!0});function xt(t){if(N==null||N==="new")return!1;const e=W(t).roles;if(t===0)return e.length===0;const s=W(t-1).roles;return s.length>0&&s[0]!==null&&s[0]!==""&&e.length===0}Se(()=>g.value.form_name,t=>{g.value.form_name=t.trim()}),Se(()=>g.value.form_short_name,t=>{g.value.form_short_name=t.trim()}),Se(()=>g.value.series,t=>{g.value.series=t.trim()});const Ie=_(null),St=(t,e,s,o,r,n)=>{Ie.value={blockIndex:e,sectionIndex:s,rowIndex:o,columnIndex:r,fieldIndex:n}},ke=(t,e,s,o,r,n)=>{if(!Ie.value)return;const{blockIndex:d,sectionIndex:u,rowIndex:m,columnIndex:c,fieldIndex:p}=Ie.value,k=h[d].sections[u].rows[m].columns[c].fields,O=h[e].sections[s].rows[o].columns[r].fields;if(d===e&&u===s&&m===o&&c===r&&p===n)return;const w=k.splice(p,1)[0];k===O&&p<n&&n--,O.splice(n,0,w),Ie.value=null},Le=_(""),It=t=>it(this,null,function*(){const e=[["module","in",["User Forms"]],["istable","=",1]];t!=null&&t.trim()&&e.push(["name","=",`${t}`]);const s={fields:JSON.stringify(["name"]),filters:JSON.stringify(e),limit_page_length:"None",doctype:me.doctypesList};try{return(yield te.get(le.GetDoctypeData,{params:s})).message.data||[]}catch(o){return console.error("Error fetching doctype list:",o),[]}}),et=_(null),$t=t=>it(this,null,function*(){if(Le.value="",et.value=null,t.tableName){let e=t.tableName.trim();if(e.length>64){Le.value="Table name cannot exceed 64 characters";return}if(!/^[a-zA-Z]+( [a-zA-Z]+)*$/.test(e)){Le.value="Table name can only contain letters and spaces (no leading/trailing spaces or special characters)";return}const o=yield It(e);et.value=o.find(r=>r.name.toLowerCase()===e.toLowerCase()),et.value&&(Le.value="Table already exists"),t.tableName=e}t.label&&(t.fieldname=Qt(t.label))});function el(){const t=g.value.is_linked_form;if(!t){Ke.value=[];return}clearTimeout(wt),wt=setTimeout(()=>{const e=[["business_unit","=",`${qe.value.value}`],["name","like",`%${t}%`]],s={fields:JSON.stringify(["name"]),limit_page_length:10,limit_start:0,filters:JSON.stringify(e),doctype:me.EzyFormDefinitions,order_by:"`tabEzy Form Definitions`.`enable` DESC, `tabEzy Form Definitions`.`creation` DESC"};te.get(`${le.GetDoctypeData}`,{params:s}).then(o=>{Ke.value=o.message.data||[]}).catch(o=>{console.error("Error fetching form definitions:",o)})},300)}function tl(t){g.value.is_linked_form=t,We.value=!1}function ll(){setTimeout(()=>{We.value=!1},200)}ce({query:"",key:""});function ge(t,e,s,o,r){return`${t}-${e}-${s}-${o}-${r}`}ce({});const Me=ce({}),dt=ce({});function sl(t){dt[t]=!0}function ol(t,e,s,o,r,n){const d=ge(e,s,o,r,n),u=[["istable","=",0]];t!=null&&t.trim()&&u.push(["name","like",`%${t}%`]);const m={fields:JSON.stringify(["name"]),filters:JSON.stringify(u),limit_page_length:"none",doctype:me.doctypesList};te.get(le.GetDoctypeData,{params:m}).then(c=>{Me[d]=c.message.data||[]}).catch(c=>{console.error("Error fetching doctype list:",c),Me[d]=[]})}function al(t,e,s,o,r,n){h[t].sections[e].rows[s].columns[o].fields[r].options=n;const d=ge(t,e,s,o,r);Me[d]=[],dt[d]=!1}const il=J(()=>h!=null&&h.length?M.value===1?[0]:Array.from({length:M.value},(t,e)=>e).filter(t=>t<M.value):[]),be=_(null),Ce=_(null),nl=(t,e,s,o,r)=>{be.value={blockIndex:t,sectionIndex:e,rowIndex:s,columnIndex:o,fieldIndex:r}},rl=()=>{be.value=null},dl=(t,e,s,o,r)=>be.value&&be.value.blockIndex===t&&be.value.sectionIndex===e&&be.value.rowIndex===s&&be.value.columnIndex===o&&be.value.fieldIndex===r,cl=(t,e,s,o)=>{Ce.value={blockIndex:t,sectionIndex:e,rowIndex:s,columnIndex:o}},ul=()=>{Ce.value=null},pl=(t,e,s,o)=>Ce.value&&Ce.value.blockIndex===t&&Ce.value.sectionIndex===e&&Ce.value.rowIndex===s&&Ce.value.columnIndex===o,qt=_([{form_json:""}]),De=_("");Yt(()=>{Rt(),De.value=F.query.Clone,N.value=F.query.id||"new",De.value==="1"&&(g.value.series=""),N.value!=null&&N.value!=null&&N.value!="new"&&(Vt(),mt()),sessionStorage.getItem("allow_approver_to_edit_form")=="1"?rt.value=!0:rt.value=!1;let t=localStorage.getItem("Bu");if(g.value.business_unit=t,F.query.preId==="PreDefine"){const e=localStorage.getItem("form_json");if(e){qt.value[0].form_json=e;const s=qt.value[0],o=JSON.parse(s.form_json),r=Nt(o.fields);ie.value=o.child_table_fields,r.forEach(n=>{h.push(n)})}}});const Fe=_(null),ee=ce({}),At=_(null),fl=t=>{Fe.value=t},ml=()=>{Fe.value=null},vl=t=>{t.preventDefault()},hl=(t,e)=>{const s=t.target.closest("tr");if(!s)return;const o=Array.from(s.parentNode.children).indexOf(s);if(o!==Fe.value){const r=e[Fe.value];e.splice(Fe.value,1),e.splice(o,0,r),Fe.value=o}},gl=_([]),ct=t=>{if(["Select","Table MultiSelect","Check","Small Text"].includes(t.fieldtype)&&t.options){const e=t.options.split(`
`).map(r=>r.trim()).filter(r=>r),s=[],o=new Set;return e.forEach(r=>{const n=r.toLowerCase();o.has(n)||(o.add(n),s.push(r))}),`
`+s.join(`
`)}else if(["Link","Table"].includes(t.fieldtype)&&t.options)return t.options.trim();return t.options},bl=(t,e)=>{const s=h[t].sections[e];s.childTables||(s.childTables=[]);const o=s.childTables.length;s.childTables.push({label:"",fieldname:"",fieldtype:"Table",idx:o,reqd:!1,as_a_block:"",description:"false",columns:[re({label:"",fieldname:"",fieldtype:"",idx:0,description:"",reqd:!1},Qe.fieldtype==="Select"&&Qe.options?{options:Qe.options?`
${Qe.options}`:`
`}:{})],newTable:!0})},yl=(t,e,s)=>{const o=h[t].sections[e].childTables[s];o.columns||(o.columns=[]),o.columns.push(re({label:"",fieldname:"",fieldtype:"",idx:o.columns.length,description:"",reqd:!1},o.columns.fieldtype==="Select"&&o.columns.options?{options:o.columns.options?`
${o.columns.options}`:`
`}:{}))},_l=(t,e,s)=>{h[t].sections[e].childTables.splice(s,1)},wl=(t,e,s,o)=>{h[t].sections[e].childTables[s].columns.splice(o,1)};function kl(t,e,s,o,r,n){var c;const d=`${e}-${s}-${o}`;R[d]||(R[d]={columns:[]});const u={},m=((c=t.label)==null?void 0:c.trim())||"";if(!m)u.label="Field Label is required";else{const p=m.toLowerCase();if(xe.includes(p)&&!Ft.includes(p))u.label=`"${m}" is a restricted field label`;else if(m.length>64)u.label="Field Label cannot exceed 64 characters";else if(!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(m))u.label="Field Label can only contain letters, numbers, and single spaces between words";else{const k=n.map((O,w)=>{var D;return{label:(D=O.label)==null?void 0:D.trim().toLowerCase(),index:w}}).filter(O=>O.label===p);if(k.length>1){const O=k[0].index;r!==O&&(u.label=`"${m}" is already used in this table`)}}}R[d].columns[r]=u}function tt(t,e,s){var n;R[e]||(R[e]={});const o=[],r=((n=t.label)==null?void 0:n.trim())||"";r||o.push("Label is required"),r.length>64&&o.push("Label cannot exceed 64 characters"),r&&!/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(r)&&o.push("No special characters allowed"),r&&xe.includes(r.toLowerCase().trim())&&o.push("This label is restricted"),r&&ie.value[e].map(m=>{var c;return(c=m.label)==null?void 0:c.trim().toLowerCase()}).filter(Boolean).filter(m=>m===r.toLowerCase()).length>1&&o.push("Duplicate label is not allowed"),t.fieldtype||o.push("Field type is required"),t.fieldtype==="Select"&&(!t.options||t.options.trim()==="")&&o.push("Options are required"),R[e][s]=o}const Cl=(t,e,s)=>{var d;const o=h[t].sections[e].childTables[s],r={tableName:!1,columns:[]};let n=!1;return(d=o.tableName)!=null&&d.trim()||(r.tableName="Table name is required.",n=!0),o.columns.forEach((u,m)=>{var p,k;const c={};(p=u.label)!=null&&p.trim()||(c.label="Field Label is required",n=!0),(k=u.fieldtype)!=null&&k.trim()||(c.fieldtype="Please select field type",n=!0),r.columns[m]=c}),R[`${t}-${e}-${s}`]=r,n},Dl=(t,e,s)=>{var r,n;const o=(n=(r=h[t])==null?void 0:r.sections)==null?void 0:n[e];o&&!Array.isArray(o[s])&&(o[s]=[])},Fl=t=>t?t.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,""):"",Sl=(t,e,s)=>{if(Cl(t,e,s)){he("Please fix validation errors before creating the table",{transition:"zoom"});return}if(et.value){he("Table already exists",{transition:"zoom"});return}const r=h[t].sections[e].childTables[s],n=h[t].sections[e];r.columns=r.columns.map((u,m)=>ye(re({},u),{idx:m,options:ct(u)})),r.newTable=!1;const d={form_short_name:r.tableName,fields:r.columns,idx:r.idx,as_a_block:r.as_a_block?r.as_a_block:"false"};te.post(le.childtable,d).then(u=>{var m,c,p;if(u){Dl(t,e,"afterCreated"),n.afterCreated[s]=re({},r),_e("Table created successfully!");const k=(p=(c=(m=u.message)==null?void 0:m[0])==null?void 0:c[0])==null?void 0:p.child_doc;k&&(h[t].sections[e].childTables[s]=ye(re(re({},h[t].sections[e].childTables[s]),k),{newTable:!1}))}}).catch(u=>{console.error("Error creating table:",u)})},Oe=(t,e,s,o=[])=>{var d;ee[e]||(ee[e]=[]),ee[e]=ee[e].filter(u=>u!==s),R[e]||(R[e]=[]),R[e][s]=[];const r=[],n=((d=t.label)==null?void 0:d.trim())||"";if(n?xe.includes(n.toLowerCase())?r.push("This label is restricted"):n.length>64?r.push("Label cannot exceed 64 characters"):/^[A-Za-z0-9]+(?: [A-Za-z0-9]+)*$/.test(n)||r.push("Only letters, numbers, and single spaces allowed"):r.push("Label is required"),o.length){const u=n.toLowerCase(),m=o.map((c,p)=>{var k;return{label:(k=c.label)==null?void 0:k.trim().toLowerCase(),idx:p}}).filter(c=>c.label===u);if(m.length>1){const c=m[0].idx;s!==c?(r.push("Duplicate label not allowed"),t._duplicate=!0):t._duplicate=!1}else t._duplicate=!1}return t.fieldtype||r.push("Field type is required"),t.fieldtype==="Select"&&(!t.options||!t.options.trim())&&r.push("Options are required"),R[e][s]=r,r.length>0&&ee[e].push(s),r.length===0},$l=(t,e,s)=>{const r=h[t].sections[e].afterCreated.find(u=>u.tableName===s);if(!r)return;const n=r.columns.length,d={fieldname:"",fieldtype:"",idx:n+1,label:"",value:"",isNew:!0,description:""};r.columns.push(d),Oe(d,s,n,r.columns)},Tt=_([]),ql=(t,e,s,o)=>{const n=h[t].sections[e].afterCreated.find(u=>u.tableName===s);if(!n)return;n.columns.splice(o,1),n.columns.forEach((u,m)=>{u.idx=m+1});const d=ee.value[s];d&&(ee.value[s]=d.filter(u=>u!==o).map(u=>u>o?u-1:u))},Al=(t,e,s)=>{const r=h[t].sections[e].afterCreated.find(n=>n.tableName===s);if(r){if(Q[s]){ee[s]=[];let n=!0;if(r.columns.forEach((m,c)=>{Oe(m,s,c,r.columns)||(n=!1)}),!n){he("Please fix the errors in the highlighted fields before saving!");return}const d=r.columns.map((k,p)=>{var O=k,{isNew:m}=O,c=gt(O,["isNew"]);return ye(re({},c),{idx:p+1,options:ct(c)})}),u={form_short_name:Fl(s),fields:d,as_a_block:r.description};te.post(le.childtable,u).then(m=>{Tt.value=m.data,_e("Fields updated successfully!")}).catch(m=>{console.error("❌ Saving fields failed:",m)})}Q[s]=!Q[s]}},Q=ce({}),Tl=t=>{ie.value[t]||(ie.value[t]=[]);const e=ie.value[t].length+1;ie.value[t].push({fieldname:"",fieldtype:"",idx:e,label:"",value:"",isNew:!0,description:"",options:ie.value[t].options?`
${ie.value[t].options}`:""})},Ll=(t,e)=>{ie.value[t]&&ie.value[t].splice(e,1)},El=(t,e)=>{if(!t)return;ee.value||(ee.value={}),ee.value[t]||(ee.value[t]=[]);const s=ie.value[t];if(s){if(Q[t]){ee.value[t]=[];let o=!0;if(s.forEach((d,u)=>{var c;tt(d,t,u);const m=(c=R[t])==null?void 0:c[u];m&&m.length>0&&(ee.value[t].push(u),o=!1),d.label&&(d.label=d.label.trim())}),!o){he("Please fix the errors before saving");return}const r=s.map((c,m)=>{var p=c,{isNew:d}=p,u=gt(p,["isNew"]);return ye(re({},u),{idx:m+1,options:ct(u)})}),n={form_short_name:t,fields:r,as_a_block:e};te.post(le.childtable,n).then(d=>{Tt.value=d.data,_e("Fields updated successfully!")}).catch(d=>{console.error("❌ Saving fields failed:",d)})}Q[t]=!Q[t],At.value=Q[t]?t:null}},Vl=_([{id:1,label:"About Form",stepno:"Step 1",icon:"bi bi-info-circle"},{id:2,label:"Fields & Workflow",stepno:"Step 2",icon:"bi bi-question-circle"},{id:3,label:"Print Format",stepno:"Step 3",icon:"ri-checkbox-circle-line"}]),ut=[{label:"Text",type:"Data"},{label:"Select",type:"Select"},{label:"Attach",type:"Attach"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Number",type:"Int"},{label:"TextArea",type:"Text"}],Rl=[{label:"Text",type:"Data"},{label:"Time",type:"Time"},{label:"Text Area",type:"Text"},{label:"Date",type:"Date"},{label:"Datetime",type:"Datetime"},{label:"Attach",type:"Attach"},{label:"Phone",type:"Data"},{label:"Check",type:"Check"},{label:"Number",type:"Int"},{label:"Select",type:"Select"},{label:"Multi Select",type:"Small Text"},{label:"Link",type:"Link"}],Ul=J(()=>[$e,...L.value]),Ml=J(()=>{const t=g.value.accessible_departments;return t.includes($e)?"All Selected":t.length>1?`${t[0]}.. +${t.length-1} more selected`:t.join(", ")}),Ol=t=>t===$e?g.value.accessible_departments.length===L.value.length:g.value.accessible_departments.includes(t),Bl=(t,e)=>{t===$e?e.target.checked?g.value.accessible_departments=[...L.value]:g.value.accessible_departments=[]:(e.target.checked?g.value.accessible_departments.push(t):g.value.accessible_departments=g.value.accessible_departments.filter(s=>s!==t),g.value.accessible_departments.length===L.value.length?g.value.accessible_departments=[...L.value]:g.value.accessible_departments=g.value.accessible_departments.filter(s=>s!==$e))},Pl=t=>{t===$e&&(g.value.accessible_departments=[...L.value])},zl=t=>{t===$e&&(g.value.accessible_departments=[])},pt=_(!1),Be=J(()=>{var e;let t=[...Z.value];if(Te.value&&(t=t.filter(s=>s.is_hod===1)),(e=we.value)!=null&&e.trim()){const s=we.value.toLowerCase();t=t.filter(o=>o.role.toLowerCase().includes(s))}return t.sort((s,o)=>s.role.localeCompare(o.role)),t.sort((s,o)=>{const r=S.value.includes(s.role),n=S.value.includes(o.role);return r===n?0:r?1:-1}),t.map(s=>s.role)}),Nl=J(()=>{const t=Be.value;return t.length>0&&t.every(e=>S.value.includes(e))});Se([S,Be],()=>{const t=Be.value;pt.value=t.length>0&&t.every(e=>S.value.includes(e))},{immediate:!0,deep:!0});function Hl(t){const e=t.target.checked,s=Z.value.filter(o=>{var r;return!(Te.value&&o.is_hod!==1||(r=we.value)!=null&&r.trim()&&!o.role.toLowerCase().includes(we.value.toLowerCase()))}).map(o=>o.role);e?S.value=Array.from(new Set([...S.value,...s])):S.value=S.value.filter(o=>!s.includes(o)),pt.value=e}function jl(){S.value=[],pt.value=!1,Te.value=!1}const pe=_("");function Yl(){const t=h[M.value];if(!t||!t.sections){console.error("Error: Invalid block or sections not found.");return}let e={type:M.value==0?"requestor":"approver",roles:S.value,approval_required:U.value,approver_can_edit:j.value,fields:t.sections.flatMap(bt),idx:M.value};M.value!==0&&(e.view_only_reportee=pe.value==="ViewOnlyReportee"?1:0,e.all_approvals_required=pe.value==="all_approvals_required"?1:0,e.requester_as_a_approver=pe.value==="requester_as_a_approver"?1:0,e.on_rejection=ve.value?ve.value:0);const s=I.findIndex(o=>o.idx===e.idx);s!==-1?I[s]=e:I.push(e),Zl()}function W(t){return I.find(e=>e.idx===t)||{roles:[]}}function Jl(t){const e=W(t),s=e.roles||[];S.value=[...s],ve.value=e.on_rejection,U.value=e.approval_required,j.value=e.approver_can_edit,e.view_only_reportee===1?pe.value="ViewOnlyReportee":e.all_approvals_required===1?pe.value="all_approvals_required":e.requester_as_a_approver===1?pe.value="requester_as_a_approver":pe.value=""}const ft=t=>{Te.value=!1,we.value="",pe.value="",ve.value="",g.value.accessible_departments.length&&Gl(t,g.value.accessible_departments),M.value=t,Jl(t)};function Gl(t,e){let s={index:t,departments:e,property:g.value.business_unit};te.post(le.addDesignationroles,s).then(o=>{o.message&&(Z.value=o.message)}).catch(o=>{console.error("Error fetching designations data:",o)})}function Zl(){te.post(le.add_roles_WF,{workflow_setup:I,doctype:g.value.form_short_name,business_unit:g.value.business_unit}).then(t=>{console.log(t),M.value==0?_e("Requestor Added"):_e(`Approver-${M.value} Added`)})}function Kl(){y.push({path:ne.value.routepath||localStorage.getItem("routepath")}),localStorage.removeItem("form_json")}function Wl(){g.value.form_name="",g.value.form_short_name="",g.value.owner_of_the_form="",g.value.business_unit="",g.value.form_category="",g.value.accessible_departments=[]}const Ql=t=>{if(st.value){he("Please check all required fields before proceeding.");return}t<C.value?Et():t>C.value&&Lt()},Lt=()=>{if(st.value){he("Please check all required fields before proceeding.");return}C.value<3&&(C.value+=1,C.value===3&&(ot.value=h))},Et=()=>{C.value>1&&(C.value-=1)},Xl=_([]);function Vt(){const t={fields:JSON.stringify(["*"]),limit_page_length:"none",doctype:me.EzyFormDefinitions,doc_id:N.value};te.get(le.GetDoctypeData,{params:t}).then(e=>{var o;let s=e==null?void 0:e.message.data;if(s){s.accessible_departments&&(s.accessible_departments=s.accessible_departments.split(",")),g.value=ye(re(re({},g.value),s),{owner_of_the_form:s.owner_of_the_form||g.value.owner_of_the_form||""});const r=JSON.parse((o=e.message.data)==null?void 0:o.form_json);de.value=r.workflow,Zt.value=r.fields.filter(d=>d.fieldtype==="Table"),Xl.value=r.fields.filter(d=>d.fieldtype==="Table"),Ae.value=e.message.data.is_landscape;let n=Nt(JSON.parse(s==null?void 0:s.form_json).fields);ie.value=JSON.parse(e.message.data.form_json).child_table_fields,gl.value=[],Gt.value=[],n.forEach((d,u)=>{h.push(d)}),JSON.parse(s==null?void 0:s.form_json).workflow.forEach((d,u)=>{I.push(d)})}}).catch(e=>{console.error("Error fetching  data:",e)})}function xl(){const t={};Xe.value&&(t.print_format=Xe.value),Ae.value!==void 0&&Ae.value!==null&&(t.is_landscape=Ae.value),te.put(le.resource+me.EzyFormDefinitions+`/${F.query.id}`,t).then(e=>{console.log(e),bootstrap.Modal.getInstance(document.getElementById("customFormatModal")).hide(),_e("Print Format Added Successfully")}).catch(e=>{console.error("Error fetching  data:",e)})}function Rt(){const t={fields:JSON.stringify(["name","department_name"]),limit_page_length:"none",business_unit:`${ne.value.business_unit||F.query.business_unit}`,doctype:me.departments};te.get(le.GetDoctypeData,{params:t}).then(e=>{var s;(s=e==null?void 0:e.message.data)!=null&&s.length&&(G.value=e.message.data.map(o=>o.name),L.value=e.message.data.map(o=>o.name))}).catch(e=>{console.error("Error fetching department data:",e)})}_(""),Se(()=>g.value.owner_of_the_form,t=>{t&&mt(t)});function mt(t){t&&typeof t=="string"&&t.trim()!==""&&Il(t)}function Il(t){const e={fields:JSON.stringify(["ezy_departments_items"]),doctype:me.departments,doc_id:t};te.get(le.GetDoctypeData,{params:e}).then(s=>{var o;(o=s==null?void 0:s.message.data)!=null&&o.ezy_departments_items&&(q.value=s.message.data.ezy_departments_items.map(r=>r.category))}).catch(s=>{console.error("Error fetching categories data:",s)})}function vt(t){let e=Os(h);const s=ye(re({},g.value),{fields:e,doctype:me.EzyFormDefinitions,workflow_setup:I,form_status:t==="save"?"Created":"Draft"});s.accessible_departments=s.accessible_departments.toString(),te.post(le.savedata,s).then(o=>{if(o&&o.message&&o.message.message){let r=localStorage.getItem("preName");if(r){let n={installed:"Yes"};te.put(`${le.resource}${me.preDefinedForm}/${r}`,n).then(d=>{localStorage.removeItem("preName")}).catch(d=>{console.error("Error fetching ezyForms data:",d)})}if(y.push({params:{paramid:o.message.message},query:{id:o.message.message}}),N.value=o.message.message,N&&N!=="new"&&(h.splice(0,h.length),Vt()),I.length<h.length)Bs("Add Workflow");else if(Ut.value===!0){_e("Form Created Successfully!",{autoClose:2e3,transition:"zoom"});let n=localStorage.getItem("routepath");t==="save"?y.push({path:n}):t==="Draft"&&y.push({path:n})}}else console.error("Invalid response structure:",o)}).catch(o=>{console.error("Error saving form data:",o)})}const lt=_(""),es=()=>{var s,o;const t=h.length,e={label:t===0?"requestor":`approver-${t}`,parent:`${(s=qe.value)==null?void 0:s.value}-${(o=g.value)==null?void 0:o.form_short_name}`,sections:[{label:"",parent:`${qe.value.value}-${g.value.form_short_name}`,childTables:[],afterCreated:{},rows:t===0?[{label:`row_0_0_${t}`,columns:[{label:"",fields:[{label:"Requested By",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Requested On",fieldtype:"Datetime",options:"",reqd:!1}]}]},{label:`row_0_1_${t}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1,description:""}]}]}]:[{label:`row_0_0_${t}`,columns:[{label:"",fields:[{label:"Approver",fieldtype:"Data",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved On",fieldtype:"Datetime",options:"",reqd:!1}]},{label:"",fields:[{label:"Approved By",fieldtype:"Attach",options:"",reqd:!1}]}]}]}]};h.push(e),Ms(()=>{lt.value&&lt.value.scrollTo({top:lt.value.scrollHeight,behavior:"smooth"})})},Ut=_(!1),ts=t=>{let e=h[t];e.parent&&V.push(e);let s=[];I.length>t&&I[t].roles&&(s=[...I[t].roles]),h.splice(t,1),I.length>t&&I.splice(t,1),h.forEach((o,r)=>{o.sections.forEach((n,d)=>{n.rows.forEach((u,m)=>{u.columns.forEach((c,p)=>{fe(r,d,m,p)})})})}),s.length&&ls(s,t)};function ls(t,e){const s={role:t,level:e,document_type:g.value.form_name,short_name:g.value.form_short_name,property:g.value.business_unit};te.post(le.deleteAssigneRoles,s).then(o=>{o&&vt()})}const ss=(t,e)=>{const s={label:"",parent:`${qe.value.value}-${g.value.form_short_name}`,rows:[{label:`row_0_${e}_${t}`,columns:[{label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]}]}]};h[t].sections.splice(e+1,0,s)},os=(t,e)=>{let s=h[t].sections[e];s.parent&&V.push(s),h[t].sections.splice(e,1),h[t].sections.forEach((o,r)=>{o.rows.forEach((n,d)=>{n.columns.forEach((u,m)=>{fe(t,r,d,m)})})})},as=(t,e,s)=>{h[t].sections[e].rows[s].columns.push({label:"",fields:[{label:"",fieldtype:"",options:"",reqd:!1}]})},is=(t,e,s,o)=>{const n=h[t].sections[e].rows[s].columns,d=n[o];d.parent&&V.push(d),n.length===1?h[t].sections[e].rows.splice(s,1):n.splice(o,1),h[t].sections.forEach((u,m)=>{u.rows.forEach((c,p)=>{c.columns.forEach((k,O)=>{fe(t,m,p,O)})})})},ns=(t,e,s,o)=>{h[t].sections[e].rows[s].columns[o].fields.push({label:"",fieldtype:"",options:"",reqd:!1})},rs=(t,e,s,o,r)=>{let n=h[t].sections[e].rows[s].columns[o].fields[r];n.parent&&V.push(n),h[t].sections[e].rows[s].columns[o].fields.splice(r,1)},ds=(t,e,s,o,r)=>{const n=h[t].sections[e].rows[s].columns[o].fields[r],d=re({},n);d.name=`${n.name} Name the field`,h[t].sections[e].rows[s].columns[o].fields.splice(r+1,0,d)},cs=(t,e,s,o,r)=>{const n=jt(h);h.splice(0,h.length,...n);let d=h[t].sections[e].rows[s].columns[o].fields[r].fieldtype;(d!=="Select"||d!=="radio"||d!=="multiselect")&&(h[t].sections[e].rows[s].columns[o].fields[r].options="")};function us(t){return xe.includes(t==null?void 0:t.trim().toLowerCase())}function ps(t){return/[^a-zA-Z0-9 _\/!@#$%^&*()?.:;|/\\[\]{}]/.test(t)||t.includes('"')||t.includes("'")}function fs(t){return t.flatMap(e=>{var s;return[(s=e.label)==null?void 0:s.trim().toLowerCase(),...e.sections.flatMap(o=>{var r;return[(r=o.label)==null?void 0:r.trim().toLowerCase(),...o.rows.flatMap(n=>n.columns.flatMap(d=>{var u;return[(u=d.label)==null?void 0:u.trim().toLowerCase(),...d.fields.map(m=>{var c;return(c=m.label)==null?void 0:c.trim().toLowerCase()})]}))]})]}).filter(e=>e!==""&&!Ft.includes(e))}function fe(t,e,s,o,r){const d=fs(h).filter((c,p,k)=>k.indexOf(c)!==p),u=jt(h);h.splice(0,h.length,...u);function m(c,p){if(!c){p.errorMsg="";return}us(c)?p.errorMsg="Entered label is restricted":ps(c)?p.errorMsg=`Label should not contain special characters, double quotes (") or single quotes (')`:c.length>64?p.errorMsg="Label should not exceed 64 characters":p.errorMsg=d.includes(c.trim().toLowerCase())?"Duplicate Label Name":""}r!==void 0&&m(h[t].sections[e].rows[s].columns[o].fields[r].label,h[t].sections[e].rows[s].columns[o].fields[r]),r===void 0&&o!==void 0&&m(h[t].sections[e].rows[s].columns[o].label,h[t].sections[e].rows[s].columns[o]),o===void 0&&r===void 0&&m(h[t].sections[e].label,h[t].sections[e]),h.forEach(c=>{c.sections.forEach(p=>{m(p.label,p),p.rows.forEach(k=>{k.columns.forEach(O=>{m(O.label,O),O.fields.forEach(w=>{m(w.label,w)})})})})})}const ht=J(()=>{function t(e){return!e||typeof e!="object"?!1:"fieldtype"in e&&e.fieldtype===""||"error"in e&&e.error||"errorMsg"in e&&e.errorMsg||["Select","Table MultiSelect"].includes(e.fieldtype)&&(!e.options||e.options.trim()==="")?!0:Array.isArray(e)?e.some(t):Object.values(e).some(t)}return t(h)}),st=J(()=>x.value.length>0||z.value.length>0||!g.value.form_category||!g.value.owner_of_the_form||g.value.accessible_departments.length===0),ms=J(()=>h.some(t=>t.sections.some(e=>e.rows.some(s=>s.columns.some(o=>o.fields.some(r=>r.label&&r.fieldtype))))));function Mt(t,e){let s=t.target.value.trim();if(!s){e==="form_name"?x.value="Input cannot be empty or only spaces":e==="form_short_name"&&(z.value="Input cannot be empty or only spaces");return}if(s.length>63){e==="form_name"?x.value="Name cannot exceed 63 characters":e==="form_short_name"&&(z.value="Short name cannot exceed 63 characters");return}if(/^\d/.test(s)){e==="form_short_name"&&(z.value="First character must be a letter");return}else z.value="";if(e==="form_short_name"&&s.length<2){z.value="Short name must have at least 2 letters";return}if(e==="form_short_name"&&/[^a-zA-Z ]/.test(s)){z.value="Only alphabets and spaces are allowed";return}if(/[^a-zA-Z0-9& ]/.test(s)){e==="form_name"?x.value="Special characters are not allowed":e==="form_short_name"&&(z.value="Special characters are not allowed");return}else e==="form_name"?x.value="":e==="form_short_name"&&(z.value="");const o=[[e,"=",`${s}`],["business_unit","=",`${g.value.business_unit}`]],r={fields:JSON.stringify(["form_name","form_short_name"]),filters:JSON.stringify(o),doctype:me.EzyFormDefinitions};te.get(`${le.GetDoctypeData}`,{params:r}).then(n=>{K.value=n.message.data,e==="form_name"?x.value=s&&K.value.some(d=>d.form_name&&d.form_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Name already exists":"":e==="form_short_name"&&(z.value=s&&K.value.some(d=>d.form_short_name&&d.form_short_name.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?"Short name already exists":"")}).catch(n=>{console.error("Error fetching ezyForms data:",n),e==="form_name"?x.value="":e==="form_short_name"&&(z.value="")})}const vs=t=>t===0?"1st row":t===1?"2nd row":t===2?"3rd row":`${t+1}th row`,ot=_([]),hs=()=>{h.length&&(ot.value=h,new bootstrap.Modal(document.getElementById("formViewModal")).show())};function gs(){te.post(le.delete_form_items,{deleted_fields:V.flatMap(bt),doctype:N}).then(t=>{var e;(e=t==null?void 0:t.message)!=null&&e.success&&vt()})}function Ot(t){return it(this,null,function*(){if(ht.value){he("Please fix the errors before proceeding.");return}Ut.value=!0;let e=V.flatMap(bt);N!=null&&N!=null&&N!="new"&&e.length?gs():vt(t)})}const bs=t=>{console.log("Field added from library:",t);const e=M.value||0,s=h[e];if(!s){he("Please create a block first before adding fields");return}const o=_s(t);if(!o)return;s.sections||(s.sections=[]),s.sections.length===0&&s.sections.push({label:"",rows:[[{fields:[]}]]});const d=s.sections[0].rows[0][0];d.fields||(d.fields=[]),d.fields.push(o),console.log("Field added successfully:",o),_e(`${o.label} field added successfully`)},ys=t=>{console.log("Drag started:",t),Kt.value=t},_s=t=>{var n,d,u,m;const e=_t[t];if(!e)return console.error("Field type not found:",t),he("Field type not found"),null;const s=Date.now(),o=Math.random().toString(36).substring(2,6),r=`${t}_${s}_${o}`;return{id:`field_${s}_${o}`,fieldname:r,label:e.name,fieldtype:e.frappe_fieldtype,options:((n=e.defaultProps)==null?void 0:n.options)||"",reqd:(d=e.defaultProps)!=null&&d.required?1:0,read_only:0,hidden:0,description:e.description||"",default:((u=e.defaultProps)==null?void 0:u.default)||"",placeholder:((m=e.defaultProps)==null?void 0:m.placeholder)||""}};return(t,e)=>(a(),i("div",null,[l("div",Vo,[l("div",Ro,[l("div",Uo,[l("div",Mo,[l("div",{class:"ps-1 my-2 d-flex align-items-center",onClick:e[0]||(e[0]=s=>Kl())},e[35]||(e[35]=[l("button",{class:"btn font-13 ms-3"},[l("i",{class:"bi bi-arrow-left"}),l("span",{class:"ms-2"},"Back")],-1)])),t.$route.query.id||t.$route.query.preId?(a(),i("span",Oo,"("+b(ne.value.formId||E(F).query.form_name)+")",1)):v("",!0)]),l("div",null,[C.value===2&&E(h).length&&!t.$route.query.id?(a(),i("button",{key:0,disabled:ht.value||st.value,style:Ls({cursor:ht.value?"not-allowed":"pointer"}),type:"butoon",class:"btn font-13 btn-light",onClick:e[1]||(e[1]=s=>Ot("Draft"))},e[36]||(e[36]=[l("i",{class:"bi bi-bookmark-check-fill"},null,-1),H(" Save As Draft ")]),12,Bo)):v("",!0)])]),l("div",Po,[l("div",zo,[l("div",No,[l("div",Ho,[l("ul",jo,[(a(!0),i(B,null,P(Vl.value,s=>(a(),i("li",{key:s.id,class:T({active:C.value===s.id,completed:C.value>s.id})},[l("div",{class:T(["d-flex gap-3 align-items-center",{"not-allowed":st.value&&C.value+1===s.id}]),onClick:o=>Ql(s.id)},[C.value>s.id?(a(),i("i",Jo)):(a(),i("i",{key:1,class:T(s.icon)},null,2)),l("div",Go,[l("span",Zo,b(s.stepno),1),e[37]||(e[37]=l("br",null,null,-1)),l("span",Ko,b(s.label),1)])],10,Yo)],2))),128))])])]),l("div",Wo,[l("div",Qo,[l("div",Xo,[C.value===1?(a(),i("div",xo,[l("div",Io,[l("div",ea,[e[38]||(e[38]=l("div",null,null,-1)),e[39]||(e[39]=l("h1",{class:"font-14 fw-bold m-0"},"About Form",-1)),l("div",null,[!t.$route.query.id&&!t.$route.query.preId?(a(),i("button",{key:0,class:"btn btn-light font-12 mx-2",type:"button",onClick:Wl},"Clear Form")):v("",!0),C.value<3?(a(),Re(Ht,{key:1,class:"btn btn-dark bg-dark text-white fw-bold font-13",name:"Next",onClick:Lt})):v("",!0)])])]),l("div",ta,[l("div",la,[e[53]||(e[53]=l("div",{class:"col-sm-none col-md-4"},null,-1)),l("div",sa,[l("div",oa,[l("div",aa,[l("div",ia,[l("div",na,[E(F).query.preId?(a(),i("span",ra,e[40]||(e[40]=[H("Predefined "),l("i",{class:"bi bi-check2-circle"},null,-1)]))):v("",!0),ae(Je,{disabled:(ne.value.formId&&ne.value.formId.length>0||E(F).query.form_name)&&De.value!=="1",labeltext:"Form Name",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formName",validationStar:"true",placeholder:"Untitled Form",onChange:e[2]||(e[2]=s=>Mt(s,"form_name")),modelValue:Dt.value,"onUpdate:modelValue":e[3]||(e[3]=s=>Dt.value=s)},null,8,["disabled","modelValue"]),x.value?(a(),i("span",da,b(x.value),1)):v("",!0)])]),l("div",ca,[ae(Je,{disabled:(ne.value.formId&&ne.value.formId.length>0||E(F).query.form_name)&&De.value!=="1",labeltext:"Form Short Code",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formShortCode",validationStar:"true",placeholder:"Untitled Form",onChange:e[4]||(e[4]=s=>Mt(s,"form_short_name")),modelValue:g.value.form_short_name,"onUpdate:modelValue":e[5]||(e[5]=s=>g.value.form_short_name=s)},null,8,["disabled","modelValue"]),z.value?(a(),i("span",ua,b(z.value),1)):v("",!0)]),l("div",pa,[ae(Je,{disabled:ne.value.formId&&ne.value.formId.length>0&&De.value!=="1",labeltext:"Form Naming series",class:"formHeight",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Naming series",modelValue:g.value.series,"onUpdate:modelValue":e[6]||(e[6]=s=>g.value.series=s)},null,8,["disabled","modelValue"]),e[41]||(e[41]=Es('<small class="text-muted" style="font-size:12px;" data-v-98f807ed> Note : Enter <code data-v-98f807ed>YY-YY</code>, <code data-v-98f807ed>YYYY</code>, or <code data-v-98f807ed>ABC</code>. The system will default to the format <code data-v-98f807ed> 24-25-0001</code>, <code data-v-98f807ed> 2025-0001</code>, or <code data-v-98f807ed> ABC-0001</code> respectively. </small>',1))]),l("div",fa,[l("label",null,[e[42]||(e[42]=H("Owner Of The Form ")),g.value.owner_of_the_form?v("",!0):(a(),i("span",ma,"*"))]),ae(E(Ge),{disabled:ne.value.formId&&ne.value.formId.length>0&&De.value!=="1",onOpen:Rt,options:G.value,onChange:mt,modelValue:g.value.owner_of_the_form,"onUpdate:modelValue":e[7]||(e[7]=s=>g.value.owner_of_the_form=s),placeholder:"Select Department",multiple:!1,class:"font-11 multiselect",searchable:!0,openDirection:"bottom"},null,8,["disabled","options","modelValue"])]),l("div",va,[l("label",null,[e[43]||(e[43]=H("Form Category ")),g.value.form_category?v("",!0):(a(),i("span",ha,"*"))]),ae(E(Ge),{disabled:ne.value.formId&&ne.value.formId.length>0&&De.value!=="1",options:q.value,modelValue:g.value.form_category,"onUpdate:modelValue":e[8]||(e[8]=s=>g.value.form_category=s),placeholder:"Select Category",multiple:!1,searchable:!0,class:"font-11 multiselect"},null,8,["disabled","options","modelValue"])]),l("div",ga,[l("label",null,[e[44]||(e[44]=H("Accessible to Department ")),g.value.accessible_departments.length?v("",!0):(a(),i("span",ba,"*"))]),ae(E(Ge),{modelValue:g.value.accessible_departments,"onUpdate:modelValue":e[10]||(e[10]=s=>g.value.accessible_departments=s),options:Ul.value,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select Department",class:"font-11",onSelect:Pl,onRemove:zl,openDirection:"bottom"},{option:yt(({option:s})=>[l("div",ya,[l("input",{type:"checkbox",checked:Ol(s),class:"custom-checkbox",onChange:o=>Bl(s,o),onClick:e[9]||(e[9]=ue(()=>{},["stop"]))},null,40,_a),l("span",null,b(s),1)])]),selection:yt(({values:s,isOpen:o})=>[s.length?$((a(),i("span",{key:0,class:"multiselect__single font-10"},b(Ml.value),513)),[[Ze,!o]]):v("",!0)]),_:1},8,["modelValue","options"])]),l("div",wa,[e[45]||(e[45]=l("label",null,"Form Type",-1)),ae(E(Ge),{options:kt,modelValue:Ct.value,"onUpdate:modelValue":e[11]||(e[11]=s=>Ct.value=s),placeholder:"Select Form Type",multiple:!1,searchable:!0,label:"label","track-by":"value",reduce:s=>s.value,class:"font-11 multiselect",openDirection:"top"},null,8,["modelValue","reduce"]),e[46]||(e[46]=l("small",{class:"text-muted font-12 ms-2"},"Note: Public form is accessible by anyone through QR code.",-1))]),l("div",ka,[e[47]||(e[47]=l("label",null,[H("Has Workflow "),l("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(E(Ge),{options:["Yes","No"],modelValue:g.value.has_workflow,"onUpdate:modelValue":e[12]||(e[12]=s=>g.value.has_workflow=s),placeholder:"Select",multiple:!1,class:"font-11 multiselect",searchable:!0},null,8,["modelValue"])]),g.value.as_web_view===1?(a(),i("div",Ca,[e[48]||(e[48]=l("label",null,[H("Form Submit Response "),l("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(Je,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit Response",modelValue:g.value.public_form_response,"onUpdate:modelValue":e[13]||(e[13]=s=>g.value.public_form_response=s)},null,8,["modelValue"])])):v("",!0),g.value.as_web_view===1?(a(),i("div",Da,[e[49]||(e[49]=l("label",null,[H("Submit Notification Email "),l("span",{class:"fw-normal font-11 text-secondary"},"(optional)")],-1)),ae(Je,{class:"formHeight mt-2",type:"text",tag:"input",name:"Value",id:"formNameSeries",placeholder:"Form Submit mail",modelValue:g.value.mail_id,"onUpdate:modelValue":e[14]||(e[14]=s=>g.value.mail_id=s)},null,8,["modelValue"]),e[50]||(e[50]=l("small",{class:"text-muted font-12 ms-2"},"Note : If multiple Emails, separate with commas (,).",-1))])):v("",!0),E(F).query.preId?(a(),i("div",Fa,[l("div",Sa,[$(l("input",{class:"form-check-input linketoCheck p-1",disabled:g.value.is_predefined_doctype==1,type:"checkbox",id:"is_linked","onUpdate:modelValue":e[15]||(e[15]=s=>g.value.is_linked=s),"true-value":1,"false-value":0},null,8,$a),[[Ee,g.value.is_linked]]),e[51]||(e[51]=l("label",{class:"form-check-label font-12 mx-2 mb-0 ps-1",for:"is_linked"}," Link ",-1))])])):v("",!0),g.value.is_linked?(a(),i("div",qa,[e[52]||(e[52]=l("label",{for:"standardFormInput"},"Form",-1)),$(l("input",{type:"text",class:"form-control standardFormInput",id:"standardFormInput",disabled:g.value.is_predefined_doctype==1,"onUpdate:modelValue":e[16]||(e[16]=s=>g.value.is_linked_form=s),placeholder:"Type to search Form Name...",onInput:el,onFocus:e[17]||(e[17]=s=>We.value=!0),onBlur:ll},null,40,Aa),[[Y,g.value.is_linked_form]]),We.value&&Ke.value.length?(a(),i("ul",Ta,[(a(!0),i(B,null,P(Ke.value,(s,o)=>(a(),i("li",{class:"list-group-item formlistitem",key:o,onMousedown:ue(r=>tl(s.name),["prevent"])},b(s.name),41,La))),128))])):v("",!0)])):v("",!0)])])]),e[54]||(e[54]=l("div",{class:"col-sm-none col-md-4"},null,-1))])])])):v("",!0),C.value===2?(a(),i("div",Ea,[l("div",Va,[l("div",Ra,[l("h1",{onClick:e[18]||(e[18]=s=>Et()),class:"font-11 m-0"},e[55]||(e[55]=[l("i",{class:"bi bi-chevron-left"},null,-1),l("span",{class:"ms-2"},"Back To About Form",-1)])),l("div",Ua,[l("div",null,[ms.value?(a(),i("button",{key:0,class:"btn btn-light previewBtn d-flex align-items-center font-13",type:"button",onClick:hs},e[56]||(e[56]=[l("i",{class:"bi bi-eye me-1 ms-1 mb-0"},null,-1),H("Preview ")]))):v("",!0)]),E(h).length?(a(),i("button",{key:0,class:"btn btn-dark font-10 Withborder border",type:"button",onClick:e[19]||(e[19]=s=>Ot("save"))},b(E(N)!=="new"?"Update Form":"Create Form"),1)):v("",!0)])]),ae(Vs,{blockArr:ot.value,formDescriptions:Xt.value,childHeaders:ie.value},null,8,["blockArr","formDescriptions","childHeaders"]),l("div",Ma,[Wt.value?(a(),i("aside",Oa,[ae(Eo,{collapsible:!0,onFieldAdd:bs,onFieldDragstart:ys})])):v("",!0),l("div",Ba,[l("div",{class:"main-block",ref_key:"mainBlockRef",ref:lt},[(a(!0),i(B,null,P(E(h),(s,o)=>(a(),i("div",{class:"block-level",key:o},[l("div",Pa,[l("div",za,[l("div",Na,[l("h6",Ha,b(o===0?"Requestor Block":`Approver
                                  Block ${o}
                                  `),1),l("div",ja,[o!==0&&W(o).view_only_reportee||W(o).all_approvals_required||W(o).requester_as_a_approver?(a(),i("div",Ya,[l("span",Ja,b(W(o).view_only_reportee===1?"Reporting Manager only":"")+" "+b(W(o).all_approvals_required===1?"All of the selected approvers":"")+" "+b(W(o).requester_as_a_approver===1?"Approval by Requestor":""),1),l("span",null,[e[57]||(e[57]=l("span",{class:"ms-1"}," on rejection escalating to ",-1)),l("span",Ga,b(W(o).on_rejection?`Level ${W(o).on_rejection}`:"Requestor"),1)]),l("span",Za,b(W(o).all_approvals_required===1?"":"(Skipping multi approval)"),1)])):v("",!0)])]),l("div",Ka,[E(N)&&E(I).length?(a(),i("div",Wa,[W(o)?(a(),i("label",Qa,[l("span",Xa,b(W(o).roles.length>0?o===0?"Requestor: ":"Approver: ":""),1),l("span",xa,b(W(o).roles.slice(0,2).join(", ")),1),W(o).roles.length>2?(a(),i("span",{key:0,"data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:r=>ft(o),class:"more-count"}," +"+b(W(o).roles.length-2)+" more ",9,Ia)):v("",!0)])):v("",!0)])):v("",!0),xt(o)&&E(N)!=null&&E(N)!=null&&E(N)!="new"&&W(o).roles.length===0?(a(),i("button",{key:1,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:r=>ft(o)},[e[58]||(e[58]=l("img",{src:Ps,alt:"Add",class:"me-1"},null,-1)),H(" "+b(o===0?"Add Requestors":"Add Approvers"),1)],8,ei)):v("",!0),E(N)!=null&&E(N)!=null&&E(N)!="new"&&W(o).roles.length>0?(a(),i("button",{key:2,class:"btn btn-light designationBtn d-flex align-items-center",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:r=>ft(o)},e[59]||(e[59]=[l("i",{class:"bi bi-pencil font-14"},null,-1)]),8,ti)):v("",!0),l("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteBlock",onClick:r=>ts(o)},e[60]||(e[60]=[l("i",{class:"bi bi-trash me-1"},null,-1),H(" Delete Block ")]),8,li)])])]),l("div",si,[(a(!0),i(B,null,P(s.sections,(r,n)=>(a(),i("div",{key:"section-"+n,class:"dynamicSection mt-0 section"},[l("section",oi,[l("div",ai,[$(l("input",{"onUpdate:modelValue":d=>r.label=d,type:"text",class:T(["border-less-input","font-14",{"italic-style":!r.label},{"fw-medium":r.label}]),onChange:d=>fe(o,n),onInput:d=>fe(o,n),placeholder:"Untitled section"},null,42,ii),[[Y,r.label]]),r.errorMsg?(a(),i("small",ni,b(r.errorMsg),1)):v("",!0)]),l("div",ri,[l("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:d=>os(o,n)},e[61]||(e[61]=[l("i",{class:"bi bi-trash me-1"},null,-1),H(" Delete Section ")]),8,di)])]),l("div",ci,[(a(!0),i(B,null,P(r.rows,(d,u)=>(a(),i("section",{class:"row dynamicRow row-container",key:"row-"+u},[l("div",ui,[l("label",pi,b(vs(u)),1),l("div",null,[d.columns.length<3?(a(),i("button",{key:0,class:"btn btn-light bg-transparent border-0 p-1 font-12",onClick:m=>as(o,n,u)},e[62]||(e[62]=[l("i",{class:"bi bi-plus font-14"},null,-1),H(" Add Column ")]),8,fi)):v("",!0)])]),l("div",mi,[l("div",vi,[(a(!0),i(B,null,P(d.columns,(m,c)=>(a(),i("div",{key:"column-"+c,onMouseenter:p=>cl(o,n,u,c),onMouseleave:ul,class:"col p-0 dynamicColumn position-relative column-container"},[l("div",gi,[l("div",bi,[$(l("input",{"onUpdate:modelValue":p=>m.label=p,type:"text",class:T(["border-less-input","ps-1","font-14","inputHeight",{"italic-style":!m.label},{"fw-medium":m.label}]),onChange:p=>fe(o,n,u,c),onInput:p=>fe(o,n,u,c),placeholder:"Column Name"},null,42,yi),[[Y,m.label]]),m.errorMsg?(a(),i("small",_i,b(m.errorMsg),1)):v("",!0)]),$(l("div",wi,[l("button",{class:"btn btn-light bg-transparent me-1 btn-sm",onClick:p=>is(o,n,u,c)},e[63]||(e[63]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,ki)],512),[[Ze,pl(o,n,u,c)]])]),m.fields.length===0?(a(),i("div",{key:0,class:"empty-drop-zone",onDragover:e[20]||(e[20]=ue(()=>{},["prevent"])),onDrop:p=>ke(p,o,n,u,c,t.fieldIndex)},null,40,Ci)):v("",!0),(a(!0),i(B,null,P(m.fields,(p,k)=>{var O;return a(),i("div",{key:"field-"+k,onMouseenter:w=>nl(o,n,u,c,k),onMouseleave:rl,class:"dynamicField m-1 draggable-item",draggable:"true",onDragstart:w=>St(w,o,n,u,c,k),onDragover:e[24]||(e[24]=ue(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},[l("div",{class:"drop-zone",onDragover:e[21]||(e[21]=ue(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},null,40,Fi),p.fieldtype!=="Table"?(a(),i("div",{key:0,class:"px-1 dynamic_fied field-border",draggable:"true",onDragstart:w=>St(w,o,n,u,c,k),onDragover:e[22]||(e[22]=ue(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},[l("div",$i,[l("div",qi,[$(l("input",{"onUpdate:modelValue":w=>p.label=w,placeholder:"Name the field",class:T(["border-less-input","font-14","p-0","inputHeight",{"italic-style":!p.label},{"fw-medium":p.label}]),onChange:w=>fe(o,n,u,c,k),onInput:w=>fe(o,n,u,c,k)},null,42,Ai),[[Y,p.label]]),p.errorMsg?(a(),i("small",Ti,b(p.errorMsg),1)):v("",!0)]),$(l("div",Li,[l("button",{class:"btn btn-light btn-sm bg-transparent py-0",onClick:w=>ds(o,n,u,c,k)},e[64]||(e[64]=[l("i",{class:"ri-file-copy-line font-13 copyIcon"},null,-1)]),8,Ei),l("button",{class:"btn btn-light btn-sm bg-transparent trash-btn py-0",onClick:w=>{rs(o,n,u,c,k),fe(o,n,u,c)}},e[65]||(e[65]=[l("i",{class:"bi bi-x-lg font-13"},null,-1)]),8,Vi)],512),[[Ze,dl(o,n,u,c,k)]])]),$(l("select",{"onUpdate:modelValue":w=>p.fieldtype=w,class:"form-select mb-2 mt-1 font-13 searchSelect",onChange:w=>cs(o,n,u,c,k)},[e[66]||(e[66]=l("option",{value:""},"Select Type",-1)),(a(),i(B,null,P(Rl,w=>l("option",{key:w,value:w.type},b(w.label),9,Ui)),64))],40,Ri),[[Ve,p.fieldtype]]),["Select","Table MultiSelect","Small Text"].includes(p.fieldtype)?(a(),i("div",Mi,[e[67]||(e[67]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),$(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":w=>p.options=w,class:"form-control shadow-none mb-1 font-12"},null,8,Oi),[[Y,p.options]]),!p.options||p.options.trim()===""?(a(),i("small",Bi," Options are required for this field type. ")):v("",!0)])):v("",!0),p.fieldtype==="Link"?(a(),i("div",Pi,[l("label",{class:"font-11 fw-light",for:"link-search-"+ge(o,n,u,c,k)}," Search Doctype: ",8,zi),$(l("input",{id:"link-search-"+ge(o,n,u,c,k),type:"text","onUpdate:modelValue":w=>E(h)[o].sections[n].rows[u].columns[c].fields[k].options=w,onInput:w=>ol(E(h)[o].sections[n].rows[u].columns[c].fields[k].options,o,n,u,c,k),onFocus:w=>sl(ge(o,n,u,c,k)),class:"form-control font-12 mb-1",placeholder:"Type to search..."},null,40,Ni),[[Y,E(h)[o].sections[n].rows[u].columns[c].fields[k].options]]),(O=Me[ge(o,n,u,c,k)])!=null&&O.length&&dt[ge(o,n,u,c,k)]?(a(),i("ul",Hi,[(a(!0),i(B,null,P(Me[ge(o,n,u,c,k)],(w,D)=>(a(),i("li",{key:D,onClick:A=>al(o,n,u,c,k,w.name),class:"list-group-item list-group-item-action"},b(w.name),9,ji))),128))])):v("",!0)])):v("",!0),l("div",Yi,[l("div",Ji,[l("div",Gi,[$(l("input",{class:"font-12","onUpdate:modelValue":w=>p.reqd=w,"true-value":1,id:"mandatory-"+o+"-"+n+"-"+u+"-"+c+"-"+k,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,8,Zi),[[Ee,p.reqd]])]),l("div",null,[l("label",{class:"font-12 m-0 fw-light",for:"mandatory-"+o+"-"+n+"-"+u+"-"+c+"-"+k},"Mandatory",8,Ki)])]),l("div",null,[l("button",{class:"btn btn-sm font-12",onClick:w=>p.showDescription=!p.showDescription},b(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,Wi)])]),p.showDescription?$((a(),i("textarea",{key:2,"onUpdate:modelValue":w=>p.description=w,class:"form-control font-12 mt-2",placeholder:"Enter field description"},null,8,Qi)),[[Y,p.description]]):v("",!0),p.error?(a(),i("small",Xi,b(p.error),1)):v("",!0)],40,Si)):v("",!0),l("div",{class:"drop-zone",onDragover:e[23]||(e[23]=ue(()=>{},["prevent"])),onDrop:w=>ke(w,o,n,u,c,k)},null,40,xi),l("div",Ii,[l("div",null,[l("div",null,[l("div",en,[p.fieldtype==="Table"?(a(),i("div",tn,[(a(!0),i(B,null,P(ie.value,(w,D)=>(a(),i("div",{key:D,class:"childTable"},[D===p.fieldname||D===p.options?(a(),i("h5",ln,b(D.replace(/_/g," ")),1)):v("",!0),Q[D]&&D===At.value?(a(),i("div",sn,[l("div",on,[p.showDescription?$((a(),i("input",{key:0,"onUpdate:modelValue":A=>p.description=A,class:"form-control font-12",placeholder:"Enter field description"},null,8,an)),[[Y,p.description]]):v("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:A=>p.showDescription=!p.showDescription},b(p.showDescription?"Hide Description":p.description?"Edit Description":"Add Description"),9,nn)])])):v("",!0),D===p.options||D===p.fieldname?(a(),i("table",rn,[e[71]||(e[71]=l("thead",null,[l("tr",null,[l("th",null,"#"),l("th",null,"Label"),l("th",null,"Field Type")])],-1)),l("tbody",{onDragover:ue(vl,["prevent"]),onDrop:A=>hl(A,w)},[(a(!0),i(B,null,P(w,(A,se)=>{var Pe,ze,Ne,He,je,Ye,oe;return a(),i("tr",{key:se,draggable:Q[D],onDragstart:X=>fl(se),onDragend:ml,class:T({dragging:Fe.value===se})},[l("td",null,b(se+1),1),Q[D]?(a(),i("td",un,[$(l("input",{"onUpdate:modelValue":X=>A.label=X,onInput:X=>tt(A,D,se),placeholder:"Field Label",class:T(["form-control",{"border-1 border-danger":(ze=(Pe=R[D])==null?void 0:Pe[se])==null?void 0:ze.length}])},null,42,pn),[[Y,A.label]]),(He=(Ne=R[D])==null?void 0:Ne[se])!=null&&He.length?(a(),i("div",fn,[(a(!0),i(B,null,P(R[D][se],(X,ws)=>(a(),i("div",{key:ws},b(X),1))),128))])):v("",!0)])):(a(),i("td",mn,b(A.label),1)),Q[D]?(a(),i("td",vn,[l("div",hn,[$(l("select",{"onUpdate:modelValue":X=>A.fieldtype=X,onChange:X=>tt(A,D,se),class:T(["form-select form-select-sm",{"border-1 border-danger":(Ye=(je=R[D])==null?void 0:je[se])==null?void 0:Ye.length}])},[e[68]||(e[68]=l("option",{value:""},"Select Type",-1)),(a(),i(B,null,P(ut,X=>l("option",{key:X.type,value:X.type},b(X.label),9,bn)),64))],42,gn),[[Ve,A.fieldtype]]),l("div",yn,[l("div",_n,[l("div",wn,[$(l("input",{class:"font-12 form-control-sm","onUpdate:modelValue":X=>A.description=X,placeholder:"description",type:"text"},null,8,kn),[[Y,A.description]])])]),l("button",{class:"btn btn-light btn-sm",onClick:X=>Ll(D,se)},e[69]||(e[69]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,Cn)])]),["Select"].includes(A.fieldtype)?(a(),i("div",Dn,[e[70]||(e[70]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),$(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":X=>A.options=X,onInput:X=>tt(A,D,se),class:"form-control shadow-none mb-1 font-12"},null,40,Fn),[[Y,A.options]]),!A.options||A.options.trim()===""?(a(),i("small",Sn," Options are required for this field type. ")):v("",!0)])):v("",!0),(oe=ee[D])!=null&&oe.includes(se)?(a(),i("span",$n,"Type required**")):v("",!0)])):(a(),i("td",qn,b(A.fieldtype),1))],42,cn)}),128))],40,dn)])):v("",!0),p.fieldtype==="Table"&&(p.label===D||p.fieldname===D)?(a(),i("div",An,[l("button",{class:"btn btn-light btn-sm mx-2",onClick:A=>El(D,p.description)},b(Q[D]?"Save":"Edit"),9,Tn),Q[D]?(a(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:A=>Tl(D)}," Add More Field ",8,Ln)):v("",!0)])):v("",!0)]))),128))])):v("",!0)])])])])],40,Di)}),128)),l("div",{class:"drop-zone-bottom",onDragover:e[25]||(e[25]=ue(()=>{},["prevent"])),onDrop:p=>ke(p,o,n,u,c,m.fields.length),style:{"background-color":"#f0f0f0",border:"1px dashed #ccc",margin:"4px"}},null,40,En),l("div",{class:"drop-zone",onDragover:e[26]||(e[26]=ue(()=>{},["prevent"])),onDrop:p=>ke(p,o,n,u,c,t.fields.length),style:{height:"10px","background-color":"transparent"}},null,40,Vn),l("div",Rn,[l("button",{class:"btn btn-light btn-sm d-flex align-items-center addField m-2",onClick:p=>ns(o,n,u,c)},e[72]||(e[72]=[l("i",{class:"bi bi-plus fs-5"},null,-1),l("span",null,"Add Field",-1)]),8,Un)])],40,hi))),128))])])]))),128)),l("div",null,[(a(!0),i(B,null,P(r.afterCreated,(d,u)=>(a(),i("div",{key:u,class:"childTable dynamicColumn m-0 p-2"},[l("h5",Mn,b(d.tableName),1),Q[d.tableName]?(a(),i("div",On,[l("div",Bn,[d.showDescription?$((a(),i("input",{key:0,"onUpdate:modelValue":m=>d.description=m,class:"form-control font-12",placeholder:"Enter field description"},null,8,Pn)),[[Y,d.description]]):v("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:m=>d.showDescription=!d.showDescription},b(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,zn)])])):v("",!0),l("table",Nn,[e[78]||(e[78]=l("thead",null,[l("tr",null,[l("th",null,"#"),l("th",null,"Label"),l("th",null,"Field Type")])],-1)),l("tbody",null,[(a(!0),i(B,null,P(d.columns,(m,c)=>{var p,k,O,w;return a(),i("tr",{key:c},[l("td",null,b(c+1),1),Q[d.tableName]?(a(),i("td",Hn,[$(l("input",{"onUpdate:modelValue":D=>m.label=D,placeholder:"Field Label",class:T(["form-control",{"border-1 border-danger":(p=ee[d.tableName])==null?void 0:p.includes(c)}]),onBlur:D=>{var A;m.label=(A=m.label)==null?void 0:A.trim(),Oe(m,d.tableName,c,d.columns)}},null,42,jn),[[Y,m.label]]),(k=R[d.tableName])!=null&&k[c]?(a(),i("div",Yn,[(a(!0),i(B,null,P(R[d.tableName][c],(D,A)=>(a(),i("span",{key:A},[H(b(D)+" ",1),e[73]||(e[73]=l("br",null,null,-1))]))),128))])):v("",!0)])):(a(),i("td",Jn,b(m.label),1)),Q[d.tableName]?(a(),i("td",Gn,[l("div",Zn,[$(l("select",{"onUpdate:modelValue":D=>m.fieldtype=D,class:T(["form-select form-select-sm",{"border-1 border-danger":(O=ee[d.tableName])==null?void 0:O.includes(c)}]),onChange:D=>Oe(m,d.tableName,c,d.columns)},[e[74]||(e[74]=l("option",{value:""},"Select Type",-1)),(a(),i(B,null,P(ut,D=>l("option",{key:D.type,value:D.type},b(D.label),9,Wn)),64))],42,Kn),[[Ve,m.fieldtype]]),l("button",{class:"btn btn-light btn-sm",onClick:D=>ql(o,n,d.tableName,c)},e[75]||(e[75]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,Qn)]),m.fieldtype==="Select"?(a(),i("div",Xn,[e[76]||(e[76]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),$(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":D=>m.options=D,class:"form-control shadow-none mb-1 font-12",onInput:D=>Oe(m,d.tableName,c,d.columns)},null,40,xn),[[Y,m.options]])])):v("",!0),(w=R[d.tableName])!=null&&w[c]?(a(),i("div",In,[(a(!0),i(B,null,P(R[d.tableName][c],(D,A)=>(a(),i("span",{key:A},[H(b(D),1),e[77]||(e[77]=l("br",null,null,-1))]))),128))])):v("",!0)])):(a(),i("td",er,b(m.fieldtype),1))])}),128))])]),l("div",tr,[l("button",{class:"btn btn-light btn-sm mx-2",onClick:m=>Al(o,n,d.tableName)},b(Q[d.tableName]?"Save":"Edit"),9,lr),Q[d.tableName]?(a(),i("button",{key:0,class:"btn btn-light btn-sm",onClick:m=>$l(o,n,d.tableName)}," Add More Field ",8,sr)):v("",!0)])]))),128))])]),l("div",null,[l("div",null,[o==0?(a(),i("button",{key:0,class:"btn btn-light addRow mb-3 mt-4",onClick:d=>bl(o,n)}," Add New Table ",8,or)):v("",!0),(a(!0),i(B,null,P(r.childTables,(d,u)=>{var m;return a(),i("div",{key:`table-${o}-${n}-${u}`,class:"child-table"},[d.newTable?(a(),i("div",ar,[l("div",ir,[l("div",null,[l("span",{class:T(d.tableName?"d-none":"text-danger")},"*",2),$(l("input",{"onUpdate:modelValue":c=>d.tableName=c,placeholder:"Table Name",onBlur:c=>$t(d),class:T(["border-less-input font-14 p-0 inputHeight",{"italic-style":!d.tableName,"fw-medium":d.tableName}])},null,42,nr),[[Y,d.tableName]]),(m=R[`${o}-${n}-${u}`])!=null&&m.tableName?(a(),i("div",rr,b(R[`${o}-${n}-${u}`].tableName),1)):v("",!0),Le.value?(a(),i("div",dr,b(Le.value),1)):v("",!0),l("div",cr,[l("div",ur,[d.showDescription?$((a(),i("input",{key:0,"onUpdate:modelValue":c=>d.as_a_block=c,class:"form-control font-12",placeholder:"Enter field description"},null,8,pr)),[[Y,d.as_a_block]]):v("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:c=>d.showDescription=!d.showDescription},b(d.showDescription?"Hide Description":d.description?"Edit Description":"Add Description"),9,fr)])])]),l("button",{class:"btn btn-light bg-transparent border-0 font-13 deleteSection",onClick:c=>_l(o,n,u)},e[79]||(e[79]=[l("i",{class:"bi bi-trash"},null,-1),H(" Remove Table ")]),8,mr)]),(a(!0),i(B,null,P(d.columns,(c,p)=>{var k,O,w,D,A,se,Pe,ze,Ne,He,je,Ye;return a(),i("div",{key:p,class:"dynamicField"},[l("div",vr,[l("div",hr,[l("div",null,[l("span",{class:T(c.label?"d-none":"text-danger")},"*",2),$(l("input",{"onUpdate:modelValue":oe=>c.label=oe,placeholder:"Name the field",onBlur:()=>{$t(c),kl(c,o,n,u,p,d.columns)},class:T(["border-less-input font-14 p-0 inputHeight",{"italic-style":!c.label,"fw-medium":c.label,"is-invalid":(w=(O=(k=R[`${o}-${n}-${u}`])==null?void 0:k.columns)==null?void 0:O[p])==null?void 0:w.label}])},null,42,gr),[[Y,c.label]]),(se=(A=(D=R[`${o}-${n}-${u}`])==null?void 0:D.columns)==null?void 0:A[p])!=null&&se.label?(a(),i("div",br,b(R[`${o}-${n}-${u}`].columns[p].label),1)):v("",!0)]),l("div",yr,[l("div",_r,[c.showDescription?$((a(),i("input",{key:0,"onUpdate:modelValue":oe=>c.description=oe,class:"form-control font-12",placeholder:"Enter field description"},null,8,wr)),[[Y,c.description]]):v("",!0),l("button",{class:"btn btn-sm text-nowrap font-12",onClick:oe=>c.showDescription=!c.showDescription},b(c.showDescription?"Hide Description":c.description?"Edit Description":"Add Description"),9,kr)]),l("button",{class:"btn btn-sm trash-btn py-0",onClick:oe=>wl(o,n,u,p)},e[80]||(e[80]=[l("i",{class:"bi bi-x-lg"},null,-1)]),8,Cr)])]),$(l("select",{"onUpdate:modelValue":oe=>c.fieldtype=oe,class:T(["form-select font-13 mb-1",{"is-invalid":(Ne=(ze=(Pe=R[`${o}-${n}-${u}`])==null?void 0:Pe.columns)==null?void 0:ze[p])==null?void 0:Ne.fieldtype}])},[e[81]||(e[81]=l("option",{value:""},"Select Type",-1)),(a(),i(B,null,P(ut,oe=>l("option",{key:oe.type,value:oe.type},b(oe.label),9,Fr)),64))],10,Dr),[[Ve,c.fieldtype]]),["Select"].includes(c.fieldtype)?(a(),i("div",Sr,[e[82]||(e[82]=l("label",{class:"font-12 fw-light",for:"options"},"Enter Options:",-1)),$(l("textarea",{id:"options",placeholder:"Enter your Options","onUpdate:modelValue":oe=>c.options=oe,class:"form-control shadow-none mb-1 font-12"},null,8,$r),[[Y,c.options]]),!c.options||c.options.trim()===""?(a(),i("small",qr," Options are required for this field type. ")):v("",!0)])):v("",!0),(Ye=(je=(He=R[`${o}-${n}-${u}`])==null?void 0:He.columns)==null?void 0:je[p])!=null&&Ye.fieldtype?(a(),i("div",Ar,b(R[`${o}-${n}-${u}`].columns[p].fieldtype),1)):v("",!0)])])}),128)),l("button",{class:"btn btn-light btn-sm addField mx-1",onClick:c=>yl(o,n,u)},e[83]||(e[83]=[l("i",{class:"bi bi-plus"},null,-1),H(" Add Field ")]),8,Tr),l("button",{class:"btn btn-dark btn-sm font-12 mx-1",onClick:c=>Sl(o,n,u)}," Create Table ",8,Lr),e[84]||(e[84]=l("hr",null,null,-1))])):v("",!0)])}),128))])]),l("div",Er,[l("button",{class:"btn btn-light border font-12",onClick:d=>ss(o,n)},e[85]||(e[85]=[l("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1),H(" Add Section ")]),8,Vr)])]))),128)),o===0?(a(),i("div",Rr)):v("",!0)])]))),128)),l("div",{class:T(["d-flex justify-content-center align-items-center add-block-btn-div py-4  ",{"background-color-white":E(h).length}])},[l("button",{class:"btn btn-light border d-flex align-items-center font-12",onClick:es},[e[86]||(e[86]=l("i",{class:"bi bi-plus-circle me-1 fs-6"},null,-1)),H(" "+b(E(h).length===0?"Add Requestor Block":"Add Approval Block"),1)])],2)],512)])])])])):v("",!0),C.value===3?(a(),i("div",Ur,[e[87]||(e[87]=l("div",{class:"stepperbackground d-flex align-items-center justify-content-end gap-2"},[l("div",null,[l("button",{class:"btn btn btn-light previewBtn font-13","data-bs-toggle":"modal","data-bs-target":"#customFormatModal"},"Print Format ")]),l("div")],-1)),ae(Rs,{blockArr:ot.value},null,8,["blockArr"])])):v("",!0)])])])])])])]),l("div",Mr,[l("div",Or,[l("div",Br,[e[91]||(e[91]=l("div",{class:"modal-header"},[l("h5",{class:"modal-title",id:"customFormatModalLabel"},"Print Format"),l("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),l("div",Pr,[e[89]||(e[89]=l("label",{for:""},"Form Name",-1)),$(l("input",{"onUpdate:modelValue":e[27]||(e[27]=s=>Xe.value=s),multiple:!1,placeholder:E(F).query.id,class:"font-11 form-control",id:"Form_name_print",searchable:!0},null,8,zr),[[Y,Xe.value]]),l("div",Nr,[l("div",Hr,[$(l("input",{class:"font-12","onUpdate:modelValue":e[28]||(e[28]=s=>Ae.value=s),"true-value":1,"false-value":0,placeholder:"Field Name",type:"checkbox"},null,512),[[Ee,Ae.value]])]),e[88]||(e[88]=l("div",null,[l("label",{for:"mandatory",class:"font-12 fw-bold m-0 fw-light"},"Print Landscape Mode")],-1))])]),l("div",{class:"modal-footer"},[e[90]||(e[90]=l("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close",-1)),l("button",{type:"button",class:"btn btn-dark",onClick:xl},"Add Print Format")])])])]),l("div",jr,[l("div",Yr,[l("span",Jr,b(M.value==0?"Add designation for Requestors":`Approval Settings For
          Level-${M.value}`),1),e[92]||(e[92]=l("button",{type:"button",class:"btn-close bg-light text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),l("div",Gr,[l("div",Zr,[l("div",Kr,[M.value!==0?(a(),i("div",Wr,[M.value!==0?(a(),i("div",Qr,[e[94]||(e[94]=l("label",{class:"fw-bold font-12 mb-2"},"Approver Type",-1)),$(l("select",{"onUpdate:modelValue":e[29]||(e[29]=s=>pe.value=s),class:"form-select shadow-none font-12"},e[93]||(e[93]=[l("option",{value:""},"Any one of the selected approvers",-1),l("option",{value:"ViewOnlyReportee"},"Reporting Manager only",-1),l("option",{value:"all_approvals_required"},"All of the selected approvers",-1),l("option",{value:"requester_as_a_approver"},"Approval by Requestor",-1)]),512),[[Ve,pe.value]])])):v("",!0)])):v("",!0)])]),l("div",Xr,[l("div",xr,[l("span",Ir," Select "+b(M.value===0?"Requestors":"Approvers"),1),l("span",ed,b(S.value.length)+" Selected ",1)]),Z.value.length?(a(),i("div",td,[l("div",ld,[l("div",sd,[l("input",{type:"checkbox",id:"selectAll",checked:Nl.value,onChange:Hl,class:"form-check-input me-2 designationCheckBox"},null,40,od),l("label",ad," Select all designation ("+b(Be.value.length)+") ",1)]),M.value!==0?(a(),i("div",id,[$(l("input",{type:"checkbox",id:"showHods","onUpdate:modelValue":e[30]||(e[30]=s=>Te.value=s),class:"form-check-input me-2 designationCheckBox"},null,512),[[Ee,Te.value]]),e[95]||(e[95]=l("label",{for:"showHods",class:"form-check-label mt-2 fw-bold"}," Show HODs Only ",-1))])):v("",!0),l("div",null,[S.value.length?(a(),i("button",{key:0,type:"button",class:"btn btn-sm font-12 text-danger",onClick:jl},e[96]||(e[96]=[l("i",{class:"bi bi-x"},null,-1),H(" Clear all ")]))):v("",!0)])]),Z.value.length?(a(),Re(E(Us),{key:0,multiple:!0,modelValue:S.value,"onUpdate:modelValue":e[31]||(e[31]=s=>S.value=s),options:Be.value,"close-on-select":!1,"clear-search-on-select":!0,placeholder:"Search & Select Designations"},null,8,["modelValue","options"])):v("",!0)],512)):(a(),i("div",nd,e[97]||(e[97]=[l("div",{class:"d-flex justify-content-center"},[l("span",null,"No Designations Found")],-1)])))]),M.value!==0?(a(),i("div",rd,[e[98]||(e[98]=l("div",null,[l("label",{for:"",class:"fw-bold font-12"},"On Rejection")],-1)),$(l("select",{"onUpdate:modelValue":e[32]||(e[32]=s=>ve.value=s),class:"form-select shadow-none font-12 mt-1 me-2"},[(a(!0),i(B,null,P(il.value,s=>(a(),i("option",{key:s,value:s},b(s===0?"Requestor":"Approver Level "+s),9,dd))),128))],512),[[Ve,ve.value,void 0,{number:!0}]])])):v("",!0),M.value!==0?(a(),i("div",cd,[l("div",ud,[l("div",pd,[$(l("input",{"onUpdate:modelValue":e[33]||(e[33]=s=>U.value=s),type:"checkbox","true-value":1,"false-value":0,id:"Approver",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Ee,U.value]]),e[99]||(e[99]=l("label",{for:"Approver",class:"m-0"},"Approval Mandatory",-1))]),rt.value===!0?(a(),i("div",fd,[$(l("input",{"onUpdate:modelValue":e[34]||(e[34]=s=>j.value=s),type:"checkbox","true-value":1,"false-value":0,id:"approver_can_edit",class:"me-2 m-0 form-check-input designationCheckBox"},null,512),[[Ee,j.value]]),e[100]||(e[100]=l("label",{for:"approver_can_edit",class:"m-0"}," Allow this approver to edit the form ",-1))])):v("",!0)])])):v("",!0)]),l("div",md,[l("div",vd,[l("div",null,[ae(Ht,{class:"btn btn-dark addingDesignations","data-bs-dismiss":"offcanvas",onClick:Yl,name:M.value===0?"Add Requestor":"Add Approvers"},null,8,["name"])])])])])]))}},yd=Ue(hd,[["__scopeId","data-v-98f807ed"]]);export{yd as default};
