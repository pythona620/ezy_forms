import{_ as z,r as m,x as P,E as V,f as W,K as d,y as l,z as i,w as x,g as O,o as f,c as _,d as o,F as J,h as G,t as w,i as j,m as q,X as Y,l as H,H as g,U as h,D as K,C as Q}from"./index-B-feo3ex.js";const X={class:"p-1 mt-3"},Z={class:"table"},ee={class:"text-end align-middle pe-3"},te={class:"bi bi-info-circle text-primary cursor-pointer"},ae={class:"px-4 text-end"},oe={key:0},se=["onClick"],ne={key:1,class:"d-flex justify-content-end align-items-center gap-2"},le={class:"form-check form-switch"},ie=["checked","onClick"],ce={class:"form-check-label mt-1"},de={class:"modal fade",id:"EnableDisable",tabindex:"-1","data-bs-backdrop":"static","aria-labelledby":"EnableDisableLabel","aria-hidden":"true"},re={class:"modal-dialog modal-dialog-centered"},ue={class:"modal-content"},me={class:"modal-header"},ge={class:"modal-title",id:"EnableDisableLabel"},he={class:"modal-body"},be={key:0,class:"logo-upload text-center"},pe={class:"btn btn-outline-secondary upload-label"},fe={key:0,for:"logoInput",class:"logo-preview mt-3 position-relative"},_e=["src"],ye={key:1},we={class:"modal-footer"},ve={__name:"AuthenticationPage",setup(Se){const c=m([{title:"Two Factor Authentication",checked:!1,about:"User need to scan QR code using Google Authenticator and set his two factor Authentication."},{title:"Send Form as an Attachment Via an E-Mail",checked:!1,about:"When a request is raised, an email will be triggered to all the approval members with form as an attachment."},{title:"Welcome E-Mail Configuration",checked:!1,about:"An email will be sent to the new user."},{title:"Enable Sign Up in Login Page",checked:!1,about:"In login page Sign up screen will be enabled so that new user can register them self."},{title:"Send Daily E-mail reminders",checked:!1,about:"Team members will receive a daily morning notification containing a list of pending forms that require their attention."},{title:"Take Acknowledgement and Signature while Login",checked:!1,about:"A message will be displayed at the time of Sign in by the user to Acknowledge and Sign at the time of login."},{title:"Take Signature while Sign Up",checked:!1,about:"When enabled user need to submit his signature before doing any activity in the application."},{title:"Allow Approver to Edit Form?",checked:!1,about:"When enabled approver can edit the form."},{title:"Form Attachment View Required Before Approval",checked:!1,about:"When form approval, the approver must view all attachments linked to that form."},{title:"Company Logo",checked:!1,about:"You can upload the company logo."}]),v=m(""),S=m(!1),E=m(!1),$=m(null),A=m(!1),u=m(""),F=m(!1),I=m(""),B=P(()=>V.value);W(()=>{R()});const C=t=>{$.value=t,A.value=c.value[t].checked,F.value=A.value;const e=A.value===!1?1:0;t===0?u.value=e?"Are you sure you want to enable Two Factor Authentication?":"Are you sure you want to disable Two Factor Authentication?":t===1?u.value=e?"Are you sure you want to enable Send Form As an Attachment Through E-Mail?":"Are you sure you want to disable Send Form As an Attachment Through E-Mail?":t===2?u.value=e?"Are you sure you want to enable E-Mail Configuration?":"Are you sure you want to disable E-Mail Configuration?":t===3?u.value=e?"Are you sure you want to enable Sign up?":"Are you sure you want to disable Sign up?":t===4?u.value=e?"Are you sure you want to enable daily email reminders?":"Are you sure you want to disable daily email reminders?":t===5?u.value=e?"Are you sure you want to enable Acknowledgement and Signiture while Login?":"Are you sure you want to disable Acknowledgement and Signiture while Login?":t===6?u.value=e?"Are you sure you want to enable Signiture while Sig Up?":"Are you sure you want to disable Signiture while Sig Up?":t===7?u.value=e?"Are you sure you want to enable Approver Edit Form?":"Are you sure you want to disable Approver Edit Form?":t===8?u.value=e?"Are you sure you want to enable File Attachment View Required?":"Are you sure you want to disable File Attachment View Required?":t===9&&(S.value=!0),new bootstrap.Modal(document.getElementById("EnableDisable")).show()},U=()=>{c.value[$.value].checked=F.value,S.value=!1},D=m(null);function L(t){const e=t.target.files[0];e&&(D.value=e,v.value=URL.createObjectURL(e))}const T=()=>{const t=$.value,e=A.value===!1?1:0,a=e?1:0,r=e?0:1;c.value[t].checked=!e;const s=t===0?"System Settings":localStorage.getItem("Bu")||"";if(t===0)l.put(`${i.resource}${d.SystemSettings}/${encodeURIComponent(s)}`,{enable_two_factor_auth:a}).then(()=>{g(`Two Factor Authentication ${a===0?"Disabled":"Enabled"} Successfully!`),bootstrap.Modal.getInstance(document.getElementById("EnableDisable")).hide(),M()}).catch(()=>{h("Failed to update Two Factor Authentication!")});else if(t===1)l.put(`${i.resource}${d.wfSettingEzyForms}/${encodeURIComponent(s)}`,{send_form_as_a_attach_through_mail:a}).then(()=>{g(`Send Form As an Attachment Through Mail ${a===0?"Disabled":"Enabled"} Successfully!`),bootstrap.Modal.getInstance(document.getElementById("EnableDisable")).hide(),b()}).catch(()=>{h("Failed to update Send Form As an Attachment Through Mail!")});else if(t===2)E.value===!0?l.put(`${i.resource}${d.wfSettingEzyForms}/${encodeURIComponent(s)}`,{welcome_mail_to_employee:a}).then(()=>{g(`Welcome Mail Configuration ${a===0?"Disabled":"Enabled"} Successfully!`),bootstrap.Modal.getInstance(document.getElementById("EnableDisable")).hide(),b()}).catch(()=>{h("Failed to update Welcome Mail Configuration!")}):(K("Please Configure Default Mail First!"),c.value[t].checked=!1);else if(t===3)l.put(`${i.resource}${d.websiteSettings}/${encodeURIComponent("Website Settings")}`,{disable_signup:r}).then(()=>{g(`Sign up ${r===1?"Disabled":"Enabled"} Successfully!`),bootstrap.Modal.getInstance(document.getElementById("EnableDisable")).hide(),R()}).catch(()=>{h("Failed to update Sign up!")});else if(t===4)l.put(`${i.resource}${d.wfSettingEzyForms}/${encodeURIComponent(s)}`,{send_daily_alerts:a}).then(()=>{g(`daily email reminders ${a===0?"Disabled":"Enabled"} Successfully!`),bootstrap.Modal.getInstance(document.getElementById("EnableDisable")).hide(),b()}).catch(()=>{h("Failed to update E-Mail Send Daily reminders")});else if(t===5)l.put(`${i.resource}${d.wfSettingEzyForms}/${encodeURIComponent(s)}`,{is_acknowledge:a}).then(()=>{g(`acknowledgement and Signiture ${a===0?"Disabled":"Enabled"} Successfully!`),bootstrap.Modal.getInstance(document.getElementById("EnableDisable")).hide(),b()}).catch(()=>{h("Failed to update acknowledgement")});else if(t===6)l.put(`${i.resource}${d.wfSettingEzyForms}/${encodeURIComponent(s)}`,{signature_required:a}).then(()=>{g(`Signiture while Sig Up ${a===0?"Disabled":"Enabled"} Successfully!`),bootstrap.Modal.getInstance(document.getElementById("EnableDisable")).hide(),b()}).catch(()=>{h("Failed to update Signiture while Sig Up")});else if(t===7)l.put(`${i.resource}${d.wfSettingEzyForms}/${encodeURIComponent(s)}`,{allow_approver_to_edit_form:a}).then(()=>{g(`Approverâ€™s ability to edit the form has been ${a===0?"disabled":"enabled"} successfully!`),sessionStorage.setItem("allow_approver_to_edit_form",a),bootstrap.Modal.getInstance(document.getElementById("EnableDisable")).hide(),b()}).catch(()=>{h("Failed to update Approver Edit Form")});else if(t===8)l.put(`${i.resource}${d.wfSettingEzyForms}/${encodeURIComponent(s)}`,{attachment_view_required:a}).then(()=>{g(`File Attachment View Required ${a===0?"Disabled":"Enabled"} Successfully!`,{autoClose:700}),sessionStorage.setItem("attachmentViewRequired",a),bootstrap.Modal.getInstance(document.getElementById("EnableDisable")).hide(),b()}).catch(()=>{Q.error("Failed to update File Attachment View Required")});else if(t===9){if(!D.value)return;const n=new FormData;n.append("file",D.value),l.post(i.uploadfile,n).then(p=>{const y={bu_logo:p.message.file_url,doctype:d.wfSettingEzyForms,name:s};return l.put(`${i.DataUpdate}`,y)}).then(p=>{var k,y;(k=p.message)!=null&&k.success?(g("Logo Updated Successfully"),bootstrap.Modal.getInstance(document.getElementById("EnableDisable")).hide()):h((y=p.message)==null?void 0:y.message)}).catch(p=>{console.error("Error uploading image:",p)})}};function b(){const t={fields:JSON.stringify(["name","bu_logo","bu_code","send_form_as_a_attach_through_mail","welcome_mail_to_employee","send_daily_alerts","is_acknowledge","signature_required","allow_approver_to_edit_form","attachment_view_required"]),filters:JSON.stringify([["name","=",I.value]]),doctype:d.wfSettingEzyForms,limit_page_length:"none"};l.get(i.GetDoctypeData,{params:t}).then(e=>{if(e!=null&&e.message){v.value=e.message.data[0].bu_logo;const a=e.message.data[0].send_form_as_a_attach_through_mail;c.value[1].checked=a==1;const r=e.message.data[0].welcome_mail_to_employee;c.value[2].checked=r==1;const s=e.message.data[0].send_daily_alerts;c.value[4].checked=s==1;const n=e.message.data[0].is_acknowledge;c.value[5].checked=n==1;const p=e.message.data[0].signature_required;c.value[6].checked=p==1;const k=e.message.data[0].allow_approver_to_edit_form;c.value[7].checked=k==1;const y=e.message.data[0].attachment_view_required;c.value[8].checked=y==1}}).catch(e=>{console.error("Error fetching ezyForms data:",e)})}const M=()=>{const t="System Settings",e={fields:JSON.stringify(["enable_two_factor_auth"]),doctype:d.SystemSettings,doc_id:t};l.get(`${i.GetDoctypeData}/${encodeURIComponent(t)}`,{params:e}).then(a=>{a.message.data&&(c.value[0].checked=a.message.data[0].enable_two_factor_auth==1)}).catch(a=>{console.error("Error fetching system settings:",a)})},R=()=>{const t="Website Settings",e={fields:JSON.stringify(["disable_signup"]),doctype:d.websiteSettings,doc_id:t};l.get(`${i.GetDoctypeData}/${encodeURIComponent(t)}`,{params:e}).then(a=>{a.message.data&&(c.value[3].checked=a.message.data[0].disable_signup==0)}).catch(a=>{console.error("Error fetching system settings:",a)})},N=()=>{const t={fields:JSON.stringify(["default_outgoing","enable_outgoing"]),filters:JSON.stringify([["default_outgoing","=",1],["enable_outgoing","=",1]]),doctype:d.Email_Account};l.get(`${i.GetDoctypeData}`,{params:t}).then(e=>{if(e.message.data&&e.message.data.length>0){const a=e.message.data[0];a.default_outgoing===1&&a.enable_outgoing===1?E.value=!0:E.value=!1}else E.value=!1}).catch(e=>{console.error("Error fetching system settings:",e)})};return x(B,t=>{t&&t.length&&(I.value=t,b(),N(),M())},{immediate:!0}),(t,e)=>{const a=O("tooltip");return f(),_("div",X,[e[6]||(e[6]=o("h1",{class:"m-0 font-13 mb-3"},"Settings",-1)),o("table",Z,[e[3]||(e[3]=o("thead",null,[o("tr",null,[o("th",{class:"px-2 text-center"},"S.No"),o("th",null,"Title"),o("th",{class:"text-end"},"About"),o("th",{width:"15%",class:"text-end pe-5"},"Actions")])],-1)),o("tbody",null,[(f(!0),_(J,null,G(c.value,(r,s)=>(f(),_("tr",{key:s},[o("td",null,w(s+1),1),o("td",null,w(r.title),1),o("td",ee,[j(o("i",te,null,512),[[a,r.about,void 0,{top:!0}]])]),o("td",ae,[r.title==="Company Logo"?(f(),_("div",oe,[o("div",{onClick:n=>C(s),class:"d-flex align-items-center justify-content-end font-12 gap-3 pe-3"},e[2]||(e[2]=[o("i",{class:"bi bi-eye mx-2 font-13"},null,-1),q("View ")]),8,se)])):(f(),_("div",ne,[o("div",le,[o("input",{class:"form-check-input shadow-none",type:"checkbox",role:"switch",checked:r.checked,onClick:Y(n=>C(s),["prevent"])},null,8,ie)]),o("label",ce,w(r.checked?"Enabled":"Disabled"),1)]))])]))),128))])]),o("div",de,[o("div",re,[o("div",ue,[o("div",me,[o("h5",ge,w(S.value?"Company Logo":"Confirm Action"),1),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:U})]),o("div",he,[S.value?(f(),_("div",be,[o("label",pe,[e[4]||(e[4]=o("i",{class:"bi bi-upload"},null,-1)),e[5]||(e[5]=q(" Upload Logo ")),o("input",{type:"file",accept:"image/*",id:"logoInput",onChange:e[0]||(e[0]=r=>L(r,t.index)),hidden:""},null,32)]),v.value?(f(),_("div",fe,[o("img",{src:v.value,alt:"Company Logo",class:"img-thumbnail rounded shadow",width:"100"},null,8,_e),o("button",{type:"button",class:"btn-close position-absolute top-0 end-10 font-12","aria-label":"Close",onClick:e[1]||(e[1]=r=>v.value=null)})])):H("",!0)])):(f(),_("div",ye,w(u.value),1))]),o("div",we,[o("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:U},"Close"),o("button",{type:"button",class:"btn btn-dark",onClick:T},w(S.value?"Submit":"Yes, Proceed"),1)])])])])])}}},Ae=z(ve,[["__scopeId","data-v-97a8694c"]]);export{Ae as default};
