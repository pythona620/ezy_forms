import{_ as B,d as i,f as I,L,o as p,c as f,A as x,b as n,a as m,G as C,i as j,D as U,k as v,l as c,n as $,j as P}from"./index-BHd6CXej.js";const A={class:"d-flex justify-content-between align-content-center py-3"},F={class:"btn-group dropdown"},H={class:"dropdown-menu font-12",style:{transform:"translate(-124px, 42px) !important"}},M={__name:"ReportsComp",setup(T){const d=i(!1),y=i([]);i([]);function _(){const t=[["module","=","ezy_custom_forms"]],e={fields:JSON.stringify(["*"]),filters:JSON.stringify(t)};v.get(c.resource+$.reportsApi,{params:e}).then(o=>{o.data&&(y.value=o.data)}).catch(o=>{console.error("Error:",o)})}const b=i([]),w=i([]);i([]);const a=i("");function D(t){a.value=t.name,d.value=!0,v.get(c.repostListData,{params:{report_name:a.value}}).then(e=>{var o,l,s;e&&(o=e==null?void 0:e.message)!=null&&o.columns&&(b.value=(l=e==null?void 0:e.message)==null?void 0:l.result,w.value=(s=e==null?void 0:e.message)==null?void 0:s.columns.map(r=>{let u={};return u.th=r==null?void 0:r.label,u.td_key=r==null?void 0:r.fieldname,u}))}).catch(e=>{console.error("Error",e)})}function E(){const t=document.getElementById("datatable");if(t){t.focus();const e=new KeyboardEvent("keydown",{key:"f",keyCode:70,ctrlKey:!0,bubbles:!0});t.dispatchEvent(e)}}function k(t){t.ctrlKey&&t.key==="f"&&(t.preventDefault(),E())}function R(){d.value=!1}const h=i([{th:"Name",td_key:"name"}]);function g(t){const e=a.value,o=t,l=c.ExportReport+`?report_name=${encodeURIComponent(e)}&file_format_type=${encodeURIComponent(o)}`;window.open(l,"_blank")}function N(t,e,o){if(o==="download"){if(!(t!=null&&t.name)||!(a!=null&&a.value)){console.error("Missing required data for PDF download");return}const l=a.value,s=t.name||t.Name||t.id||t.report_name,r=c.getReportData+`?doctype=${encodeURIComponent(l)}&name=${encodeURIComponent(s)}`;window.open(r,"_blank")}if(o==="mail"){const l={docname:t.name,doctype:a.value};v.post(c.reportMailSend,l).then(s=>{s&&P.success("Mail send successfully")}).catch(s=>{console.error("Upload error:",s)})}}return I(()=>{_(),document.addEventListener("keydown",k)}),L(()=>{document.removeEventListener("keydown",k)}),(t,e)=>(p(),f("section",null,[d.value?(p(),f(x,{key:1},[e[4]||(e[4]=n("div",{class:"d-flex justify-content-between align-items-center py-2"},null,-1)),n("section",null,[n("div",A,[n("button",{type:"button",class:"font-12 btn btn-light backtoListbtn",onClick:R},e[3]||(e[3]=[n("i",{class:"bi bi-chevron-left"},null,-1),j(" Back to Report List ")])),n("div",F,[m(U,{class:"btn-outline-primary m-0 dropdown-toggle d-flex justify-content-center align-items-center bg-white",name:"Export",type:"button",id:"exportDropdown","data-bs-toggle":"dropdown","aria-expanded":"false"}),n("ul",H,[n("li",null,[n("a",{class:"dropdown-item",onClick:e[0]||(e[0]=o=>g("Csv"))},"Download Csv")]),n("li",null,[n("a",{class:"dropdown-item",onClick:e[1]||(e[1]=o=>g("Excel"))},"Download Excel")])])])])]),n("section",null,[m(C,{class:"newtable",tHeaders:w.value,tData:b.value,onCellClick:N,isAction:"true",download:"true"},null,8,["tHeaders","tData"])])],64)):(p(),f(x,{key:0},[e[2]||(e[2]=n("div",{class:"d-flex justify-content-between align-items-center py-2"},[n("div")],-1)),n("div",null,[m(C,{tHeaders:h.value,tData:y.value,onCellClick:D,isAction:"true",viewType:"viewPdf",isCheckbox:"true"},null,8,["tHeaders","tData"])])],64))]))}},V=B(M,[["__scopeId","data-v-83a669f4"]]);export{V as default};
